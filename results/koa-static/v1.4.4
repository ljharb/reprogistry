[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-01T18:03:18.492Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "koa-static@1.4.4",
			"name": "koa-static",
			"version": "1.4.4",
			"location": "https://registry.npmjs.org/koa-static/-/koa-static-1.4.4.tgz",
			"integrity": "sha512-7zq435W3bQ9Xi6Qaor8YtL+VubBaVbfl26w9Z84AXTmC9f8SjUtEc/TY+eZVU44uMZ4XCvX2ikuOtvYUfV4QNA==",
			"publishedAt": "2014-05-04T17:20:13.750Z",
			"publishedWith": {
				"node": null,
				"npm": "1.4.3"
			}
		},
		"source": {
			"integrity": null,
			"location": "git://github.com/koajs/static",
			"spec": "github:koajs/static#HEAD"
		},
		"comparisonHash": "8a2a8dcbb729bf3ee9216e490c955701f0ddebe1",
		"diff": {
			"files": {
				"Readme.md": {
					"diff": "--- published/Readme.md\n+++ rebuilt/Readme.md\n@@ -1,6 +1,12 @@\n-# koa-static [![Build Status](https://travis-ci.org/koajs/static.png)](https://travis-ci.org/koajs/static)\n+# koa-static\n \n- Static file serving middleware.\n+[![NPM version][npm-image]][npm-url]\n+[![Build status][travis-image]][travis-url]\n+[![Test coverage][coveralls-image]][coveralls-url]\n+[![License][license-image]][license-url]\n+[![Downloads][downloads-image]][downloads-url]\n+\n+Koa static file serving middleware, wrapper for [`koa-send`](https://github.com/koajs/send).\n \n ## Installation\n \n@@ -8,34 +14,71 @@\n $ npm install koa-static\n ```\n \n-## Options\n+## API\n+\n+```js\n+import Koa from \"koa\"; // CJS: require('koa');\n+import serve from \"koa-static\"; // CJS: require('koa-static')\n+const app = new Koa();\n+app.use(serve(root, opts));\n+```\n+\n+- `root` root directory string. nothing above this root directory can be served\n+- `opts` options object.\n \n- - `maxage` Browser cache max-age in milliseconds. defaults to 0\n- - `hidden` Allow transfer of hidden files. defaults to false\n- - `index` Default file name, defaults to 'index.html'\n- - `defer` If true, serves after `yield next`, allowing any downstream middleware to respond first.\n+### Options\n+\n+- `maxage` Browser cache max-age in milliseconds. defaults to 0\n+- `hidden` Allow transfer of hidden files. defaults to false\n+- `index` Default file name, defaults to 'index.html'\n+- `defer` If true, serves after `return next()`, allowing any downstream middleware to respond first.\n+- `gzip` Try to serve the gzipped version of a file automatically when gzip is supported by a client and if the requested file with .gz extension exists. defaults to true.\n+- `brotli` Try to serve the brotli version of a file automatically when brotli is supported by a client and if the requested file with .br extension exists (note, that brotli is only accepted over https). defaults to true.\n+- [setHeaders](https://github.com/koajs/send#setheaders) Function to set custom headers on response.\n+- `extensions` Try to match extensions from passed array to search for file when no extension is sufficed in URL. First found is served. (defaults to `false`).  e.g. `['html']`\n \n ## Example\n \n ```js\n-var serve = require('koa-static');\n-var koa = require('koa');\n-var app = koa();\n+const serve = require(\"koa-static\");\n+const Koa = require(\"koa\");\n+const app = new Koa();\n \n // $ GET /package.json\n-app.use(serve('.'));\n+app.use(serve(\".\"));\n \n // $ GET /hello.txt\n-app.use(serve('test/fixtures'));\n+app.use(serve(\"test/fixtures\"));\n \n // or use absolute paths\n-app.use(serve(__dirname + '/test/fixtures'));\n+app.use(serve(__dirname + \"/test/fixtures\"));\n \n app.listen(3000);\n \n-console.log('listening on port 3000');\n+console.log(\"listening on port 3000\");\n ```\n \n+### See also\n+\n+- [koajs/conditional-get](https://github.com/koajs/conditional-get) Conditional GET support for koa\n+- [koajs/compress](https://github.com/koajs/compress) Compress middleware for koa\n+- [koajs/mount](https://github.com/koajs/mount) Mount `koa-static` to a specific path\n+\n ## License\n \n-  MIT\n+MIT\n+\n+[npm-image]: https://img.shields.io/npm/v/koa-static.svg?style=flat-square\n+[npm-url]: https://npmjs.org/package/koa-static\n+[github-tag]: http://img.shields.io/github/tag/koajs/static.svg?style=flat-square\n+[github-url]: https://github.com/koajs/static/tags\n+[travis-image]: https://img.shields.io/travis/koajs/static.svg?style=flat-square\n+[travis-url]: https://travis-ci.org/koajs/static\n+[coveralls-image]: https://img.shields.io/coveralls/koajs/static.svg?style=flat-square\n+[coveralls-url]: https://coveralls.io/r/koajs/static?branch=master\n+[license-image]: http://img.shields.io/npm/l/koa-static.svg?style=flat-square\n+[license-url]: LICENSE\n+[downloads-image]: http://img.shields.io/npm/dm/koa-static.svg?style=flat-square\n+[downloads-url]: https://npmjs.org/package/koa-static\n",
					"match": false,
					"packageHash": "3d5084d33e7a9f4295566c2e2e2af44d146b6651904810bc816fc1d985f0f805",
					"size": 841,
					"sourceHash": "9af7884a10d2fcfb2c373241350d8e33362744c7ecae49692fd5bd4c89b224a8",
					"status": "content"
				},
				"index.js": {
					"diff": "--- published/index.js\n+++ rebuilt/index.js\n@@ -1,17 +1,20 @@\n \n+'use strict'\n+\n /**\n  * Module dependencies.\n  */\n \n-var assert = require('assert');\n-var debug = require('debug')('koa-static');\n-var send = require('koa-send');\n+const debug = require('debug')('koa-static')\n+const path = require('path')\n+const assert = require('assert')\n+const send = require('koa-send')\n \n /**\n  * Expose `serve()`.\n  */\n \n-module.exports = serve;\n+module.exports = serve\n \n /**\n  * Serve static files from `root`.\n@@ -22,29 +25,46 @@\n  * @api public\n  */\n \n-function serve(root, opts) {\n-  opts = opts || {};\n-\n-  assert(root, 'root directory is required to serve files');\n+function serve (root, opts = {}) {\n+  assert(root, 'root directory is required to serve files')\n \n-  // options\n-  debug('static \"%s\" %j', root, opts);\n-  opts.root = root;\n-  opts.index = opts.index || 'index.html';\n+  debug('static \"%s\" %j', root, opts)\n+  opts.root = path.resolve(root)\n+  opts.index = opts.index ?? 'index.html'\n \n   if (!opts.defer) {\n-    return function *static(next){\n-      if (this.idempotent && (yield send(this, this.path, opts))) return;\n-      yield next;\n-    };\n+    return async function serve (ctx, next) {\n+      let done = false\n+\n+      if (ctx.method === 'HEAD' || ctx.method === 'GET') {\n+        try {\n+          done = await send(ctx, ctx.path, opts)\n+        } catch (err) {\n+          if (err.status !== 404) {\n+            throw err\n+          }\n+        }\n+      }\n+\n+      if (!done) {\n+        await next()\n+      }\n+    }\n   }\n \n-  return function *static(next){\n-    yield next;\n+  return async function serve (ctx, next) {\n+    await next()\n \n+    if (ctx.method !== 'HEAD' && ctx.method !== 'GET') return\n     // response is already handled\n-    if (!this.idempotent || this.body != null || this.status != null) return;\n+    if (ctx.body != null || ctx.status !== 404) return // eslint-disable-line\n \n-    yield send(this, this.path, opts);\n-  };\n-}\n\\ No newline at end of file\n+    try {\n+      await send(ctx, ctx.path, opts)\n+    } catch (err) {\n+      if (err.status !== 404) {\n+        throw err\n+      }\n+    }\n+  }\n+}\n",
					"match": false,
					"packageHash": "7734d17633fc81d32f991307abbd45c6c14711a765cf03c175247556c36f95c5",
					"size": 930,
					"sourceHash": "82b6d6256d9ef1f9adbeda38f3c287a48830c58b09f442ccfa78b554c29bd8c3",
					"status": "content"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -2,7 +2,7 @@\n   \"name\": \"koa-static\",\n   \"description\": \"Static file serving middleware for koa\",\n   \"repository\": \"koajs/static\",\n-  \"version\": \"1.4.4\",\n+  \"version\": \"5.0.0\",\n   \"keywords\": [\n     \"koa\",\n     \"middleware\",\n@@ -14,17 +14,29 @@\n     \"index.js\"\n   ],\n   \"devDependencies\": {\n-    \"koa\": \"~0.4.0\",\n-    \"should\": \"~1.2.2\",\n-    \"mocha\": \"~1.12.0\",\n-    \"supertest\": \"~0.7.1\"\n+    \"eslint\": \"^8.16.0\",\n+    \"eslint-config-standard\": \"^17.0.0\",\n+    \"eslint-plugin-import\": \"^2.26.0\",\n+    \"eslint-plugin-n\": \"^15.2.0\",\n+    \"eslint-plugin-promise\": \"^6.0.0\",\n+    \"eslint-plugin-standard\": \"^5.0.0\",\n+    \"koa\": \"^2.13.4\",\n+    \"mocha\": \"^10.0.0\",\n+    \"nyc\": \"^15.1.0\",\n+    \"supertest\": \"^6.2.3\"\n   },\n   \"license\": \"MIT\",\n   \"dependencies\": {\n-    \"debug\": \"*\",\n-    \"koa-send\": \"~1.2.3\"\n+    \"debug\": \"^4.3.4\",\n+    \"koa-send\": \"^5.0.1\"\n   },\n   \"scripts\": {\n-    \"test\": \"make test\"\n+    \"lint\": \"eslint --fix .\",\n+    \"test\": \"mocha --exit\",\n+    \"test-cov\": \"nyc npm run test\",\n+    \"test-travis\": \"nyc npm run test -- --report lcovonly\"\n+  },\n+  \"engines\": {\n+    \"node\": \">= 14\"\n   }\n }\n",
					"match": false,
					"packageHash": "f5dd7e271718a2e6204008c20aeea7216375f64dd6e18dac9ea9886de820be39",
					"size": 519,
					"sourceHash": "fc7dd30cf732dd88b68a2a22030495d4254e7228c1f8052705f78d373e5d936a",
					"status": "content"
				},
				"LICENSE": {
					"match": false,
					"status": "missing-in-package"
				}
			},
			"summary": {
				"differentFiles": 3,
				"matchingFiles": 0,
				"missingInPackage": 1,
				"missingInSource": 0,
				"score": 0,
				"totalFiles": 4
			}
		}
	}
]
