[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-04T11:28:52.186Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "d3-scale@3.3.0-rc.2",
			"name": "d3-scale",
			"version": "3.3.0-rc.2",
			"location": "https://registry.npmjs.org/d3-scale/-/d3-scale-3.3.0-rc.2.tgz",
			"integrity": "sha512-Mnmy0N2CbXxPN9UIS4YsEiLykyGyNAnccjYmmWZVf0GTb5+vgkNSWDo/up+8mqCY5R0vv4vHjnEFSvn4pLLqUA==",
			"publishedAt": "2020-07-27T16:27:49.710Z",
			"publishedWith": {
				"node": null,
				"npm": null
			}
		},
		"source": {
			"integrity": null,
			"location": "https://github.com/d3/d3-scale.git",
			"spec": "github:d3/d3-scale#HEAD"
		},
		"comparisonHash": "8a2a8dcbb729bf3ee9216e490c955701f0ddebe1",
		"diff": {
			"files": {
				"LICENSE": {
					"diff": "--- published/LICENSE\n+++ rebuilt/LICENSE\n@@ -1,27 +1,13 @@\n-Copyright 2010-2015 Mike Bostock\n-All rights reserved.\n+Copyright 2010-2021 Mike Bostock\n \n-Redistribution and use in source and binary forms, with or without modification,\n-are permitted provided that the following conditions are met:\n+Permission to use, copy, modify, and/or distribute this software for any purpose\n+with or without fee is hereby granted, provided that the above copyright notice\n+and this permission notice appear in all copies.\n \n-* Redistributions of source code must retain the above copyright notice, this\n-  list of conditions and the following disclaimer.\n-\n-* Redistributions in binary form must reproduce the above copyright notice,\n-  this list of conditions and the following disclaimer in the documentation\n-  and/or other materials provided with the distribution.\n-\n-* Neither the name of the author nor the names of contributors may be used to\n-  endorse or promote products derived from this software without specific prior\n-  written permission.\n-\n-THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n-ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n-WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n-DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n-ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n-(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n-LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n-ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n-(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n-SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n+REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND\n+FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n+INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\n+OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER\n+TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF\n+THIS SOFTWARE.\n",
					"match": false,
					"packageHash": "7eea8533ea92bd8c32a901e89ecb0305890905bb12711449565ddff96891146d",
					"size": 1475,
					"sourceHash": "e008c5e25a6be382593089c29bfabbc553c6378eee02895aec46ce396cc404ee",
					"status": "content"
				},
				"README.md": {
					"diff": "--- published/README.md\n+++ rebuilt/README.md\n@@ -1,987 +1,12 @@\n # d3-scale\n \n-Scales are a convenient abstraction for a fundamental task in visualization: mapping a dimension of abstract data to a visual representation. Although most often used for position-encoding quantitative data, such as mapping a measurement in meters to a position in pixels for dots in a scatterplot, scales can represent virtually any visual encoding, such as diverging colors, stroke widths, or symbol size. Scales can also be used with virtually any type of data, such as named categorical data or discrete data that requires sensible breaks.\n+<a href=\"https://d3js.org\"><img src=\"https://github.com/d3/d3/raw/main/docs/public/logo.svg\" width=\"256\" height=\"256\"></a>\n \n-For [continuous](#continuous-scales) quantitative data, you typically want a [linear scale](#linear-scales). (For time series data, a [time scale](#time-scales).) If the distribution calls for it, consider transforming data using a [power](#power-scales) or [log](#log-scales) scale. A [quantize scale](#quantize-scales) may aid differentiation by rounding continuous data to a fixed set of discrete values; similarly, a [quantile scale](#quantile-scales) computes quantiles from a sample population, and a [threshold scale](#threshold-scales) allows you to specify arbitrary breaks in continuous data.\n+Scales map a dimension of abstract data to a visual representation. Although most often used for encoding data as position, say to map time and temperature to a horizontal and vertical position in a scatterplot, scales can represent virtually any visual encoding, such as color, stroke width, or symbol size. Scales can also be used with virtually any type of data, such as named categorical data or discrete data that requires sensible breaks.\n \n-For discrete ordinal (ordered) or categorical (unordered) data, an [ordinal scale](#ordinal-scales) specifies an explicit mapping from a set of data values to a corresponding set of visual attributes (such as colors). The related [band](#band-scales) and [point](#point-scales) scales are useful for position-encoding ordinal data, such as bars in a bar chart or dots in an categorical scatterplot.\n+## Resources\n \n-This repository does not provide color schemes; see [d3-scale-chromatic](https://github.com/d3/d3-scale-chromatic) for color schemes designed to work with d3-scale.\n-\n-Scales have no intrinsic visual representation. However, most scales can [generate](#continuous_ticks) and [format](#continuous_tickFormat) ticks for reference marks to aid in the construction of axes.\n-\n-For a longer introduction, see these recommended tutorials:\n-\n-* [Introducing d3-scale](https://medium.com/@mbostock/introducing-d3-scale-61980c51545f) by Mike Bostock\n-\n-* Chapter 7. Scales of [*Interactive Data Visualization for the Web*](http://alignedleft.com/work/d3-book) by Scott Murray\n-\n-* [d3: scales, and color.](http://www.jeromecukier.net/2011/08/11/d3-scales-and-color/) by Jérôme Cukier\n-\n-## Installing\n-\n-If you use NPM, `npm install d3-scale`. Otherwise, download the [latest release](https://github.com/d3/d3-scale/releases/latest). You can also load directly from [d3js.org](https://d3js.org), either as a [standalone library](https://d3js.org/d3-scale.v3.min.js) or as part of [D3](https://github.com/d3/d3). AMD, CommonJS, and vanilla environments are supported. In vanilla, a `d3` global is exported:\n-\n-```html\n-<script src=\"https://d3js.org/d3-array.v2.min.js\"></script>\n-<script src=\"https://d3js.org/d3-color.v1.min.js\"></script>\n-<script src=\"https://d3js.org/d3-format.v1.min.js\"></script>\n-<script src=\"https://d3js.org/d3-interpolate.v1.min.js\"></script>\n-<script src=\"https://d3js.org/d3-time.v1.min.js\"></script>\n-<script src=\"https://d3js.org/d3-time-format.v2.min.js\"></script>\n-<script src=\"https://d3js.org/d3-scale.v3.min.js\"></script>\n-<script>\n-\n-var x = d3.scaleLinear();\n-\n-</script>\n-```\n-\n-(You can omit d3-time and d3-time-format if you’re not using [d3.scaleTime](#scaleTime) or [d3.scaleUtc](#scaleUtc).)\n-\n-## API Reference\n-\n-* [Continuous](#continuous-scales) ([Linear](#linear-scales), [Power](#power-scales), [Log](#log-scales), [Identity](#identity-scales), [Time](#time-scales), [Radial](#radial-scales))\n-* [Sequential](#sequential-scales)\n-* [Diverging](#diverging-scales)\n-* [Quantize](#quantize-scales)\n-* [Quantile](#quantile-scales)\n-* [Threshold](#threshold-scales)\n-* [Ordinal](#ordinal-scales) ([Band](#band-scales), [Point](#point-scales))\n-\n-### Continuous Scales\n-\n-Continuous scales map a continuous, quantitative input [domain](#continuous_domain) to a continuous output [range](#continuous_range). If the range is also numeric, the mapping may be [inverted](#continuous_invert). A continuous scale is not constructed directly; instead, try a [linear](#linear-scales), [power](#power-scales), [log](#log-scales), [identity](#identity-scales), [radial](#radial-scales), [time](#time-scales) or [sequential color](#sequential-scales) scale.\n-\n-<a name=\"_continuous\" href=\"#_continuous\">#</a> <i>continuous</i>(<i>value</i>) · [Source](https://github.com/d3/d3-scale/blob/master/src/continuous.js), [Examples](https://observablehq.com/@d3/continuous-scales)\n-\n-Given a *value* from the [domain](#continuous_domain), returns the corresponding value from the [range](#continuous_range). If the given *value* is outside the domain, and [clamping](#continuous_clamp) is not enabled, the mapping may be extrapolated such that the returned value is outside the range. For example, to apply a position encoding:\n-\n-```js\n-var x = d3.scaleLinear()\n-    .domain([10, 130])\n-    .range([0, 960]);\n-\n-x(20); // 80\n-x(50); // 320\n-```\n-\n-Or to apply a color encoding:\n-\n-```js\n-var color = d3.scaleLinear()\n-    .domain([10, 100])\n-    .range([\"brown\", \"steelblue\"]);\n-\n-color(20); // \"#9a3439\"\n-color(50); // \"#7b5167\"\n-```\n-\n-Or, in shorthand:\n-\n-```js\n-var x = d3.scaleLinear([10, 130], [0, 960]);\n-var color = d3.scaleLinear([10, 100], [\"brown\", \"steelblue\"]);\n-```\n-\n-<a name=\"continuous_invert\" href=\"#continuous_invert\">#</a> <i>continuous</i>.<b>invert</b>(<i>value</i>) · [Source](https://github.com/d3/d3-scale/blob/master/src/continuous.js), [Examples](https://observablehq.com/@d3/continuous-scales)\n-\n-Given a *value* from the [range](#continuous_range), returns the corresponding value from the [domain](#continuous_domain). Inversion is useful for interaction, say to determine the data value corresponding to the position of the mouse. For example, to invert a position encoding:\n-\n-```js\n-var x = d3.scaleLinear()\n-    .domain([10, 130])\n-    .range([0, 960]);\n",
					"match": false,
					"packageHash": "eb52546ed69a35215ebafc375886b42e72e4d54178d9d10f3fd3e2f2658a7d21",
					"size": 91075,
					"sourceHash": "85f069e579a483a0aa79571cd4224dc4e21d7594b3fa61dbd2cc8a5c2e178554",
					"status": "content"
				},
				"dist/d3-scale.js": {
					"match": false,
					"packageHash": "4a2ca83680835dc275f13ab2bfdbd2f92c30eb4c773ee43ca3f2a8ef31ff4880",
					"size": 32975,
					"status": "missing-in-source"
				},
				"dist/d3-scale.min.js": {
					"match": false,
					"packageHash": "45bc9e6c1a9d402e3994537726b6cfb2ccf44a233d53c685d1b2c51e8bf842c8",
					"size": 16231,
					"status": "missing-in-source"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,53 +1,57 @@\n {\n   \"name\": \"d3-scale\",\n-  \"version\": \"3.3.0-rc.2\",\n-  \"publishConfig\": {\n-    \"tag\": \"next\"\n-  },\n+  \"version\": \"4.0.2\",\n   \"description\": \"Encodings that map abstract data to visual representation.\",\n+  \"homepage\": \"https://d3js.org/d3-scale/\",\n+  \"repository\": {\n+    \"type\": \"git\",\n+    \"url\": \"https://github.com/d3/d3-scale.git\"\n+  },\n   \"keywords\": [\n     \"d3\",\n     \"d3-module\",\n     \"scale\",\n     \"visualization\"\n   ],\n-  \"homepage\": \"https://d3js.org/d3-scale/\",\n-  \"license\": \"BSD-3-Clause\",\n+  \"license\": \"ISC\",\n   \"author\": {\n     \"name\": \"Mike Bostock\",\n-    \"url\": \"http://bost.ocks.org/mike\"\n-  },\n-  \"main\": \"dist/d3-scale.js\",\n-  \"unpkg\": \"dist/d3-scale.min.js\",\n-  \"jsdelivr\": \"dist/d3-scale.min.js\",\n-  \"module\": \"src/index.js\",\n-  \"repository\": {\n-    \"type\": \"git\",\n-    \"url\": \"https://github.com/d3/d3-scale.git\"\n+    \"url\": \"https://bost.ocks.org/mike\"\n   },\n+  \"type\": \"module\",\n   \"files\": [\n     \"dist/**/*.js\",\n     \"src/**/*.js\"\n   ],\n-  \"scripts\": {\n-    \"pretest\": \"rollup -c\",\n-    \"test\": \"TZ=America/Los_Angeles tape 'test/**/*-test.js' && eslint src\",\n-    \"prepublishOnly\": \"rm -rf dist && yarn test\",\n-    \"postpublish\": \"git push && git push --tags && cd ../d3.github.com && git pull && cp ../${npm_package_name}/dist/${npm_package_name}.js ${npm_package_name}.v${npm_package_version%%.*}.js && cp ../${npm_package_name}/dist/${npm_package_name}.min.js ${npm_package_name}.v${npm_package_version%%.*}.min.js && git add ${npm_package_name}.v${npm_package_version%%.*}.js ${npm_package_name}.v${npm_package_version%%.*}.min.js && git commit -m \\\"${npm_package_name} ${npm_package_version}\\\" && git push && cd - && zip -j dist/${npm_package_name}.zip -- LICENSE README.md dist/${npm_package_name}.js dist/${npm_package_name}.min.js\"\n+  \"module\": \"src/index.js\",\n+  \"main\": \"src/index.js\",\n+  \"jsdelivr\": \"dist/d3-scale.min.js\",\n+  \"unpkg\": \"dist/d3-scale.min.js\",\n+  \"exports\": {\n+    \"umd\": \"./dist/d3-scale.min.js\",\n+    \"default\": \"./src/index.js\"\n   },\n   \"sideEffects\": false,\n   \"dependencies\": {\n-    \"d3-array\": \"1.2.0 - 2\",\n-    \"d3-format\": \">=2.0.0-rc.1\",\n-    \"d3-interpolate\": \">=2.0.0-rc.1\",\n-    \"d3-time\": \">=2.0.0-rc.1\",\n-    \"d3-time-format\": \">=3.0.0-rc.1\"\n+    \"d3-array\": \"2.10.0 - 3\",\n+    \"d3-format\": \"1 - 3\",\n+    \"d3-interpolate\": \"1.2.0 - 3\",\n+    \"d3-time\": \"2.1.1 - 3\",\n+    \"d3-time-format\": \"2 - 4\"\n   },\n   \"devDependencies\": {\n-    \"d3-color\": \">=2.0.0-rc.1\",\n-    \"eslint\": \"6\",\n-    \"rollup\": \"1\",\n-    \"rollup-plugin-terser\": \"5\",\n-    \"tape\": \"4\"\n+    \"d3-color\": \"1 - 3\",\n+    \"eslint\": \"7\",\n+    \"mocha\": \"9\",\n+    \"rollup\": \"2\",\n+    \"rollup-plugin-terser\": \"7\"\n+  },\n+  \"scripts\": {\n+    \"test\": \"TZ=America/Los_Angeles mocha 'test/**/*-test.js' && eslint src test\",\n+    \"prepublishOnly\": \"rm -rf dist && yarn test && rollup -c\",\n+    \"postpublish\": \"git push && git push --tags && cd ../d3.github.com && git pull && cp ../${npm_package_name}/dist/${npm_package_name}.js ${npm_package_name}.v${npm_package_version%%.*}.js && cp ../${npm_package_name}/dist/${npm_package_name}.min.js ${npm_package_name}.v${npm_package_version%%.*}.min.js && git add ${npm_package_name}.v${npm_package_version%%.*}.js ${npm_package_name}.v${npm_package_version%%.*}.min.js && git commit -m \\\"${npm_package_name} ${npm_package_version}\\\" && git push && cd -\"\n+  },\n+  \"engines\": {\n+    \"node\": \">=12\"\n   }\n }\n",
					"match": false,
					"packageHash": "e2e00f3a7ed3ab3974ffc72df214a1a8bab1e9277995366a24ddeccf1df244f3",
					"size": 1860,
					"sourceHash": "75f7dfe869b2e6d1cbecd380f939f218ca046a26313c4e623aa52d6352a9b51b",
					"status": "content"
				},
				"src/colors.js": {
					"diff": "--- published/src/colors.js\n+++ rebuilt/src/colors.js\n@@ -1,4 +1,4 @@\n-export default function(s) {\n+export default function colors(s) {\n   return s.match(/.{6}/g).map(function(x) {\n     return \"#\" + x;\n   });\n",
					"match": false,
					"packageHash": "36a62ff864f99e2f0d8cfe674405edba508890794d6bf5c6936a2fb763f8c319",
					"size": 101,
					"sourceHash": "718293c3c91efacdef0c4d4a2cc86c376cf1c23dc826e14364c05c01c54e27bb",
					"status": "content"
				},
				"src/constant.js": {
					"diff": "--- published/src/constant.js\n+++ rebuilt/src/constant.js\n@@ -1,4 +1,4 @@\n-export default function(x) {\n+export default function constants(x) {\n   return function() {\n     return x;\n   };\n",
					"match": false,
					"packageHash": "88f2653180d441d431ad68e0e2cf2c02aea72976c5ff24b6ed988a5bb2b78847",
					"size": 72,
					"sourceHash": "b8f6ff74e0b9e97f4359d90dead2c55a39acf7b5041356fb18bb09fd41b06d38",
					"status": "content"
				},
				"src/continuous.js": {
					"diff": "--- published/src/continuous.js\n+++ rebuilt/src/continuous.js\n@@ -83,7 +83,7 @@\n   }\n \n   function scale(x) {\n-    return isNaN(x = +x) ? unknown : (output || (output = piecewise(domain.map(transform), range, interpolate)))(transform(clamp(x)));\n+    return x == null || isNaN(x = +x) ? unknown : (output || (output = piecewise(domain.map(transform), range, interpolate)))(transform(clamp(x)));\n   }\n \n   scale.invert = function(y) {\n",
					"match": false,
					"packageHash": "7df083f4d46a37a2bfbc0915ee9c39c5b623b2e3259e824516dc39a9bc1ae85f",
					"size": 3456,
					"sourceHash": "a8bd9670abd40c813d047082a35126cb18068f1959bf78b74e6ca4c864de123a",
					"status": "content"
				},
				"src/identity.js": {
					"diff": "--- published/src/identity.js\n+++ rebuilt/src/identity.js\n@@ -5,7 +5,7 @@\n   var unknown;\n \n   function scale(x) {\n-    return isNaN(x = +x) ? unknown : x;\n+    return x == null || isNaN(x = +x) ? unknown : x;\n   }\n \n   scale.invert = scale;\n",
					"match": false,
					"packageHash": "730db5e942c102771b63fe147e86c51192d191e50b8ff1e3acf36a0115921b72",
					"size": 641,
					"sourceHash": "f8c17ac1438127e719d5480a93d539824543e0fd81266e162301ca31179dae53",
					"status": "content"
				},
				"src/linear.js": {
					"diff": "--- published/src/linear.js\n+++ rebuilt/src/linear.js\n@@ -19,38 +19,36 @@\n   scale.nice = function(count) {\n     if (count == null) count = 10;\n \n-    var d = domain(),\n-        i0 = 0,\n-        i1 = d.length - 1,\n-        start = d[i0],\n-        stop = d[i1],\n-        step;\n+    var d = domain();\n+    var i0 = 0;\n+    var i1 = d.length - 1;\n+    var start = d[i0];\n+    var stop = d[i1];\n+    var prestep;\n+    var step;\n+    var maxIter = 10;\n \n     if (stop < start) {\n       step = start, start = stop, stop = step;\n       step = i0, i0 = i1, i1 = step;\n     }\n-\n-    step = tickIncrement(start, stop, count);\n-\n-    if (step > 0) {\n-      start = Math.floor(start / step) * step;\n-      stop = Math.ceil(stop / step) * step;\n-      step = tickIncrement(start, stop, count);\n-    } else if (step < 0) {\n-      start = Math.ceil(start * step) / step;\n-      stop = Math.floor(stop * step) / step;\n+    \n+    while (maxIter-- > 0) {\n       step = tickIncrement(start, stop, count);\n-    }\n-\n-    if (step > 0) {\n-      d[i0] = Math.floor(start / step) * step;\n-      d[i1] = Math.ceil(stop / step) * step;\n-      domain(d);\n-    } else if (step < 0) {\n-      d[i0] = Math.ceil(start * step) / step;\n-      d[i1] = Math.floor(stop * step) / step;\n-      domain(d);\n+      if (step === prestep) {\n+        d[i0] = start\n+        d[i1] = stop\n+        return domain(d);\n+      } else if (step > 0) {\n+        start = Math.floor(start / step) * step;\n+        stop = Math.ceil(stop / step) * step;\n+      } else if (step < 0) {\n+        start = Math.ceil(start * step) / step;\n+        stop = Math.floor(stop * step) / step;\n+      } else {\n+        break;\n+      }\n+      prestep = step;\n     }\n \n     return scale;\n",
					"match": false,
					"packageHash": "275b2ee30df625773f618b91e62641222a93b70daa0973a6e7eaada5d29b0af0",
					"size": 1738,
					"sourceHash": "6223d1339147f7a311374307451183a110912c230e62f484b4dc06914c78ac87",
					"status": "content"
				},
				"src/log.js": {
					"diff": "--- published/src/log.js\n+++ rebuilt/src/log.js\n@@ -1,5 +1,5 @@\n import {ticks} from \"d3-array\";\n-import {format} from \"d3-format\";\n+import {format, formatSpecifier} from \"d3-format\";\n import nice from \"./nice.js\";\n import {copy, transformer} from \"./continuous.js\";\n import {initRange} from \"./init.js\";\n@@ -27,28 +27,26 @@\n function powp(base) {\n   return base === 10 ? pow10\n       : base === Math.E ? Math.exp\n-      : function(x) { return Math.pow(base, x); };\n+      : x => Math.pow(base, x);\n }\n \n function logp(base) {\n   return base === Math.E ? Math.log\n       : base === 10 && Math.log10\n       || base === 2 && Math.log2\n-      || (base = Math.log(base), function(x) { return Math.log(x) / base; });\n+      || (base = Math.log(base), x => Math.log(x) / base);\n }\n \n function reflect(f) {\n-  return function(x) {\n-    return -f(-x);\n-  };\n+  return (x, k) => -f(-x, k);\n }\n \n export function loggish(transform) {\n-  var scale = transform(transformLog, transformExp),\n-      domain = scale.domain,\n-      base = 10,\n-      logs,\n-      pows;\n+  const scale = transform(transformLog, transformExp);\n+  const domain = scale.domain;\n+  let base = 10;\n+  let logs;\n+  let pows;\n \n   function rescale() {\n     logs = logp(base), pows = powp(base);\n@@ -69,34 +67,33 @@\n     return arguments.length ? (domain(_), rescale()) : domain();\n   };\n \n-  scale.ticks = function(count) {\n-    var d = domain(),\n-        u = d[0],\n-        v = d[d.length - 1],\n-        r;\n-\n-    if (r = v < u) i = u, u = v, v = i;\n-\n-    var i = logs(u),\n-        j = logs(v),\n-        p,\n-        k,\n-        t,\n-        n = count == null ? 10 : +count,\n-        z = [];\n+  scale.ticks = count => {\n+    const d = domain();\n+    let u = d[0];\n+    let v = d[d.length - 1];\n+    const r = v < u;\n+\n+    if (r) ([u, v] = [v, u]);\n+\n+    let i = logs(u);\n+    let j = logs(v);\n+    let k;\n+    let t;\n+    const n = count == null ? 10 : +count;\n+    let z = [];\n \n     if (!(base % 1) && j - i < n) {\n       i = Math.floor(i), j = Math.ceil(j);\n       if (u > 0) for (; i <= j; ++i) {\n-        for (k = 1, p = pows(i); k < base; ++k) {\n-          t = p * k;\n+        for (k = 1; k < base; ++k) {\n+          t = i < 0 ? k / pows(-i) : k * pows(i);\n           if (t < u) continue;\n           if (t > v) break;\n           z.push(t);\n         }\n       } else for (; i <= j; ++i) {\n-        for (k = base - 1, p = pows(i); k >= 1; --k) {\n-          t = p * k;\n+        for (k = base - 1; k >= 1; --k) {\n+          t = i > 0 ? k / pows(-i) : k * pows(i);\n           if (t < u) continue;\n           if (t > v) break;\n           z.push(t);\n@@ -106,27 +103,29 @@\n",
					"match": false,
					"packageHash": "a607ee2e8388785b76d9a5ad5079d8560c50181874e123d9903f2284013ecd41",
					"size": 3434,
					"sourceHash": "a8d231005032382f02b9ce4d3ad546c3b354bdd78657f27fbd01bf8029296816",
					"status": "content"
				},
				"src/nice.js": {
					"diff": "--- published/src/nice.js\n+++ rebuilt/src/nice.js\n@@ -1,4 +1,4 @@\n-export default function(domain, interval) {\n+export default function nice(domain, interval) {\n   domain = domain.slice();\n \n   var i0 = 0,\n",
					"match": false,
					"packageHash": "35ddedf2a9bcccf8205e2207359f171fe2d5aefc1f7a59ab3e90d3ec14da8622",
					"size": 340,
					"sourceHash": "abbdda83a7947cb900b067f806d0edb0a01e1d5994dc6001a61cb8d0684c51c5",
					"status": "content"
				},
				"src/number.js": {
					"diff": "--- published/src/number.js\n+++ rebuilt/src/number.js\n@@ -1,3 +1,3 @@\n-export default function(x) {\n+export default function number(x) {\n   return +x;\n }\n",
					"match": false,
					"packageHash": "ab2e2acdc9b8dcbaba953657ce544315f8d812895bb5b0e05fc029c1a56a733b",
					"size": 44,
					"sourceHash": "8c70975a48a85b2d42def097bcef0ace97ab7aff08b028a31133775b4a293b17",
					"status": "content"
				},
				"src/ordinal.js": {
					"diff": "--- published/src/ordinal.js\n+++ rebuilt/src/ordinal.js\n@@ -1,29 +1,29 @@\n+import {InternMap} from \"d3-array\";\n import {initRange} from \"./init.js\";\n \n export const implicit = Symbol(\"implicit\");\n \n export default function ordinal() {\n-  var index = new Map(),\n+  var index = new InternMap(),\n       domain = [],\n       range = [],\n       unknown = implicit;\n \n   function scale(d) {\n-    var key = d + \"\", i = index.get(key);\n-    if (!i) {\n+    let i = index.get(d);\n+    if (i === undefined) {\n       if (unknown !== implicit) return unknown;\n-      index.set(key, i = domain.push(d));\n+      index.set(d, i = domain.push(d) - 1);\n     }\n-    return range[(i - 1) % range.length];\n+    return range[i % range.length];\n   }\n \n   scale.domain = function(_) {\n     if (!arguments.length) return domain.slice();\n-    domain = [], index = new Map();\n+    domain = [], index = new InternMap();\n     for (const value of _) {\n-      const key = value + \"\";\n-      if (index.has(key)) continue;\n-      index.set(key, domain.push(value));\n+      if (index.has(value)) continue;\n+      index.set(value, domain.push(value) - 1);\n     }\n     return scale;\n   };\n",
					"match": false,
					"packageHash": "e768caf6865f5c02f206cfefea5e935971ade38e938cb83e19633b740bd06832",
					"size": 1069,
					"sourceHash": "5544d03e8d0addb80b37b6b2fb522de4f19916f545e6b2d6e6648609514aac87",
					"status": "content"
				},
				"src/quantile.js": {
					"diff": "--- published/src/quantile.js\n+++ rebuilt/src/quantile.js\n@@ -1,4 +1,4 @@\n-import {ascending, bisect, quantile as threshold} from \"d3-array\";\n+import {ascending, bisect, quantileSorted as threshold} from \"d3-array\";\n import {initRange} from \"./init.js\";\n \n export default function quantile() {\n@@ -15,7 +15,7 @@\n   }\n \n   function scale(x) {\n-    return isNaN(x = +x) ? unknown : range[bisect(thresholds, x)];\n+    return x == null || isNaN(x = +x) ? unknown : range[bisect(thresholds, x)];\n   }\n \n   scale.invertExtent = function(y) {\n",
					"match": false,
					"packageHash": "d05e19590d54ac0b36eba8831272370ea064d882f4b06b4185c3982f3379f74c",
					"size": 1423,
					"sourceHash": "1edcf3f2bd1bdcb19679616404a85c8177d65910ccd323272ab48a1e75d46ac9",
					"status": "content"
				},
				"src/quantize.js": {
					"diff": "--- published/src/quantize.js\n+++ rebuilt/src/quantize.js\n@@ -11,7 +11,7 @@\n       unknown;\n \n   function scale(x) {\n-    return x <= x ? range[bisect(domain, x, 0, n)] : unknown;\n+    return x != null && x <= x ? range[bisect(domain, x, 0, n)] : unknown;\n   }\n \n   function rescale() {\n",
					"match": false,
					"packageHash": "9b7c7c756960d3dcde147542c0d653e0cefc46a8f05f1a7781e8425d32c33103",
					"size": 1326,
					"sourceHash": "cdcb763fbc19b1c39c5d8f41e6c1516b42eac56c29dc5f74cc292dc3a55d1c1f",
					"status": "content"
				},
				"src/sequential.js": {
					"diff": "--- published/src/sequential.js\n+++ rebuilt/src/sequential.js\n@@ -18,7 +18,7 @@\n       unknown;\n \n   function scale(x) {\n-    return isNaN(x = +x) ? unknown : interpolator(k10 === 0 ? 0.5 : (x = (transform(x) - t0) * k10, clamp ? Math.max(0, Math.min(1, x)) : x));\n+    return x == null || isNaN(x = +x) ? unknown : interpolator(k10 === 0 ? 0.5 : (x = (transform(x) - t0) * k10, clamp ? Math.max(0, Math.min(1, x)) : x));\n   }\n \n   scale.domain = function(_) {\n",
					"match": false,
					"packageHash": "876d7caacf3eea007185b5c7cd1139ed019272e7bd6030c7753662a170218b89",
					"size": 2773,
					"sourceHash": "cee1ae8cd48b104e8bac6b585290b0929470bc83ae0fa4ed85a5d739af0a61ae",
					"status": "content"
				},
				"src/sequentialQuantile.js": {
					"diff": "--- published/src/sequentialQuantile.js\n+++ rebuilt/src/sequentialQuantile.js\n@@ -7,7 +7,7 @@\n       interpolator = identity;\n \n   function scale(x) {\n-    if (!isNaN(x = +x)) return interpolator((bisect(domain, x, 1) - 1) / (domain.length - 1));\n+    if (x != null && !isNaN(x = +x)) return interpolator((bisect(domain, x, 1) - 1) / (domain.length - 1));\n   }\n \n   scale.domain = function(_) {\n",
					"match": false,
					"packageHash": "b00af57bb0eaf93db657950653bd45a2e74a09e558d62dc35b7222c1e238cec6",
					"size": 1065,
					"sourceHash": "5c282edc5c201b7cb1975169430e0727fa7faf4a394e2900271e6e2ca79db09b",
					"status": "content"
				},
				"src/threshold.js": {
					"diff": "--- published/src/threshold.js\n+++ rebuilt/src/threshold.js\n@@ -8,7 +8,7 @@\n       n = 1;\n \n   function scale(x) {\n-    return x <= x ? range[bisect(domain, x, 0, n)] : unknown;\n+    return x != null && x <= x ? range[bisect(domain, x, 0, n)] : unknown;\n   }\n \n   scale.domain = function(_) {\n",
					"match": false,
					"packageHash": "c5c9df5244d8a800602061748bc4db4cdeaac72db4290cd0da65ac408aefefa8",
					"size": 984,
					"sourceHash": "60b6e3f0cd43434be31ffc172fb227c49a70fdad1404912dd17e0757892a135c",
					"status": "content"
				},
				"src/tickFormat.js": {
					"diff": "--- published/src/tickFormat.js\n+++ rebuilt/src/tickFormat.js\n@@ -1,7 +1,7 @@\n import {tickStep} from \"d3-array\";\n import {format, formatPrefix, formatSpecifier, precisionFixed, precisionPrefix, precisionRound} from \"d3-format\";\n \n-export default function(start, stop, count, specifier) {\n+export default function tickFormat(start, stop, count, specifier) {\n   var step = tickStep(start, stop, count),\n       precision;\n   specifier = formatSpecifier(specifier == null ? \",f\" : specifier);\n",
					"match": false,
					"packageHash": "e7ed84a184c9710654d3a8e8326c23c2aa8d057ace81a195ba1b02d0995c40b6",
					"size": 1122,
					"sourceHash": "995af53d61ee16226248e72ee107fa8c113b81955ef78aad9246e783239dd82d",
					"status": "content"
				},
				"src/time.js": {
					"diff": "--- published/src/time.js\n+++ rebuilt/src/time.js\n@@ -1,18 +1,9 @@\n-import {bisector, tickStep} from \"d3-array\";\n-import {timeYear, timeMonth, timeWeek, timeDay, timeHour, timeMinute, timeSecond, timeMillisecond} from \"d3-time\";\n+import {timeYear, timeMonth, timeWeek, timeDay, timeHour, timeMinute, timeSecond, timeTicks, timeTickInterval} from \"d3-time\";\n import {timeFormat} from \"d3-time-format\";\n import continuous, {copy} from \"./continuous.js\";\n import {initRange} from \"./init.js\";\n import nice from \"./nice.js\";\n \n-var durationSecond = 1000,\n-    durationMinute = durationSecond * 60,\n-    durationHour = durationMinute * 60,\n-    durationDay = durationHour * 24,\n-    durationWeek = durationDay * 7,\n-    durationMonth = durationDay * 30,\n-    durationYear = durationDay * 365;\n-\n function date(t) {\n   return new Date(t);\n }\n@@ -21,7 +12,7 @@\n   return t instanceof Date ? +t : +new Date(+t);\n }\n \n-export function calendar(year, month, week, day, hour, minute, second, millisecond, format) {\n+export function calendar(ticks, tickInterval, year, month, week, day, hour, minute, second, format) {\n   var scale = continuous(),\n       invert = scale.invert,\n       domain = scale.domain;\n@@ -35,27 +26,6 @@\n       formatMonth = format(\"%B\"),\n       formatYear = format(\"%Y\");\n \n-  var tickIntervals = [\n-    [second,  1,      durationSecond],\n-    [second,  5,  5 * durationSecond],\n-    [second, 15, 15 * durationSecond],\n-    [second, 30, 30 * durationSecond],\n-    [minute,  1,      durationMinute],\n-    [minute,  5,  5 * durationMinute],\n-    [minute, 15, 15 * durationMinute],\n-    [minute, 30, 30 * durationMinute],\n-    [  hour,  1,      durationHour  ],\n-    [  hour,  3,  3 * durationHour  ],\n-    [  hour,  6,  6 * durationHour  ],\n-    [  hour, 12, 12 * durationHour  ],\n-    [   day,  1,      durationDay   ],\n-    [   day,  2,  2 * durationDay   ],\n-    [  week,  1,      durationWeek  ],\n-    [ month,  1,      durationMonth ],\n-    [ month,  3,  3 * durationMonth ],\n-    [  year,  1,      durationYear  ]\n-  ];\n-\n   function tickFormat(date) {\n     return (second(date) < date ? formatMillisecond\n         : minute(date) < date ? formatSecond\n@@ -66,33 +36,6 @@\n         : formatYear)(date);\n   }\n \n-  function tickInterval(interval, start, stop) {\n-    if (interval == null) interval = 10;\n-\n-    // If a desired tick count is specified, pick a reasonable tick interval\n-    // based on the extent of the domain and a rough estimate of tick size.\n-    // Otherwise, assume interval is already a time interval and use it.\n-    if (typeof interval === \"number\") {\n-      var target = Math.abs(stop - start) / interval,\n-          i = bisector(function(i) { return i[2]; }).right(tickIntervals, target),\n-          step;\n-      if (i === tickIntervals.length) {\n-        step = tickStep(start / durationYear, stop / durationYear, interval);\n-        interval = year;\n-      } else if (i) {\n-        i = tickIntervals[target / tickIntervals[i - 1][2] < tickIntervals[i][2] / target ? i - 1 : i];\n-        step = i[1];\n-        interval = i[0];\n-      } else {\n-        step = Math.max(tickStep(start, stop, interval), 1);\n-        interval = millisecond;\n-      }\n-      return interval.every(step);\n-    }\n-\n-    return interval;\n-  }\n-\n   scale.invert = function(y) {\n     return new Date(invert(y));\n   };\n@@ -102,15 +45,8 @@\n   };\n \n   scale.ticks = function(interval) {\n-    var d = domain(),\n-        t0 = d[0],\n-        t1 = d[d.length - 1],\n",
					"match": false,
					"packageHash": "5abcb71aa8dc2b9c52f1a692f99c78a062cc3e2eac88c05ff0ef159c2ddc169b",
					"size": 4461,
					"sourceHash": "666b7acd807e2ad4130097bf121ab0a38b02a25cc57de3eff9e07e043b7d8fc9",
					"status": "content"
				},
				"src/utcTime.js": {
					"diff": "--- published/src/utcTime.js\n+++ rebuilt/src/utcTime.js\n@@ -1,8 +1,8 @@\n-import {calendar} from \"./time.js\";\n+import {utcYear, utcMonth, utcWeek, utcDay, utcHour, utcMinute, utcSecond, utcTicks, utcTickInterval} from \"d3-time\";\n import {utcFormat} from \"d3-time-format\";\n-import {utcYear, utcMonth, utcWeek, utcDay, utcHour, utcMinute, utcSecond, utcMillisecond} from \"d3-time\";\n+import {calendar} from \"./time.js\";\n import {initRange} from \"./init.js\";\n \n-export default function() {\n-  return initRange.apply(calendar(utcYear, utcMonth, utcWeek, utcDay, utcHour, utcMinute, utcSecond, utcMillisecond, utcFormat).domain([Date.UTC(2000, 0, 1), Date.UTC(2000, 0, 2)]), arguments);\n+export default function utcTime() {\n+  return initRange.apply(calendar(utcTicks, utcTickInterval, utcYear, utcMonth, utcWeek, utcDay, utcHour, utcMinute, utcSecond, utcFormat).domain([Date.UTC(2000, 0, 1), Date.UTC(2000, 0, 2)]), arguments);\n }\n",
					"match": false,
					"packageHash": "dacd4bf5663f2a573a7358b985c7ae6f5585625c87da24fc04a25de848903fcc",
					"size": 447,
					"sourceHash": "17505cdb0da21a365076d355b1746b280aa2a3bcabe7b14a10587c50781ebfbb",
					"status": "content"
				}
			},
			"summary": {
				"differentFiles": 20,
				"matchingFiles": 7,
				"missingInPackage": 0,
				"missingInSource": 2,
				"score": 0.2413793103448276,
				"totalFiles": 29
			}
		}
	}
]
