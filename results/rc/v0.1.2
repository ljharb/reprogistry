[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-06T21:03:59.206Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "rc@0.1.2",
			"name": "rc",
			"version": "0.1.2",
			"location": "https://registry.npmjs.org/rc/-/rc-0.1.2.tgz",
			"integrity": "sha512-eFgoeyuJJLA9TvFxkDj0FdtLKodASuEGvVa/ISpgQgw8L/P0tdJ+nTlwy5r6Ut3zRAQFIRqQq/iv6pTSGvBW/g==",
			"publishedAt": "2013-04-27T14:36:59.537Z",
			"publishedWith": {
				"node": null,
				"npm": "1.2.3"
			}
		},
		"source": {
			"integrity": null,
			"location": "https://github.com/dominictarr/rc.git",
			"spec": "github:dominictarr/rc#HEAD"
		},
		"comparisonHash": "9ef46a5bd31291e57cbab41e2f17c57bd6da0b5b",
		"diff": {
			"files": {
				".npmignore": {
					"match": false,
					"packageHash": "a1cd9589c07a23e3a67e8c6017e10a46d26085a85c7b55dee70192c788b1d1f8",
					"size": 42,
					"status": "missing-in-source"
				},
				"README.md": {
					"diff": "--- published/README.md\n+++ rebuilt/README.md\n@@ -1,43 +1,227 @@\n # rc\n \n-the non configurable configuration loader for lazy people.\n+The non-configurable configuration loader for lazy people.\n \n-# Usage\n+## Usage\n \n-the only option is to pass rc the name of your app, and your default configuration.\n+The only option is to pass rc the name of your app, and your default configuration.\n \n+```javascript\n+var conf = require('rc')(appname, {\n+  //defaults go here.\n+  port: 2468,\n+\n+  //defaults which are objects will be merged, not replaced\n+  views: {\n+    engine: 'jade'\n+  }\n+});\n ```\n-  var rc = require('rc')(appname, {\n-    //defaults go here.\n-    port: 2468\n-  })\n+\n+`rc` will return your configuration options merged with the defaults you specify.\n+If you pass in a predefined defaults object, it will be mutated:\n+\n+```javascript\n+var conf = {};\n+require('rc')(appname, conf);\n ```\n \n-# Standards\n+If `rc` finds any config files for your app, the returned config object will have\n+a `configs` array containing their paths:\n+\n+```javascript\n+var appCfg = require('rc')(appname, conf);\n+appCfg.configs[0] // /etc/appnamerc\n+appCfg.configs[1] // /home/dominictarr/.config/appname\n+appCfg.config // same as appCfg.configs[appCfg.configs.length - 1]\n+```\n \n-Given your application name, rc will look in all the obvious places for configuration.\n+## Standards\n \n+Given your application name (`appname`), rc will look in all the obvious places for configuration.\n \n-  * command line arguments (parsed by optimist)\n-  * enviroment variables prefixed with ${APPNAME}_\n+  * command line arguments, parsed by minimist _(e.g. `--foo baz`, also nested: `--foo.bar=baz`)_\n+  * environment variables prefixed with `${appname}_`\n+    * or use \"\\_\\_\" to indicate nested properties <br/> _(e.g. `appname_foo__bar__baz` => `foo.bar.baz`)_\n   * if you passed an option `--config file` then from that file\n-  * `$HOME/.${APPNAME}rc`\n-  * `$HOME/.${APPNAME}/config`\n-  * `$HOME/.config/${APPNAME}`\n-  * `$HOME/.config/${APPNAME}/config`\n-  * `/etc/${APPNAME}rc`\n-  * `/etc/${APPNAME}/config`\n+  * a local `.${appname}rc` or the first found looking in `./ ../ ../../ ../../../` etc.\n+  * `$HOME/.${appname}rc`\n+  * `$HOME/.${appname}/config`\n+  * `$HOME/.config/${appname}`\n+  * `$HOME/.config/${appname}/config`\n+  * `/etc/${appname}rc`\n+  * `/etc/${appname}/config`\n   * the defaults object you passed in.\n \n-All configuration sources that where found will be flattened into one object,\n-so that sources earlier in this list override later ones.\n+All configuration sources that were found will be flattened into one object,\n+so that sources **earlier** in this list override later ones.\n+\n+\n+## Configuration File Formats\n+\n+Configuration files (e.g. `.appnamerc`) may be in either [json](http://json.org/example) or [ini](http://en.wikipedia.org/wiki/INI_file) format. **No** file extension (`.json` or `.ini`) should be used. The example configurations below are equivalent:\n+\n+\n+#### Formatted as `ini`\n+\n+```\n+; You can include comments in `ini` format if you want.\n+\n+dependsOn=0.10.0\n+\n+\n+; `rc` has built-in support for ini sections, see?\n+\n+[commands]\n+  www     = ./commands/www\n+  console = ./commands/repl\n+\n",
					"match": false,
					"packageHash": "c199fe4dc3587caa645611a09274f3dfa698f6ba6acdd8ada96b6776c9cb687a",
					"size": 1069,
					"sourceHash": "3088babbed9971cd5ac60321b0818863c49ea773be0b14389494b4e7e4248d8d",
					"status": "content"
				},
				"index.js": {
					"diff": "--- published/index.js\n+++ rebuilt/index.js\n@@ -1,5 +1,3 @@\n-#! /usr/bin/env node\n-var argv = require('optimist').argv\n var cc   = require('./lib/utils')\n var join = require('path').join\n var deepExtend = require('deep-extend')\n@@ -9,30 +7,47 @@\n            ? process.env.USERPROFILE\n            : process.env.HOME\n \n-module.exports = function (name, defaults) {\n-  if(!name)\n-    throw new Error('nameless configuration fail')\n+module.exports = function (name, defaults, argv, parse) {\n+  if('string' !== typeof name)\n+    throw new Error('rc(name): name *must* be string')\n+  if(!argv)\n+    argv = require('minimist')(process.argv.slice(2))\n   defaults = (\n       'string' === typeof defaults\n     ? cc.json(defaults) : defaults\n     ) || {}\n \n-  return deepExtend.apply(null, [\n-    defaults,\n-    win ? {} : cc.json(join(etc, name, 'config')),\n-    win ? {} : cc.json(join(etc, name + 'rc')),\n-    cc.json(join(home, '.config', name, 'config')),\n-    cc.json(join(home, '.config', name)),\n-    cc.json(join(home, '.' + name, 'config')),\n-    cc.json(join(home, '.' + name + 'rc')),\n-    cc.json(argv.config),\n-    cc.env(name + '_'),\n-    argv\n-  ])\n-}\n+  parse = parse || cc.parse\n+\n+  var env = cc.env(name + '_')\n+\n+  var configs = [defaults]\n+  var configFiles = []\n+  function addConfigFile (file) {\n+    if (configFiles.indexOf(file) >= 0) return\n+    var fileConfig = cc.file(file)\n+    if (fileConfig) {\n+      configs.push(parse(fileConfig))\n+      configFiles.push(file)\n+    }\n+  }\n+\n+  // which files do we look at?\n+  if (!win)\n+   [join(etc, name, 'config'),\n+    join(etc, name + 'rc')].forEach(addConfigFile)\n+  if (home)\n+   [join(home, '.config', name, 'config'),\n+    join(home, '.config', name),\n+    join(home, '.' + name, 'config'),\n+    join(home, '.' + name + 'rc')].forEach(addConfigFile)\n+  addConfigFile(cc.find('.'+name+'rc'))\n+  if (env.config) addConfigFile(env.config)\n+  if (argv.config) addConfigFile(argv.config)\n \n-if(!module.parent) {\n-  console.log(\n-    JSON.stringify(module.exports(process.argv[2]), false, 2)\n-  )\n+  return deepExtend.apply(null, configs.concat([\n+    env,\n+    argv,\n+    configFiles.length ? {configs: configFiles, config: configFiles[configFiles.length - 1]} : undefined,\n+  ]))\n }\n",
					"match": false,
					"packageHash": "4e490ea49acede2df5917b5f7b53160d898a47c764f1b6aa87c95bf1260c4136",
					"size": 1011,
					"sourceHash": "7a4c19d1025d2669723dd2a939ced7d556d815eedfff62bf288970365b8b26dc",
					"status": "content"
				},
				"lib/utils.js": {
					"diff": "--- published/lib/utils.js\n+++ rebuilt/lib/utils.js\n@@ -1,30 +1,42 @@\n+'use strict';\n var fs   = require('fs')\n var ini  = require('ini')\n var path = require('path')\n+var stripJsonComments = require('strip-json-comments')\n \n-var parse = exports.parse = function (content, file) {\n+var parse = exports.parse = function (content) {\n \n   //if it ends in .json or starts with { then it must be json.\n   //must be done this way, because ini accepts everything.\n   //can't just try and parse it and let it throw if it's not ini.\n-  //everything is ini. even json with a systax error.\n+  //everything is ini. even json with a syntax error.\n \n-  if((file && /\\.json$/.test(file)) || /^\\s*{/.test(content)) \n-    return JSON.parse(content)\n+  if(/^\\s*{/.test(content))\n+    return JSON.parse(stripJsonComments(content))\n   return ini.parse(content)\n \n }\n \n-var json = exports.json = function () {\n+var file = exports.file = function () {\n   var args = [].slice.call(arguments).filter(function (arg) { return arg != null })\n+\n+  //path.join breaks if it's a not a string, so just skip this.\n+  for(var i in args)\n+    if('string' !== typeof args[i])\n+      return\n+\n   var file = path.join.apply(null, args)\n   var content\n   try {\n-    content = fs.readFileSync(file,'utf-8')\n+    return fs.readFileSync(file,'utf-8')\n   } catch (err) {\n     return\n   }\n-  return parse(content)\n+}\n+\n+var json = exports.json = function () {\n+  var content = file.apply(null, arguments)\n+  return content ? parse(content) : null\n }\n \n var env = exports.env = function (prefix, env) {\n@@ -32,9 +44,61 @@\n   var obj = {}\n   var l = prefix.length\n   for(var k in env) {\n-    if((i =k.indexOf(prefix)) === 0)\n-      obj[k.substring(l)] = env[k]\n+    if(k.toLowerCase().indexOf(prefix.toLowerCase()) === 0) {\n+\n+      var keypath = k.substring(l).split('__')\n+\n+      // Trim empty strings from keypath array\n+      var _emptyStringIndex\n+      while ((_emptyStringIndex=keypath.indexOf('')) > -1) {\n+        keypath.splice(_emptyStringIndex, 1)\n+      }\n+\n+      var cursor = obj\n+      keypath.forEach(function _buildSubObj(_subkey,i){\n+\n+        // (check for _subkey first so we ignore empty strings)\n+        // (check for cursor to avoid assignment to primitive objects)\n+        if (!_subkey || typeof cursor !== 'object')\n+          return\n+\n+        // If this is the last key, just stuff the value in there\n+        // Assigns actual value from env variable to final key\n+        // (unless it's just an empty string- in that case use the last valid key)\n+        if (i === keypath.length-1)\n+          cursor[_subkey] = env[k]\n+\n+\n+        // Build sub-object if nothing already exists at the keypath\n+        if (cursor[_subkey] === undefined)\n+          cursor[_subkey] = {}\n+\n+        // Increment cursor used to track the object at the current depth\n+        cursor = cursor[_subkey]\n+\n+      })\n+\n+    }\n+\n   }\n \n   return obj\n }\n+\n+var find = exports.find = function () {\n",
					"match": false,
					"packageHash": "26b0ea115acd53d48efe3b2a77083e3a27117a9a93b6e67506af397a3cecc8dd",
					"size": 1024,
					"sourceHash": "3eba35eafd078a2c4843a11000c06443b5d8b2fea3b682aae20daeea5be66cd2",
					"status": "content"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,28 +1,29 @@\n {\n   \"name\": \"rc\",\n-  \"version\": \"0.1.2\",\n+  \"version\": \"1.2.8\",\n   \"description\": \"hardwired configuration loader\",\n   \"main\": \"index.js\",\n-  \"browserify\": \"browser.js\",\n+  \"browser\": \"browser.js\",\n   \"scripts\": {\n-    \"test\": \"set -e; node test/test.js; node test/ini.js\"\n+    \"test\": \"set -e; node test/test.js; node test/ini.js; node test/nested-env-vars.js\"\n   },\n   \"repository\": {\n     \"type\": \"git\",\n     \"url\": \"https://github.com/dominictarr/rc.git\"\n   },\n+  \"license\": \"(BSD-2-Clause OR MIT OR Apache-2.0)\",\n   \"keywords\": [\n     \"config\",\n     \"rc\",\n     \"unix\",\n     \"defaults\"\n   ],\n-  \"bin\": \"./index.js\",\n+  \"bin\": \"./cli.js\",\n   \"author\": \"Dominic Tarr <dominic.tarr@gmail.com> (dominictarr.com)\",\n-  \"licenses\": [\"BSD\", \"MIT\", \"Apache2\"],\n   \"dependencies\": {\n-    \"optimist\": \"~0.3.4\",\n-    \"deep-extend\": \"~0.2.5\",\n-    \"ini\": \"~1.1.0\"\n+    \"deep-extend\": \"^0.6.0\",\n+    \"ini\": \"~1.3.0\",\n+    \"minimist\": \"^1.2.0\",\n+    \"strip-json-comments\": \"~2.0.1\"\n   }\n }\n",
					"match": false,
					"packageHash": "6037146a30ff196e41890f890ba3f014ed45e472c5aab6aa936002bee933c5fe",
					"size": 622,
					"sourceHash": "96f035349a8e6034d380348ec3d454ed8ea3a602c7a5700eb36ff48310bdbe9f",
					"status": "content"
				},
				"test/test.js": {
					"diff": "--- published/test/test.js\n+++ rebuilt/test/test.js\n@@ -12,3 +12,48 @@\n \n assert.equal(config.option, true)\n assert.equal(config.envOption, 42)\n+\n+var customArgv = require('../')(n, {\n+  option: true\n+}, { // nopt-like argv\n+  option: false,\n+  envOption: 24,\n+  argv: {\n+    remain: [],\n+    cooked: ['--no-option', '--envOption', '24'],\n+    original: ['--no-option', '--envOption=24']\n+  }\n+})\n+\n+console.log(customArgv)\n+\n+assert.equal(customArgv.option, false)\n+assert.equal(customArgv.envOption, 24)\n+\n+var fs = require('fs')\n+var path = require('path')\n+var jsonrc = path.resolve('.' + n + 'rc');\n+\n+fs.writeFileSync(jsonrc, [\n+  '{',\n+    '// json overrides default',\n+    '\"option\": false,',\n+    '/* env overrides json */',\n+    '\"envOption\": 24',\n+  '}'\n+].join('\\n'));\n+\n+var commentedJSON = require('../')(n, {\n+  option: true\n+})\n+\n+fs.unlinkSync(jsonrc);\n+\n+console.log(commentedJSON)\n+\n+assert.equal(commentedJSON.option, false)\n+assert.equal(commentedJSON.envOption, 42)\n+\n+assert.equal(commentedJSON.config, jsonrc)\n+assert.equal(commentedJSON.configs.length, 1)\n+assert.equal(commentedJSON.configs[0], jsonrc)\n",
					"match": false,
					"packageHash": "93eea23c9d099bf13f061ddbd25f6b1d8c7b5e76d463530cc96e155719e96a94",
					"size": 236,
					"sourceHash": "1e277a1cdda596747a7d3d7d7995b43eb104901ce9f0ecf234dc6e625e2ebe6b",
					"status": "content"
				},
				"cli.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/nested-env-vars.js": {
					"match": false,
					"status": "missing-in-package"
				}
			},
			"summary": {
				"differentFiles": 5,
				"matchingFiles": 5,
				"missingInPackage": 2,
				"missingInSource": 1,
				"score": 0.38461538461538464,
				"totalFiles": 13
			}
		}
	}
]
