[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2025-12-30T15:22:13.360Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "cors@0.0.1",
			"name": "cors",
			"version": "0.0.1",
			"location": "https://registry.npmjs.org/cors/-/cors-0.0.1.tgz",
			"integrity": "sha512-ieXsXHf1hcDNmmPmLt+j5eKZ3ldJ3BxpVVFWFt/eIBo0N7dSd5XZ/3VNWN5OpqXmc/+U0ho2qPqLuvq6zAkAUw==",
			"publishedAt": "2013-01-31T04:13:41.715Z",
			"publishedWith": {
				"node": null,
				"npm": "1.1.59"
			}
		},
		"source": {
			"integrity": "sha512-IKALmMiYqvU2TScp/6tP6jDmYVsap5en240r5oVG3HGGtKxZitCwTiyGobRYWj1T88EY8fzlDBISQVPi41PYoA==",
			"location": "git://github.com/troygoode/node-cors.git",
			"spec": "github:troygoode/node-cors#v0.0.1"
		},
		"comparisonHash": "8a2a8dcbb729bf3ee9216e490c955701f0ddebe1",
		"diff": {
			"files": {
				".npmignore": {
					"match": false,
					"packageHash": "e899bf713cf77aa856a101618725b1022591943d6e3b97d4757b60716d2a4941",
					"size": 37,
					"status": "missing-in-source"
				},
				"README.markdown": {
					"diff": "--- published/README.markdown\n+++ rebuilt/README.markdown\n@@ -1,6 +1,7 @@\n # cors\n \n-CORS is a node.js package for providing a [connect](http://www.senchalabs.org/connect/)/[express](http://expressjs.com/) middleware that can be used to enable [CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing) with various options.\n+CORS is a node.js package for providing a middleware that can be used\n+with connect/express to enable CORS with various options.\n \n [![build status](https://secure.travis-ci.org/TroyGoode/node-cors.png)](http://travis-ci.org/TroyGoode/node-cors)\n \n@@ -12,79 +13,7 @@\n \n ## Usage\n \n-### Simple Usage (Enable *All* CORS Requests)\n-\n-```javascript\n-var express = require('express')\n-  , cors = require('cors')\n-  , app = express();\n-\n-app.get('/products/:id', cors(), function(req, res, next){\n-  res.json({msg: 'This is CORS-enabled for all origins!'});\n-});\n-\n-app.listen(80, function(){\n-  console.log('CORS-enabled web server listening on port 80');\n-});\n-```\n-\n-### Configuring CORS\n-\n-```javascript\n-var express = require('express')\n-  , cors = require('cors')\n-  , app = express();\n-\n-var corsOptions = {\n-  origin: 'http://example.com'\n-};\n-\n-app.get('/products/:id', cors(corsOptions), function(req, res, next){\n-  res.json({msg: 'This is CORS-enabled for only example.com.'});\n-});\n-\n-app.listen(80, function(){\n-  console.log('CORS-enabled web server listening on port 80');\n-});\n-```\n-\n-### Configuring CORS Asynchronously\n-\n-```javascript\n-var express = require('express')\n-  , cors = require('cors')\n-  , app = express();\n-\n-var whitelist = ['http://example1.com', 'http://example2.com'];\n-var corsOptionsDelegate = function(req, callback){\n-  var corsOptions;\n-  if(whitelist.indexOf(req.header('Origin')) !== -1){\n-    corsOptions = { origin: true }; // reflect (enable) the requested origin in the CORS response\n-  }else{\n-    corsOptions = { origin: false }; // disable CORS for this request\n-  }\n-  callback(null, corsOptions); // callback expects two parameters: error and options\n-};\n-\n-app.get('/products/:id', cors(corsOptionsDelegate), function(req, res, next){\n-  res.json({msg: 'This is CORS-enabled for a whitelisted domain.'});\n-});\n-\n-app.listen(80, function(){\n-  console.log('CORS-enabled web server listening on port 80');\n-});\n-```\n-\n-## Options\n-\n-For details on the effect of each CORS header, [read this article on HTML5 Rocks](http://www.html5rocks.com/en/tutorials/cors/).\n-\n-* `options.origin`: Configures the **Access-Control-Allow-Origin** CORS header. Expects a string (ex: \"http://example.com\"). Set to `true` to reflect the [request origin](http://tools.ietf.org/html/draft-abarth-origin-09), as defined by `req.header('Origin')`. Set to `false` to disable CORS.\n-* `options.methods`: Configures the **Access-Control-Allow-Methods** CORS header. Expects a comma-delimited string (ex: 'GET,PUT,POST') or an array (ex: `['GET', 'PUT', 'POST']`).\n-* `options.headers`: Configures the **Access-Control-Allow-Headers** CORS header. Expects a comma-delimited string (ex: 'Content-Type,Authorization') or an array (ex: `['Content-Type', 'Authorization]`). If not specified, defaults to reflecting the headers specified in the request's **Access-Control-Request-Headers** header.\n-* `options.credentials`: Configures the **Access-Control-Allow-Credentials** CORS header. Set to `true` to pass the header, otherwise it is omitted.\n-* `options.maxAge`: Configures the **Access-Control-Allow-Max-Age** CORS header. Set to an integer to pass the header, otherwise it is omitted.\n-* `options.enablePreflight`: By default, a request that runs through this middleware with a method of `OPTIONS` will short-circuit with a `204` response to the client after the CORS headers have been written. Set this option to `false` to disable this feature.\n+TBD...\n \n ## License\n \n",
					"match": false,
					"packageHash": "6ff7850e3668bb3dfc8519f146c93ccc70185201e9c6596b2170be04e79c309d",
					"size": 3733,
					"sourceHash": "cdddbe3077d1b18dd1aa87a5da5c45341fbc90a126e893594cf693f16850ff0b",
					"status": "content"
				},
				"lib/index.js": {
					"diff": "--- published/lib/index.js\n+++ rebuilt/lib/index.js\n@@ -28,7 +28,7 @@\n \n       // copy default values over from the 'defaults' hash as needed\n       var options = options || defaults;\n-      options.origin = options.origin === undefined ? defaults.origin : options.origin;\n+      options.origin = options.origin || defaults.origin;\n       options.methods = options.methods || defaults.methods;\n       options.enablePreflight = options.enablePreflight === undefined\n         ? defaults.enablePreflight\n@@ -36,10 +36,8 @@\n \n       // turn each option into a string\n       var origin = options.origin === true // if .origin is *true*, reflect the request Origin\n-            ? req.header('Origin')\n-            : options.origin === false // if .origin is *false*, disable CORS\n-              ? false\n-              : options.origin,\n+            ? req.headers['Origin']\n+            : options.origin,\n           methods = options.methods.join // if .methods is a string use that, otherwise expect an array\n             ? options.methods.join(',')\n             : options.methods,\n@@ -49,23 +47,21 @@\n                 ? options.headers.join(',') // .headers is an array, so turn it into a string\n                 : options.headers // .headers is a string already\n               : null // .headers was specified but is an empty string or empty array, so don't include\n-            : req.header('Access-Control-Request-Headers'), // .headers wasn't specified, so reflect the request headers\n+            : req.headers['Access-Control-Request-Headers'], // .headers wasn't specified, so reflect the request headers\n           credentials = options.credentials === true,\n           maxAge = options.maxAge && options.maxAge.toString();\n \n       // append each response header if it is present\n-      if(origin !== false){\n-        res.header('Access-Control-Allow-Origin', origin); // required\n-        res.header('Access-Control-Allow-Methods', methods); // required\n-        if(headers && headers.length){\n-          res.header('Access-Control-Allow-Headers', headers);\n-        }\n-        if(credentials === true){\n-          res.header('Access-Control-Allow-Credentials', 'true');\n-        }\n-        if(maxAge && maxAge.length){\n-          res.header('Access-Control-Allow-Max-Age', maxAge);\n-        }\n+      res.header('Access-Control-Allow-Origin', origin); // required\n+      res.header('Access-Control-Allow-Methods', methods); // required\n+      if(headers && headers.length){\n+        res.header('Access-Control-Allow-Headers', headers);\n+      }\n+      if(credentials === true){\n+        res.header('Access-Control-Allow-Credentials', 'true');\n+      }\n+      if(maxAge && maxAge.length){\n+        res.header('Access-Control-Allow-Max-Age', maxAge);\n       }\n \n       // if this HTTP request is an *OPTIONS* request, short-circuit (if we're allowed to do so) rather than going to next middleware\n",
					"match": false,
					"packageHash": "f49f30b3f451cc4a535134eaad45ad994291e7242e9d043e929b54e6050dc84b",
					"size": 3354,
					"sourceHash": "070c782071003e0464611da539cdf6ee456bf056afd503b9270e988d72ade8b2",
					"status": "content"
				},
				"test/cors.js": {
					"diff": "--- published/test/cors.js\n+++ rebuilt/test/cors.js\n@@ -1,13 +1,10 @@\n var should = require('should'),\n     cors = require('../lib'),\n     fakeRequest = function(){\n-      var _headers = {\n-        'origin': 'request.com',\n-        'access-control-request-headers': 'requestedHeader1,requestedHeader2'\n-      };\n       return {\n-        header: function(key){\n-          return _headers[key.toLowerCase()];\n+        headers: {\n+          'Origin': 'request.com',\n+          'Access-Control-Request-Headers': 'requestedHeader1,requestedHeader2'\n         }\n       };\n     },\n@@ -114,31 +111,6 @@\n         done();\n       };\n \n-      // act\n-      cors(options)(req, res, next);\n-    });\n-\n-    it('origin of false disables cors', function(done){\n-      // arrange\n-      var options = {\n-        origin: false,\n-        methods: ['FOO', 'bar'],\n-        headers: ['FIZZ', 'buzz'],\n-        credentials: true,\n-        maxAge: 123\n-      };\n-      var req = fakeRequest();\n-      var res = fakeResponse();\n-      var next = function(){\n-        // assert\n-        should.not.exist(res.header('Access-Control-Allow-Origin'));\n-        should.not.exist(res.header('Access-Control-Allow-Methods'));\n-        should.not.exist(res.header('Access-Control-Allow-Headers'));\n-        should.not.exist(res.header('Access-Control-Allow-Credentials'));\n-        should.not.exist(res.header('Access-Control-Allow-Max-Age'));\n-        done();\n-      };\n-\n       // act\n       cors(options)(req, res, next);\n     });\n",
					"match": false,
					"packageHash": "57656f70431f6ccf7a9308cc6ad5605b01b5f8efb5a63969d27b82b4ed7b8cb6",
					"size": 9682,
					"sourceHash": "6c3e23c97487c42a148661d583b505168d0a4f273ff5802d6d6a8a4b1f7e9687",
					"status": "content"
				}
			},
			"summary": {
				"differentFiles": 3,
				"matchingFiles": 4,
				"missingInPackage": 0,
				"missingInSource": 1,
				"score": 0.5,
				"totalFiles": 8
			}
		}
	}
]
