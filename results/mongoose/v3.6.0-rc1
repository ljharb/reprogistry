[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2025-12-31T08:27:35.947Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "mongoose@3.6.0-rc1",
			"name": "mongoose",
			"version": "3.6.0-rc1",
			"location": "https://registry.npmjs.org/mongoose/-/mongoose-3.6.0rc1.tgz",
			"integrity": "sha512-IYu/c7ppM1U6pgV5aqq6bzMvod2OEBz9nclqWnZolBB0zfyn1Gj4j4f8CGbsweEvqFjJNaTSE3ZfWLQejX04KQ==",
			"publishedAt": "2013-08-16T18:47:04.730Z",
			"publishedWith": {
				"node": null,
				"npm": "1.2.11"
			}
		},
		"source": {
			"integrity": null,
			"location": "git://github.com/LearnBoost/mongoose.git",
			"spec": "github:LearnBoost/mongoose#HEAD"
		},
		"comparisonHash": "8a2a8dcbb729bf3ee9216e490c955701f0ddebe1",
		"diff": {
			"files": {
				".npmignore": {
					"match": false,
					"packageHash": "3512d46537136a6f4183699531c2ab9061cbb5b5fbda1acd7ad29a6a42f70b9e",
					"size": 113,
					"status": "missing-in-source"
				},
				".travis.yml": {
					"match": false,
					"packageHash": "143322358308fba5bf132c63fa235b7e94370b658464fef638ac2c92b53ee019",
					"size": 65,
					"status": "missing-in-source"
				},
				"CONTRIBUTING.md": {
					"match": false,
					"packageHash": "f4ebee72235a578a05793ae91540d40eb4be435ea37e4adf6d9c5e8aa2062c68",
					"size": 3808,
					"status": "missing-in-source"
				},
				"History.md": {
					"match": false,
					"packageHash": "6c13d07c03cea3c93fc080faeca8ef9cb80d5274ad1ba8ef06da23c2891fb390",
					"size": 47738,
					"status": "missing-in-source"
				},
				"README.md": {
					"diff": "--- published/README.md\n+++ rebuilt/README.md\n@@ -1,76 +1,149 @@\n-## What's Mongoose?\n+# Mongoose\n \n-Mongoose is a [MongoDB](http://www.mongodb.org/) object modeling tool designed to work in an asynchronous environment.\n+Mongoose is a [MongoDB](https://www.mongodb.org/) object modeling tool designed to work in an asynchronous environment. Mongoose supports [Node.js](https://nodejs.org/en/) and [Deno](https://deno.land/) (alpha).\n+\n+[![Build Status](https://github.com/Automattic/mongoose/workflows/Test/badge.svg)](https://github.com/Automattic/mongoose)\n+[![NPM version](https://badge.fury.io/js/mongoose.svg)](http://badge.fury.io/js/mongoose)\n+[![Deno version](https://deno.land/badge/mongoose/version)](https://deno.land/x/mongoose)\n+[![Deno popularity](https://deno.land/badge/mongoose/popularity)](https://deno.land/x/mongoose)\n+\n+[![npm](https://nodei.co/npm/mongoose.png)](https://www.npmjs.com/package/mongoose)\n \n ## Documentation\n \n-[mongoosejs.com](http://mongoosejs.com/)\n+The official documentation website is [mongoosejs.com](http://mongoosejs.com/).\n \n-## Try it live\n-<a href=\"https://runnable.com/#learnboost/mongoose/code.js/launch\" target=\"_blank\"><img src=\"https://runnable.com/external/styles/assets/runnablebtn.png\" style=\"width:67px;height:25px;\"></a>\n+Mongoose 9.0.0 was released on November 21, 2025. You can find more details on [backwards breaking changes in 9.0.0 on our docs site](https://mongoosejs.com/docs/migrating_to_9.html).\n \n ## Support\n \n-  - [Stack Overflow](http://stackoverflow.com/questions/tagged/mongoose)\n-  - [bug reports](https://github.com/learnboost/mongoose/issues/)\n-  - [help forum](http://groups.google.com/group/mongoose-orm)\n-  - [10gen support](http://www.mongodb.org/display/DOCS/Technical+Support)\n-  - (irc) #mongoosejs on freenode\n+* [Stack Overflow](http://stackoverflow.com/questions/tagged/mongoose)\n+* [Bug Reports](https://github.com/Automattic/mongoose/issues/)\n+* [Mongoose Slack Channel](http://slack.mongoosejs.io/)\n+* [Help Forum](http://groups.google.com/group/mongoose-orm)\n+* [MongoDB Support](https://www.mongodb.com/docs/manual/support/)\n+\n+## Plugins\n+\n+Check out the [plugins search site](http://plugins.mongoosejs.io/) to see hundreds of related modules from the community. Next, learn how to write your own plugin from the [docs](http://mongoosejs.com/docs/plugins.html) or [this blog post](http://thecodebarbarian.com/2015/03/06/guide-to-mongoose-plugins).\n+\n+## Contributors\n+\n+Pull requests are always welcome! Please base pull requests against the `master`\n+branch and follow the [contributing guide](https://github.com/Automattic/mongoose/blob/master/CONTRIBUTING.md).\n+\n+If your pull requests makes documentation changes, please do **not**\n+modify any `.html` files. The `.html` files are compiled code, so please make\n+your changes in `docs/*.pug`, `lib/*.js`, or `test/docs/*.js`.\n+\n+View all 400+ [contributors](https://github.com/Automattic/mongoose/graphs/contributors).\n \n ## Installation\n \n-First install [node.js](http://nodejs.org/) and [mongodb](http://www.mongodb.org/downloads).\n+First install [Node.js](http://nodejs.org/) and [MongoDB](https://www.mongodb.org/downloads). Then:\n \n-    $ npm install mongoose\n+Then install the `mongoose` package using your preferred package manager:\n \n-## Plugins\n+### Using npm\n \n-Check out the [plugins search site](http://plugins.mongoosejs.com/) to see hundreds of related modules from the community.\n+```sh\n+npm install mongoose\n+```\n \n-## Contributors\n+### Using pnpm\n+\n+```sh\n+pnpm add mongoose\n+```\n+\n+### Using Yarn\n+\n+```sh\n+yarn add mongoose\n+```\n+\n+### Using Bun\n+\n+```sh\n+bun add mongoose\n+```\n+\n+Mongoose 6.8.0 also includes alpha support for [Deno](https://deno.land/).\n+\n+## Importing\n+\n+```javascript\n+// Using Node.js `require()`\n+const mongoose = require('mongoose');\n+\n+// Using ES6 imports\n+import mongoose from 'mongoose';\n+```\n+\n",
					"match": false,
					"packageHash": "6f1749527473ae55e713c16513f021506dd75c3f2d78ec0e044bbd2c6ae0e0ab",
					"size": 9873,
					"sourceHash": "933000205e94034ec897f34c2c7cb4d18a7de1faad1e7d93ccf29fc93d7c135a",
					"status": "content"
				},
				"examples/schema.js": {
					"match": false,
					"packageHash": "476696d6b14fcd15db43f5d2420c70d703edd5258b7df7db38ec48be13d0dfbd",
					"size": 1928,
					"status": "missing-in-source"
				},
				"index.js": {
					"diff": "--- published/index.js\n+++ rebuilt/index.js\n@@ -1,7 +1,64 @@\n-\n /**\n  * Export lib/mongoose\n  *\n  */\n \n-module.exports = require('./lib/');\n+'use strict';\n+\n+const mongoose = require('./lib/');\n+\n+module.exports = mongoose;\n+module.exports.default = mongoose;\n+module.exports.mongoose = mongoose;\n+\n+// Re-export for ESM support\n+module.exports.cast = mongoose.cast;\n+module.exports.STATES = mongoose.STATES;\n+module.exports.setDriver = mongoose.setDriver;\n+module.exports.set = mongoose.set;\n+module.exports.get = mongoose.get;\n+module.exports.createConnection = mongoose.createConnection;\n+module.exports.connect = mongoose.connect;\n+module.exports.disconnect = mongoose.disconnect;\n+module.exports.startSession = mongoose.startSession;\n+module.exports.pluralize = mongoose.pluralize;\n+module.exports.model = mongoose.model;\n+module.exports.deleteModel = mongoose.deleteModel;\n+module.exports.modelNames = mongoose.modelNames;\n+module.exports.plugin = mongoose.plugin;\n+module.exports.connections = mongoose.connections;\n+module.exports.version = mongoose.version;\n+module.exports.Aggregate = mongoose.Aggregate;\n+module.exports.Mongoose = mongoose.Mongoose;\n+module.exports.Schema = mongoose.Schema;\n+module.exports.SchemaType = mongoose.SchemaType;\n+module.exports.SchemaTypes = mongoose.SchemaTypes;\n+module.exports.VirtualType = mongoose.VirtualType;\n+module.exports.Types = mongoose.Types;\n+module.exports.Query = mongoose.Query;\n+module.exports.Model = mongoose.Model;\n+module.exports.Document = mongoose.Document;\n+module.exports.ObjectId = mongoose.ObjectId;\n+module.exports.isValidObjectId = mongoose.isValidObjectId;\n+module.exports.isObjectIdOrHexString = mongoose.isObjectIdOrHexString;\n+module.exports.syncIndexes = mongoose.syncIndexes;\n+module.exports.Decimal128 = mongoose.Decimal128;\n+module.exports.Mixed = mongoose.Mixed;\n+module.exports.Date = mongoose.Date;\n+module.exports.Number = mongoose.Number;\n+module.exports.Error = mongoose.Error;\n+module.exports.MongooseError = mongoose.MongooseError;\n+module.exports.now = mongoose.now;\n+module.exports.CastError = mongoose.CastError;\n+module.exports.SchemaTypeOptions = mongoose.SchemaTypeOptions;\n+module.exports.mongo = mongoose.mongo;\n+module.exports.mquery = mongoose.mquery;\n+module.exports.sanitizeFilter = mongoose.sanitizeFilter;\n+module.exports.trusted = mongoose.trusted;\n+module.exports.skipMiddlewareFunction = mongoose.skipMiddlewareFunction;\n+module.exports.overwriteMiddlewareResult = mongoose.overwriteMiddlewareResult;\n+\n+// The following properties are not exported using ESM because `setDriver()` can mutate these\n+// module.exports.connection = mongoose.connection;\n+// module.exports.Collection = mongoose.Collection;\n+// module.exports.Connection = mongoose.Connection;\n",
					"match": false,
					"packageHash": "190699a763329b67abc63cecc10737a84397c7d8fc30d2782679b3abd0a793db",
					"size": 72,
					"sourceHash": "59e21822580047abc5468d740b720d1383fa3569aa2da3ac70325265fbb0e25b",
					"status": "content"
				},
				"lib/collection.js": {
					"diff": "--- published/lib/collection.js\n+++ rebuilt/lib/collection.js\n@@ -1,9 +1,12 @@\n+'use strict';\n \n /*!\n  * Module dependencies.\n  */\n \n-var STATES = require('./connectionstate')\n+const EventEmitter = require('events').EventEmitter;\n+const STATES = require('./connectionState');\n+const immediate = require('./helpers/immediate');\n \n /**\n  * Abstract Collection constructor\n@@ -12,32 +15,27 @@\n  *\n  * @param {String} name name of the collection\n  * @param {Connection} conn A MongooseConnection instance\n- * @param {Object} opts optional collection options\n+ * @param {Object} [opts] optional collection options\n  * @api public\n  */\n \n-function Collection (name, conn, opts) {\n-  if (undefined === opts) opts = {};\n-  if (undefined === opts.capped) opts.capped = {};\n-\n-  opts.bufferCommands = undefined === opts.bufferCommands\n-    ? true\n-    : opts.bufferCommands;\n-\n-  if ('number' == typeof opts.capped) {\n-    opts.capped = { size: opts.capped };\n+function Collection(name, conn, opts) {\n+  if (opts === void 0) {\n+    opts = {};\n   }\n \n   this.opts = opts;\n   this.name = name;\n+  this.collectionName = name;\n   this.conn = conn;\n   this.queue = [];\n-  this.buffer = this.opts.bufferCommands;\n+  this.buffer = !conn?._hasOpened;\n+  this.emitter = new EventEmitter();\n \n-  if (STATES.connected == this.conn.readyState) {\n+  if (STATES.connected === this.conn.readyState) {\n     this.onOpen();\n   }\n-};\n+}\n \n /**\n  * The collection name\n@@ -49,6 +47,15 @@\n Collection.prototype.name;\n \n /**\n+ * The collection name\n+ *\n+ * @api public\n+ * @property collectionName\n+ */\n+\n+Collection.prototype.collectionName;\n+\n+/**\n  * The Connection instance\n  *\n  * @api public\n@@ -63,10 +70,9 @@\n  * @api private\n  */\n \n-Collection.prototype.onOpen = function () {\n-  var self = this;\n+Collection.prototype.onOpen = function() {\n   this.buffer = false;\n-  self.doQueue();\n+  immediate(() => this.doQueue());\n };\n \n /**\n@@ -75,11 +81,7 @@\n  * @api private\n  */\n \n-Collection.prototype.onClose = function () {\n-  if (this.opts.bufferCommands) {\n-    this.buffer = true;\n-  }\n-};\n+Collection.prototype.onClose = function() {};\n \n /**\n  * Queues a method for later execution when its\n",
					"match": false,
					"packageHash": "211527d6724d0f2c06bd905215da49ee741b8a20317105f3994b7c69d8b0f6be",
					"size": 3633,
					"sourceHash": "d7dc206d8201f928816b9d26055442980d2f327d20c4fc867d2f567c00488d52",
					"status": "content"
				},
				"lib/connection.js": {
					"diff": "--- published/lib/connection.js\n+++ rebuilt/lib/connection.js\n@@ -1,26 +1,46 @@\n+'use strict';\n+\n /*!\n  * Module dependencies.\n  */\n \n-var url = require('url')\n-  , utils = require('./utils')\n-  , EventEmitter = require('events').EventEmitter\n-  , driver = global.MONGOOSE_DRIVER_PATH || './drivers/node-mongodb-native'\n-  , Model = require('./model')\n-  , Schema = require('./schema')\n-  , Collection  = require(driver + '/collection')\n-  , STATES = require('./connectionstate')\n-  , MongooseError = require('./error')\n-  , assert =require('assert')\n-  , muri = require('muri')\n+const ChangeStream = require('./cursor/changeStream');\n+const EventEmitter = require('events').EventEmitter;\n+const Schema = require('./schema');\n+const STATES = require('./connectionState');\n+const MongooseBulkWriteError = require('./error/bulkWriteError');\n+const MongooseError = require('./error/index');\n+const ServerSelectionError = require('./error/serverSelection');\n+const SyncIndexesError = require('./error/syncIndexes');\n+const applyPlugins = require('./helpers/schema/applyPlugins');\n+const clone = require('./helpers/clone');\n+const driver = require('./driver');\n+const get = require('./helpers/get');\n+const getDefaultBulkwriteResult = require('./helpers/getDefaultBulkwriteResult');\n+const immediate = require('./helpers/immediate');\n+const utils = require('./utils');\n+const CreateCollectionsError = require('./error/createCollectionsError');\n+const castBulkWrite = require('./helpers/model/castBulkWrite');\n+const { modelSymbol } = require('./helpers/symbols');\n+const isPromise = require('./helpers/isPromise');\n+const decorateBulkWriteResult = require('./helpers/model/decorateBulkWriteResult');\n+\n+const arrayAtomicsSymbol = require('./helpers/symbols').arrayAtomicsSymbol;\n+const sessionNewDocuments = require('./helpers/symbols').sessionNewDocuments;\n+\n+// Snapshot the native Date constructor to ensure both Date.now() and new Date() (and other Date methods)\n+// bypass timer mocks such as those set up by useFakeTimers().\n+const Date = globalThis.Date;\n \n-/*!\n- * Protocol prefix regexp.\n+/**\n+ * A list of authentication mechanisms that don't require a password for authentication.\n+ * This is used by the authMechanismDoesNotRequirePassword method.\n  *\n  * @api private\n  */\n-\n-var rgxProtocol = /^(?:.)+:\\/\\//;\n+const noPasswordAuthMechanisms = [\n+  'MONGODB-X509'\n+];\n \n /**\n  * Connection constructor\n@@ -28,41 +48,50 @@\n  * For practical reasons, a Connection equals a Db.\n  *\n  * @param {Mongoose} base a mongoose instance\n- * @inherits NodeJS EventEmitter http://nodejs.org/api/events.html#events_class_events_eventemitter\n- * @event `connecting`: Emitted when `connection.{open,openSet}()` is executed on this connection.\n+ * @inherits NodeJS EventEmitter https://nodejs.org/api/events.html#class-eventemitter\n+ * @event `connecting`: Emitted when `connection.openUri()` is executed on this connection.\n  * @event `connected`: Emitted when this connection successfully connects to the db. May be emitted _multiple_ times in `reconnected` scenarios.\n- * @event `open`: Emitted after we `connected` and `onOpen` is executed on all of this connections models.\n+ * @event `open`: Emitted after we `connected` and `onOpen` is executed on all of this connection's models.\n  * @event `disconnecting`: Emitted when `connection.close()` was executed.\n  * @event `disconnected`: Emitted after getting disconnected from the db.\n- * @event `close`: Emitted after we `disconnected` and `onClose` executed on all of this connections models.\n- * @event `reconnected`: Emitted after we `connected` and subsequently `disconnected`, followed by successfully another successfull connection.\n+ * @event `close`: Emitted after we `disconnected` and `onClose` executed on all of this connection's models.\n+ * @event `reconnected`: Emitted after we `connected` and subsequently `disconnected`, followed by successfully another successful connection.\n  * @event `error`: Emitted when an error occurs on this connection.\n- * @event `fullsetup`: Emitted in a replica-set scenario, when all nodes specified in the connection string are connected.\n+ * @event `operation-start`: Emitted when a call to the MongoDB Node.js driver, like a `find()` or `insertOne()`, happens on any collection tied to this connection.\n+ * @event `operation-end`: Emitted when a call to the MongoDB Node.js driver, like a `find()` or `insertOne()`, either succeeds or errors.\n  * @api public\n  */\n \n-function Connection (base) {\n+function Connection(base) {\n   this.base = base;\n   this.collections = {};\n   this.models = {};\n+  this.config = {};\n   this.replica = false;\n-  this.hosts = null;\n-  this.host = null;\n-  this.port = null;\n-  this.user = null;\n-  this.pass = null;\n",
					"match": false,
					"packageHash": "9ec81ba5c26e667f4929b3e9f740395e3ea4b65b510d710b835b231a51f3c33c",
					"size": 18017,
					"sourceHash": "2a19077e15429dd2974bf84813f104736015aa9aca3a021127c024f31c1df49c",
					"status": "content"
				},
				"lib/connectionstate.js": {
					"match": false,
					"packageHash": "792dc2f0b478bbf54d6e1649c4190fa8c9e5faf17d4edea7187e21ab52572f52",
					"size": 520,
					"status": "missing-in-source"
				},
				"lib/document.js": {
					"diff": "--- published/lib/document.js\n+++ rebuilt/lib/document.js\n@@ -1,115 +1,546 @@\n+'use strict';\n+\n /*!\n  * Module dependencies.\n  */\n \n-var EventEmitter = require('events').EventEmitter\n-  , MongooseError = require('./error')\n-  , MixedSchema = require('./schema/mixed')\n-  , Schema = require('./schema')\n-  , ValidatorError = require('./schematype').ValidatorError\n-  , utils = require('./utils')\n-  , clone = utils.clone\n-  , isMongooseObject = utils.isMongooseObject\n-  , inspect = require('util').inspect\n-  , ElemMatchError = MongooseError.ElemMatchError\n-  , ValidationError = MongooseError.ValidationError\n-  , DocumentError = MongooseError.DocumentError\n-  , InternalCache = require('./internal')\n-  , deepEqual = utils.deepEqual\n-  , hooks = require('hooks')\n-  , DocumentArray\n-  , MongooseArray\n+const DivergentArrayError = require('./error/divergentArray');\n+const EventEmitter = require('events').EventEmitter;\n+const InternalCache = require('./internal');\n+const MongooseBuffer = require('./types/buffer');\n+const MongooseError = require('./error/index');\n+const MixedSchema = require('./schema/mixed');\n+const ModifiedPathsSnapshot = require('./modifiedPathsSnapshot');\n+const ObjectExpectedError = require('./error/objectExpected');\n+const ObjectParameterError = require('./error/objectParameter');\n+const ParallelValidateError = require('./error/parallelValidate');\n+const Schema = require('./schema');\n+const StrictModeError = require('./error/strict');\n+const ValidationError = require('./error/validation');\n+const ValidatorError = require('./error/validator');\n+const $__hasIncludedChildren = require('./helpers/projection/hasIncludedChildren');\n+const applyDefaults = require('./helpers/document/applyDefaults');\n+const cleanModifiedSubpaths = require('./helpers/document/cleanModifiedSubpaths');\n+const clone = require('./helpers/clone');\n+const compile = require('./helpers/document/compile').compile;\n+const defineKey = require('./helpers/document/compile').defineKey;\n+const firstKey = require('./helpers/firstKey');\n+const flatten = require('./helpers/common').flatten;\n+const getEmbeddedDiscriminatorPath = require('./helpers/document/getEmbeddedDiscriminatorPath');\n+const getKeysInSchemaOrder = require('./helpers/schema/getKeysInSchemaOrder');\n+const getSubdocumentStrictValue = require('./helpers/schema/getSubdocumentStrictValue');\n+const handleSpreadDoc = require('./helpers/document/handleSpreadDoc');\n+const isBsonType = require('./helpers/isBsonType');\n+const isDefiningProjection = require('./helpers/projection/isDefiningProjection');\n+const isExclusive = require('./helpers/projection/isExclusive');\n+const isPathExcluded = require('./helpers/projection/isPathExcluded');\n+const inspect = require('util').inspect;\n+const internalToObjectOptions = require('./options').internalToObjectOptions;\n+const markArraySubdocsPopulated = require('./helpers/populate/markArraySubdocsPopulated');\n+const minimize = require('./helpers/minimize');\n+const mpath = require('mpath');\n+const parentPaths = require('./helpers/path/parentPaths');\n+const queryhelpers = require('./queryHelpers');\n+const utils = require('./utils');\n+const isPromise = require('./helpers/isPromise');\n+\n+const deepEqual = utils.deepEqual;\n+const isMongooseObject = utils.isMongooseObject;\n+\n+const arrayAtomicsBackupSymbol = require('./helpers/symbols').arrayAtomicsBackupSymbol;\n+const arrayAtomicsSymbol = require('./helpers/symbols').arrayAtomicsSymbol;\n+const documentArrayParent = require('./helpers/symbols').documentArrayParent;\n+const documentIsModified = require('./helpers/symbols').documentIsModified;\n+const documentModifiedPaths = require('./helpers/symbols').documentModifiedPaths;\n+const documentSchemaSymbol = require('./helpers/symbols').documentSchemaSymbol;\n+const getSymbol = require('./helpers/symbols').getSymbol;\n+const modelSymbol = require('./helpers/symbols').modelSymbol;\n+const populateModelSymbol = require('./helpers/symbols').populateModelSymbol;\n+const scopeSymbol = require('./helpers/symbols').scopeSymbol;\n+const schemaMixedSymbol = require('./schema/symbols').schemaMixedSymbol;\n+const getDeepestSubdocumentForPath = require('./helpers/document/getDeepestSubdocumentForPath');\n+const sessionNewDocuments = require('./helpers/symbols').sessionNewDocuments;\n+\n+let DocumentArray;\n+let MongooseArray;\n+let Embedded;\n+\n+const specialProperties = utils.specialProperties;\n+\n+const VERSION_WHERE = 1;\n+const VERSION_INC = 2;\n+const VERSION_ALL = VERSION_WHERE | VERSION_INC;\n \n /**\n- * Document constructor.\n+ * The core Mongoose document constructor. You should not call this directly,\n+ * the Mongoose [Model constructor](./api/model.html#Model) calls this for you.\n  *\n  * @param {Object} obj the values to set\n- * @param {Object} [opts] optional object containing the fields which were selected in the query returning this document and any populated paths data\n",
					"match": false,
					"packageHash": "86f5cdf337364343b1395b4250f5a43e40012db42f30123189d685ec09c5be9a",
					"size": 40877,
					"sourceHash": "88b7dfa59b77643ce4eba90dbbf3d8d09cedbcb8a07108f001d23393a5191fff",
					"status": "content"
				},
				"lib/drivers/node-mongodb-native/binary.js": {
					"match": false,
					"packageHash": "11fa1bd84e364d1a3867132e460fa2b3e954cae998c4c72618087b8a1dfa3b91",
					"size": 119,
					"status": "missing-in-source"
				},
				"lib/drivers/node-mongodb-native/collection.js": {
					"diff": "--- published/lib/drivers/node-mongodb-native/collection.js\n+++ rebuilt/lib/drivers/node-mongodb-native/collection.js\n@@ -1,24 +1,35 @@\n+'use strict';\n \n /*!\n  * Module dependencies.\n  */\n \n-var MongooseCollection = require('../../collection')\n-  , Collection = require('mongodb').Collection\n-  , STATES = require('../../connectionstate')\n-  , utils = require('../../utils')\n+const MongooseCollection = require('../../collection');\n+const MongooseError = require('../../error/mongooseError');\n+const Collection = require('mongodb').Collection;\n+const ObjectId = require('../../types/objectid');\n+const getConstructorName = require('../../helpers/getConstructorName');\n+const internalToObjectOptions = require('../../options').internalToObjectOptions;\n+const stream = require('stream');\n+const util = require('util');\n+\n+const formatToObjectOptions = Object.freeze({ ...internalToObjectOptions, copyTrustedSymbol: false });\n \n /**\n  * A [node-mongodb-native](https://github.com/mongodb/node-mongodb-native) collection implementation.\n  *\n  * All methods methods from the [node-mongodb-native](https://github.com/mongodb/node-mongodb-native) driver are copied and wrapped in queue management.\n  *\n- * @inherits Collection\n+ * @inherits Collection https://mongodb.github.io/node-mongodb-native/4.9/classes/Collection.html\n  * @api private\n  */\n \n-function NativeCollection () {\n+function NativeCollection(name, conn, options) {\n   this.collection = null;\n+  this.Promise = options.Promise || Promise;\n+  this.modelName = options.modelName;\n+  delete options.modelName;\n+  this._closed = false;\n   MongooseCollection.apply(this, arguments);\n }\n \n@@ -26,7 +37,7 @@\n  * Inherit from abstract Collection.\n  */\n \n-NativeCollection.prototype.__proto__ = MongooseCollection.prototype;\n+Object.setPrototypeOf(NativeCollection.prototype, MongooseCollection.prototype);\n \n /**\n  * Called when the connection opens.\n@@ -34,170 +45,341 @@\n  * @api private\n  */\n \n-NativeCollection.prototype.onOpen = function () {\n-  var self = this;\n-\n-  // always get a new collection in case the user changed host:port\n-  // of parent db instance when re-opening the connection.\n-\n-  if (!self.opts.capped.size) {\n-    // non-capped\n-    return self.conn.db.collection(self.name, callback);\n-  }\n-\n-  // capped\n-  return self.conn.db.collection(self.name, function (err, c) {\n-    if (err) return callback(err);\n+NativeCollection.prototype.onOpen = function() {\n+  this.collection = this.conn.db.collection(this.name);\n+  MongooseCollection.prototype.onOpen.call(this);\n+  return this.collection;\n+};\n \n-    // discover if this collection exists and if it is capped\n-    c.options(function (err, exists) {\n-      if (err) return callback(err);\n+/**\n+ * Called when the connection closes\n+ *\n+ * @api private\n+ */\n \n-      if (exists) {\n-        if (exists.capped) {\n-          callback(null, c);\n-        } else {\n-          var msg = 'A non-capped collection exists with this name.\\n\\n'\n-                  + ' To use this collection as a capped collection, please '\n-                  + 'first convert it.\\n'\n-                  + ' http://www.mongodb.org/display/DOCS/Capped+Collections#CappedCollections-Convertingacollectiontocapped'\n-          err = new Error(msg);\n-          callback(err);\n-        }\n-      } else {\n-        // create\n-        var opts = utils.clone(self.opts.capped);\n",
					"match": false,
					"packageHash": "0104495dc833965be7be1c7ba075a04f19d91f8e51b50fc6fdf8693fcca869bd",
					"size": 5570,
					"sourceHash": "0e1cc34846c8dc10bd151a693da6e69847b1aabab0f2d14ddf5c0729f5af52da",
					"status": "content"
				},
				"lib/drivers/node-mongodb-native/connection.js": {
					"diff": "--- published/lib/drivers/node-mongodb-native/connection.js\n+++ rebuilt/lib/drivers/node-mongodb-native/connection.js\n@@ -2,11 +2,17 @@\n  * Module dependencies.\n  */\n \n-var MongooseConnection = require('../../connection')\n-  , mongo = require('mongodb')\n-  , Server = mongo.Server\n-  , STATES = require('../../connectionstate')\n-  , ReplSetServers = mongo.ReplSetServers;\n+'use strict';\n+\n+const MongooseConnection = require('../../connection');\n+const MongooseError = require('../../error/index');\n+const STATES = require('../../connectionState');\n+const mongodb = require('mongodb');\n+const pkg = require('../../../package.json');\n+const processConnectionOptions = require('../../helpers/processConnectionOptions');\n+const setTimeout = require('../../helpers/timers').setTimeout;\n+const utils = require('../../utils');\n+const Schema = require('../../schema');\n \n /**\n  * A [node-mongodb-native](https://github.com/mongodb/node-mongodb-native) connection implementation.\n@@ -18,271 +24,477 @@\n function NativeConnection() {\n   MongooseConnection.apply(this, arguments);\n   this._listening = false;\n-};\n+  // Tracks the last time (as unix timestamp) the connection received a\n+  // serverHeartbeatSucceeded or serverHeartbeatFailed event from the underlying MongoClient.\n+  // If we haven't received one in a while (like due to a frozen AWS Lambda container) then\n+  // `readyState` is likely stale.\n+  this._lastHeartbeatAt = null;\n+}\n+\n+/**\n+ * Expose the possible connection states.\n+ * @api public\n+ */\n+\n+NativeConnection.STATES = STATES;\n \n /*!\n  * Inherits from Connection.\n  */\n \n-NativeConnection.prototype.__proto__ = MongooseConnection.prototype;\n+Object.setPrototypeOf(NativeConnection.prototype, MongooseConnection.prototype);\n \n /**\n- * Opens the connection to MongoDB.\n+ * Switches to a different database using the same connection pool.\n  *\n- * @param {Function} fn\n- * @return {Connection} this\n- * @api private\n+ * Returns a new connection object, with the new db. If you set the `useCache`\n+ * option, `useDb()` will cache connections by `name`.\n+ *\n+ * **Note:** Calling `close()` on a `useDb()` connection will close the base connection as well.\n+ *\n+ * @param {String} name The database name\n+ * @param {Object} [options]\n+ * @param {Boolean} [options.useCache=false] If true, cache results so calling `useDb()` multiple times with the same name only creates 1 connection object.\n+ * @return {Connection} New Connection Object\n+ * @api public\n  */\n \n-NativeConnection.prototype.doOpen = function (fn) {\n-  if (this.db) {\n-    mute(this);\n+NativeConnection.prototype.useDb = function(name, options) {\n+  // Return immediately if cached\n+  options = options || {};\n+  if (options.useCache && this.relatedDbs[name]) {\n+    return this.relatedDbs[name];\n   }\n \n-  var server = new mongo.Server(this.host, this.port, this.options.server);\n-  this.db = new mongo.Db(this.name, server, this.options.db);\n-\n-  var self = this;\n-  this.db.open(function (err) {\n-    if (err) return fn(err);\n-    listen(self);\n-    fn();\n-  });\n-\n-  return this;\n-};\n+  // we have to manually copy all of the attributes...\n+  const newConn = new this.constructor();\n+  newConn.name = name;\n+  newConn.base = this.base;\n+  newConn.collections = {};\n+  newConn.models = {};\n+  newConn.replica = this.replica;\n+  newConn.config = Object.assign({}, this.config, newConn.config);\n",
					"match": false,
					"packageHash": "52cb5d7d16485ae45b9028a31a56b8ea9b34e7b38dcdea23a76c065bd6294f54",
					"size": 7240,
					"sourceHash": "9501aba2c252f09149bf206976421113f16d24d502ef9e05f83db4f210fc2e22",
					"status": "content"
				},
				"lib/drivers/node-mongodb-native/objectid.js": {
					"match": false,
					"packageHash": "7fb6f5ccb8f10b2440fae8cc34105bed346daaedc661e836fc945ffbb483563e",
					"size": 660,
					"status": "missing-in-source"
				},
				"lib/error.js": {
					"match": false,
					"packageHash": "f044bbc46b38221c3f4f82197ac056a56f70c3fa5123ac2702e506dffbfe4418",
					"size": 991,
					"status": "missing-in-source"
				},
				"lib/errors/cast.js": {
					"match": false,
					"packageHash": "abe31abcff884548c3e6113fed8523fdff30ecf2f24896b95d4a16480878d54b",
					"size": 649,
					"status": "missing-in-source"
				},
				"lib/errors/divergentArray.js": {
					"match": false,
					"packageHash": "18b438371262ae43274e96282617bbc90a418a46929cfcf01b30ee39443b3f00",
					"size": 1076,
					"status": "missing-in-source"
				},
				"lib/errors/document.js": {
					"match": false,
					"packageHash": "ad6a26de90d7ef693820a4065fe7e331387c44bafddcb27f6cd1840e630ae64b",
					"size": 493,
					"status": "missing-in-source"
				},
				"lib/errors/missingSchema.js": {
					"match": false,
					"packageHash": "9338b5bcd8d01072b622451e3043166e4000a7c810c673402a17d01e1d9b1b60",
					"size": 598,
					"status": "missing-in-source"
				},
				"lib/errors/overwriteModel.js": {
					"match": false,
					"packageHash": "c34a62ae29d6a74791dafb29c437edb39e3aefa8c76f3ebc45d0f9d8a4406e39",
					"size": 533,
					"status": "missing-in-source"
				},
				"lib/errors/validation.js": {
					"match": false,
					"packageHash": "b0d66c40f9a176e366ad302314bc2de8efd8460f39a309aaf703c65eb7d06c53",
					"size": 797,
					"status": "missing-in-source"
				},
				"lib/errors/validator.js": {
					"match": false,
					"packageHash": "e121d69df159bdbb2c1714633d5222d69460bea2a9067266d1f0dccc0ceee598",
					"size": 917,
					"status": "missing-in-source"
				},
				"lib/errors/version.js": {
					"match": false,
					"packageHash": "1555d74f72955b58c6fa1cc313b608ee5bdfc9ed3872c5abcbef4ee43c1bb7f7",
					"size": 485,
					"status": "missing-in-source"
				},
				"lib/index.js": {
					"diff": "--- published/lib/index.js\n+++ rebuilt/lib/index.js\n@@ -1,579 +1,17 @@\n+'use strict';\n \n /*!\n  * Module dependencies.\n  */\n \n-var Schema = require('./schema')\n-  , SchemaType = require('./schematype')\n-  , VirtualType = require('./virtualtype')\n-  , SchemaTypes = Schema.Types\n-  , SchemaDefaults = require('./schemadefault')\n-  , Types = require('./types')\n-  , Query = require('./query')\n-  , Promise = require('./promise')\n-  , Model = require('./model')\n-  , Document = require('./document')\n-  , utils = require('./utils')\n-  , format = utils.toCollectionName\n-  , mongodb = require('mongodb')\n+const mongodbDriver = require('./drivers/node-mongodb-native');\n \n-/**\n- * Mongoose constructor.\n- *\n- * The exports object of the `mongoose` module is an instance of this class.\n- * Most apps will only use this one instance.\n- *\n- * @api public\n- */\n-\n-function Mongoose () {\n-  this.connections = [];\n-  this.plugins = [];\n-  this.models = {};\n-  this.modelSchemas = {};\n-  this.options = {};\n-  this.createConnection(); // default connection\n-};\n-\n-/**\n- * Sets mongoose options\n- *\n- * ####Example:\n- *\n- *     mongoose.set('test', value) // sets the 'test' option to `value`\n- *\n- * @param {String} key\n- * @param {String} value\n- * @api public\n- */\n-\n-Mongoose.prototype.set = function (key, value) {\n-  if (arguments.length == 1)\n-    return this.options[key];\n-  this.options[key] = value;\n-  return this;\n-};\n-\n-/**\n- * Gets mongoose options\n- *\n- * ####Example:\n- *\n- *     mongoose.get('test') // returns the 'test' value\n- *\n- * @param {String} key\n- * @method get\n- * @api public\n- */\n-\n-Mongoose.prototype.get = Mongoose.prototype.set;\n-\n-/*!\n- * ReplSet connection string check.\n- */\n-\n-var rgxReplSet = /^.+,.+$/;\n-\n-/**\n- * Creates a Connection instance.\n- *\n- * Each `connection` instance maps to a single database. This method is helpful when mangaging multiple db connections.\n- *\n- * If arguments are passed, they are proxied to either [Connection#open](#connection_Connection-open) or [Connection#openSet](#connection_Connection-openSet) appropriately. This means we can pass `db`, `server`, and `replset` options to the driver.\n- *\n- * _Options passed take precedence over options included in connection strings._\n- *\n- * ####Example:\n- *\n- *     // with mongodb:// URI\n- *     db = mongoose.createConnection('mongodb://user:pass@localhost:port/database');\n- *\n- *     // and options\n- *     var opts = { db: { native_parser: true }}\n- *     db = mongoose.createConnection('mongodb://user:pass@localhost:port/database', opts);\n- *\n- *     // replica sets\n",
					"match": false,
					"packageHash": "dd4a8007e716af8061a82dbf715f6148406514711780909d69a3b583640abeca",
					"size": 13092,
					"sourceHash": "d91a70387987fd6b5d044298268984581a639788a1e940d10476ce2f77a4e6cb",
					"status": "content"
				},
				"lib/internal.js": {
					"diff": "--- published/lib/internal.js\n+++ rebuilt/lib/internal.js\n@@ -1,30 +1,46 @@\n-/**\n+/*!\n  * Dependencies\n  */\n \n-var StateMachine = require('./statemachine')\n-var ActiveRoster = StateMachine.ctor('require', 'modify', 'init', 'default')\n+'use strict';\n+\n+const StateMachine = require('./stateMachine');\n+const ActiveRoster = StateMachine.ctor('require', 'modify', 'init', 'default', 'ignore');\n \n module.exports = exports = InternalCache;\n \n-function InternalCache () {\n-  this.strictMode = undefined;\n-  this.selected = undefined;\n-  this.shardval = undefined;\n-  this.saveError = undefined;\n-  this.validationError = undefined;\n-  this.adhocPaths = undefined;\n-  this.removing = undefined;\n-  this.inserting = undefined;\n-  this.version = undefined;\n-  this.getters = {};\n-  this._id = undefined;\n-  this.populate = undefined;\n-  this.populated = undefined;\n-  this.scope = undefined;\n-  this.activePaths = new ActiveRoster;\n-\n-  // embedded docs\n-  this.ownerDocument = undefined;\n-  this.fullPath = undefined;\n+function InternalCache() {\n+  this.activePaths = new ActiveRoster();\n }\n+\n+InternalCache.prototype.strictMode = true;\n+\n+InternalCache.prototype.fullPath = undefined;\n+InternalCache.prototype.selected = undefined;\n+InternalCache.prototype.shardval = undefined;\n+InternalCache.prototype.saveError = undefined;\n+InternalCache.prototype.validationError = undefined;\n+InternalCache.prototype.adhocPaths = undefined;\n+InternalCache.prototype.removing = undefined;\n+InternalCache.prototype.inserting = undefined;\n+InternalCache.prototype.saving = undefined;\n+InternalCache.prototype.version = undefined;\n+InternalCache.prototype._id = undefined;\n+InternalCache.prototype.ownerDocument = undefined;\n+InternalCache.prototype.populate = undefined; // what we want to populate in this doc\n+InternalCache.prototype.populated = undefined;// the _ids that have been populated\n+InternalCache.prototype.primitiveAtomics = undefined;\n+\n+/**\n+ * If `false`, this document was not the result of population.\n+ * If `true`, this document is a populated doc underneath another doc\n+ * If an object, this document is a populated doc and the `value` property of the\n+ * object contains the original depopulated value.\n+ */\n+InternalCache.prototype.wasPopulated = false;\n+\n+InternalCache.prototype.scope = undefined;\n+\n+InternalCache.prototype.session = null;\n+InternalCache.prototype.pathsToScopes = null;\n+InternalCache.prototype.cachedRequired = null;\n",
					"match": false,
					"packageHash": "e374fa00b26fb2e9f38f4346677ff52ed4c13680d6ddf6bbe01a044046dcdc48",
					"size": 746,
					"sourceHash": "e2789c4a80bd67a54889f034b21fa7a0909af3c70a6ccea9a7555946be9348f7",
					"status": "content"
				},
				"lib/model.js": {
					"diff": "--- published/lib/model.js\n+++ rebuilt/lib/model.js\n@@ -1,456 +1,648 @@\n+'use strict';\n+\n /*!\n  * Module dependencies.\n  */\n \n-var Document = require('./document')\n-  , MongooseArray = require('./types/array')\n-  , MongooseBuffer = require('./types/buffer')\n-  , MongooseError = require('./error')\n-  , VersionError = MongooseError.VersionError\n-  , DivergentArrayError = MongooseError.DivergentArrayError\n-  , Query = require('./query')\n-  , Schema = require('./schema')\n-  , Types = require('./schema/index')\n-  , utils = require('./utils')\n-  , hasOwnProperty = utils.object.hasOwnProperty\n-  , isMongooseObject = utils.isMongooseObject\n-  , EventEmitter = require('events').EventEmitter\n-  , merge = utils.merge\n-  , Promise = require('./promise')\n-  , assert = require('assert')\n-  , tick = utils.tick\n-\n-var VERSION_WHERE = 1\n-  , VERSION_INC = 2\n-  , VERSION_ALL = VERSION_WHERE | VERSION_INC;\n-\n-/**\n- * Model constructor\n- *\n- * @param {Object} doc values to with which to create the document\n- * @inherits Document\n- * @event `error`: If listening to this Model event, it is emitted when a document was saved without passing a callback and an `error` occurred. If not listening, the event bubbles to the connection used to create this Model.\n+const Aggregate = require('./aggregate');\n+const ChangeStream = require('./cursor/changeStream');\n+const Document = require('./document');\n+const DocumentNotFoundError = require('./error/notFound');\n+const EventEmitter = require('events').EventEmitter;\n+const Kareem = require('kareem');\n+const MongooseBulkWriteError = require('./error/bulkWriteError');\n+const MongooseError = require('./error/index');\n+const ObjectParameterError = require('./error/objectParameter');\n+const OverwriteModelError = require('./error/overwriteModel');\n+const Query = require('./query');\n+const SaveOptions = require('./options/saveOptions');\n+const Schema = require('./schema');\n+const ValidationError = require('./error/validation');\n+const VersionError = require('./error/version');\n+const ParallelSaveError = require('./error/parallelSave');\n+const applyDefaultsHelper = require('./helpers/document/applyDefaults');\n+const applyDefaultsToPOJO = require('./helpers/model/applyDefaultsToPOJO');\n+const applyEmbeddedDiscriminators = require('./helpers/discriminator/applyEmbeddedDiscriminators');\n+const applyHooks = require('./helpers/model/applyHooks');\n+const applyMethods = require('./helpers/model/applyMethods');\n+const applyProjection = require('./helpers/projection/applyProjection');\n+const applyReadConcern = require('./helpers/schema/applyReadConcern');\n+const applySchemaCollation = require('./helpers/indexes/applySchemaCollation');\n+const applyStaticHooks = require('./helpers/model/applyStaticHooks');\n+const applyStatics = require('./helpers/model/applyStatics');\n+const applyTimestampsHelper = require('./helpers/document/applyTimestamps');\n+const applyWriteConcern = require('./helpers/schema/applyWriteConcern');\n+const applyVirtualsHelper = require('./helpers/document/applyVirtuals');\n+const assignVals = require('./helpers/populate/assignVals');\n+const castBulkWrite = require('./helpers/model/castBulkWrite');\n+const clone = require('./helpers/clone');\n+const createPopulateQueryFilter = require('./helpers/populate/createPopulateQueryFilter');\n+const decorateUpdateWithVersionKey = require('./helpers/update/decorateUpdateWithVersionKey');\n+const getDefaultBulkwriteResult = require('./helpers/getDefaultBulkwriteResult');\n+const getSchemaDiscriminatorByValue = require('./helpers/discriminator/getSchemaDiscriminatorByValue');\n+const discriminator = require('./helpers/model/discriminator');\n+const each = require('./helpers/each');\n+const get = require('./helpers/get');\n+const getConstructorName = require('./helpers/getConstructorName');\n+const getDiscriminatorByValue = require('./helpers/discriminator/getDiscriminatorByValue');\n+const getModelsMapForPopulate = require('./helpers/populate/getModelsMapForPopulate');\n+const immediate = require('./helpers/immediate');\n+const internalToObjectOptions = require('./options').internalToObjectOptions;\n+const isDefaultIdIndex = require('./helpers/indexes/isDefaultIdIndex');\n+const isIndexEqual = require('./helpers/indexes/isIndexEqual');\n+const isTimeseriesIndex = require('./helpers/indexes/isTimeseriesIndex');\n+const {\n+  getRelatedDBIndexes,\n+  getRelatedSchemaIndexes\n+} = require('./helpers/indexes/getRelatedIndexes');\n+const decorateDiscriminatorIndexOptions = require('./helpers/indexes/decorateDiscriminatorIndexOptions');\n+const isPathSelectedInclusive = require('./helpers/projection/isPathSelectedInclusive');\n+const leanPopulateMap = require('./helpers/populate/leanPopulateMap');\n+const parallelLimit = require('./helpers/parallelLimit');\n+const prepareDiscriminatorPipeline = require('./helpers/aggregate/prepareDiscriminatorPipeline');\n+const pushNestedArrayPaths = require('./helpers/model/pushNestedArrayPaths');\n+const removeDeselectedForeignField = require('./helpers/populate/removeDeselectedForeignField');\n+const setDottedPath = require('./helpers/path/setDottedPath');\n+const util = require('util');\n+const utils = require('./utils');\n+const minimize = require('./helpers/minimize');\n+const MongooseBulkSaveIncompleteError = require('./error/bulkSaveIncompleteError');\n",
					"match": false,
					"packageHash": "18c649498bc42a3801d4b69f401ab9cb9909c2518abc120c00994c6068c4fb42",
					"size": 59233,
					"sourceHash": "5913ebb152aad2e3091b26c7cd85e1211288382b90fabded4e1aee493ab47b98",
					"status": "content"
				},
				"lib/namedscope.js": {
					"match": false,
					"packageHash": "1fd342a95c86a04e9dbf3829436651772e7a67a1c2804e013adc1080321f4bdd",
					"size": 1696,
					"status": "missing-in-source"
				},
				"lib/promise.js": {
					"match": false,
					"packageHash": "bd3a43eb6e66fca55df59b8c8bdf3515452d92ba6c8cdc7662493d45a5b49cf2",
					"size": 6379,
					"status": "missing-in-source"
				},
				"lib/query.js": {
					"diff": "--- published/lib/query.js\n+++ rebuilt/lib/query.js\n@@ -1,597 +1,523 @@\n+'use strict';\n+\n /*!\n  * Module dependencies.\n  */\n \n-var utils = require('./utils')\n-  , merge = utils.merge\n-  , Promise = require('./promise')\n-  , Document = require('./document')\n-  , Types = require('./schema/index')\n-  , inGroupsOf = utils.inGroupsOf\n-  , tick = utils.tick\n-  , QueryStream = require('./querystream')\n-  , ReadPref = require('mongodb').ReadPreference\n-\n-/**\n- * Query constructor used for building queries.\n- *\n- * ####Example:\n- *\n- *     var query = Model.find();\n+const CastError = require('./error/cast');\n+const DocumentNotFoundError = require('./error/notFound');\n+const Kareem = require('kareem');\n+const MongooseError = require('./error/mongooseError');\n+const ObjectParameterError = require('./error/objectParameter');\n+const QueryCursor = require('./cursor/queryCursor');\n+const ValidationError = require('./error/validation');\n+const { applyGlobalMaxTimeMS, applyGlobalDiskUse } = require('./helpers/query/applyGlobalOption');\n+const handleReadPreferenceAliases = require('./helpers/query/handleReadPreferenceAliases');\n+const applyReadConcern = require('./helpers/schema/applyReadConcern');\n+const applyWriteConcern = require('./helpers/schema/applyWriteConcern');\n+const cast = require('./cast');\n+const castArrayFilters = require('./helpers/update/castArrayFilters');\n+const castNumber = require('./cast/number');\n+const castUpdate = require('./helpers/query/castUpdate');\n+const clone = require('./helpers/clone');\n+const getDiscriminatorByValue = require('./helpers/discriminator/getDiscriminatorByValue');\n+const helpers = require('./queryHelpers');\n+const internalToObjectOptions = require('./options').internalToObjectOptions;\n+const isExclusive = require('./helpers/projection/isExclusive');\n+const isInclusive = require('./helpers/projection/isInclusive');\n+const isPathSelectedInclusive = require('./helpers/projection/isPathSelectedInclusive');\n+const isSubpath = require('./helpers/projection/isSubpath');\n+const mpath = require('mpath');\n+const mquery = require('mquery');\n+const parseProjection = require('./helpers/projection/parseProjection');\n+const removeUnusedArrayFilters = require('./helpers/update/removeUnusedArrayFilters');\n+const sanitizeFilter = require('./helpers/query/sanitizeFilter');\n+const sanitizeProjection = require('./helpers/query/sanitizeProjection');\n+const selectPopulatedFields = require('./helpers/query/selectPopulatedFields');\n+const setDefaultsOnInsert = require('./helpers/setDefaultsOnInsert');\n+const specialProperties = require('./helpers/specialProperties');\n+const updateValidators = require('./helpers/updateValidators');\n+const util = require('util');\n+const utils = require('./utils');\n+const queryMiddlewareFunctions = require('./constants').queryMiddlewareFunctions;\n+\n+const queryOptionMethods = new Set([\n+  'allowDiskUse',\n+  'batchSize',\n+  'collation',\n+  'comment',\n+  'explain',\n+  'hint',\n+  'j',\n+  'lean',\n+  'limit',\n+  'maxTimeMS',\n+  'populate',\n+  'projection',\n+  'read',\n+  'select',\n+  'skip',\n+  'slice',\n+  'sort',\n+  'tailable',\n+  'w',\n+  'writeConcern',\n+  'wtimeout'\n+]);\n+\n+// Map from operation name to the name of the function that executes the actual operation against MongoDB.\n+// Called a thunk for legacy reasons, \"thunk\" means function that takes exactly 1 param, a callback.\n+// Currently `_countDocuments()`, etc. are async functions that take no params.\n+const opToThunk = new Map([\n+  ['countDocuments', '_countDocuments'],\n+  ['distinct', '__distinct'],\n+  ['estimatedDocumentCount', '_estimatedDocumentCount'],\n+  ['find', '_find'],\n+  ['findOne', '_findOne'],\n+  ['findOneAndReplace', '_findOneAndReplace'],\n+  ['findOneAndUpdate', '_findOneAndUpdate'],\n+  ['replaceOne', '_replaceOne'],\n+  ['updateMany', '_updateMany'],\n+  ['updateOne', '_updateOne'],\n",
					"match": false,
					"packageHash": "1766a8cb9767ff0acff82da332fe1b2439a7e1441296eb88a74598f523640f62",
					"size": 63471,
					"sourceHash": "39b932d10ea2e0f0db6aa40447b481a941a2e5c0fdf428257547e0b947a31311",
					"status": "content"
				},
				"lib/querystream.js": {
					"match": false,
					"packageHash": "3d90404199619f14d74273272ba311399d0942792bc8a05fb1884ff1bf8420c7",
					"size": 7367,
					"status": "missing-in-source"
				},
				"lib/schema/array.js": {
					"diff": "--- published/lib/schema/array.js\n+++ rebuilt/lib/schema/array.js\n@@ -1,23 +1,34 @@\n+'use strict';\n+\n /*!\n  * Module dependencies.\n  */\n \n-var SchemaType = require('../schematype')\n-  , CastError = SchemaType.CastError\n-  , NumberSchema = require('./number')\n-  , Types = {\n-        Boolean: require('./boolean')\n-      , Date: require('./date')\n-      , Number: require('./number')\n-      , String: require('./string')\n-      , ObjectId: require('./objectid')\n-      , Buffer: require('./buffer')\n-    }\n-  , MongooseArray = require('../types').Array\n-  , EmbeddedDoc = require('../types').Embedded\n-  , Mixed = require('./mixed')\n-  , Query = require('../query')\n-  , isMongooseObject = require('../utils').isMongooseObject\n+const $exists = require('./operators/exists');\n+const $type = require('./operators/type');\n+const MongooseError = require('../error/mongooseError');\n+const SchemaArrayOptions = require('../options/schemaArrayOptions');\n+const SchemaType = require('../schemaType');\n+const CastError = SchemaType.CastError;\n+const Mixed = require('./mixed');\n+const VirtualOptions = require('../options/virtualOptions');\n+const VirtualType = require('../virtualType');\n+const arrayDepth = require('../helpers/arrayDepth');\n+const cast = require('../cast');\n+const clone = require('../helpers/clone');\n+const getConstructorName = require('../helpers/getConstructorName');\n+const isOperator = require('../helpers/query/isOperator');\n+const util = require('util');\n+const utils = require('../utils');\n+const castToNumber = require('./operators/helpers').castToNumber;\n+const createJSONSchemaTypeDefinition = require('../helpers/createJSONSchemaTypeDefinition');\n+const geospatial = require('./operators/geospatial');\n+const getDiscriminatorByValue = require('../helpers/discriminator/getDiscriminatorByValue');\n+\n+let MongooseArray;\n+let EmbeddedDoc;\n+\n+const emptyOpts = Object.freeze({});\n \n /**\n  * Array SchemaType constructor\n@@ -25,73 +36,244 @@\n  * @param {String} key\n  * @param {SchemaType} cast\n  * @param {Object} options\n+ * @param {Object} schemaOptions\n+ * @param {Schema} parentSchema\n  * @inherits SchemaType\n- * @api private\n+ * @api public\n  */\n \n-function SchemaArray (key, cast, options) {\n+function SchemaArray(key, cast, options, schemaOptions, parentSchema) {\n+  // lazy load\n+  EmbeddedDoc || (EmbeddedDoc = require('../types').Embedded);\n+\n+  let typeKey = 'type';\n+  if (schemaOptions?.typeKey) {\n+    typeKey = schemaOptions.typeKey;\n+  }\n+  this.schemaOptions = schemaOptions;\n+\n   if (cast) {\n-    var castOptions = {};\n+    let castOptions = {};\n \n-    if ('Object' === cast.constructor.name) {\n-      if (cast.type) {\n+    if (utils.isPOJO(cast)) {\n+      if (cast[typeKey]) {\n         // support { type: Woot }\n-        castOptions = cast;\n-        cast = cast.type;\n-        delete castOptions.type;\n+        castOptions = clone(cast); // do not alter user arguments\n+        delete castOptions[typeKey];\n+        cast = cast[typeKey];\n       } else {\n         cast = Mixed;\n       }\n     }\n \n+    if (options?.ref != null && castOptions.ref == null) {\n+      castOptions.ref = options.ref;\n+    }\n+\n+    if (cast === Object) {\n",
					"match": false,
					"packageHash": "6af819c213c7ba232f58fb1503f7c16ac9854426b3ec74ce692ed0c2fe4cf9a1",
					"size": 7514,
					"sourceHash": "ad03152f0f97fa91ae04c9264507771198c2d9bf42de6b30cbe7fb69edb98b5e",
					"status": "content"
				},
				"lib/schema/boolean.js": {
					"diff": "--- published/lib/schema/boolean.js\n+++ rebuilt/lib/schema/boolean.js\n@@ -1,66 +1,258 @@\n+'use strict';\n+\n /*!\n  * Module dependencies.\n  */\n \n-var SchemaType = require('../schematype');\n+const CastError = require('../error/cast');\n+const SchemaType = require('../schemaType');\n+const castBoolean = require('../cast/boolean');\n+const createJSONSchemaTypeDefinition = require('../helpers/createJSONSchemaTypeDefinition');\n \n /**\n  * Boolean SchemaType constructor.\n  *\n  * @param {String} path\n  * @param {Object} options\n+ * @param {Object} schemaOptions\n+ * @param {Schema} parentSchema\n  * @inherits SchemaType\n- * @api private\n+ * @api public\n  */\n \n-function SchemaBoolean (path, options) {\n-  SchemaType.call(this, path, options);\n-};\n+function SchemaBoolean(path, options, _schemaOptions, parentSchema) {\n+  SchemaType.call(this, path, options, 'Boolean', parentSchema);\n+}\n+\n+/**\n+ * This schema type's name, to defend against minifiers that mangle\n+ * function names.\n+ *\n+ * @api public\n+ */\n+SchemaBoolean.schemaName = 'Boolean';\n+\n+SchemaBoolean.defaultOptions = {};\n \n /*!\n  * Inherits from SchemaType.\n  */\n-SchemaBoolean.prototype.__proto__ = SchemaType.prototype;\n+SchemaBoolean.prototype = Object.create(SchemaType.prototype);\n+SchemaBoolean.prototype.constructor = SchemaBoolean;\n+\n+/*!\n+ * ignore\n+ */\n+\n+SchemaBoolean._cast = castBoolean;\n+\n+/**\n+ * Sets a default option for all Boolean instances.\n+ *\n+ * #### Example:\n+ *\n+ *     // Make all booleans have `default` of false.\n+ *     mongoose.Schema.Boolean.set('default', false);\n+ *\n+ *     const Order = mongoose.model('Order', new Schema({ isPaid: Boolean }));\n+ *     new Order({ }).isPaid; // false\n+ *\n+ * @param {String} option The option you'd like to set the value for\n+ * @param {Any} value value for option\n+ * @return {undefined}\n+ * @function set\n+ * @static\n+ * @api public\n+ */\n+\n+SchemaBoolean.set = SchemaType.set;\n+\n+SchemaBoolean.setters = [];\n \n /**\n- * Required validator\n+ * Attaches a getter for all Boolean instances\n  *\n- * @api private\n+ * #### Example:\n+ *\n+ *     mongoose.Schema.Boolean.get(v => v === true ? 'yes' : 'no');\n+ *\n+ *     const Order = mongoose.model('Order', new Schema({ isPaid: Boolean }));\n+ *     new Order({ isPaid: false }).isPaid; // 'no'\n+ *\n+ * @param {Function} getter\n+ * @return {this}\n+ * @function get\n+ * @static\n+ * @api public\n  */\n \n-SchemaBoolean.prototype.checkRequired = function (value) {\n",
					"match": false,
					"packageHash": "3fc3de798c3b415778372ed14f3165df00da8c66ec155767d122b9670293cb92",
					"size": 1530,
					"sourceHash": "c923b937fcfca7201a6a61749118d37a8047b3041e448ad2bc3b313fe3f65c54",
					"status": "content"
				},
				"lib/schema/buffer.js": {
					"diff": "--- published/lib/schema/buffer.js\n+++ rebuilt/lib/schema/buffer.js\n@@ -2,45 +2,136 @@\n  * Module dependencies.\n  */\n \n-var SchemaType = require('../schematype')\n-  , CastError = SchemaType.CastError\n-  , MongooseBuffer = require('../types').Buffer\n-  , Binary = MongooseBuffer.Binary\n-  , Query = require('../query')\n-  , utils = require('../utils')\n-  , Document\n+'use strict';\n+\n+const MongooseBuffer = require('../types/buffer');\n+const SchemaBufferOptions = require('../options/schemaBufferOptions');\n+const SchemaType = require('../schemaType');\n+const createJSONSchemaTypeDefinition = require('../helpers/createJSONSchemaTypeDefinition');\n+const handleBitwiseOperator = require('./operators/bitwise');\n+const utils = require('../utils');\n+\n+const Binary = MongooseBuffer.Binary;\n+const CastError = SchemaType.CastError;\n \n /**\n  * Buffer SchemaType constructor\n  *\n  * @param {String} key\n- * @param {SchemaType} cast\n+ * @param {Object} options\n+ * @param {Object} schemaOptions\n+ * @param {Schema} parentSchema\n  * @inherits SchemaType\n- * @api private\n+ * @api public\n  */\n \n-function SchemaBuffer (key, options) {\n-  SchemaType.call(this, key, options, 'Buffer');\n-};\n+function SchemaBuffer(key, options, _schemaOptions, parentSchema) {\n+  SchemaType.call(this, key, options, 'Buffer', parentSchema);\n+}\n+\n+/**\n+ * This schema type's name, to defend against minifiers that mangle\n+ * function names.\n+ *\n+ * @api public\n+ */\n+SchemaBuffer.schemaName = 'Buffer';\n+\n+SchemaBuffer.defaultOptions = {};\n \n /*!\n  * Inherits from SchemaType.\n  */\n+SchemaBuffer.prototype = Object.create(SchemaType.prototype);\n+SchemaBuffer.prototype.constructor = SchemaBuffer;\n+SchemaBuffer.prototype.OptionsConstructor = SchemaBufferOptions;\n \n-SchemaBuffer.prototype.__proto__ = SchemaType.prototype;\n+/*!\n+ * ignore\n+ */\n+\n+SchemaBuffer._checkRequired = v => !!v?.length;\n \n /**\n- * Check required\n+ * Sets a default option for all Buffer instances.\n  *\n- * @api private\n+ * #### Example:\n+ *\n+ *     // Make all buffers have `required` of true by default.\n+ *     mongoose.Schema.Buffer.set('required', true);\n+ *\n+ *     const User = mongoose.model('User', new Schema({ test: Buffer }));\n+ *     new User({ }).validateSync().errors.test.message; // Path `test` is required.\n+ *\n+ * @param {String} option The option you'd like to set the value for\n+ * @param {Any} value value for option\n+ * @return {undefined}\n+ * @function set\n+ * @static\n+ * @api public\n  */\n \n-SchemaBuffer.prototype.checkRequired = function (value, doc) {\n+SchemaBuffer.set = SchemaType.set;\n+\n+SchemaBuffer.setters = [];\n+\n+/**\n+ * Attaches a getter for all Buffer instances\n+ *\n+ * #### Example:\n+ *\n",
					"match": false,
					"packageHash": "385c4cde0bfd75fe7b694419553a29fd27e11465b5fdb37e87e15b5b17640f0e",
					"size": 3441,
					"sourceHash": "eaec78e15ecb2b3aef4fbd18e4b85890186ecbb4d1b2c520e47a6987019ca38e",
					"status": "content"
				},
				"lib/schema/date.js": {
					"diff": "--- published/lib/schema/date.js\n+++ rebuilt/lib/schema/date.js\n@@ -2,43 +2,159 @@\n  * Module requirements.\n  */\n \n-var SchemaType = require('../schematype');\n-var CastError = SchemaType.CastError;\n-var utils = require('../utils');\n+'use strict';\n+\n+const MongooseError = require('../error/index');\n+const SchemaDateOptions = require('../options/schemaDateOptions');\n+const SchemaType = require('../schemaType');\n+const castDate = require('../cast/date');\n+const createJSONSchemaTypeDefinition = require('../helpers/createJSONSchemaTypeDefinition');\n+const getConstructorName = require('../helpers/getConstructorName');\n+const utils = require('../utils');\n+\n+const CastError = SchemaType.CastError;\n \n /**\n  * Date SchemaType constructor.\n  *\n  * @param {String} key\n  * @param {Object} options\n+ * @param {Object} schemaOptions\n+ * @param {Schema} parentSchema\n  * @inherits SchemaType\n- * @api private\n+ * @api public\n  */\n \n-function SchemaDate (key, options) {\n-  SchemaType.call(this, key, options);\n-};\n+function SchemaDate(key, options, _schemaOptions, parentSchema) {\n+  SchemaType.call(this, key, options, 'Date', parentSchema);\n+}\n+\n+/**\n+ * This schema type's name, to defend against minifiers that mangle\n+ * function names.\n+ *\n+ * @api public\n+ */\n+SchemaDate.schemaName = 'Date';\n+\n+SchemaDate.defaultOptions = {};\n \n /*!\n  * Inherits from SchemaType.\n  */\n+SchemaDate.prototype = Object.create(SchemaType.prototype);\n+SchemaDate.prototype.constructor = SchemaDate;\n+SchemaDate.prototype.OptionsConstructor = SchemaDateOptions;\n+\n+/*!\n+ * ignore\n+ */\n+\n+SchemaDate._cast = castDate;\n+\n+/**\n+ * Sets a default option for all Date instances.\n+ *\n+ * #### Example:\n+ *\n+ *     // Make all dates have `required` of true by default.\n+ *     mongoose.Schema.Date.set('required', true);\n+ *\n+ *     const User = mongoose.model('User', new Schema({ test: Date }));\n+ *     new User({ }).validateSync().errors.test.message; // Path `test` is required.\n+ *\n+ * @param {String} option The option you'd like to set the value for\n+ * @param {Any} value value for option\n+ * @return {undefined}\n+ * @function set\n+ * @static\n+ * @api public\n+ */\n+\n+SchemaDate.set = SchemaType.set;\n+\n+SchemaDate.setters = [];\n+\n+/**\n+ * Attaches a getter for all Date instances\n+ *\n+ * #### Example:\n+ *\n+ *     // Always convert Dates to string\n+ *     mongoose.Date.get(v => v.toString());\n+ *\n+ *     const Model = mongoose.model('Test', new Schema({ date: { type: Date, default: () => new Date() } }));\n+ *     typeof (new Model({}).date); // 'string'\n+ *\n+ * @param {Function} getter\n+ * @return {this}\n+ * @function get\n",
					"match": false,
					"packageHash": "8515c6951087fbfa1bf6129935dc7bf635c0b9fe7aa3c8abaae385f30a1fa994",
					"size": 3332,
					"sourceHash": "1bffe2a1868e648c7b5c28da2b51d362e9d6d441f8dc85e2a240018995323e3c",
					"status": "content"
				},
				"lib/schema/documentarray.js": {
					"match": false,
					"packageHash": "fd123370b83e86bddfb92d9c1bcc96742eb63d584a19ad791bc0f7da4e342d75",
					"size": 4481,
					"status": "missing-in-source"
				},
				"lib/schema/index.js": {
					"diff": "--- published/lib/schema/index.js\n+++ rebuilt/lib/schema/index.js\n@@ -3,26 +3,29 @@\n  * Module exports.\n  */\n \n-exports.String = require('./string');\n-\n-exports.Number = require('./number');\n-\n-exports.Boolean = require('./boolean');\n-\n-exports.DocumentArray = require('./documentarray');\n+'use strict';\n \n exports.Array = require('./array');\n-\n+exports.BigInt = require('./bigint');\n+exports.Boolean = require('./boolean');\n exports.Buffer = require('./buffer');\n-\n exports.Date = require('./date');\n-\n-exports.ObjectId = require('./objectid');\n-\n+exports.Decimal128 = exports.Decimal = require('./decimal128');\n+exports.DocumentArray = require('./documentArray');\n+exports.Double = require('./double');\n+exports.Int32 = require('./int32');\n+exports.Map = require('./map');\n exports.Mixed = require('./mixed');\n+exports.Number = require('./number');\n+exports.ObjectId = require('./objectId');\n+exports.String = require('./string');\n+exports.Subdocument = require('./subdocument');\n+exports.UUID = require('./uuid');\n+exports.Union = require('./union');\n \n // alias\n \n exports.Oid = exports.ObjectId;\n exports.Object = exports.Mixed;\n exports.Bool = exports.Boolean;\n+exports.ObjectID = exports.ObjectId;\n",
					"match": false,
					"packageHash": "86848123ef33d78c9c7d0e902c422ce81a580133a5348629c6703294a647498f",
					"size": 498,
					"sourceHash": "68cbcac3c023b0c197facb0f6da86bc55f33f669adb2fd8864588196f7071c05",
					"status": "content"
				},
				"lib/schema/mixed.js": {
					"diff": "--- published/lib/schema/mixed.js\n+++ rebuilt/lib/schema/mixed.js\n@@ -1,54 +1,102 @@\n-\n /*!\n  * Module dependencies.\n  */\n \n-var SchemaType = require('../schematype');\n-var utils = require('../utils');\n+'use strict';\n+\n+const SchemaType = require('../schemaType');\n+const symbols = require('./symbols');\n+const isObject = require('../helpers/isObject');\n+const utils = require('../utils');\n \n /**\n  * Mixed SchemaType constructor.\n  *\n  * @param {String} path\n  * @param {Object} options\n+ * @param {Object} _schemaOptions\n+ * @param {Schema} parentSchema\n  * @inherits SchemaType\n- * @api private\n+ * @api public\n  */\n \n-function Mixed (path, options) {\n-  if (options && options.default) {\n-    var def = options.default;\n-    if (Array.isArray(def) && 0 === def.length) {\n+function SchemaMixed(path, options, _schemaOptions, parentSchema) {\n+  if (options?.default) {\n+    const def = options.default;\n+    if (Array.isArray(def) && def.length === 0) {\n       // make sure empty array defaults are handled\n       options.default = Array;\n-    } else if (!options.shared &&\n-               utils.isObject(def) &&\n-               0 === Object.keys(def).length) {\n+    } else if (!options.shared && isObject(def) && utils.hasOwnKeys(def) === false) {\n       // prevent odd \"shared\" objects between documents\n-      options.default = function () {\n-        return {}\n-      }\n+      options.default = function() {\n+        return {};\n+      };\n     }\n   }\n \n-  SchemaType.call(this, path, options);\n-};\n+  SchemaType.call(this, path, options, 'Mixed', parentSchema);\n+\n+  this[symbols.schemaMixedSymbol] = true;\n+}\n+\n+/**\n+ * This schema type's name, to defend against minifiers that mangle\n+ * function names.\n+ *\n+ * @api public\n+ */\n+SchemaMixed.schemaName = 'Mixed';\n+\n+SchemaMixed.defaultOptions = {};\n \n /*!\n  * Inherits from SchemaType.\n  */\n+SchemaMixed.prototype = Object.create(SchemaType.prototype);\n+SchemaMixed.prototype.constructor = SchemaMixed;\n \n-Mixed.prototype.__proto__ = SchemaType.prototype;\n+/**\n+ * Attaches a getter for all Mixed paths.\n+ *\n+ * #### Example:\n+ *\n+ *     // Hide the 'hidden' path\n+ *     mongoose.Schema.Mixed.get(v => Object.assign({}, v, { hidden: null }));\n+ *\n+ *     const Model = mongoose.model('Test', new Schema({ test: {} }));\n+ *     new Model({ test: { hidden: 'Secret!' } }).test.hidden; // null\n+ *\n+ * @param {Function} getter\n+ * @return {this}\n+ * @function get\n+ * @static\n+ * @api public\n+ */\n+\n+SchemaMixed.get = SchemaType.get;\n \n /**\n- * Required validator\n+ * Sets a default option for all Mixed instances.\n",
					"match": false,
					"packageHash": "3e60e8319c327d42cd8f70eab91e03d341d53a16038197e81a492bc9c92bbc32",
					"size": 1426,
					"sourceHash": "8db2bb66fd73888874c3cec8be5861b692d5c8dc003913374dcfbe134b3c67ae",
					"status": "content"
				},
				"lib/schema/number.js": {
					"diff": "--- published/lib/schema/number.js\n+++ rebuilt/lib/schema/number.js\n@@ -1,190 +1,466 @@\n+'use strict';\n+\n /*!\n  * Module requirements.\n  */\n \n-var SchemaType = require('../schematype')\n-  , CastError = SchemaType.CastError\n-  , utils = require('../utils')\n-  , Document\n+const MongooseError = require('../error/index');\n+const SchemaNumberOptions = require('../options/schemaNumberOptions');\n+const SchemaType = require('../schemaType');\n+const castNumber = require('../cast/number');\n+const createJSONSchemaTypeDefinition = require('../helpers/createJSONSchemaTypeDefinition');\n+const handleBitwiseOperator = require('./operators/bitwise');\n+const utils = require('../utils');\n+\n+const CastError = SchemaType.CastError;\n \n /**\n  * Number SchemaType constructor.\n  *\n  * @param {String} key\n  * @param {Object} options\n+ * @param {Object} schemaOptions\n+ * @param {Schema} parentSchema\n  * @inherits SchemaType\n- * @api private\n+ * @api public\n+ */\n+\n+function SchemaNumber(key, options, _schemaOptions, parentSchema) {\n+  this.enumValues = [];\n+  SchemaType.call(this, key, options, 'Number', parentSchema);\n+}\n+\n+/**\n+ * Attaches a getter for all Number instances.\n+ *\n+ * #### Example:\n+ *\n+ *     // Make all numbers round down\n+ *     mongoose.Number.get(function(v) { return Math.floor(v); });\n+ *\n+ *     const Model = mongoose.model('Test', new Schema({ test: Number }));\n+ *     new Model({ test: 3.14 }).test; // 3\n+ *\n+ * @param {Function} getter\n+ * @return {this}\n+ * @function get\n+ * @static\n+ * @api public\n+ */\n+\n+SchemaNumber.get = SchemaType.get;\n+\n+/**\n+ * Sets a default option for all Number instances.\n+ *\n+ * #### Example:\n+ *\n+ *     // Make all numbers have option `min` equal to 0.\n+ *     mongoose.Schema.Number.set('min', 0);\n+ *\n+ *     const Order = mongoose.model('Order', new Schema({ amount: Number }));\n+ *     new Order({ amount: -10 }).validateSync().errors.amount.message; // Path `amount` must be larger than 0.\n+ *\n+ * @param {String} option The option you'd like to set the value for\n+ * @param {Any} value value for option\n+ * @return {undefined}\n+ * @function set\n+ * @static\n+ * @api public\n+ */\n+\n+SchemaNumber.set = SchemaType.set;\n+\n+SchemaNumber.setters = [];\n+\n+/*!\n+ * ignore\n+ */\n+\n+SchemaNumber._cast = castNumber;\n+\n+/**\n+ * Get/set the function used to cast arbitrary values to numbers.\n+ *\n+ * #### Example:\n+ *\n+ *     // Make Mongoose cast empty strings '' to 0 for paths declared as numbers\n+ *     const original = mongoose.Number.cast();\n+ *     mongoose.Number.cast(v => {\n+ *       if (v === '') { return 0; }\n+ *       return original(v);\n+ *     });\n",
					"match": false,
					"packageHash": "a32bfadec915a044f52bbb6a7c07648d2934033af70b2648f3b8efcbea90197b",
					"size": 4781,
					"sourceHash": "8eff8c42e00fe67816006f73958b5ad0147842275dec1c2864785bcfa892e34f",
					"status": "content"
				},
				"lib/schema/objectid.js": {
					"match": false,
					"packageHash": "1e7701a4befe8c1adc1daf301326e51b0a37de99a1f48d9f58a0122f747a56df",
					"size": 3596,
					"status": "missing-in-source"
				},
				"lib/schema/string.js": {
					"diff": "--- published/lib/schema/string.js\n+++ rebuilt/lib/schema/string.js\n@@ -1,190 +1,586 @@\n+'use strict';\n \n /*!\n  * Module dependencies.\n  */\n \n-var SchemaType = require('../schematype')\n-  , CastError = SchemaType.CastError\n-  , utils = require('../utils')\n-  , Document\n+const SchemaType = require('../schemaType');\n+const MongooseError = require('../error/index');\n+const SchemaStringOptions = require('../options/schemaStringOptions');\n+const castString = require('../cast/string');\n+const createJSONSchemaTypeDefinition = require('../helpers/createJSONSchemaTypeDefinition');\n+const utils = require('../utils');\n+const isBsonType = require('../helpers/isBsonType');\n+\n+const CastError = SchemaType.CastError;\n \n /**\n  * String SchemaType constructor.\n  *\n  * @param {String} key\n  * @param {Object} options\n+ * @param {Object} schemaOptions\n+ * @param {Schema} parentSchema\n  * @inherits SchemaType\n- * @api private\n+ * @api public\n  */\n \n-function SchemaString (key, options) {\n+function SchemaString(key, options, _schemaOptions, parentSchema) {\n   this.enumValues = [];\n   this.regExp = null;\n-  SchemaType.call(this, key, options, 'String');\n-};\n+  SchemaType.call(this, key, options, 'String', parentSchema);\n+}\n+\n+/**\n+ * This schema type's name, to defend against minifiers that mangle\n+ * function names.\n+ *\n+ * @api public\n+ */\n+SchemaString.schemaName = 'String';\n+\n+SchemaString.defaultOptions = {};\n \n /*!\n  * Inherits from SchemaType.\n  */\n+SchemaString.prototype = Object.create(SchemaType.prototype);\n+SchemaString.prototype.constructor = SchemaString;\n+Object.defineProperty(SchemaString.prototype, 'OptionsConstructor', {\n+  configurable: false,\n+  enumerable: false,\n+  writable: false,\n+  value: SchemaStringOptions\n+});\n \n-SchemaString.prototype.__proto__ = SchemaType.prototype;\n+/*!\n+ * ignore\n+ */\n+\n+SchemaString._cast = castString;\n \n /**\n- * Adds enumeration values and a coinciding validator.\n+ * Get/set the function used to cast arbitrary values to strings.\n  *\n- * ####Example:\n+ * #### Example:\n  *\n- *     var states = 'opening open closing closed'.split(' ')\n- *     var s = new Schema({ state: { type: String, enum: states })\n- *     var M = db.model('M', s)\n- *     var m = new M({ state: 'invalid' })\n- *     m.save(function (err) {\n- *       console.error(err) // validator error\n- *       m.state = 'open'\n- *       m.save() // success\n- *     })\n+ *     // Throw an error if you pass in an object. Normally, Mongoose allows\n+ *     // objects with custom `toString()` functions.\n+ *     const original = mongoose.Schema.Types.String.cast();\n+ *     mongoose.Schema.Types.String.cast(v => {\n+ *       assert.ok(v == null || typeof v !== 'object');\n+ *       return original(v);\n+ *     });\n+ *\n+ *     // Or disable casting entirely\n+ *     mongoose.Schema.Types.String.cast(false);\n+ *\n",
					"match": false,
					"packageHash": "5630e693e3c865b2da75fd3a9f704d959c51e292bb4ced3983ab838be4f90205",
					"size": 6647,
					"sourceHash": "d25e6cd4bc60e4db07c62f84925ab7c1602a4f87f53d94373d1f6e1dee00a502",
					"status": "content"
				},
				"lib/schema.js": {
					"diff": "--- published/lib/schema.js\n+++ rebuilt/lib/schema.js\n@@ -1,120 +1,355 @@\n+'use strict';\n+\n /*!\n  * Module dependencies.\n  */\n \n-var EventEmitter = require('events').EventEmitter\n-  , VirtualType = require('./virtualtype')\n-  , utils = require('./utils')\n-  , NamedScope\n-  , Query\n-  , Types\n+const EventEmitter = require('events').EventEmitter;\n+const Kareem = require('kareem');\n+const MongooseError = require('./error/mongooseError');\n+const SchemaType = require('./schemaType');\n+const SchemaTypeOptions = require('./options/schemaTypeOptions');\n+const VirtualOptions = require('./options/virtualOptions');\n+const VirtualType = require('./virtualType');\n+const addAutoId = require('./helpers/schema/addAutoId');\n+const clone = require('./helpers/clone');\n+const get = require('./helpers/get');\n+const getConstructorName = require('./helpers/getConstructorName');\n+const getIndexes = require('./helpers/schema/getIndexes');\n+const handleReadPreferenceAliases = require('./helpers/query/handleReadPreferenceAliases');\n+const idGetter = require('./helpers/schema/idGetter');\n+const isIndexSpecEqual = require('./helpers/indexes/isIndexSpecEqual');\n+const merge = require('./helpers/schema/merge');\n+const mpath = require('mpath');\n+const setPopulatedVirtualValue = require('./helpers/populate/setPopulatedVirtualValue');\n+const setupTimestamps = require('./helpers/timestamps/setupTimestamps');\n+const symbols = require('./schema/symbols');\n+const utils = require('./utils');\n+const validateRef = require('./helpers/populate/validateRef');\n+\n+const hasNumericSubpathRegex = /\\.\\d+(\\.|$)/;\n+\n+let MongooseTypes;\n+\n+const queryHooks = require('./constants').queryMiddlewareFunctions;\n+const documentHooks = require('./constants').documentMiddlewareFunctions;\n+const hookNames = queryHooks.concat(documentHooks).\n+  reduce((s, hook) => s.add(hook), new Set());\n+\n+const isPOJO = utils.isPOJO;\n+\n+let id = 0;\n+\n+const numberRE = /^\\d+$/;\n \n /**\n  * Schema constructor.\n  *\n- * ####Example:\n+ * #### Example:\n  *\n- *     var child = new Schema({ name: String });\n- *     var schema = new Schema({ name: String, age: Number, children: [child] });\n- *     var Tree = mongoose.model('Tree', schema);\n+ *     const child = new Schema({ name: String });\n+ *     const schema = new Schema({ name: String, age: Number, children: [child] });\n+ *     const Tree = mongoose.model('Tree', schema);\n  *\n  *     // setting schema options\n- *     new Schema({ name: String }, { _id: false, autoIndex: false })\n+ *     new Schema({ name: String }, { id: false, autoIndex: false })\n  *\n- * ####Options:\n+ * #### Options:\n  *\n- * - [autoIndex](/docs/guide.html#autoIndex): bool - defaults to true\n- * - [bufferCommands](/docs/guide.html#bufferCommands): bool - defaults to true\n- * - [capped](/docs/guide.html#capped): bool - defaults to false\n- * - [collection](/docs/guide.html#collection): string - no default\n- * - [id](/docs/guide.html#id): bool - defaults to true\n- * - [_id](/docs/guide.html#_id): bool - defaults to true\n- * - `minimize`: bool - controls [document#toObject](#document_Document-toObject) behavior when called manually - defaults to true\n- * - [read](/docs/guide.html#read): string\n- * - [safe](/docs/guide.html#safe): bool - defaults to true.\n- * - [shardKey](/docs/guide.html#shardKey): bool - defaults to `null`\n- * - [strict](/docs/guide.html#strict): bool - defaults to true\n- * - [toJSON](/docs/guide.html#toJSON) - object - no default\n- * - [toObject](/docs/guide.html#toObject) - object - no default\n- * - [versionKey](/docs/guide.html#versionKey): bool - defaults to \"__v\"\n+ * - [autoIndex](https://mongoosejs.com/docs/guide.html#autoIndex): bool - defaults to null (which means use the connection's autoIndex option)\n+ * - [autoCreate](https://mongoosejs.com/docs/guide.html#autoCreate): bool - defaults to null (which means use the connection's autoCreate option)\n+ * - [bufferCommands](https://mongoosejs.com/docs/guide.html#bufferCommands): bool - defaults to true\n+ * - [bufferTimeoutMS](https://mongoosejs.com/docs/guide.html#bufferTimeoutMS): number - defaults to 10000 (10 seconds). If `bufferCommands` is enabled, the amount of time Mongoose will wait for connectivity to be restablished before erroring out.\n+ * - [capped](https://mongoosejs.com/docs/guide.html#capped): bool | number | object - defaults to false\n+ * - [collection](https://mongoosejs.com/docs/guide.html#collection): string - no default\n+ * - [discriminatorKey](https://mongoosejs.com/docs/guide.html#discriminatorKey): string - defaults to `__t`\n+ * - [id](https://mongoosejs.com/docs/guide.html#id): bool - defaults to true\n+ * - [_id](https://mongoosejs.com/docs/guide.html#_id): bool - defaults to true\n+ * - [minimize](https://mongoosejs.com/docs/guide.html#minimize): bool - controls [document#toObject](https://mongoosejs.com/docs/api/document.html#Document.prototype.toObject()) behavior when called manually - defaults to true\n+ * - [read](https://mongoosejs.com/docs/guide.html#read): string\n+ * - [readConcern](https://mongoosejs.com/docs/guide.html#readConcern): object - defaults to null, use to set a default [read concern](https://www.mongodb.com/docs/manual/reference/read-concern/) for all queries.\n+ * - [writeConcern](https://mongoosejs.com/docs/guide.html#writeConcern): object - defaults to null, use to override [the MongoDB server's default write concern settings](https://www.mongodb.com/docs/manual/reference/write-concern/)\n",
					"match": false,
					"packageHash": "121f6b227216665352a0bc266ace04618bd16a1645b40dd32bfedd9d2476934f",
					"size": 21282,
					"sourceHash": "71e604b3e1f2511124eccad8912f93663003615415942942aa841e972cb40220",
					"status": "content"
				},
				"lib/schemadefault.js": {
					"match": false,
					"packageHash": "fc63d106d99cbc5645158c88832dba0134ad0e507fc52598bb4a67192a44a42e",
					"size": 662,
					"status": "missing-in-source"
				},
				"lib/schematype.js": {
					"match": false,
					"packageHash": "6875a779a039c47b111ff5a104cca92473765699d863a61d4e175819f1d30ff0",
					"size": 18460,
					"status": "missing-in-source"
				},
				"lib/statemachine.js": {
					"match": false,
					"packageHash": "3600492c5c117b4b3e22023b3ee2b31c9a38de0fec58459b5c23594c09c30ce2",
					"size": 4390,
					"status": "missing-in-source"
				},
				"lib/types/array.js": {
					"match": false,
					"packageHash": "68f9f4033b32bd818256c9a5ffdd04bcb91bcc5c2756883b759a0693a90a0c71",
					"size": 17509,
					"status": "missing-in-source"
				},
				"lib/types/buffer.js": {
					"diff": "--- published/lib/types/buffer.js\n+++ rebuilt/lib/types/buffer.js\n@@ -1,15 +1,12 @@\n-\n-/*!\n- * Access driver.\n- */\n-\n-var driver = global.MONGOOSE_DRIVER_PATH || '../drivers/node-mongodb-native';\n-\n /*!\n  * Module dependencies.\n  */\n \n-var Binary = require(driver + '/binary');\n+'use strict';\n+\n+const Binary = require('mongodb/lib/bson').Binary;\n+const UUID = require('mongodb/lib/bson').UUID;\n+const utils = require('../utils');\n \n /**\n  * Mongoose Buffer constructor.\n@@ -20,23 +17,19 @@\n  * @param {String} encode\n  * @param {Number} offset\n  * @api private\n- * @inherits Buffer\n- * @see http://bit.ly/f6CnZU\n+ * @inherits Buffer https://nodejs.org/api/buffer.html\n+ * @see https://bit.ly/f6CnZU\n  */\n \n-function MongooseBuffer (value, encode, offset) {\n-  var length = arguments.length;\n-  var val;\n-\n-  if (0 === length || null === arguments[0] || undefined === arguments[0]) {\n+function MongooseBuffer(value, encode, offset) {\n+  let val = value;\n+  if (value == null) {\n     val = 0;\n-  } else {\n-    val = value;\n   }\n \n-  var encoding;\n-  var path;\n-  var doc;\n+  let encoding;\n+  let path;\n+  let doc;\n \n   if (Array.isArray(encode)) {\n     // internal casting\n@@ -46,136 +39,189 @@\n     encoding = encode;\n   }\n \n-  var buf = new Buffer(val, encoding, offset);\n-  buf.__proto__ = MongooseBuffer.prototype;\n+  let buf;\n+  if (typeof val === 'number' || val instanceof Number) {\n+    buf = Buffer.alloc(val);\n+  } else { // string, array or object { type: 'Buffer', data: [...] }\n+    buf = Buffer.from(val, encoding, offset);\n+  }\n+  utils.decorate(buf, MongooseBuffer.mixin);\n+  buf.isMongooseBuffer = true;\n \n   // make sure these internal props don't show up in Object.keys()\n-  Object.defineProperties(buf, {\n-      validators: { value: [] }\n-    , _path: { value: path }\n-    , _parent: { value: doc }\n-  });\n-\n-  if (doc && \"string\" === typeof path) {\n-    Object.defineProperty(buf, '_schema', {\n-        value: doc.schema.path(path)\n-    });\n-  }\n+  buf[MongooseBuffer.pathSymbol] = path;\n+  buf[parentSymbol] = doc;\n \n+  buf._subtype = 0;\n   return buf;\n-};\n+}\n+\n+const pathSymbol = Symbol.for('mongoose#Buffer#_path');\n+const parentSymbol = Symbol.for('mongoose#Buffer#_parent');\n+MongooseBuffer.pathSymbol = pathSymbol;\n \n /*!\n  * Inherit from Buffer.\n  */\n \n-MongooseBuffer.prototype = new Buffer(0);\n-\n",
					"match": false,
					"packageHash": "f0a142f2278a047391186b1d148e47d06168de12d184a7b6e20543e4d12ca63b",
					"size": 4105,
					"sourceHash": "e4d9369da89c1c7d2a16f7e1f5b28ccc304e7465b060b1c7bb6138c66945c86a",
					"status": "content"
				},
				"lib/types/documentarray.js": {
					"match": false,
					"packageHash": "9e056f04d091f6877018a2cd4793626ceb9e327f61a3679ea16c7de3655b2155",
					"size": 3926,
					"status": "missing-in-source"
				},
				"lib/types/embedded.js": {
					"match": false,
					"packageHash": "560ac953ccce025184adca43b3b52acbf0dd5ad6af617a77ad21fe2cde84787e",
					"size": 5134,
					"status": "missing-in-source"
				},
				"lib/types/index.js": {
					"diff": "--- published/lib/types/index.js\n+++ rebuilt/lib/types/index.js\n@@ -3,11 +3,21 @@\n  * Module exports.\n  */\n \n+'use strict';\n+\n exports.Array = require('./array');\n exports.Buffer = require('./buffer');\n \n exports.Document = // @deprecate\n-exports.Embedded = require('./embedded');\n+exports.Embedded = require('./arraySubdocument');\n \n-exports.DocumentArray = require('./documentarray');\n+exports.DocumentArray = require('./documentArray');\n+exports.Double = require('./double');\n+exports.Decimal128 = require('./decimal128');\n exports.ObjectId = require('./objectid');\n+\n+exports.Map = require('./map');\n+\n+exports.Subdocument = require('./subdocument');\n+\n+exports.UUID = require('./uuid');\n",
					"match": false,
					"packageHash": "b0ed6fe390375dfdcc5e9cd923104ddc38b9299116408aea36edcec210216974",
					"size": 274,
					"sourceHash": "e2912bfd55bd79b7b244cf510faee6322f01fe324d05f56c23ef0b868df0d1ad",
					"status": "content"
				},
				"lib/types/objectid.js": {
					"diff": "--- published/lib/types/objectid.js\n+++ rebuilt/lib/types/objectid.js\n@@ -1,43 +1,41 @@\n-\n-/*!\n- * Access driver.\n- */\n-\n-var driver = global.MONGOOSE_DRIVER_PATH || '../drivers/node-mongodb-native';\n-\n /**\n  * ObjectId type constructor\n  *\n- * ####Example\n+ * #### Example:\n  *\n- *     var id = new mongoose.Types.ObjectId;\n+ *     const id = new mongoose.Types.ObjectId;\n  *\n  * @constructor ObjectId\n  */\n \n-var ObjectId = require(driver + '/objectid');\n-module.exports = ObjectId;\n+'use strict';\n+\n+const ObjectId = require('mongodb/lib/bson').ObjectId;\n+const objectIdSymbol = require('../helpers/symbols').objectIdSymbol;\n \n /**\n- * Creates an ObjectId from `str`\n- *\n- * @param {ObjectId|HexString} str\n- * @static fromString\n- * @receiver ObjectId\n- * @return {ObjectId}\n+ * Getter for convenience with populate, see gh-6115\n  * @api private\n  */\n \n-ObjectId.fromString;\n+Object.defineProperty(ObjectId.prototype, '_id', {\n+  enumerable: false,\n+  configurable: true,\n+  get: function() {\n+    return this;\n+  }\n+});\n \n-/**\n- * Converts `oid` to a string.\n- *\n- * @param {ObjectId} oid ObjectId instance\n- * @static toString\n- * @receiver ObjectId\n- * @return {String}\n- * @api private\n+/*!\n+ * Convenience `valueOf()` to allow comparing ObjectIds using double equals re: gh-7299\n  */\n \n-ObjectId.toString;\n+if (!Object.hasOwn(ObjectId.prototype, 'valueOf')) {\n+  ObjectId.prototype.valueOf = function objectIdValueOf() {\n+    return this.toString();\n+  };\n+}\n+\n+ObjectId.prototype[objectIdSymbol] = true;\n+\n+module.exports = ObjectId;\n",
					"match": false,
					"packageHash": "fb63ca1e15b2503806cb5aa5bbb933a2a18af9b89977c0e19fea04065cc3e02a",
					"size": 681,
					"sourceHash": "0ad9bbbfe43f16125f63f78ffb3f21f1712a51ac116dfceea5fd95c86455f39c",
					"status": "content"
				},
				"lib/utils.js": {
					"diff": "--- published/lib/utils.js\n+++ rebuilt/lib/utils.js\n@@ -1,116 +1,66 @@\n+'use strict';\n+\n /*!\n  * Module dependencies.\n  */\n \n-var ReadPref = require('mongodb').ReadPreference\n-  , ObjectId = require('./types/objectid')\n-  , ms = require('ms')\n-  , sliced = require('sliced')\n-  , mpath = require('mpath')\n-  , MongooseBuffer\n-  , MongooseArray\n-  , Document\n+const UUID = require('mongodb/lib/bson').UUID;\n+const ms = require('ms');\n+const mpath = require('mpath');\n+const ObjectId = require('./types/objectid');\n+const PopulateOptions = require('./options/populateOptions');\n+const clone = require('./helpers/clone');\n+const immediate = require('./helpers/immediate');\n+const isObject = require('./helpers/isObject');\n+const isMongooseArray = require('./types/array/isMongooseArray');\n+const isMongooseDocumentArray = require('./types/documentArray/isMongooseDocumentArray');\n+const isBsonType = require('./helpers/isBsonType');\n+const isPOJO = require('./helpers/isPOJO');\n+const getFunctionName = require('./helpers/getFunctionName');\n+const isMongooseObject = require('./helpers/isMongooseObject');\n+const schemaMerge = require('./helpers/schema/merge');\n+const specialProperties = require('./helpers/specialProperties');\n+const { trustedSymbol } = require('./helpers/query/trusted');\n+\n+let Document;\n+\n+exports.specialProperties = specialProperties;\n+\n+exports.isMongooseArray = isMongooseArray.isMongooseArray;\n+exports.isMongooseDocumentArray = isMongooseDocumentArray.isMongooseDocumentArray;\n+exports.registerMongooseArray = isMongooseArray.registerMongooseArray;\n+exports.registerMongooseDocumentArray = isMongooseDocumentArray.registerMongooseDocumentArray;\n+\n+const oneSpaceRE = /\\s/;\n+const manySpaceRE = /\\s+/;\n \n /**\n- * Produces a collection name from model `name`.\n+ * Produces a collection name from model `name`. By default, just returns\n+ * the model name\n  *\n  * @param {String} name a model name\n+ * @param {Function} pluralize function that pluralizes the collection name\n  * @return {String} a collection name\n  * @api private\n  */\n \n-exports.toCollectionName = function (name) {\n-  if ('system.profile' === name) return name;\n-  if ('system.indexes' === name) return name;\n-  return pluralize(name.toLowerCase());\n-};\n-\n-/**\n- * Pluralization rules.\n- *\n- * These rules are applied while processing the argument to `toCollectionName`.\n- *\n- * @deprecated remove in 4.x gh-1350\n- */\n-\n-exports.pluralization = [\n-  [/(m)an$/gi, '$1en'],\n-  [/(pe)rson$/gi, '$1ople'],\n-  [/(child)$/gi, '$1ren'],\n-  [/^(ox)$/gi, '$1en'],\n-  [/(ax|test)is$/gi, '$1es'],\n-  [/(octop|vir)us$/gi, '$1i'],\n-  [/(alias|status)$/gi, '$1es'],\n-  [/(bu)s$/gi, '$1ses'],\n-  [/(buffal|tomat|potat)o$/gi, '$1oes'],\n-  [/([ti])um$/gi, '$1a'],\n-  [/sis$/gi, 'ses'],\n-  [/(?:([^f])fe|([lr])f)$/gi, '$1$2ves'],\n-  [/(hive)$/gi, '$1s'],\n-  [/([^aeiouy]|qu)y$/gi, '$1ies'],\n-  [/(x|ch|ss|sh)$/gi, '$1es'],\n-  [/(matr|vert|ind)ix|ex$/gi, '$1ices'],\n-  [/([m|l])ouse$/gi, '$1ice'],\n-  [/(quiz)$/gi, '$1zes'],\n-  [/s$/gi, 's'],\n-  [/$/gi, 's']\n-];\n-var rules = exports.pluralization;\n-\n-/**\n- * Uncountable words.\n- *\n- * These words are applied while processing the argument to `toCollectionName`.\n",
					"match": false,
					"packageHash": "424906619e425b798bd8ad0e738ec567ba5bddab8f168665b7230006823fe49e",
					"size": 13865,
					"sourceHash": "f36e837c2cd4d43c56be70ed3bc5b99c4f410e7ca5051ca6aeb5b785756c82dd",
					"status": "content"
				},
				"lib/virtualtype.js": {
					"match": false,
					"packageHash": "6353d95c5a6177e84806f8c23923a3f2bb8f5061aa9d6bbe202aceb4c75fd882",
					"size": 2037,
					"status": "missing-in-source"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,38 +1,148 @@\n {\n-    \"name\": \"mongoose\"\n-  , \"description\": \"Mongoose MongoDB ODM\"\n-  , \"version\": \"3.6.0rc1\"\n-  , \"author\": \"Guillermo Rauch <guillermo@learnboost.com>\"\n-  , \"keywords\": [\"mongodb\", \"mongoose\", \"orm\", \"data\", \"datastore\", \"nosql\", \"odm\", \"sql\", \"db\", \"database\"]\n-  , \"dependencies\": {\n-        \"hooks\": \"0.2.1\"\n-      , \"mongodb\": \"1.2.13\"\n-      , \"ms\": \"0.1.0\"\n-      , \"sliced\": \"0.0.3\"\n-      , \"muri\": \"0.3.1\"\n-      , \"mpromise\": \"0.2.1\"\n-      , \"mpath\": \"0.1.1\"\n+  \"name\": \"mongoose\",\n+  \"description\": \"Mongoose MongoDB ODM\",\n+  \"version\": \"9.1.1\",\n+  \"author\": \"Guillermo Rauch <guillermo@learnboost.com>\",\n+  \"keywords\": [\n+    \"mongodb\",\n+    \"document\",\n+    \"model\",\n+    \"schema\",\n+    \"database\",\n+    \"odm\",\n+    \"data\",\n+    \"datastore\",\n+    \"query\",\n+    \"nosql\",\n+    \"orm\",\n+    \"db\"\n+  ],\n+  \"type\": \"commonjs\",\n+  \"license\": \"MIT\",\n+  \"dependencies\": {\n+    \"kareem\": \"3.0.0\",\n+    \"mongodb\": \"~7.0\",\n+    \"mpath\": \"0.9.0\",\n+    \"mquery\": \"6.0.0\",\n+    \"ms\": \"2.1.3\",\n+    \"sift\": \"17.1.3\"\n+  },\n+  \"devDependencies\": {\n+    \"@ark/attest\": \"0.55.0\",\n+    \"@mongodb-js/mongodb-downloader\": \"^1.0.0\",\n+    \"acquit\": \"1.4.0\",\n+    \"acquit-ignore\": \"0.2.1\",\n+    \"acquit-require\": \"0.1.1\",\n+    \"ajv\": \"8.17.1\",\n+    \"broken-link-checker\": \"^0.7.8\",\n+    \"cheerio\": \"1.1.2\",\n+    \"dox\": \"1.0.0\",\n+    \"eslint\": \"9.39.1\",\n+    \"eslint-plugin-markdown\": \"^5.1.0\",\n+    \"eslint-plugin-mocha-no-only\": \"1.2.0\",\n+    \"express\": \"^4.19.2\",\n+    \"fs-extra\": \"~11.3.0\",\n+    \"highlight.js\": \"11.11.1\",\n+    \"lodash.isequal\": \"4.5.0\",\n+    \"lodash.isequalwith\": \"4.4.0\",\n+    \"markdownlint-cli2\": \"^0.19.1\",\n+    \"marked\": \"15.x\",\n+    \"mkdirp\": \"^3.0.1\",\n+    \"mocha\": \"11.7.5\",\n+    \"moment\": \"2.30.1\",\n+    \"mongodb-memory-server\": \"11.0.0\",\n+    \"mongodb-runner\": \"^6.0.0\",\n+    \"mongodb-client-encryption\": \"~7.0\",\n+    \"ncp\": \"^2.0.0\",\n+    \"nyc\": \"15.1.0\",\n+    \"pug\": \"3.0.3\",\n+    \"sinon\": \"21.0.0\",\n+    \"tsd\": \"0.33.0\",\n+    \"typescript\": \"5.9.3\",\n+    \"typescript-eslint\": \"^8.31.1\",\n+    \"uuid\": \"11.1.0\"\n+  },\n+  \"directories\": {\n+    \"lib\": \"./lib/mongoose\"\n+  },\n+  \"scripts\": {\n+    \"docs:clean\": \"npm run docs:clean:stable\",\n+    \"docs:clean:stable\": \"rimraf index.html && rimraf -rf ./docs/*.html  && rimraf -rf ./docs/api && rimraf -rf ./docs/tutorials/*.html && rimraf -rf ./docs/typescript/*.html && rimraf -rf ./docs/*.html && rimraf -rf ./docs/source/_docs && rimraf -rf ./tmp\",\n+    \"docs:clean:5x\": \"rimraf index.html && rimraf -rf ./docs/5.x && rimraf -rf ./docs/source/_docs && rimraf -rf ./tmp\",\n+    \"docs:clean:6x\": \"rimraf index.html && rimraf -rf ./docs/6.x && rimraf -rf ./docs/source/_docs && rimraf -rf ./tmp\",\n+    \"docs:copy:tmp\": \"mkdirp ./tmp/docs/css && mkdirp ./tmp/docs/js && mkdirp ./tmp/docs/images && mkdirp ./tmp/docs/tutorials && mkdirp ./tmp/docs/typescript && mkdirp ./tmp/docs/api && ncp ./docs/css ./tmp/docs/css --filter=.css$ && ncp ./docs/js ./tmp/docs/js --filter=.js$ && ncp ./docs/images ./tmp/docs/images && ncp ./docs/tutorials ./tmp/docs/tutorials && ncp ./docs/typescript ./tmp/docs/typescript && ncp ./docs/api ./tmp/docs/api && cp index.html ./tmp && cp docs/*.html ./tmp/docs/\",\n+    \"docs:copy:tmp:5x\": \"rimraf ./docs/5.x && ncp ./tmp ./docs/5.x\",\n+    \"docs:copy:tmp:6x\": \"rimraf ./docs/6.x && ncp ./tmp ./docs/6.x\",\n+    \"docs:generate\": \"node ./scripts/website.js\",\n+    \"docs:generate:sponsorData\": \"node ./scripts/loadSponsorData.js\",\n+    \"docs:test\": \"npm run docs:generate\",\n+    \"docs:view\": \"node ./scripts/static.js\",\n+    \"docs:prepare:publish:stable\": \"git checkout gh-pages && git merge master && npm run docs:generate\",\n+    \"docs:prepare:publish:5x\": \"git checkout 5.x && git merge 5.x && npm run docs:clean:stable && npm run docs:generate && npm run docs:copy:tmp && git checkout gh-pages && npm run docs:copy:tmp:5x\",\n+    \"docs:prepare:publish:6x\": \"git checkout 6.x && git merge 6.x && npm run docs:clean:stable && env DOCS_DEPLOY=true npm run docs:generate && mv ./docs/6.x ./tmp && git checkout gh-pages && npm run docs:copy:tmp:6x\",\n+    \"docs:prepare:publish:7x\": \"env DOCS_DEPLOY=true npm run docs:generate && git checkout gh-pages && rimraf ./docs/7.x && mv ./tmp ./docs/7.x\",\n+    \"docs:prepare:publish:8x\": \"env DOCS_DEPLOY=true npm run docs:generate && git checkout gh-pages && rimraf ./docs/8.x && mv ./tmp ./docs/8.x\",\n",
					"match": false,
					"packageHash": "33d8a60429dc5cb87026d2f6719952afb58cbbde4e533e199054c6684356a4e3",
					"size": 1152,
					"sourceHash": "b45355d59f19fe255810883f3629195acb9894b92d4f1aa1f0c7c75e83bda117",
					"status": "content"
				},
				"static.js": {
					"match": false,
					"packageHash": "b6c20b7409ffb973449d8b8d9d24dc964f296adc52a9bde3f4fb5e95227df919",
					"size": 426,
					"status": "missing-in-source"
				},
				"website.js": {
					"match": false,
					"packageHash": "09dd6c29e01ffd5d7128cb7f3269f52bcf6b7173bc4d0733a41a40b922a5ff61",
					"size": 1682,
					"status": "missing-in-source"
				},
				"LICENSE.md": {
					"match": false,
					"status": "missing-in-package"
				},
				"SECURITY.md": {
					"match": false,
					"status": "missing-in-package"
				},
				"eslint.config.mjs": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/aggregate.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cast/bigint.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cast/boolean.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cast/date.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cast/decimal128.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cast/double.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cast/int32.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cast/number.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cast/objectid.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cast/string.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cast/uuid.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cast.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/connectionState.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cursor/aggregationCursor.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cursor/changeStream.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cursor/queryCursor.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/driver.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/drivers/node-mongodb-native/bulkWriteResult.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/drivers/node-mongodb-native/index.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/browserMissingSchema.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/bulkSaveIncompleteError.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/bulkWriteError.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/cast.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/createCollectionsError.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/divergentArray.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/eachAsyncMultiError.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/index.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/invalidSchemaOption.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/messages.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/missingSchema.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/mongooseError.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/notFound.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/objectExpected.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/objectParameter.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/overwriteModel.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/parallelSave.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/parallelValidate.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/serverSelection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/setOptionError.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/strict.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/strictPopulate.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/syncIndexes.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/validation.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/validator.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/error/version.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/aggregate/prepareDiscriminatorPipeline.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/aggregate/stringifyFunctionOperators.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/arrayDepth.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/clone.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/common.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/createJSONSchemaTypeDefinition.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/cursor/eachAsync.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/discriminator/applyEmbeddedDiscriminators.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/discriminator/areDiscriminatorValuesEqual.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/discriminator/checkEmbeddedDiscriminatorKeyProjection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/discriminator/getConstructor.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/discriminator/getDiscriminatorByValue.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/discriminator/getSchemaDiscriminatorByValue.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/discriminator/mergeDiscriminatorSchema.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/document/applyDefaults.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/document/applyTimestamps.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/document/applyVirtuals.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/document/cleanModifiedSubpaths.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/document/compile.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/document/getDeepestSubdocumentForPath.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/document/getEmbeddedDiscriminatorPath.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/document/handleSpreadDoc.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/each.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/error/combinePathErrors.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/firstKey.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/get.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/getConstructorName.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/getDefaultBulkwriteResult.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/getFunctionName.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/immediate.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/indexes/applySchemaCollation.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/indexes/decorateDiscriminatorIndexOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/indexes/getRelatedIndexes.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/indexes/isDefaultIdIndex.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/indexes/isIndexEqual.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/indexes/isIndexSpecEqual.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/indexes/isTextIndex.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/indexes/isTimeseriesIndex.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/isAsyncFunction.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/isBsonType.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/isMongooseObject.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/isObject.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/isPOJO.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/isPromise.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/isSimpleValidator.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/minimize.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/model/applyDefaultsToPOJO.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/model/applyHooks.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/model/applyMethods.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/model/applyStaticHooks.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/model/applyStatics.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/model/castBulkWrite.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/model/decorateBulkWriteResult.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/model/discriminator.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/model/pushNestedArrayPaths.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/omitUndefined.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/once.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/parallelLimit.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/path/parentPaths.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/path/setDottedPath.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/pluralize.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/assignRawDocsToIdStructure.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/assignVals.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/createPopulateQueryFilter.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/getModelsMapForPopulate.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/getSchemaTypes.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/getVirtual.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/leanPopulateMap.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/lookupLocalFields.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/markArraySubdocsPopulated.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/modelNamesFromRefPath.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/removeDeselectedForeignField.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/setPopulatedVirtualValue.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/skipPopulateValue.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/populate/validateRef.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/printJestWarning.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/processConnectionOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/projection/applyProjection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/projection/hasIncludedChildren.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/projection/isDefiningProjection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/projection/isExclusive.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/projection/isInclusive.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/projection/isNestedProjection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/projection/isPathExcluded.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/projection/isPathSelectedInclusive.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/projection/isSubpath.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/projection/parseProjection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/applyGlobalOption.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/cast$expr.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/castFilterPath.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/castUpdate.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/getEmbeddedDiscriminatorPath.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/handleImmutable.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/handleReadPreferenceAliases.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/hasDollarKeys.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/isOperator.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/sanitizeFilter.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/sanitizeProjection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/selectPopulatedFields.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/trusted.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/query/validOps.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/addAutoId.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/applyBuiltinPlugins.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/applyPlugins.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/applyReadConcern.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/applyWriteConcern.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/cleanPositionalOperators.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/getIndexes.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/getKeysInSchemaOrder.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/getPath.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/getSubdocumentStrictValue.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/handleIdOption.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/handleTimestampOption.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/idGetter.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schema/merge.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/schematype/handleImmutable.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/setDefaultsOnInsert.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/specialProperties.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/symbols.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/timers.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/timestamps/setDocumentTimestamps.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/timestamps/setupTimestamps.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/topology/allServersUnknown.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/topology/isAtlas.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/topology/isSSLError.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/update/applyTimestampsToChildren.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/update/applyTimestampsToUpdate.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/update/castArrayFilters.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/update/decorateUpdateWithVersionKey.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/update/modifiedPaths.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/update/moveImmutableProperties.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/update/removeUnusedArrayFilters.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/update/updatedPathsByArrayFilter.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers/updateValidators.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/modifiedPathsSnapshot.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/mongoose.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/populateOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/propertyOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/saveOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/schemaArrayOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/schemaBufferOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/schemaDateOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/schemaDocumentArrayOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/schemaMapOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/schemaNumberOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/schemaObjectIdOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/schemaStringOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/schemaSubdocumentOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/schemaTypeOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/schemaUnionOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options/virtualOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/options.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/plugins/index.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/plugins/saveSubdocs.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/plugins/sharding.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/plugins/trackTransaction.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/plugins/validateBeforeSave.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/queryHelpers.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/bigint.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/decimal128.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/documentArray.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/documentArrayElement.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/double.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/int32.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/map.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/objectId.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/operators/bitwise.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/operators/exists.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/operators/geospatial.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/operators/helpers.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/operators/text.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/operators/type.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/subdocument.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/symbols.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/union.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schema/uuid.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/schemaType.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/stateMachine.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/types/array/index.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/types/array/isMongooseArray.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/types/array/methods/index.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/types/arraySubdocument.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/types/decimal128.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/types/documentArray/index.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/types/documentArray/isMongooseDocumentArray.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/types/documentArray/methods/index.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/types/double.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/types/map.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/types/subdocument.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/types/uuid.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/validOptions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/virtualType.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/aggregate.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/augmentations.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/callback.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/collection.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/connection.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/cursor.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/document.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/error.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/expressions.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/helpers.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/index.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/indexes.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/inferhydrateddoctype.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/inferrawdoctype.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/inferschematype.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/middlewares.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/models.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/mongooseoptions.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/pipelinestage.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/populate.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/query.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/schemaoptions.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/schematypes.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/session.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/types.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/utility.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/validation.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"types/virtuals.d.ts": {
					"match": false,
					"status": "missing-in-package"
				}
			},
			"summary": {
				"differentFiles": 25,
				"matchingFiles": 1,
				"missingInPackage": 269,
				"missingInSource": 31,
				"score": 0.003067484662576687,
				"totalFiles": 326
			}
		}
	}
]
