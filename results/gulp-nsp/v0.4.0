[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-06T11:44:21.140Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "gulp-nsp@0.4.0",
			"name": "gulp-nsp",
			"version": "0.4.0",
			"location": "https://registry.npmjs.org/gulp-nsp/-/gulp-nsp-0.4.0.tgz",
			"integrity": "sha512-+6jTSNq5CMFoidKEGqB+9AHDZD/T7xil7ksDQYFWY+I0RAWpN2CVlh+ncKKxch3kQyPFklNeUWv8X3rkJA/h6w==",
			"publishedAt": "2015-03-09T00:17:15.924Z",
			"publishedWith": {
				"node": null,
				"npm": "1.4.28"
			}
		},
		"source": {
			"integrity": "sha512-oRMkChkzbOQZ6435HWXTWTIvaNfm1vtSxMAYGnLgeaGCURDK/2FPkle2NfuQY/1cuPDw+QJjmIa3P38oXCYIqg==",
			"location": "https://github.com/nodesecurity/gulp-nsp",
			"spec": "github:nodesecurity/gulp-nsp#7d2f4b691eba837165b034dd54f1b8631e62bea5"
		},
		"comparisonHash": "9ef46a5bd31291e57cbab41e2f17c57bd6da0b5b",
		"diff": {
			"files": {
				".jscsrc": {
					"match": false,
					"packageHash": "7f19a42a6eb1743d6dc6822a47265bb52f2ce52cc92ccf97a2250000add2bb36",
					"size": 57,
					"status": "missing-in-source"
				},
				".jshintignore": {
					"match": false,
					"packageHash": "16d30e4462189fb14dd611bdb708c510630c576a1f35b9383e89a4352da36c97",
					"size": 13,
					"status": "missing-in-source"
				},
				".jshintrc": {
					"match": false,
					"packageHash": "8823c8ea39f917a4a6702e47c4ac635b0e569d9974274b85280866689c4a5e7a",
					"size": 454,
					"status": "missing-in-source"
				},
				".npmignore": {
					"match": false,
					"packageHash": "891ecbb359335482e5b990cba96f380696512d9ac665774b4e325d443f1f7851",
					"size": 27,
					"status": "missing-in-source"
				},
				"README.md": {
					"diff": "--- published/README.md\n+++ rebuilt/README.md\n@@ -1,35 +1,94 @@\n # gulp-nsp\n-A gulp plugin that runs the Node Security Project audit for you\n \n-###Usage\n-Install gulp-nsp into your project.\n+# Installation\n+\n+To install the gulp-nsp module into your project simply run\n+\n ```bash\n npm install gulp-nsp --save\n ```\n \n-Then in your gulpfile, add the following task like so.\n+# Usage\n+\n+Then in your gulpfile, add the following task.\n \n ```javascript\n var gulpNSP = require('gulp-nsp');\n \n-//To check your package.json\n+//To check your project\n gulp.task('nsp', function (cb) {\n-  gulpNSP('./package', cb);\n+  gulpNSP({package: __dirname + '/package.json'}, cb);\n });\n+```\n \n-//To check your shrinkwrap.json\n+```javascript\n+//If you're using a shrinkwrap file, pass both the shrinkwrap and the package.json\n gulp.task('nsp', function (cb) {\n-  gulpNSP('./npm-shrinkwrap', cb);\n+  gulpNSP({\n+    shrinkwrap: __dirname + '/npm-shrinkwrap.json',\n+    package: __dirname + '/package.json'\n+  }, cb);\n });\n+```\n+\n+## Options\n \n-//If you don't want to stop your gulp flow if some vulnerabilities have been found:\n+### stopOnError\n+If you don't want to stop your gulp flow if some vulnerabilities have been found use the stopOnError option:\n+\n+```javascript\n gulp.task('nsp', function (cb) {\n   gulpNSP({\n-    path: './npm-shrinkwrap.json',\n+    package: __dirname + '/package.json',\n     stopOnError: false\n   }, cb);\n });\n ```\n \n-####Note\n-The string you pass to the module is the path to your package.json/npm-shrinkwrap.json relative to your gulpfile.\n+### output\n+If you want to use an alternative output reporter provided by nsp use the output option.\n+\n+```javascript\n+gulp.task('nsp', function (cb) {\n+  gulpNSP({\n+    package: __dirname + '/package.json',\n+    reporter: 'summary'\n+  }, cb);\n+});\n+```\n+\n+### proxy\n+If you want to use a proxy you can configure it via this option.\n+\n+\n+```javascript\n+gulp.task('nsp', function (cb) {\n+  gulpNSP({\n+    package: __dirname + '/package.json',\n+    proxy: 'http://127.0.0.1:8080'\n+  }, cb);\n+});\n+```\n+\n+### Exceptions\n+The Node Security CLI supports adding exceptions. These are advisories that you have evaluated and personally deemed unimportant for your project. Instructions are available on the [nsp cli repository](https://github.com/nodesecurity/nsp#exceptions).\n+\n+## License\n+\n+    Copyright (c) 2016 by ^Lift Security\n+\n+    Licensed under the Apache License, Version 2.0 (the \"License\");\n+    you may not use this file except in compliance with the License.\n+    You may obtain a copy of the License at\n+\n+       http://www.apache.org/licenses/LICENSE-2.0\n+\n",
					"match": false,
					"packageHash": "55eb533006a977302f963020f323cf9921d7a69a3a3c88bedd8699e023ef9753",
					"size": 797,
					"sourceHash": "c4fc658e0309e3df8127d39339d33a86f3875c3fae85e81943dc9a853911fa10",
					"status": "content"
				},
				"index.js": {
					"diff": "--- published/index.js\n+++ rebuilt/index.js\n@@ -1,54 +1,111 @@\n-var auditShrinkWrap = require('nsp-audit-shrinkwrap');\n-var auditPackage = require('nsp-audit-package');\n-var nspPrettyOutput = require('./lib/prettyOutput');\n-var gutil = require('gulp-util');\n-var auditor;\n-\n-function nspGulp(parameters, cb) {\n-    if (typeof parameters === 'string') {\n-        var path = parameters;\n-        parameters = {};\n-        parameters.path = path;\n-    }\n-\n-    if (parameters.path.indexOf('package') > -1) {\n-        auditor = auditPackage;\n-    } else if (parameters.path.indexOf('shrinkwrap') > -1) {\n-        auditor = auditShrinkWrap.auditByPath;\n-    } else {\n-        return cb({\n-            stack: 'You need to specify the correct path to either your ' +\n-                   'package.json or shrinkwrap.json in relation to your ' +\n-                   'gulpfile.',\n-            message: 'Please Specify Valid Path'\n-        });\n-    }\n-\n-    auditor(parameters.path, function(err, results) {\n-        var ret;\n-\n-        if (err) {\n-            ret = cb(err);\n-        } else {\n-            if (results.length > 0) {\n-                var stack = '\\n' + nspPrettyOutput(results);\n-\n-                if (parameters.stopOnError === false) {\n-                    gutil.log(stack);\n-                    ret = cb();\n-                } else {\n-                    ret = cb({\n-                        stack: stack,\n-                        message: 'Vulnerabilities Found'\n-                    });\n-                }\n-            } else {\n-                ret = cb();\n-            }\n+'use strict';\n+\n+var Nsp = require('nsp');\n+var Preprocessor = require('nsp/lib/preprocessor');\n+var Reporter = require('nsp/reporters');\n+var PluginError = require('plugin-error');\n+var Log = require('fancy-log');\n+var PLUGIN_NAME = require('./package.json').name;\n+var Os = require('os');\n+var Fs = require('fs');\n+var Path = require('path');\n+\n+var internals = {};\n+internals.wrapReporter = function (name, fn, ...args) {\n+\n+  var output = '';\n+  return new Promise((resolve, reject) => {\n+\n+    try {\n+      return resolve(fn(...args, {\n+        log: function (...segments) {\n+\n+          output += segments.join(' ') + '\\n';\n+        },\n+        error: function (...segments) {\n+\n+          output += segments.join(' ') + '\\n';\n         }\n+      }));\n+    }\n+    catch (err) {\n+      return reject(err);\n+    }\n+  }).catch((err) => {\n+\n+    output += `Error in reporter: ${name}\\n`;\n+    output += err.stack + '\\n';\n+  }).then(() => {\n+\n+    return output;\n+  });\n+};\n+\n+var rsGulp = function (params, callback) {\n+\n+  var payload = Nsp.sanitizeParameters(params);\n+  var reporter = Reporter.load(payload.reporter);\n+\n+  return Promise.resolve().then(() => {\n+\n",
					"match": false,
					"packageHash": "34430fe71b521f18232462e4ba511ff5180fc3699d15ee005fc63a348b2cef6e",
					"size": 1538,
					"sourceHash": "6a765a532ca0c22175a7bcef391c18f21d00e0f4ef8172525fd002cd8c82063b",
					"status": "content"
				},
				"lib/prettyOutput.js": {
					"match": false,
					"packageHash": "dc48b4c3520905f1c8d0d1a99a8bb02b7a605ccbc450146c62813fd327fa079f",
					"size": 762,
					"status": "missing-in-source"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,45 +1,38 @@\n {\n   \"name\": \"gulp-nsp\",\n-  \"version\": \"0.4.0\",\n-  \"description\": \"A gulp plugin that runs the Node Security Project audit for you\",\n+  \"version\": \"3.0.1\",\n+  \"description\": \"A gulp module that runs Node Security check\",\n   \"main\": \"index.js\",\n   \"scripts\": {\n-    \"codestyle\": \"./node_modules/.bin/jscs index.js test/*.js\",\n-    \"lint\": \"./node_modules/.bin/jshint .\",\n-    \"test\": \"./node_modules/.bin/mocha\"\n+    \"lint\": \"eslint .\",\n+    \"test\": \"gulp nsp\"\n+  },\n+  \"repository\": {\n+    \"type\": \"git\",\n+    \"url\": \"git+ssh://git@github.com/nodesecurity/gulp-nsp.git\"\n   },\n-  \"repository\": \"nodesecurity/gulp-nsp\",\n-  \"precommit\": [\n-    \"codestyle\",\n-    \"lint\",\n-    \"test\"\n-  ],\n   \"keywords\": [\n-    \"gulp\",\n-    \"nsp\",\n     \"security\",\n-    \"plugin\",\n-    \"gulpplugin\"\n-  ],\n-  \"author\": \"Joey Cozza <>\",\n-  \"contributors\": [\n-    \"David Dias <daviddias.p@gmail.com>\",\n-    \"Alexis Mineaud <alexis.mineaud@gmail.com>\"\n+    \"gulp\",\n+    \"gulpfriendly\",\n+    \"nodesecurity\",\n+    \"nsp\"\n   ],\n-  \"license\": \"ISC\",\n+  \"author\": \"^Lift Security\",\n+  \"bugs\": {\n+    \"url\": \"https://github.com/nodesecurity/gulp-nsp/issues\"\n+  },\n+  \"homepage\": \"https://github.com/nodesecurity/gulp-nsp#readme\",\n   \"dependencies\": {\n-    \"async\": \"^0.9.0\",\n-    \"chalk\": \"^1.0.0\",\n-    \"nsp-audit-package\": \"^0.2.0\",\n-    \"nsp-audit-shrinkwrap\": \"^1.0.3\",\n-    \"text-table\": \"^0.2.0\"\n+    \"fancy-log\": \"^1.3.2\",\n+    \"nsp\": \"^3.2.1\",\n+    \"plugin-error\": \"^1.0.1\"\n   },\n   \"devDependencies\": {\n-    \"chai\": \"^2.1.0\",\n-    \"gulp-util\": \"^3.0.4\",\n-    \"jscs\": \"^1.11.3\",\n-    \"jshint\": \"^2.6.3\",\n-    \"mocha\": \"^2.1.0\",\n-    \"precommit-hook\": \"^1.0.7\"\n-  }\n+    \"eslint\": \"^2.5.3\",\n+    \"eslint-config-nodesecurity\": \"^1.3.1\",\n+    \"eslint-plugin-hapi\": \"^1.2.2\",\n+    \"gulp\": \"^3.9.0\"\n+  },\n+  \"license\": \"Apache-2.0\"\n }\n",
					"match": false,
					"packageHash": "f407dd90aff4b1c220b323299b3e7826572a9c6d05188c89ce3ef69f3312c5fa",
					"size": 1028,
					"sourceHash": "e1acced6c4f72f866d9bb6b63dd5b49a72332c0c251ef44b234362a29bba23f9",
					"status": "content"
				},
				"test/index.js": {
					"match": false,
					"packageHash": "b5ee28f4ed10d03a06f43c85bbe5f644ab5e6029d84ac0ee3f99f59b7f2db991",
					"size": 1966,
					"status": "missing-in-source"
				},
				"test/notVulnerables/npm-shrinkwrap.json": {
					"match": false,
					"packageHash": "301437acf237fa894e2dc8fdadc2d5166e58e6d6bbed12b88c808c71d1867563",
					"size": 95161,
					"status": "missing-in-source"
				},
				"test/notVulnerables/package.json": {
					"match": false,
					"packageHash": "992ea54ca3a4b7b9291d82d513e841ed1149b6b44d3eb4383c4744f354fa907f",
					"size": 540,
					"status": "missing-in-source"
				},
				"test/vulnerables/npm-shrinkwrap.json": {
					"match": false,
					"packageHash": "d9cc95808ba21b107124b4454c13ff1303db995e434bbfd8c60c95a84dfc47aa",
					"size": 98410,
					"status": "missing-in-source"
				},
				"test/vulnerables/package.json": {
					"match": false,
					"packageHash": "14f0824a148162da140a201b75ddd402300927e88c3b6890c18da345a9110c21",
					"size": 563,
					"status": "missing-in-source"
				},
				".drone.yml": {
					"match": false,
					"status": "missing-in-package"
				},
				".eslintrc": {
					"match": false,
					"status": "missing-in-package"
				},
				"LICENSE": {
					"match": false,
					"status": "missing-in-package"
				},
				"contributing.md": {
					"match": false,
					"status": "missing-in-package"
				},
				"gulpfile.js": {
					"match": false,
					"status": "missing-in-package"
				}
			},
			"summary": {
				"differentFiles": 3,
				"matchingFiles": 0,
				"missingInPackage": 5,
				"missingInSource": 10,
				"score": 0,
				"totalFiles": 18
			}
		}
	}
]
