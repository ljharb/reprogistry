[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2025-12-31T08:02:26.139Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "mongodb@0.9.8-5",
			"name": "mongodb",
			"version": "0.9.8-5",
			"location": "https://registry.npmjs.org/mongodb/-/mongodb-0.9.8-5.tgz",
			"integrity": "sha512-lDGsmzAIQc02buk8ZWfR7qsG+sREjlT+vAbji3mEe7vUiGnLrVm7leoSv0mWB37N/7c3DBgPONcFq22obD22kw==",
			"publishedAt": "2012-02-02T12:04:27.712Z",
			"publishedWith": {
				"node": "v0.6.9",
				"npm": "1.1.0-3"
			}
		},
		"source": {
			"integrity": null,
			"location": "git://github.com/christkv/node-mongodb-native.git",
			"spec": "github:christkv/node-mongodb-native#HEAD"
		},
		"comparisonHash": "8a2a8dcbb729bf3ee9216e490c955701f0ddebe1",
		"diff": {
			"files": {
				".npmignore": {
					"match": false,
					"packageHash": "2d3f445d989bca314d1d91fc625d0b8868133a5e1e32746ee5e9d71dc1d900be",
					"size": 18,
					"status": "missing-in-source"
				},
				"HISTORY": {
					"match": false,
					"packageHash": "5d80f3f38dedc85751d2607a28f8f81fb6f78f41ac6cde2e753902f849329d8e",
					"size": 18017,
					"status": "missing-in-source"
				},
				"Makefile": {
					"diff": "--- published/Makefile\n+++ rebuilt/Makefile\n@@ -1,13 +1,13 @@\n NODE = node\n NPM = npm\n-NODEUNIT = deps/nodeunit/bin/nodeunit\n+NODEUNIT = node_modules/nodeunit/bin/nodeunit\n DOX = node_modules/dox/bin/dox\n name = all\n \n total: build_native\n \n build_native:\n-\t$(MAKE) -C ./external-libs/bson all\n+\t# $(MAKE) -C ./external-libs/bson all\n \n build_native_debug:\n \t$(MAKE) -C ./external-libs/bson all_debug\n@@ -25,6 +25,10 @@\n \t@echo \"\\n == Run All tests minus replicaset tests==\"\n \t$(NODE) dev/tools/test_all.js --noreplicaset --boot\n \n+test_pure: build_native\n+\t@echo \"\\n == Run All tests minus replicaset tests==\"\n+\t$(NODE) dev/tools/test_all.js --noreplicaset --boot --noactive\n+\n test_junit: build_native\n \t@echo \"\\n == Run All tests minus replicaset tests==\"\n \t$(NODE) dev/tools/test_all.js --junit --noreplicaset\n",
					"match": false,
					"packageHash": "6684624343669632daf9ef366544737c84b1193abfa7853a316b79aca098121e",
					"size": 1669,
					"sourceHash": "9a40c06659b42802352fedb651c7e3ac1993e441b74345c4f4015c7835dbd375",
					"status": "content"
				},
				"Readme.md": {
					"diff": "--- published/Readme.md\n+++ rebuilt/Readme.md\n@@ -1,3 +1,8 @@\n+Main Documentation site\n+=======================\n+\n+[Documentation](http://christkv.github.com/node-mongodb-native/)\n+\n Install\n ========\n \n@@ -7,7 +12,7 @@\n     \n That may give you a warning telling you that bugs['web'] should be bugs['url'], it would be safe to ignore it (this has been fixed in the development version) \n \n-To install from the latest from the repository, run::\n+To install the latest from the repository, run::\n \n     npm install path/to/node-mongodb-native\n \n@@ -33,7 +38,7 @@\n             // Locate all the entries using find\n             collection.find().toArray(function(err, results) {\n               test.assertEquals(1, results.length);\n-              test.assertTrue(results.a === 2);\n+              test.assertTrue(results[0].a === 2);\n \n               // Let's close the db\n               client.close();\n",
					"match": false,
					"packageHash": "803937a3f19ed29abfddb639d58f02ad1c5cea84ae7be4e730e15c63bc969426",
					"size": 16402,
					"sourceHash": "eec96097c0795dae69c2266acd746c7b1ee7a3bec8afe76b1dc19d24418f5075",
					"status": "content"
				},
				"TODO": {
					"match": false,
					"packageHash": "54e5f2728996690550283c95a44134fc3267c308d9be15ccf01e898b56b2f012",
					"size": 1410,
					"status": "missing-in-source"
				},
				"deps/gleak/.npmignore": {
					"match": false,
					"packageHash": "40bdd3939495d4595182f964a238fb8808cffe3d7b9f51c98fe10929f4009c42",
					"size": 32,
					"status": "missing-in-source"
				},
				"deps/gleak/History.md": {
					"match": false,
					"packageHash": "08987e79cc38f2e3cb3d8d52f93d9aaa943c9d4e6a84a46d41c1fc21a32dedb1",
					"size": 678,
					"status": "missing-in-source"
				},
				"deps/gleak/Makefile": {
					"match": false,
					"packageHash": "cc7dd0edba33a120a5958a144be8db4fbca198d95dfca0d65067e31f62e5f1e2",
					"size": 92,
					"status": "missing-in-source"
				},
				"deps/gleak/README.md": {
					"match": false,
					"packageHash": "8164a2545addd67dc9aa7dcfe8bca5aae0e7a349385641b315c4a4fb56dd5ff0",
					"size": 3700,
					"status": "missing-in-source"
				},
				"deps/gleak/index.js": {
					"match": false,
					"packageHash": "89fa6d2a3902f52c2a46347ddf5c18b6b3113921baf6ffbc6630dd68aa082fd7",
					"size": 3204,
					"status": "missing-in-source"
				},
				"deps/gleak/package.json": {
					"match": false,
					"packageHash": "11667342c7fbbf3a91d19b86704fffa3f29d1777c5ea7fe704e05b65e6a863c4",
					"size": 471,
					"status": "missing-in-source"
				},
				"deps/gleak/test/index.js": {
					"match": false,
					"packageHash": "654e16e8db2684b1761ec263da4b2b1e7aaa5bc15751bd05a56eccc05ca9c9cd",
					"size": 5310,
					"status": "missing-in-source"
				},
				"deps/nodeunit/.npmignore": {
					"match": false,
					"packageHash": "c22365d4b129983208d56dfa095d9af9e674c734939c8a7c62489c082db31480",
					"size": 36,
					"status": "missing-in-source"
				},
				"deps/nodeunit/CONTRIBUTORS.md": {
					"match": false,
					"packageHash": "b2f57278fcf2ccaa94580b24f1ac5d4318e2a484f41b52c786847b0fb893ce05",
					"size": 1707,
					"status": "missing-in-source"
				},
				"deps/nodeunit/LICENSE": {
					"match": false,
					"packageHash": "b04b9e208e566fa898c7429e4dd5b45ba3ba2f7391e5c009cf63c53d580fa9b4",
					"size": 1058,
					"status": "missing-in-source"
				},
				"deps/nodeunit/Makefile": {
					"match": false,
					"packageHash": "c77672bfa6d33da5edcae0d7c7a293efdedb11cc67fea9a1a036411ef193ce6f",
					"size": 8420,
					"status": "missing-in-source"
				},
				"deps/nodeunit/README.md": {
					"match": false,
					"packageHash": "91daddd091c3c5da6745c746e745dc697676887b62b8ae0948bfa44abf9eb3d4",
					"size": 15567,
					"status": "missing-in-source"
				},
				"deps/nodeunit/bin/nodeunit": {
					"match": false,
					"packageHash": "28fe1effed0377e9aef78b4e80ee8b084eef7d99f3933f50c3e4654c964f072d",
					"size": 4114,
					"status": "missing-in-source"
				},
				"deps/nodeunit/bin/nodeunit.json": {
					"match": false,
					"packageHash": "1751ba7b7ad826d3162da359fccef5d1352d1d9a8b710e6753139aa142b1d255",
					"size": 274,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/async.js": {
					"match": false,
					"packageHash": "6e67d1380c0ea1c5e876cdeb9b9f39ea8dba07d426d1377f3a1be62d57e0125c",
					"size": 18641,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/console.log.js": {
					"match": false,
					"packageHash": "6f15abd13c83f16ea6540016f2a06996d4e07cb02573d9087323595c382f33bc",
					"size": 1391,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/History.md": {
					"match": false,
					"packageHash": "6c08597fe65774f76e3e4ba9cbe167b110e1cd7bcc7f0c4fb2ced4c120e47b4b",
					"size": 1322,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/Makefile": {
					"match": false,
					"packageHash": "beef32fb9ad4fadf407ef8e442454685a88b426cdcc37a0db29fc4106ea6879c",
					"size": 318,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/Readme.md": {
					"match": false,
					"packageHash": "5ab3481febe7ac7eb8d035b08261bee927548e8274d915a7ce88fc981d962149",
					"size": 3795,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/benchmark.js": {
					"match": false,
					"packageHash": "c0303c6a0c1bc62955fd1a76b7bba5dd825dbd4d2754f68542aeae6832fa4ee8",
					"size": 326,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/ejs.js": {
					"match": false,
					"packageHash": "a7c37e1bab2082a61398cdf518d6282cdcdbbde72baf28ce3a8262cd5b3f7e79",
					"size": 10294,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/ejs.min.js": {
					"match": false,
					"packageHash": "f36293cd9f6ab336210aacb73b62d7c0fa836548910d531b2957c6287620e898",
					"size": 5511,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/examples/client.html": {
					"match": false,
					"packageHash": "bfba4547ad4bb7201bb6315c95b7a6ee1169a3c69e49b46c010d148cc1cb99d3",
					"size": 71,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/examples/list.ejs": {
					"match": false,
					"packageHash": "65a1f30b6790730a0c56213ed68177fe1f247d0f7ae648eb50b5eaed087f2236",
					"size": 128,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/examples/list.js": {
					"match": false,
					"packageHash": "f5d0349bd16bd3e941801d823b52f3d884f2cb6c9a54cb49fc2b9581ff9583c0",
					"size": 242,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/index.js": {
					"match": false,
					"packageHash": "4403be0492957e66b618d84c0584d9c1e0f54bdede324b3e65a89d31f222be95",
					"size": 39,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/lib/ejs.js": {
					"match": false,
					"packageHash": "a23ad05a8e09f034f1cd492c7ebf6f67c5acf58c7a7fbb2b4a989bb4b6e318ca",
					"size": 5590,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/lib/filters.js": {
					"match": false,
					"packageHash": "4b51c32cc59d8c8a2f77b88d3ff89f600d158f0ff05111ed1c6e312c89983404",
					"size": 3018,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/lib/utils.js": {
					"match": false,
					"packageHash": "0fd9be88e01050e9b5d12ae8bfeba269f91b6459629c508a5ecf4c2ecef8cadb",
					"size": 379,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/package.json": {
					"match": false,
					"packageHash": "65585fba46a915dd0d747f4f758e56b49ede65de31833a2b2458ecfc3e601a27",
					"size": 265,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/support/compile.js": {
					"match": false,
					"packageHash": "678861fae85d7f5f7f6891c608951914df7e479397214e58747a89f95b7c0f77",
					"size": 3682,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/ejs/test/ejs.test.js": {
					"match": false,
					"packageHash": "b61b7a10fe665c6c3f741637cf21fac4864e8f6539726c060c6545fba85c50ad",
					"size": 7096,
					"status": "missing-in-source"
				},
				"deps/nodeunit/deps/json2.js": {
					"match": false,
					"packageHash": "bdbc17cf6a48eb58c27e9ec5eecfb9131968c37ad871541dba108f4756dabc72",
					"size": 17390,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/bin/nodeunit": {
					"match": false,
					"packageHash": "28fe1effed0377e9aef78b4e80ee8b084eef7d99f3933f50c3e4654c964f072d",
					"size": 4114,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/bin/nodeunit.json": {
					"match": false,
					"packageHash": "1751ba7b7ad826d3162da359fccef5d1352d1d9a8b710e6753139aa142b1d255",
					"size": 274,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/deps/async.js": {
					"match": false,
					"packageHash": "6e67d1380c0ea1c5e876cdeb9b9f39ea8dba07d426d1377f3a1be62d57e0125c",
					"size": 18641,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/deps/console.log.js": {
					"match": false,
					"packageHash": "6f15abd13c83f16ea6540016f2a06996d4e07cb02573d9087323595c382f33bc",
					"size": 1391,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/deps/ejs.js": {
					"match": false,
					"packageHash": "0bf20b8aa0f451bf912d24aa509a9f2469e94d378a8b455da983ad72cb0d3240",
					"size": 2596,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/deps/json2.js": {
					"match": false,
					"packageHash": "bdbc17cf6a48eb58c27e9ec5eecfb9131968c37ad871541dba108f4756dabc72",
					"size": 17390,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/index.js": {
					"match": false,
					"packageHash": "4a2146a5e00131523679c7d60430d41c67ae0a4ddacd52e51b2f0ce0ae517a5c",
					"size": 166,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/.swp": {
					"match": false,
					"packageHash": "59ec25a0e12ea23509f467e650702c817e03745a8076e8c25f4f13197121de95",
					"size": 12288,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/assert.js": {
					"match": false,
					"packageHash": "d4955c60c4a103dab8a365683bde42078ecd601606f4b5830682364952d42968",
					"size": 10746,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/core.js": {
					"match": false,
					"packageHash": "0c6eef5009226433670f4f7d06abae220f04e788236bfdf400cef920cb8423d2",
					"size": 7875,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/nodeunit.js": {
					"match": false,
					"packageHash": "6be48cf577e50b741711d7183117176eada3462c89c6e6c4f834a1a83b7675a8",
					"size": 2424,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/reporters/browser.js": {
					"match": false,
					"packageHash": "9499c7847d23c1d1c4aec8eaaa5d1961e0d4f2543d508d47881ba6aa561bfb84",
					"size": 3949,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/reporters/default.js": {
					"match": false,
					"packageHash": "1b85e291756d1acc470d53450f7b50f15732c5e29ad5bea5f6fdde0b175b3bac",
					"size": 3880,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/reporters/eclipse.js": {
					"match": false,
					"packageHash": "f0fde3dadd63007ed94d1b44c6ebb2d5b869181f2b52e55aaf5a6f3bcaeb8d69",
					"size": 3073,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/reporters/html.js": {
					"match": false,
					"packageHash": "b8067f9ec03f585ce734e40bea2eb59d545ee97e15ca0e0247e0e94b0e66d798",
					"size": 3499,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/reporters/index.js": {
					"match": false,
					"packageHash": "3296c4eef757f654cfccb6a10f1ab0e21a0dd393849ec83a85b26af65b068bbb",
					"size": 513,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/reporters/junit.js": {
					"match": false,
					"packageHash": "8ad08815e91b249c5b46f0f8cb7ee57d5e60d57b1eeb336d0b29403bf0aa81b8",
					"size": 5525,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/reporters/machineout.js": {
					"match": false,
					"packageHash": "c94439317472742a6816e72b4a997ef831170bff4eb8708c30fa47fb35739ead",
					"size": 3518,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/reporters/minimal.js": {
					"match": false,
					"packageHash": "a6dc741dbcb07ba8f4b7a920476fb8f28969d76d14b0a44f8588e20065caf4de",
					"size": 3455,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/reporters/nested.js": {
					"match": false,
					"packageHash": "069bddb2f7f39198ccdcd41cdfeb2e10cac4768602ce504c6f4cbc3a8adead11",
					"size": 6233,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/reporters/skip_passed.js": {
					"match": false,
					"packageHash": "bb7e6f90c3d1c5bd320fa34759cf87dc694eba55e971aa9a31ab432e8709f965",
					"size": 3192,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/reporters/tap.js": {
					"match": false,
					"packageHash": "0b252048fb320d586f31a36c6f819c276f6cba6999ac70696daf80f067c2834e",
					"size": 1771,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/reporters/verbose.js": {
					"match": false,
					"packageHash": "c7a2f32179a571b04290c7e1f8ffda14383f0831b04f0577e7ba47ee199489dc",
					"size": 3508,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/track.js": {
					"match": false,
					"packageHash": "ec270d8929498670b8858bf64f1148ddfe0b8fafd6326f208521a85a385c3e31",
					"size": 1204,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/types.js": {
					"match": false,
					"packageHash": "8508286bb18391260b9b4f9d31bf0b29489a4600f8978105f46e28033d422651",
					"size": 5125,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/lib/utils.js": {
					"match": false,
					"packageHash": "e36bc5a9dca3b9319028912b21c54e50b44ef2a851ca55b6ace0376b39ed237b",
					"size": 6060,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/package.json": {
					"match": false,
					"packageHash": "9d75aed7ebafe4957e6bec7de8179216c7fca093bb04ba3055b044ce48410a5b",
					"size": 1714,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/share/junit.xml.ejs": {
					"match": false,
					"packageHash": "84500bc9c9138c39faa25d81744c17dc9f2f7c081027a025e21fc988d9bef71f",
					"size": 725,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/share/license.js": {
					"match": false,
					"packageHash": "c2d81ff8586c4f0e55b222efbdad15072f0960409d49144c39f55d99f96e19c4",
					"size": 235,
					"status": "missing-in-source"
				},
				"deps/nodeunit/dist/nodeunit/share/nodeunit.css": {
					"match": false,
					"packageHash": "e1cff7d7b6903ac5358471ad8a04e400402a20dcf7efd4a9b7a71ca19ebba2fd",
					"size": 1358,
					"status": "missing-in-source"
				},
				"deps/nodeunit/doc/nodeunit.md": {
					"match": false,
					"packageHash": "c57518a39297ef6ba91ee72ceeaba7ad5d9807f1cdb02d6449a266904a8305cf",
					"size": 1637,
					"status": "missing-in-source"
				},
				"deps/nodeunit/examples/browser/nodeunit.js": {
					"match": false,
					"packageHash": "ade0c3787e07974c65395bf7e72df085cc32476fb454c5ad1b649e0923e02c1a",
					"size": 62779,
					"status": "missing-in-source"
				},
				"deps/nodeunit/examples/browser/suite1.js": {
					"match": false,
					"packageHash": "a0cf930d2666256e73299191618d5a58f005cc1bbf7733a7fdeb2aa169bd11d3",
					"size": 319,
					"status": "missing-in-source"
				},
				"deps/nodeunit/examples/browser/suite2.js": {
					"match": false,
					"packageHash": "cca3850beb4e4ea16bffbd6769191e384acf9e88de80a44e49a6266f89bc50ce",
					"size": 396,
					"status": "missing-in-source"
				},
				"deps/nodeunit/examples/browser/suite3.js": {
					"match": false,
					"packageHash": "ce1937eb001169b9c98a8215ce251c76f9e34e4e111fd69ecde8212c9742ebcf",
					"size": 173,
					"status": "missing-in-source"
				},
				"deps/nodeunit/examples/browser/test.html": {
					"match": false,
					"packageHash": "5d93878896c6f9d6d642b16d98368c497d0aa61e1287e1e7083dd425c6297d4f",
					"size": 375,
					"status": "missing-in-source"
				},
				"deps/nodeunit/examples/nested/nested_reporter_test.unit.js": {
					"match": false,
					"packageHash": "90a35d7de6ae192108b687b6f275aa742e368f0de0b1b32591f02810f0422575",
					"size": 2297,
					"status": "missing-in-source"
				},
				"deps/nodeunit/img/example_fail.png": {
					"match": false,
					"packageHash": "5205647e4ddd31179fe5e1e4ddba8c496a76c2e821b2629b74772b62287381ab",
					"size": 38642,
					"status": "missing-in-source"
				},
				"deps/nodeunit/img/example_machineout.png": {
					"match": false,
					"packageHash": "98f46456c8308de51d5ff6195ffb547dcc0793cbf80d53ad2d3c7790b897fd1c",
					"size": 422136,
					"status": "missing-in-source"
				},
				"deps/nodeunit/img/example_pass.png": {
					"match": false,
					"packageHash": "cd2164286b1c9fcb94cc71856dcdd258d285df39579e1445a1c16dd5d2d3f1c4",
					"size": 14133,
					"status": "missing-in-source"
				},
				"deps/nodeunit/index.js": {
					"match": false,
					"packageHash": "4a2146a5e00131523679c7d60430d41c67ae0a4ddacd52e51b2f0ce0ae517a5c",
					"size": 166,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/assert.js": {
					"match": false,
					"packageHash": "d4955c60c4a103dab8a365683bde42078ecd601606f4b5830682364952d42968",
					"size": 10746,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/core.js": {
					"match": false,
					"packageHash": "0c6eef5009226433670f4f7d06abae220f04e788236bfdf400cef920cb8423d2",
					"size": 7875,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/nodeunit.js": {
					"match": false,
					"packageHash": "01110c5d0b15550212b3e675ebc24b0cc06cf3aec32d2d663cfb770b4ff3e8fd",
					"size": 2424,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/reporters/browser.js": {
					"match": false,
					"packageHash": "9499c7847d23c1d1c4aec8eaaa5d1961e0d4f2543d508d47881ba6aa561bfb84",
					"size": 3949,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/reporters/default.js": {
					"match": false,
					"packageHash": "1b85e291756d1acc470d53450f7b50f15732c5e29ad5bea5f6fdde0b175b3bac",
					"size": 3880,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/reporters/eclipse.js": {
					"match": false,
					"packageHash": "f0fde3dadd63007ed94d1b44c6ebb2d5b869181f2b52e55aaf5a6f3bcaeb8d69",
					"size": 3073,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/reporters/html.js": {
					"match": false,
					"packageHash": "b8067f9ec03f585ce734e40bea2eb59d545ee97e15ca0e0247e0e94b0e66d798",
					"size": 3499,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/reporters/index.js": {
					"match": false,
					"packageHash": "3296c4eef757f654cfccb6a10f1ab0e21a0dd393849ec83a85b26af65b068bbb",
					"size": 513,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/reporters/junit.js": {
					"match": false,
					"packageHash": "8c886542c922334d8b7e46ea6604ea3853b203add8a84e7ea6d3465278c23aa2",
					"size": 5351,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/reporters/machineout.js": {
					"match": false,
					"packageHash": "c94439317472742a6816e72b4a997ef831170bff4eb8708c30fa47fb35739ead",
					"size": 3518,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/reporters/minimal.js": {
					"match": false,
					"packageHash": "a6dc741dbcb07ba8f4b7a920476fb8f28969d76d14b0a44f8588e20065caf4de",
					"size": 3455,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/reporters/nested.js": {
					"match": false,
					"packageHash": "069bddb2f7f39198ccdcd41cdfeb2e10cac4768602ce504c6f4cbc3a8adead11",
					"size": 6233,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/reporters/skip_passed.js": {
					"match": false,
					"packageHash": "bb7e6f90c3d1c5bd320fa34759cf87dc694eba55e971aa9a31ab432e8709f965",
					"size": 3192,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/reporters/tap.js": {
					"match": false,
					"packageHash": "0b252048fb320d586f31a36c6f819c276f6cba6999ac70696daf80f067c2834e",
					"size": 1771,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/reporters/verbose.js": {
					"match": false,
					"packageHash": "c7a2f32179a571b04290c7e1f8ffda14383f0831b04f0577e7ba47ee199489dc",
					"size": 3508,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/track.js": {
					"match": false,
					"packageHash": "ec270d8929498670b8858bf64f1148ddfe0b8fafd6326f208521a85a385c3e31",
					"size": 1204,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/types.js": {
					"match": false,
					"packageHash": "8508286bb18391260b9b4f9d31bf0b29489a4600f8978105f46e28033d422651",
					"size": 5125,
					"status": "missing-in-source"
				},
				"deps/nodeunit/lib/utils.js": {
					"match": false,
					"packageHash": "355eba3450757868f7ab0acb01a1a4759dff8e7de8e798770ae0d722c1effc67",
					"size": 6099,
					"status": "missing-in-source"
				},
				"deps/nodeunit/man1/nodeunit.1": {
					"match": false,
					"packageHash": "cd9bac2075ba9fda7b0c26d96f64a1af629eb438a897c40d23f303a43224cf8c",
					"size": 1957,
					"status": "missing-in-source"
				},
				"deps/nodeunit/nodelint.cfg": {
					"match": false,
					"packageHash": "e7b2ff62e46f295febfb7054b019154a52cb0b398b06f08752acecd789069442",
					"size": 239,
					"status": "missing-in-source"
				},
				"deps/nodeunit/package.json": {
					"match": false,
					"packageHash": "34c64703c37565f140635d31dd859cb289afc5c32a328c74ea19f04c203982b7",
					"size": 1714,
					"status": "missing-in-source"
				},
				"deps/nodeunit/share/junit.xml.ejs": {
					"match": false,
					"packageHash": "84500bc9c9138c39faa25d81744c17dc9f2f7c081027a025e21fc988d9bef71f",
					"size": 725,
					"status": "missing-in-source"
				},
				"deps/nodeunit/share/license.js": {
					"match": false,
					"packageHash": "c2d81ff8586c4f0e55b222efbdad15072f0960409d49144c39f55d99f96e19c4",
					"size": 235,
					"status": "missing-in-source"
				},
				"deps/nodeunit/share/nodeunit.css": {
					"match": false,
					"packageHash": "e1cff7d7b6903ac5358471ad8a04e400402a20dcf7efd4a9b7a71ca19ebba2fd",
					"size": 1358,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/fixtures/coffee/mock_coffee_module.coffee": {
					"match": false,
					"packageHash": "a8ba7102b30806f8323e4658688507287363b6972f8a04bd344672b995becdd4",
					"size": 64,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/fixtures/dir/mock_module3.js": {
					"match": false,
					"packageHash": "59f360a9d2bf7964fa63ce58e013da089e565c87202c35a3492cd9cc330418af",
					"size": 31,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/fixtures/dir/mock_module4.js": {
					"match": false,
					"packageHash": "8d96c8ee9c1881d9fced4856817ec92a74c5e7f891057d9bae43a97439cede16",
					"size": 31,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/fixtures/mock_module1.js": {
					"match": false,
					"packageHash": "d0e39b00e441f76ba906a4df1311edcf7ac2063845c34d949b185c073babdb53",
					"size": 31,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/fixtures/mock_module2.js": {
					"match": false,
					"packageHash": "f79ae9762607ab929a7cef72f47f8f85fd176e0b03479a95a0b64093c5aff5db",
					"size": 31,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/fixtures/raw_jscode1.js": {
					"match": false,
					"packageHash": "59e98924953900c233df9fd658fa5eb81587bd00ff0a461faf0b5c432ccc89f4",
					"size": 55,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/fixtures/raw_jscode2.js": {
					"match": false,
					"packageHash": "58f4d19c89bf584aa58f59205156e28b0ec8da8f40e7208169c7140cf2189e79",
					"size": 57,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/fixtures/raw_jscode3.js": {
					"match": false,
					"packageHash": "f2897e8d4ecbea9793fc07bf4e417c2675aa4e96e544ebdc5c80385dc06111c3",
					"size": 15,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/test-base.js": {
					"match": false,
					"packageHash": "37c7ea3406de4c5a3b965e72f2bb92226f402cafb0b7226eb53f424a2190762d",
					"size": 6250,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/test-failing-callbacks.js": {
					"match": false,
					"packageHash": "15bd6b031fa69025b97695793801d59448f048a5615ff8b3330f6b173715cc5e",
					"size": 3614,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/test-httputil.js": {
					"match": false,
					"packageHash": "cd3cc667209dd77721a210e1588fc33ccf754229eb27c3f5ba4c6e1fcbcb9b08",
					"size": 1751,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/test-runfiles.js": {
					"match": false,
					"packageHash": "4cd76c20a7a94770453fe81af085d9c75171447879055a8a5d7aa4b2fc476ef1",
					"size": 6561,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/test-runmodule.js": {
					"match": false,
					"packageHash": "18e88f9a356616966e8bf2d62527384aafb8b7a00313942bc2c63b6dfdad1ea6",
					"size": 5634,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/test-runtest.js": {
					"match": false,
					"packageHash": "7377ea3e92c86979a5b1ee08c1cfa1cbae1b60a9cfbfca55904875e66570d631",
					"size": 1570,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/test-sandbox.js": {
					"match": false,
					"packageHash": "1d20ecc18dff9c49b1f2554b7705bd15edd6743f8f8d0ab8bd0848d321df1fad",
					"size": 1015,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/test-testcase-legacy.js": {
					"match": false,
					"packageHash": "34f7315163dd8a5bab8c15c51bcea406a94e657257cd384ee1cd39e245b4cac7",
					"size": 7000,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/test-testcase.js": {
					"match": false,
					"packageHash": "93aa73196007e98559b3ff4398beca62cfdf105087e2c8e219d1ff2287fbb5a2",
					"size": 6926,
					"status": "missing-in-source"
				},
				"deps/nodeunit/test/test.html": {
					"match": false,
					"packageHash": "a1330141a7c40ddb2b30e5026241956042c787ecefba0e34636d73a9a2957d8e",
					"size": 914,
					"status": "missing-in-source"
				},
				"deps/step/README.markdown": {
					"match": false,
					"packageHash": "b023a8cd9a4a6ac09d3f20c6092f89e72f8c76e528bf45f0d8ac7a15f788f03e",
					"size": 3042,
					"status": "missing-in-source"
				},
				"deps/step/lib/step.js": {
					"match": false,
					"packageHash": "3dfd25f5bc117cc3acda7859ab4ddbd02251fdae55db565050b24d3260f7e198",
					"size": 4542,
					"status": "missing-in-source"
				},
				"deps/step/package.json": {
					"match": false,
					"packageHash": "d9400fc4eb190667a8d9f466e2986590b1badd1f2b22b6a35c28067daee4d8a7",
					"size": 376,
					"status": "missing-in-source"
				},
				"deps/step/test/callbackTest.js": {
					"match": false,
					"packageHash": "bd04258a35b05d769e7b5973ee1e161cf2ebf2102e2be460267e076e6d8389cf",
					"size": 621,
					"status": "missing-in-source"
				},
				"deps/step/test/errorTest.js": {
					"match": false,
					"packageHash": "eb689f8efdfcdec28f2e349fb4e0cbe5fc178ca178f5ec07a13075a812ead2a5",
					"size": 532,
					"status": "missing-in-source"
				},
				"deps/step/test/fnTest.js": {
					"match": false,
					"packageHash": "02d50088fc420a1bc2010dff0ae93d76593a7820748339cf707dd9d5e9334772",
					"size": 429,
					"status": "missing-in-source"
				},
				"deps/step/test/groupTest.js": {
					"match": false,
					"packageHash": "6c624cb9a4e7f11b187bba73bd87c91f1105e69d0943ddfa8313f2b4734a4bbf",
					"size": 2527,
					"status": "missing-in-source"
				},
				"deps/step/test/helper.js": {
					"match": false,
					"packageHash": "0746c0b3441c3c18e8579dd4fbca2f54384340348fe36885e0a9e5590f2f5097",
					"size": 533,
					"status": "missing-in-source"
				},
				"deps/step/test/parallelTest.js": {
					"match": false,
					"packageHash": "96362563d20b138a981099bf69c488502a5196c7657f7a9b83ae18bcc93d031c",
					"size": 1375,
					"status": "missing-in-source"
				},
				"dev/benchmark/bson_benchmark.js": {
					"match": false,
					"packageHash": "4ea6fdee1d895142ec82f9db2b2220cadc0364919cc248331fdebc02256ba679",
					"size": 3747,
					"status": "missing-in-source"
				},
				"dev/benchmark/bson_buffalo_benchmark.js": {
					"match": false,
					"packageHash": "b26a642f07b78bf8e79353030568a62cc504bd999a977d2d60b21206ab34016a",
					"size": 15317,
					"status": "missing-in-source"
				},
				"dev/benchmark/bson_native_benchmark.js": {
					"match": false,
					"packageHash": "6336e28ea8fab921f245ff3cd3eb56c163df32209150f7ffc0d50803aaec7cca",
					"size": 6176,
					"status": "missing-in-source"
				},
				"dev/benchmark/emit_benchmark.js": {
					"match": false,
					"packageHash": "e93169932750d07fad678478af7949b539130c172b8805ee3a89dc595d7dfd03",
					"size": 1129,
					"status": "missing-in-source"
				},
				"dev/benchmark/grid_fs_write_benchmark.js": {
					"match": false,
					"packageHash": "27e5950e3c9247e99e1fb061ba51a2bd5eea1284cc454566cd0263b8b2bf55bd",
					"size": 971,
					"status": "missing-in-source"
				},
				"dev/benchmark/gridfs_benchmark.js": {
					"match": false,
					"packageHash": "0cc721bd39cb3461e44588df0f95606e9d0b12b781776359abc61ff0b7b389f9",
					"size": 4137,
					"status": "missing-in-source"
				},
				"dev/benchmark/hammer.js": {
					"match": false,
					"packageHash": "10a21f6f1e218a43c04c1d7f691f284b2cca3a304e607766ef6a645ff78213df",
					"size": 4142,
					"status": "missing-in-source"
				},
				"dev/benchmark/hammer_replicaset.js": {
					"match": false,
					"packageHash": "9cf3176eae246c70840c658d7fb5b31a3a31796cc17593237bdabc788df3b2d9",
					"size": 6397,
					"status": "missing-in-source"
				},
				"dev/benchmark/streaming_benchmark.js": {
					"match": false,
					"packageHash": "7ddeddd0cd7325b47018a7504313ea5988ba60b31c95ab301397dbbc2bff34f4",
					"size": 1647,
					"status": "missing-in-source"
				},
				"dev/harness/memory_leak_harness.js": {
					"match": false,
					"packageHash": "2404b821ac6562f3ae77503916d36bc6180c2057ea913e9524243230902d1c74",
					"size": 1567,
					"status": "missing-in-source"
				},
				"dev/tools/build-docs.js": {
					"match": false,
					"packageHash": "fb7543bd359d7a8c8cbb1a6090b13965c121f2e3919d0125b957c2a87835454d",
					"size": 8861,
					"status": "missing-in-source"
				},
				"dev/tools/doc-templates/class.ejs": {
					"match": false,
					"packageHash": "428445d6ae1ad7ca84ab3eef2100e52701dcf57fda3829a3f4ccdddc81892daa",
					"size": 12669,
					"status": "missing-in-source"
				},
				"dev/tools/doc-templates/function.ejs": {
					"match": false,
					"packageHash": "c803710302d5769d8fcd51958c516ff27f2a3c5ad9373c348d1d180c04a74624",
					"size": 8,
					"status": "missing-in-source"
				},
				"dev/tools/doc-templates/index.ejs": {
					"match": false,
					"packageHash": "ebab8edc992443d41dd2affaae8663c710767d8308b168f4a402b4738e3407b1",
					"size": 370,
					"status": "missing-in-source"
				},
				"dev/tools/gleak.js": {
					"match": false,
					"packageHash": "2453da104407529b386b465449dd275a2111f150a170ec5705c7c1c8b6705e12",
					"size": 101,
					"status": "missing-in-source"
				},
				"dev/tools/test_all.js": {
					"match": false,
					"packageHash": "b397a2e035bf5133842d72e6c7450d02b376199182b6afcb76693928939243e9",
					"size": 5760,
					"status": "missing-in-source"
				},
				"dev/tools/test_set_runner.js": {
					"match": false,
					"packageHash": "b8691ce23508f302c1e730a4f9cdab1749d67149f2650862ce230abbceb14e88",
					"size": 857,
					"status": "missing-in-source"
				},
				"docs/sphinx-docs/build/html/.buildinfo": {
					"match": false,
					"packageHash": "21ca7b61b6e736172186d2c7066440885d735ead48a7c89b365bf0e4c640ac8a",
					"size": 230,
					"status": "missing-in-source"
				},
				"docs/sphinx-docs/source/.static/.mongodb": {
					"match": false,
					"packageHash": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
					"size": 0,
					"status": "missing-in-source"
				},
				"docs/sphinx-docs/source/.static/logo-mongodb.png": {
					"match": false,
					"packageHash": "cc1dc8b061d1d146719b2246d4901afbb2c02519e701c42886c15ee679e19d36",
					"size": 13030,
					"status": "missing-in-source"
				},
				"docs/sphinx-docs/templates/.mongodb": {
					"match": false,
					"packageHash": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
					"size": 0,
					"status": "missing-in-source"
				},
				"examples/admin.js": {
					"match": false,
					"packageHash": "2d440b977416005dea48cda521cdaf2478d443068ef008756dc48719b61203db",
					"size": 2193,
					"status": "missing-in-source"
				},
				"examples/blog.js": {
					"match": false,
					"packageHash": "137c4147a59743c8272baf0243e3f6ba2201ce20e97b3008d9afab263f6b916c",
					"size": 5940,
					"status": "missing-in-source"
				},
				"examples/capped.js": {
					"match": false,
					"packageHash": "53a9f9f12bb62e19ad8d4b9e5d3f79934f0bf1f57f582d3c02ab9a00f9efe532",
					"size": 1271,
					"status": "missing-in-source"
				},
				"examples/cursor.js": {
					"match": false,
					"packageHash": "efbda1522289effdb078a217545b364d84ea6a86abed04e1758d7f00e5362345",
					"size": 2560,
					"status": "missing-in-source"
				},
				"examples/gridfs.js": {
					"match": false,
					"packageHash": "3a0146ba12de6dc8bf07de5fd2dbbe5523821f2e67b61cbbf6658db6735369e4",
					"size": 5894,
					"status": "missing-in-source"
				},
				"examples/index.js": {
					"match": false,
					"packageHash": "c3ad958d2e3f17e9893474165393edb322f01afaebfa158244fed62a456baf3a",
					"size": 2368,
					"status": "missing-in-source"
				},
				"examples/info.js": {
					"match": false,
					"packageHash": "42fe6b013315fe972811cb4b5cd54f5f17820914d39de7b139c5034612c83209",
					"size": 1657,
					"status": "missing-in-source"
				},
				"examples/oplog.js": {
					"match": false,
					"packageHash": "cea2a2cd1a25e83eeb88823b5579725ef6ccaa8629c229ab9847c0fc426c8adc",
					"size": 3270,
					"status": "missing-in-source"
				},
				"examples/queries.js": {
					"match": false,
					"packageHash": "c39e274f9548374d0cf47baafd622d443b97429bd171ec20f22a17f77cfd4d36",
					"size": 5289,
					"status": "missing-in-source"
				},
				"examples/replSetServersQueries.js": {
					"match": false,
					"packageHash": "e4107de45e3049b4c9ad4d1cceb3c38d6c0bafc824621ef866678852b3318718",
					"size": 5741,
					"status": "missing-in-source"
				},
				"examples/replSetServersSimple.js": {
					"match": false,
					"packageHash": "12bac6387da463cdaeac2a101ea34ac7286bbccf01309230ae8df319e9177e45",
					"size": 2252,
					"status": "missing-in-source"
				},
				"examples/simple.js": {
					"match": false,
					"packageHash": "3194e95088f4cb9a12fd97b6ad375ab1874a1f52c33faea7eb9987d0095238b1",
					"size": 1686,
					"status": "missing-in-source"
				},
				"examples/strict.js": {
					"match": false,
					"packageHash": "73070e7cace51498c1dd0aedfadb13ac82cb9bfc5a13439c4c17890f021ba817",
					"size": 1445,
					"status": "missing-in-source"
				},
				"examples/types.js": {
					"match": false,
					"packageHash": "d3f0ee5438e7d555c9a085858d587f555f9d8be40dc808f1d64eac6c057e20d8",
					"size": 1678,
					"status": "missing-in-source"
				},
				"examples/url.js": {
					"match": false,
					"packageHash": "027764e2135279cec233b184fb6c5e8d432616d450e33303482994ecda85b89b",
					"size": 394,
					"status": "missing-in-source"
				},
				"external-libs/bson/bson.cc": {
					"diff": "--- published/external-libs/bson/bson.cc\n+++ rebuilt/external-libs/bson/bson.cc\n@@ -1,7 +1,18 @@\n #include <assert.h>\n #include <string.h>\n #include <stdlib.h>\n+\n+#ifdef __clang__\n+#pragma clang diagnostic push\n+#pragma clang diagnostic ignored \"-Wunused-parameter\"\n+#endif\n+\n #include <v8.h>\n+\n+#ifdef __clang__\n+#pragma clang diagnostic pop\n+#endif\n+\n #include <node.h>\n #include <node_version.h>\n #include <node_buffer.h>\n@@ -201,7 +212,7 @@\n   char *error_str = (char *)malloc(256 * sizeof(char));\n   // Decode the key\n   ssize_t len = DecodeBytes(key, BINARY);\n-  ssize_t written = DecodeWrite(key_str, len, key, BINARY);\n+  DecodeWrite(key_str, len, key, BINARY);\n   *(key_str + key->Utf8Length()) = '\\0';\n   // Check if we have a valid key\n   if(key->Utf8Length() > 0 && *(key_str) == '$') {\n@@ -364,14 +375,7 @@\n   // Controls the flow\n   bool done = false;\n   bool finished = false;\n-  bool isObject = false;\n \n-  // Define a local vector that keeps the stack\n-  // vector<vector<Local<Value> > > stack;// = new vector<vector<Local<Value> > >(0);\n-  \n-  // My own stack max of 1024 objects deep\n-  Local<Object> *stack[64];\n-  \n   // Current object we are processing\n   Local<Object> currentObject = value->ToObject();\n \n@@ -503,185 +507,6 @@\n   return object_size;\n }\n \n-Handle<Value> BSON::BSONSerialize2(const Arguments &args) {\n-  HandleScope scope;\n-\n-  if(args.Length() == 1 && !args[0]->IsObject()) return VException(\"One, two or tree arguments required - [object] or [object, boolean] or [object, boolean, boolean]\");\n-  if(args.Length() == 2 && !args[0]->IsObject() && !args[1]->IsBoolean()) return VException(\"One, two or tree arguments required - [object] or [object, boolean] or [object, boolean, boolean]\");\n-  if(args.Length() == 3 && !args[0]->IsObject() && !args[1]->IsBoolean() && !args[2]->IsBoolean()) return VException(\"One, two or tree arguments required - [object] or [object, boolean] or [object, boolean, boolean]\");\n-  if(args.Length() > 3) return VException(\"One, two or tree arguments required - [object] or [object, boolean] or [object, boolean, boolean]\");\n-\n-  // Calculate the total size of the document in binary form to ensure we only allocate memory once\n-  uint32_t object_size = BSON::calculate_object_size2(args[0]);\n-  // Allocate the memory needed for the serializtion\n-  char *serialized_object = (char *)malloc(object_size * sizeof(char));  \n-  // Catch any errors\n-  try {\n-    // Check if we have a boolean value\n-    bool check_key = false;\n-    if(args.Length() == 3 && args[1]->IsBoolean()) {\n-      check_key = args[1]->BooleanValue();\n-    }\n-    \n-    // Serialize the object\n-    BSON::serialize2(serialized_object, 0, Null(), args[0], object_size, check_key);      \n-  } catch(char *err_msg) {\n-    // Free up serialized object space\n-    free(serialized_object);\n-    V8::AdjustAmountOfExternalAllocatedMemory(-object_size);\n-    // Throw exception with the string\n-    Handle<Value> error = VException(err_msg);\n-    // free error message\n-    free(err_msg);\n-    // Return error\n-    return error;\n-  }\n-\n-  // Write the object size\n-  BSON::write_int32((serialized_object), object_size);  \n-\n-  // If we have 3 arguments\n-  if(args.Length() == 3) {\n-    // Local<Boolean> asBuffer = args[2]->ToBoolean();    \n-    Buffer *buffer = Buffer::New(serialized_object, object_size);\n-    // Release the serialized string\n-    free(serialized_object);\n-    return scope.Close(buffer->handle_);\n-  } else {\n-    // Encode the string (string - null termiating character)\n-    Local<Value> bin_value = Encode(serialized_object, object_size, BINARY)->ToString();\n-    // Return the serialized content\n-    return bin_value;    \n-  }  \n-}\n",
					"match": false,
					"packageHash": "75ca7686741d9819578606c97f631e20bad2121af6b3966d8b6e0dc03e17a7b4",
					"size": 93311,
					"sourceHash": "3bbf33024abd0bbd372cf8d602e8323759fdd165640ea5b8822dd862932a142e",
					"status": "content"
				},
				"external-libs/bson/build/.wafpickle-7": {
					"match": false,
					"packageHash": "a91308a524e47c8079aa5497e816dbd038433033c26fec1722efd6416931b9ec",
					"size": 975,
					"status": "missing-in-source"
				},
				"external-libs/bson/test/test_bson.js": {
					"match": false,
					"packageHash": "bcd6e36821d635eb4ab27c30f73f1673a7354d36634dbe30798bf69a3cd3be27",
					"size": 17358,
					"status": "missing-in-source"
				},
				"external-libs/bson/test/test_full_bson.js": {
					"match": false,
					"packageHash": "8b2c12b54a99aaf7f18b58f52084f9a3f27f3dde4c195fb70261ee4f69773ae4",
					"size": 8088,
					"status": "missing-in-source"
				},
				"external-libs/bson/test/test_stackless_bson.js": {
					"match": false,
					"packageHash": "4735bedcb17acec2df8f375f780a90a4ec24226866cb750919b847e0066be75d",
					"size": 5033,
					"status": "missing-in-source"
				},
				"install.js": {
					"diff": "--- published/install.js\n+++ rebuilt/install.js\n@@ -10,7 +10,6 @@\n // Check if we want to build the native code\n var build_native = process.env['npm_package_config_native'] != null ? process.env['npm_package_config_native'] : 'false';\n build_native = build_native == 'true' ? true : false;\n-\n // If we are building the native bson extension ensure we use gmake if available\n if(build_native) {\n   // Check if we need to use gmake\n",
					"match": false,
					"packageHash": "955347cbab86146af5f817e5d6c514338c51e8cb1bc5c48de2b7df001ce98910",
					"size": 1565,
					"sourceHash": "773466260a06c5ce4dfabbe8530bccd1def293efcda3c09ad1dea99915efb931",
					"status": "content"
				},
				"lib/mongodb/admin.js": {
					"diff": "--- published/lib/mongodb/admin.js\n+++ rebuilt/lib/mongodb/admin.js\n@@ -13,6 +13,8 @@\n  * @return {Function} Constructor for Admin type.\n  */\n function Admin(db) {  \n+  if(!(this instanceof Admin)) return new Admin(db);\n+  \n   this.db = db;\n };\n \n@@ -46,6 +48,29 @@\n }\n \n /**\n+ * Retrieve this db's server status.\n+ *\n+ * @param {Function} callback returns the server status.\n+ * @return {null}\n+ * @api public\n+ */\n+Admin.prototype.serverStatus = function(callback) {\n+  var self = this;\n+\n+  this.command({serverStatus: 1}, function(err, result) {\n+    if (err == null && result.documents[0].ok == 1) {\n+      callback(null, result.documents[0]);\n+    } else {\n+      if (err) {\n+        callback(err, false);\n+      } else {\n+        callback(self.wrap(result.documents[0]), false);\n+      }\n+    }\n+  });\n+};\n+\n+/**\n  * Retrieve the current profiling Level for MongoDB\n  * \n  * @param {Function} callback Callback function of format `function(err, result) {}`.\n@@ -141,17 +166,26 @@\n  * Add a user to the MongoDB server, if the user exists it will\n  * overwrite the current password\n  *\n+ * Options\n+ *  - **safe** {true | {w:n, wtimeout:n} | {fsync:true}, default:false}, executes with a getLastError command returning the results of the command on MongoDB.\n+ *\n  * @param {String} username The user name for the authentication.\n  * @param {String} password The password for the authentication.\n+ * @param {Object} [options] additional options during update.\n  * @param {Function} callback Callback function of format `function(err, result) {}`.\n  * @return {null} Returns no result\n  * @api public\n  */\n-Admin.prototype.addUser = function(username, password, callback) {\n+Admin.prototype.addUser = function(username, password, options, callback) {\n+  var self = this;\n+  var args = Array.prototype.slice.call(arguments, 2);\n+  callback = args.pop();\n+  options = args.length ? args.shift() : {};\n+\n   var self = this;\n   var databaseName = this.db.databaseName;\n   this.db.databaseName = 'admin';\n-  this.db.addUser(username, password, function(err, result) {\n+  this.db.addUser(username, password, options, function(err, result) {\n     self.db.databaseName = databaseName;\n     return callback(err, result);\n   })  \n@@ -160,16 +194,25 @@\n /**\n  * Remove a user from the MongoDB server\n  *\n+ * Options\n+ *  - **safe** {true | {w:n, wtimeout:n} | {fsync:true}, default:false}, executes with a getLastError command returning the results of the command on MongoDB.\n+ *\n  * @param {String} username The user name for the authentication.\n+ * @param {Object} [options] additional options during update.\n  * @param {Function} callback Callback function of format `function(err, result) {}`.\n  * @return {null} Returns no result\n  * @api public\n  */\n-Admin.prototype.removeUser = function(username, callback) {\n+Admin.prototype.removeUser = function(username, options, callback) {\n+  var self = this;\n+  var args = Array.prototype.slice.call(arguments, 1);\n+  callback = args.pop();\n+  options = args.length ? args.shift() : {};\n+\n   var self = this;\n   var databaseName = this.db.databaseName;\n   this.db.databaseName = 'admin';\n-  this.db.removeUser(username, function(err, result) {\n+  this.db.removeUser(username, options, function(err, result) {\n     self.db.databaseName = databaseName;\n     return callback(err, result);\n   })  \n@@ -319,6 +362,29 @@\n }\n",
					"match": false,
					"packageHash": "64c0e811e0a64542c72bd9ffab715180058990397fa059e02875e3293a88d517",
					"size": 9814,
					"sourceHash": "a037f0b049bc29d04bfc3ee04e7483bbe7b8750c68b95e6c0b45b94b67897af1",
					"status": "content"
				},
				"lib/mongodb/bson/binary.js": {
					"match": false,
					"packageHash": "7818c39749ea6296d188c681fc731088c2ca21b251d5fa5b54542a73c86ace78",
					"size": 4576,
					"status": "missing-in-source"
				},
				"lib/mongodb/bson/binary_parser.js": {
					"match": false,
					"packageHash": "ef9e3cac450d49f4d2f5879017e6bff297710d096dbeb8a47d5082db39f38b38",
					"size": 12297,
					"status": "missing-in-source"
				},
				"lib/mongodb/bson/binary_utils.js": {
					"match": false,
					"packageHash": "f9837d9b2dd787c6e452579657fb60e59d0831cf8a0b5d9cf03ab20c92d242d5",
					"size": 812,
					"status": "missing-in-source"
				},
				"lib/mongodb/bson/bson.js": {
					"match": false,
					"packageHash": "4005f9490ca7015224125b9f12e872c6e2fe5c3cd8aad9e92b75cdeac27a489c",
					"size": 48284,
					"status": "missing-in-source"
				},
				"lib/mongodb/bson/code.js": {
					"match": false,
					"packageHash": "70d048505f75daec9b808d37a89a08ee04b3f3acd974bfc31e925de36b2da156",
					"size": 500,
					"status": "missing-in-source"
				},
				"lib/mongodb/bson/db_ref.js": {
					"match": false,
					"packageHash": "ac392fd7facba12665adc47ab312951a45a8c7623d83064d67e8ba36053c8de7",
					"size": 651,
					"status": "missing-in-source"
				},
				"lib/mongodb/bson/double.js": {
					"match": false,
					"packageHash": "04f7f65c8bf87a6945b2400311c753f2470f5ae4dadeac7afae15eb36257018e",
					"size": 570,
					"status": "missing-in-source"
				},
				"lib/mongodb/bson/float_parser.js": {
					"match": false,
					"packageHash": "5b6b4382617418d5310f2a0565db42b33b957eb2c5c478fc428fdd82ee1d882d",
					"size": 3844,
					"status": "missing-in-source"
				},
				"lib/mongodb/bson/long.js": {
					"match": false,
					"packageHash": "ff0fb4b4e6b51c92009135cba0b5ae0b534f6eadea96e83e3925c5fd8e3214eb",
					"size": 23021,
					"status": "missing-in-source"
				},
				"lib/mongodb/bson/max_key.js": {
					"match": false,
					"packageHash": "168918bf5dcb8347430e080ce81fd20e800943a825ab18884ec7bbb6b77f944b",
					"size": 203,
					"status": "missing-in-source"
				},
				"lib/mongodb/bson/min_key.js": {
					"match": false,
					"packageHash": "200ff31a92036dac1070053ff5cce971720eb30c3825b5723d2c33e2b0179489",
					"size": 201,
					"status": "missing-in-source"
				},
				"lib/mongodb/bson/objectid.js": {
					"match": false,
					"packageHash": "b6de45fe5996291428a959ccb00f0caae6966a257524ef1cafa408f68cef85bd",
					"size": 6549,
					"status": "missing-in-source"
				},
				"lib/mongodb/bson/symbol.js": {
					"match": false,
					"packageHash": "2bfc540ad1fe70e8611a0597b422f7f0ca7c2fd126e2739cf47416e98de49506",
					"size": 761,
					"status": "missing-in-source"
				},
				"lib/mongodb/bson/timestamp.js": {
					"match": false,
					"packageHash": "614f364ef74c5ca7bd040dbecdbf6a56ac839738cb82167090cae74eac897f65",
					"size": 24231,
					"status": "missing-in-source"
				},
				"lib/mongodb/collection.js": {
					"diff": "--- published/lib/mongodb/collection.js\n+++ rebuilt/lib/mongodb/collection.js\n@@ -7,12 +7,9 @@\n   , DeleteCommand = require('./commands/delete_command').DeleteCommand\n   , UpdateCommand = require('./commands/update_command').UpdateCommand\n   , DbCommand = require('./commands/db_command').DbCommand\n-  , BinaryParser = require('./bson/binary_parser').BinaryParser\n-  , ObjectID = require('./bson/objectid').ObjectID\n-  , Code = require('./bson/code').Code\n+  , ObjectID = require('bson').ObjectID\n+  , Code = require('bson').Code\n   , Cursor = require('./cursor').Cursor\n-  , debug = require('util').debug\n-  , inspect = require('util').inspect\n   , utils = require('./utils');\n \n /**\n@@ -44,11 +41,13 @@\n  * @return {Object} a collection instance.\n  */\n function Collection (db, collectionName, pkFactory, options) {\n+  if(!(this instanceof Collection)) return new Collection(db, collectionName, pkFactory, options);\n+  \n   checkCollectionName(collectionName);\n \n   this.db = db;\n   this.collectionName = collectionName;\n-  this.internalHint;\n+  this.internalHint = null;\n   this.opts = options != null && ('object' === typeof options) ? options : {};\n   this.slaveOk = options == null || options.slaveOk == null ? db.slaveOk : options.slaveOk;\n   this.serializeFunctions = options == null || options.serializeFunctions == null ? db.serializeFunctions : options.serializeFunctions;\n@@ -57,7 +56,7 @@\n     ? ObjectID\n     : pkFactory;\n     \n-  var self = this\n+  var self = this;\n   Object.defineProperty(this, \"hint\", {\n       enumerable: true\n     , get: function () {\n@@ -67,7 +66,7 @@\n         this.internalHint = normalizeHintField(v);\n       }\n   });\n-};\n+}\n \n /**\n  * Inserts a single document or a an array of documents into MongoDB.\n@@ -151,6 +150,8 @@\n   errorOptions = errorOptions == null && this.opts.safe != null ? this.opts.safe : errorOptions;\n   errorOptions = errorOptions == null && this.db.strict != null ? this.db.strict : errorOptions;\n \n+  // If we have a write concern set and no callback throw error\n+  if(errorOptions && errorOptions['safe'] != false && typeof callback !== 'function') throw new Error(\"safe cannot be used without a callback\");\n   // Execute the command, do not add a callback as it's async\n   if (options && options.safe || this.opts.safe != null || this.db.strict) {\n     // Insert options\n@@ -172,9 +173,9 @@\n       error = error && error.documents;\n       if(!callback) return;      \n \n-      if (err) {\n+      if(err) {\n         callback(err);\n-      } else if (error[0].err) {\n+      } else if(error[0].err || error[0].errmsg) {\n         callback(self.db.wrap(error[0]));\n       } else {\n         callback(null, error[0].n);\n@@ -255,7 +256,7 @@\n     var doc = docs[index];\n     \n     // Add id to each document if it's not already defined\n-    if (!(doc instanceof Buffer) && !doc['_id'] && self.db.forceServerObjectId != true) {\n+    if (!(Buffer.isBuffer(doc)) && doc['_id'] == null && self.db.forceServerObjectId != true) {\n       doc['_id'] = self.pkFactory.createPk();\n     }\n \n@@ -266,11 +267,13 @@\n   var errorOptions = options.safe != null ? options.safe : null;\n   errorOptions = errorOptions == null && self.opts.safe != null ? self.opts.safe : errorOptions;\n   errorOptions = errorOptions == null && self.db.strict != null ? self.db.strict : errorOptions;\n+\n+  // If we have a write concern set and no callback throw error\n+  if(errorOptions && errorOptions['safe'] != false && typeof callback !== 'function') throw new Error(\"safe cannot be used without a callback\");\n   \n   // Default command options\n   var commandOptions = {};    \n   // If safe is defined check for error message\n-  // if(options != null && (options.safe == true || this.db.strict == true || this.opts.safe == true)) {\n   if(errorOptions && errorOptions != false) {\n     // Insert options\n     commandOptions['read'] = false;\n@@ -294,7 +297,7 @@\n \n       if (err) {\n         callback(err);\n-      } else if (error[0].err) {\n",
					"match": false,
					"packageHash": "09431587f31455fd4962777b18e8cf1c5c7c6d9fab245ca4583a5f5e25d76d24",
					"size": 53021,
					"sourceHash": "a3563efa6644f7f9f404b47e0386f1ca647574fd634b04b427ee5ef9c05c8b56",
					"status": "content"
				},
				"lib/mongodb/commands/base_command.js": {
					"diff": "--- published/lib/mongodb/commands/base_command.js\n+++ rebuilt/lib/mongodb/commands/base_command.js\n@@ -1,7 +1,3 @@\n-var BinaryParser = require('../bson/binary_parser').BinaryParser,\n-  debug = require('util').debug,\n-  inspect = require('util').inspect;\n-\n /**\n   Base object used for common functionality\n **/\n",
					"match": false,
					"packageHash": "4da764d9a6b2c9ef7ffb01aa2018388739e12237d0974f8f5b6a1632085caad1",
					"size": 774,
					"sourceHash": "3b9d5bf8d0033df72262cdd5c60feb91a4052597696bb1123bae0beeda3f9aa9",
					"status": "content"
				},
				"lib/mongodb/commands/db_command.js": {
					"diff": "--- published/lib/mongodb/commands/db_command.js\n+++ rebuilt/lib/mongodb/commands/db_command.js\n@@ -1,9 +1,7 @@\n var QueryCommand = require('./query_command').QueryCommand,\n   InsertCommand = require('./insert_command').InsertCommand,\n   inherits = require('util').inherits,\n-  debug = require('util').debug,\n-  crypto = require('crypto'),\n-  inspect = require('util').inspect;\n+  crypto = require('crypto');\n \n /**\n   Db Command\n@@ -94,9 +92,11 @@\n };\n \n DbCommand.createGetLastErrorCommand = function(options, db) {\n-  var args = Array.prototype.slice.call(arguments, 0);\n-  db = args.pop();\n-  options = args.length ? args.shift() : {};\n+\n+  if (typeof db === 'undefined') {\n+    db =  options;\n+    options = {};\n+  }\n   // Final command \n   var command = {'getlasterror':1};\n   // If we have an options Object let's merge in the fields (fsync/wtimeout/w)\n@@ -124,7 +124,7 @@\n   var fieldHash = {};\n   var indexes = [];\n   var keys;\n-\n+  \n   // Get all the fields accordingly\n   if (fieldOrSpec.constructor === String) {             // 'type'\n     indexes.push(fieldOrSpec + '_' + 1);\n@@ -201,3 +201,7 @@\n DbCommand.createAdminDbCommand = function(db, command_hash) {\n   return new DbCommand(db, \"admin.\" + DbCommand.SYSTEM_COMMAND_COLLECTION, QueryCommand.OPTS_NO_CURSOR_TIMEOUT, 0, -1, command_hash, null);\n };\n+\n+DbCommand.createDbSlaveOkCommand = function(db, command_hash, options) {\n+  return new DbCommand(db, db.databaseName + \".\" + DbCommand.SYSTEM_COMMAND_COLLECTION, QueryCommand.OPTS_NO_CURSOR_TIMEOUT | QueryCommand.OPTS_SLAVE, 0, -1, command_hash, null, options);\n+};\n\\ No newline at end of file\n",
					"match": false,
					"packageHash": "ed64dfb97a0578fb29dc05597b143b7813067b5064f1988c4cfb476a97f836bd",
					"size": 8991,
					"sourceHash": "6f41be547a863b0b0169eba3b2ecc8d56a3ca07357817dae0fd22c2063b2d8ed",
					"status": "content"
				},
				"lib/mongodb/commands/delete_command.js": {
					"diff": "--- published/lib/mongodb/commands/delete_command.js\n+++ rebuilt/lib/mongodb/commands/delete_command.js\n@@ -1,7 +1,5 @@\n var BaseCommand = require('./base_command').BaseCommand,\n-  inherits = require('util').inherits,\n-  debug = require('util').debug, \n-  inspect = require('util').inspect;\n+  inherits = require('util').inherits;\n \n /**\n   Insert Document Command\n@@ -11,7 +9,7 @@\n \n   // Validate correctness off the selector\n   var object = selector;\n-  if(object instanceof Buffer) {\n+  if(Buffer.isBuffer(object)) {\n     var object_size = object[0] | object[1] << 8 | object[2] << 16 | object[3] << 24;        \n     if(object_size != object.length)  {\n       var error = new Error(\"delete raw message size does not match message header size [\" + object.length + \"] != [\" + object_size + \"]\");\n@@ -40,7 +38,7 @@\n */\n DeleteCommand.prototype.toBinary = function() {\n   // Calculate total length of the document\n-  var totalLengthOfCommand = 4 + Buffer.byteLength(this.collectionName) + 1 + 4 + this.db.bson.calculateObjectSize(this.selector) + (4 * 4);\n+  var totalLengthOfCommand = 4 + Buffer.byteLength(this.collectionName) + 1 + 4 + this.db.bson.calculateObjectSize(this.selector, false, true) + (4 * 4);\n   // Let's build the single pass buffer command\n   var _index = 0;\n   var _command = new Buffer(totalLengthOfCommand);\n@@ -92,7 +90,7 @@\n \n   // Serialize the selector\n   // If we are passing a raw buffer, do minimal validation\n-  if(this.selector instanceof Buffer) {\n+  if(Buffer.isBuffer(this.selector)) {\n     documentLength = this.selector.length;\n     // Copy the data into the current buffer\n     this.selector.copy(_command, _index);\n",
					"match": false,
					"packageHash": "d734996eca9347a8f9564ec48c0acecbd117b655a3b67ff2a016e5d45cb46479",
					"size": 3962,
					"sourceHash": "4e4d0f12685765c7a6eb62947f5f73432a07453a99925a1a0e1a63d53d4d218a",
					"status": "content"
				},
				"lib/mongodb/commands/get_more_command.js": {
					"diff": "--- published/lib/mongodb/commands/get_more_command.js\n+++ rebuilt/lib/mongodb/commands/get_more_command.js\n@@ -1,8 +1,6 @@\n var BaseCommand = require('./base_command').BaseCommand,\n   inherits = require('util').inherits,\n-  debug = require('util').debug,\n-  inspect = require('util').inspect,\n-  binaryutils = require('../bson/binary_utils');\n+  binaryutils = require('../utils');\n \n /**\n   Get More Document Command\n",
					"match": false,
					"packageHash": "a63794a32835772baa22edb81e8af920c4bff657c27444ad8ea62d8635f62181",
					"size": 2968,
					"sourceHash": "9c9ec06d4ad6306c6823afb357aa2f5a41fffc9ac401894f0ba240e13b72a592",
					"status": "content"
				},
				"lib/mongodb/commands/insert_command.js": {
					"diff": "--- published/lib/mongodb/commands/insert_command.js\n+++ rebuilt/lib/mongodb/commands/insert_command.js\n@@ -1,7 +1,5 @@\n var BaseCommand = require('./base_command').BaseCommand,\n-  inherits = require('util').inherits,\n-  debug = require('util').debug,\n-  inspect = require('util').inspect;\n+  inherits = require('util').inherits;\n \n /**\n   Insert Document Command\n@@ -37,7 +35,7 @@\n InsertCommand.OP_INSERT =\t2002;\n \n InsertCommand.prototype.add = function(document) {\n-  if(document instanceof Buffer) {\n+  if(Buffer.isBuffer(document)) {\n     var object_size = document[0] | document[1] << 8 | document[2] << 16 | document[3] << 24;    \n     if(object_size != document.length)  {\n       var error = new Error(\"insert raw message size does not match message header size [\" + document.length + \"] != [\" + object_size + \"]\");\n@@ -63,14 +61,14 @@\n   var totalLengthOfCommand = 4 + Buffer.byteLength(this.collectionName) + 1 + (4 * 4);\n   // var docLength = 0\n   for(var i = 0; i < this.documents.length; i++) {\n-    if(this.documents[i] instanceof Buffer) {\n+    if(Buffer.isBuffer(this.documents[i])) {\n       totalLengthOfCommand += this.documents[i].length;\n     } else {\n       // Calculate size of document\n-      totalLengthOfCommand += this.db.bson.calculateObjectSize(this.documents[i], this.serializeFunctions);      \n+      totalLengthOfCommand += this.db.bson.calculateObjectSize(this.documents[i], this.serializeFunctions, true);\n     }\n   }\n-    \n+  \n   // Let's build the single pass buffer command\n   var _index = 0;\n   var _command = new Buffer(totalLengthOfCommand);\n@@ -119,7 +117,7 @@\n \n     // Serialize the selector\n     // If we are passing a raw buffer, do minimal validation\n-    if(object instanceof Buffer) {      \n+    if(Buffer.isBuffer(object)) {\n       documentLength = object.length;\n       // Copy the data into the current buffer\n       object.copy(_command, _index);\n",
					"match": false,
					"packageHash": "9e3ae657a998cec0267b72854841cfb0d284f8b5288f00b50e35e8177b529aa8",
					"size": 5161,
					"sourceHash": "90970dad921cc155b641d84092b4cee8d1b9f7486e4199685a856dc4fb4ed19d",
					"status": "content"
				},
				"lib/mongodb/commands/kill_cursor_command.js": {
					"diff": "--- published/lib/mongodb/commands/kill_cursor_command.js\n+++ rebuilt/lib/mongodb/commands/kill_cursor_command.js\n@@ -1,8 +1,6 @@\n var BaseCommand = require('./base_command').BaseCommand,\n   inherits = require('util').inherits,\n-  binaryutils = require('../bson/binary_utils'),\n-  debug = require('util').debug,\n-  inspect = require('util').inspect;\n+  binaryutils = require('../utils');\n \n /**\n   Insert Document Command\n",
					"match": false,
					"packageHash": "9936ea981ab114f879b79fd0debb73194ffe4315f27e356a60cbe02c403e0ab8",
					"size": 3427,
					"sourceHash": "d01af72568b490f4e88bb07da854ed5b050494e55e90b60b8b3d11561f8ffa5e",
					"status": "content"
				},
				"lib/mongodb/commands/query_command.js": {
					"diff": "--- published/lib/mongodb/commands/query_command.js\n+++ rebuilt/lib/mongodb/commands/query_command.js\n@@ -1,8 +1,5 @@\n var BaseCommand = require('./base_command').BaseCommand,\n-  BinaryParser = require('../bson/binary_parser').BinaryParser,\n-  inherits = require('util').inherits,\n-  debug = require('util').debug,\n-  inspect = require('util').inspect;\n+  inherits = require('util').inherits;\n \n /**\n   Insert Document Command\n@@ -11,20 +8,21 @@\n   BaseCommand.call(this);\n \n   // Validate correctness off the selector\n-  var object = query;\n-  if(object instanceof Buffer) {\n-    var object_size = object[0] | object[1] << 8 | object[2] << 16 | object[3] << 24;    \n-    if(object_size != object.length)  {\n+  var object = query,\n+    object_size;\n+  if(Buffer.isBuffer(object)) {\n+    object_size = object[0] | object[1] << 8 | object[2] << 16 | object[3] << 24;\n+    if(object_size != object.length) {\n       var error = new Error(\"query selector raw message size does not match message header size [\" + object.length + \"] != [\" + object_size + \"]\");\n       error.name = 'MongoError';\n       throw error;\n     }\n   }\n \n-  var object = returnFieldSelector;\n-  if(object instanceof Buffer) {\n-    var object_size = object[0] | object[1] << 8 | object[2] << 16 | object[3] << 24;    \n-    if(object_size != object.length)  {\n+  object = returnFieldSelector;\n+  if(Buffer.isBuffer(object)) {\n+    object_size = object[0] | object[1] << 8 | object[2] << 16 | object[3] << 24;\n+    if(object_size != object.length) {\n       var error = new Error(\"query fields raw message size does not match message header size [\" + object.length + \"] != [\" + object_size + \"]\");\n       error.name = 'MongoError';\n       throw error;\n@@ -45,7 +43,7 @@\n   // Let us defined on a command basis if we want functions to be serialized or not\n   if(options['serializeFunctions'] != null && options['serializeFunctions']) {\n     this.serializeFunctions = true;\n-  }  \n+  }\n };\n \n inherits(QueryCommand, BaseCommand);\n@@ -66,18 +64,18 @@\n QueryCommand.prototype.toBinary = function() {\n   var totalLengthOfCommand = 0;\n   // Calculate total length of the document\n-  if(this.query instanceof Buffer) {\n+  if(Buffer.isBuffer(this.query)) {\n     totalLengthOfCommand = 4 + Buffer.byteLength(this.collectionName) + 1 + 4 + 4 + this.query.length + (4 * 4);    \n   } else {\n-    totalLengthOfCommand = 4 + Buffer.byteLength(this.collectionName) + 1 + 4 + 4 + this.db.bson.calculateObjectSize(this.query, this.serializeFunctions) + (4 * 4);    \n+    totalLengthOfCommand = 4 + Buffer.byteLength(this.collectionName) + 1 + 4 + 4 + this.db.bson.calculateObjectSize(this.query, this.serializeFunctions, true) + (4 * 4);    \n   }\n   \n   // Calculate extra fields size\n-  if(this.returnFieldSelector != null && !(this.returnFieldSelector instanceof Buffer))  {\n+  if(this.returnFieldSelector != null && !(Buffer.isBuffer(this.returnFieldSelector)))  {\n     if(Object.keys(this.returnFieldSelector).length > 0) {\n-      totalLengthOfCommand += this.db.bson.calculateObjectSize(this.returnFieldSelector, this.serializeFunctions);\n+      totalLengthOfCommand += this.db.bson.calculateObjectSize(this.returnFieldSelector, this.serializeFunctions, true);\n     }\n-  } else if(this.returnFieldSelector instanceof Buffer) {\n+  } else if(Buffer.isBuffer(this.returnFieldSelector)) {\n     totalLengthOfCommand += this.returnFieldSelector.length;\n   }\n \n@@ -144,7 +142,7 @@\n   var object = this.query;\n \n   // Serialize the selector\n-  if(object instanceof Buffer) {\n+  if(Buffer.isBuffer(object)) {\n     documentLength = object.length;\n     // Copy the data into the current buffer\n     object.copy(_command, _index);\n@@ -164,7 +162,7 @@\n   _command[_index - 1] = 0;    \n \n   // Push field selector if available\n-  if(this.returnFieldSelector != null && !(this.returnFieldSelector instanceof Buffer))  {\n+  if(this.returnFieldSelector != null && !(Buffer.isBuffer(this.returnFieldSelector)))  {\n     if(Object.keys(this.returnFieldSelector).length > 0) {\n       var documentLength = this.db.bson.serializeWithBufferAndIndex(this.returnFieldSelector, this.checkKeys, _command, _index, this.serializeFunctions) - _index + 1;\n       // Write the length to the document\n@@ -177,7 +175,7 @@\n       // Add terminating 0 for the object\n       _command[_index - 1] = 0;    \n     }\n-  } if(this.returnFieldSelector != null && this.returnFieldSelector instanceof Buffer)  {\n+  } if(this.returnFieldSelector != null && Buffer.isBuffer(this.returnFieldSelector))  {\n     // Document binary length\n",
					"match": false,
					"packageHash": "bfad2d55959c16c44eb8abd889e94b20967016be777de3a858fdad393d4772a3",
					"size": 8396,
					"sourceHash": "42e8d9b5c0118fe3e93e96f00a9998faafbc79b058168904ec3341353c71240b",
					"status": "content"
				},
				"lib/mongodb/commands/update_command.js": {
					"diff": "--- published/lib/mongodb/commands/update_command.js\n+++ rebuilt/lib/mongodb/commands/update_command.js\n@@ -1,7 +1,5 @@\n var BaseCommand = require('./base_command').BaseCommand,\n-  inherits = require('util').inherits,\n-  debug = require('util').debug,\n-  inspect = require('util').inspect;\n+  inherits = require('util').inherits;\n \n /**\n   Update Document Command\n@@ -10,7 +8,7 @@\n   BaseCommand.call(this);\n \n   var object = spec;\n-  if(object instanceof Buffer) {\n+  if(Buffer.isBuffer(object)) {\n     var object_size = object[0] | object[1] << 8 | object[2] << 16 | object[3] << 24;    \n     if(object_size != object.length)  {\n       var error = new Error(\"update spec raw message size does not match message header size [\" + object.length + \"] != [\" + object_size + \"]\");\n@@ -20,7 +18,7 @@\n   }\n \n   var object = document;\n-  if(object instanceof Buffer) {\n+  if(Buffer.isBuffer(object)) {\n     var object_size = object[0] | object[1] << 8 | object[2] << 16 | object[3] << 24;    \n     if(object_size != object.length)  {\n       var error = new Error(\"update document raw message size does not match message header size [\" + object.length + \"] != [\" + object_size + \"]\");\n@@ -65,8 +63,8 @@\n */\n UpdateCommand.prototype.toBinary = function() {\n   // Calculate total length of the document\n-  var totalLengthOfCommand = 4 + Buffer.byteLength(this.collectionName) + 1 + 4 + this.db.bson.calculateObjectSize(this.spec, false) +\n-      this.db.bson.calculateObjectSize(this.document, this.serializeFunctions) + (4 * 4);\n+  var totalLengthOfCommand = 4 + Buffer.byteLength(this.collectionName) + 1 + 4 + this.db.bson.calculateObjectSize(this.spec, false, true) +\n+      this.db.bson.calculateObjectSize(this.document, this.serializeFunctions, true) + (4 * 4);\n \n   // Let's build the single pass buffer command\n   var _index = 0;\n@@ -122,7 +120,7 @@\n \n   // Serialize the selector\n   // If we are passing a raw buffer, do minimal validation\n-  if(object instanceof Buffer) {\n+  if(Buffer.isBuffer(object)) {\n     var object_size = object[0] | object[1] << 8 | object[2] << 16 | object[3] << 24;\n     if(object_size != object.length) throw new Error(\"raw message size does not match message header size [\" + object.length + \"] != [\" + object_size + \"]\");\n     documentLength = object.length;\n@@ -148,7 +146,7 @@\n \n   // Serialize the document\n   // If we are passing a raw buffer, do minimal validation\n-  if(object instanceof Buffer) {\n+  if(Buffer.isBuffer(object)) {\n     var object_size = object[0] | object[1] << 8 | object[2] << 16 | object[3] << 24;\n     if(object_size != object.length) throw new Error(\"raw message size does not match message header size [\" + object.length + \"] != [\" + object_size + \"]\");\n     documentLength = object.length;\n",
					"match": false,
					"packageHash": "89212ccae8e11b6660e27fc21c12158aee8108ff880f7b81128b344fea747977",
					"size": 6701,
					"sourceHash": "1e9efcade1290911d79395a36a74e0f4bdfc7608c739482547738ac544d537d3",
					"status": "content"
				},
				"lib/mongodb/connection/connection.js": {
					"diff": "--- published/lib/mongodb/connection/connection.js\n+++ rebuilt/lib/mongodb/connection/connection.js\n@@ -1,11 +1,9 @@\n var utils = require('./connection_utils'),\n   inherits = require('util').inherits,\n   net = require('net'),\n-  debug = require('util').debug,\n-  inspect = require('util').inspect,\n   EventEmitter = require('events').EventEmitter,\n   inherits = require('util').inherits,\n-  binaryutils = require('../bson/binary_utils'),\n+  binaryutils = require('../utils'),\n   tls = require('tls');\n \n var Connection = exports.Connection = function(id, socketOptions) {\n@@ -39,17 +37,16 @@\n }\n \n // Set max bson size\n-Connection.DEFAULT_MAX_BSON_SIZE = 4 * 1024 * 1024 * 4 * 3;\n+Connection.DEFAULT_MAX_BSON_SIZE = 1024 * 1024 * 4;\n \n // Inherit event emitter so we can emit stuff wohoo\n-// inherits(Connection, SimpleEmitter);\n inherits(Connection, EventEmitter);\n \n Connection.prototype.start = function() {\n   // If we have a normal connection\n   if(this.socketOptions.ssl) {\n     // Create a new stream\n-    this.connection = new net.Stream();    \n+    this.connection = new net.Socket();    \n     // Set options on the socket\n     this.connection.setTimeout(this.socketOptions.timeout);\n     // Work around for 0.4.X\n@@ -62,9 +59,9 @@\n         this.connection.setKeepAlive(false);\n       }         \n     }\n-\n+    \n     // Set up pair for tls with server, accept self-signed certificates as well\n-    this.pair = tls.createSecurePair(false);\n+    var pair = this.pair = tls.createSecurePair(false);\n     // Set up encrypted streams\n     this.pair.encrypted.pipe(this.connection);\n     this.connection.pipe(this.pair.encrypted);\n@@ -76,7 +73,7 @@\n     this.pair.cleartext.on(\"data\", createDataHandler(this));\n     // Add handlers\n     this.connection.on(\"error\", errorHandler(this));\n-    // Add all handlers to the socket to manage it\n+    // this.connection.on(\"connect\", connectHandler(this));\n     this.connection.on(\"end\", endHandler(this));\n     this.connection.on(\"timeout\", timeoutHandler(this));\n     this.connection.on(\"drain\", drainHandler(this));\n@@ -84,10 +81,7 @@\n     // Start socket\n     this.connection.connect(this.socketOptions.port, this.socketOptions.host);\n   } else {\n-    // // Create a new stream\n-    // this.connection = new net.Stream();\n-    // // Create new connection instance\n-    // this.connection = new net.Socket();\n+    // Create new connection instance\n     this.connection = net.createConnection(this.socketOptions.port, this.socketOptions.host);\n     // Set options on the socket\n     this.connection.setTimeout(this.socketOptions.timeout);\n@@ -113,8 +107,6 @@\n     this.connection.on(\"timeout\", timeoutHandler(this));\n     this.connection.on(\"drain\", drainHandler(this));\n     this.connection.on(\"close\", closeHandler(this));\n-    // // Start socket\n-    // this.connection.connect(this.socketOptions.port, this.socketOptions.host);\n   }  \n }\n \n@@ -130,11 +122,13 @@\n     if(Array.isArray(command)) {\n       for(var i = 0; i < command.length; i++) {\n         var binaryCommand = command[i].toBinary()\n+        if(binaryCommand.length > this.maxBsonSize) return callback(new Error(\"Document exceeds maximal allowed bson size of \" + this.maxBsonSize + \" bytes\"));\n         if(this.logger != null && this.logger.doDebug) this.logger.debug(\"writing command to mongodb\", binaryCommand);\n         var r = this.writeSteam.write(binaryCommand);\n       }\n     } else {\n       var binaryCommand = command.toBinary()\n+      if(binaryCommand.length > this.maxBsonSize) return callback(new Error(\"Document exceeds maximal allowed bson size of \" + this.maxBsonSize + \" bytes\"));\n       if(this.logger != null && this.logger.doDebug) this.logger.debug(\"writing command to mongodb\", binaryCommand);\n       var r = this.writeSteam.write(binaryCommand);\n     }    \n@@ -371,7 +365,6 @@\n \n var timeoutHandler = function(self) {  \n   return function() {\n-    // console.log(\"--------------------------------------------- timeoutHandler\")\n     self.emit(\"timeout\", {err: 'connection to [' + self.socketOptions.host + ':' + self.socketOptions.port + '] timed out'}, self);\n   }\n }\n@@ -383,7 +376,6 @@\n",
					"match": false,
					"packageHash": "b258e76ba1bcd22060286f3c69029e0f10eb295d0234e9dff94de7f33368a160",
					"size": 16368,
					"sourceHash": "a05c2fb8cfdcc1099cb7e68c0b153a5789d48a77dbfe1a1d3b78f940f008ee46",
					"status": "content"
				},
				"lib/mongodb/connection/connection_pool.js": {
					"diff": "--- published/lib/mongodb/connection/connection_pool.js\n+++ rebuilt/lib/mongodb/connection/connection_pool.js\n@@ -18,6 +18,7 @@\n   this.bson = bson;\n   // PoolSize is always + 1 for special reserved \"measurment\" socket (like ping, stats etc)\n   this.poolSize = poolSize;\n+  this.minPoolSize = Math.floor(this.poolSize / 2) + 1;\n   \n   // Set default settings for the socket options\n   utils.setIntegerParameter(this.socketOptions, 'timeout', 0);\n@@ -31,9 +32,7 @@\n   utils.setIntegerParameter(this.socketOptions, 'bufferSize', 0);  \n   \n   // Internal structures\n-  this.openConnections = [];\n-  this.connections = [];\n-  \n+  this.openConnections = [];  \n   // Assign connection id's\n   this.connectionId = 0;\n   \n@@ -69,15 +68,13 @@\n     connection.on(\"connect\", function(err, connection) {\n       // Add connection to list of open connections\n       _self.openConnections.push(connection);\n-      _self.connections.push(connection)\n-\n       // If the number of open connections is equal to the poolSize signal ready pool\n-      if(_self.connections.length === _self.poolSize && _self._poolState !== 'disconnected') {\n+      if(_self.openConnections.length === _self.poolSize && _self._poolState !== 'disconnected') {\n         // Set connected\n         _self._poolState = 'connected';\n         // Emit pool ready\n         _self.emit(\"poolReady\");\n-      } else if(_self.connections.length < _self.poolSize) {\n+      } else if(_self.openConnections.length < _self.poolSize) {\n         // We need to open another connection, make sure it's in the next\n         // tick so we don't get a cascade of errors\n         process.nextTick(function() {\n@@ -92,8 +89,7 @@\n     connection.on(\"error\", function(err, connection) {\n       numberOfErrors++;\n       // If we are already disconnected ignore the event\n-      if(connectionStatus == 'disconnected' && _self.listeners(\"error\").length > 0) {\n-      // if(connectionStatus == 'connected') {\n+      if(connectionStatus != 'disconnected' && _self.listeners(\"error\").length > 0) {\n         _self.emit(\"error\", err);        \n       }\n \n@@ -101,9 +97,8 @@\n       connectionStatus = 'disconnected';\n       // Set disconnected\n       _self._poolState = 'disconnected'; \n-      // Clean up\n-      _self.openConnections = [];    \n-      _self.connections = [];\n+      // Stop\n+      _self.stop();\n     });\n \n     // Close handler\n@@ -117,9 +112,8 @@\n       connectionStatus = 'disconnected';\n       // Set disconnected\n       _self._poolState = 'disconnected'; \n-      // Clean up\n-      _self.openConnections = [];    \n-      _self.connections = [];\n+      // Stop\n+      _self.stop();\n     });\n \n     // Timeout handler\n@@ -133,16 +127,14 @@\n       connectionStatus = 'disconnected';\n       // Set disconnected\n       _self._poolState = 'disconnected'; \n-      // Clean up\n-      _self.openConnections = [];    \n-      _self.connections = [];\n+      // Stop\n+      _self.stop();\n     });\n \n     // Parse error, needs a complete shutdown of the pool\n     connection.on(\"parseError\", function() {\n       // If we are already disconnected ignore the event\n       if(connectionStatus !== 'disconnected' && _self.listeners(\"parseError\").length > 0) {\n-      // if(connectionStatus == 'connected') {\n         _self.emit(\"parseError\", new Error(\"parseError occured\"));        \n       }\n       \n@@ -199,14 +191,12 @@\n   }\n \n   // Close all connections\n-  for(var i = 0; i < this.connections.length; i++) {\n-    this.connections[i].close();\n+  for(var i = 0; i < this.openConnections.length; i++) {\n+    this.openConnections[i].close();\n",
					"match": false,
					"packageHash": "234d3a718fe707cc0d652b72648e12dc1349ddfcbb59b4583bfabbd6e96d832f",
					"size": 7954,
					"sourceHash": "ccd192af58ec6c8b8d2fe094bf77ce695fca8f47f7e69c869489fadb0e9f00ab",
					"status": "content"
				},
				"lib/mongodb/connection/repl_set_servers.js": {
					"match": false,
					"packageHash": "090cbe1f3aae8928663e03e3e25bdb519aa21912b7f0c12bc873fb3d2fb335ce",
					"size": 38604,
					"status": "missing-in-source"
				},
				"lib/mongodb/connection/server.js": {
					"diff": "--- published/lib/mongodb/connection/server.js\n+++ rebuilt/lib/mongodb/connection/server.js\n@@ -2,11 +2,32 @@\n   DbCommand = require('../commands/db_command').DbCommand,\n   MongoReply = require('../responses/mongo_reply').MongoReply,\n   ConnectionPool = require('./connection_pool').ConnectionPool,\n-  SimpleEmitter = require('./simple_emitter').SimpleEmitter,\n-  MongoReply = require(\"../responses/mongo_reply\").MongoReply,\n+  EventEmitter = require('events').EventEmitter,\n   inherits = require('util').inherits;\n \n-var Server = exports.Server = function(host, port, options) {\n+/**\n+ * Class representing a single MongoDB Server connection\n+ *\n+ * Options\n+ *  - **readPreference** {String, default:null}, set's the read preference (Server.READ_PRIMAR, Server.READ_SECONDARY_ONLY, Server.READ_SECONDARY)\n+ *  - **ssl** {Boolean, default:false}, use ssl connection (needs to have a mongod server with ssl support)\n+ *  - **slaveOk** {Boolean, default:false}, legacy option allowing reads from secondary, use **readPrefrence** instead.\n+ *  - **poolSize** {Number, default:1}, number of connections in the connection pool, set to 1 as default for legacy reasons.\n+ *  - **socketOptions** {Object, default:null}, an object containing socket options to use (noDelay:(boolean), keepAlive:(number), timeout:(number))\n+ *  - **logger** {Object, default:null}, an object representing a logger that you want to use, needs to support functions debug, log, error **({error:function(message, object) {}, log:function(message, object) {}, debug:function(message, object) {}})**.\n+ *  - **auto_reconnect** {Boolean, default:false}, reconnect on error.\n+ *\n+ * @class Represents a Server connection.\n+ * @param {String} host the server host\n+ * @param {Number} port the server port\n+ * @param {Object} [options] optional options for insert command\n+ */\n+function Server(host, port, options) {\n+  // Set up event emitter\n+  EventEmitter.call(this);  \n+  // Set up Server instance\n+  if(!(this instanceof Server)) return new Server(host, port, options);\n+  \n   var self = this;\n   this.host = host;\n   this.port = port;\n@@ -17,6 +38,7 @@\n   this.poolSize = this.options.poolSize == null ? 1 : this.options.poolSize;\n   this.ssl = this.options.ssl == null ? false : this.options.ssl;\n   this.slaveOk = this.options[\"slave_ok\"];\n+  this._used = false;\n   \n   // Get the readPreference\n   var readPreference = this.options['readPreference'];  \n@@ -47,7 +69,7 @@\n   this.logger = this.options.logger != null \n     && (typeof this.options.logger.debug == 'function') \n     && (typeof this.options.logger.error == 'function') \n-    && (typeof this.options.logger.debug == 'function') \n+    && (typeof this.options.logger.log == 'function') \n       ? this.options.logger : {error:function(message, object) {}, log:function(message, object) {}, debug:function(message, object) {}};\n \n   // Just keeps list of events we allow\n@@ -118,28 +140,28 @@\n   });    \n };\n \n+/**\n+ * @ignore\n+ */\n // Inherit simple event emitter\n-inherits(Server, SimpleEmitter);\n+inherits(Server, EventEmitter);\n // Read Preferences\n Server.READ_PRIMARY = 'primary';\n Server.READ_SECONDARY = 'secondary';\n Server.READ_SECONDARY_ONLY = 'secondaryOnly';\n-\n-// Allow setting the read preference at the server level\n-Server.prototype.setReadPreference = function(preference) {\n-  // Set read preference\n-  this._readPreference = preference;\n-  // Ensure slaveOk is correct for secodnaries read preference and tags\n-  if((this._readPreference == Server.READ_SECONDARY || this._readPreference == Server.READ_SECONDARY_ONLY) \n-    || (this._readPreference != null && typeof this._readPreference == 'object')) {\n-    this.slaveOk = true;\n-  }\n-}\n-\n // Always ourselves\n Server.prototype.setReadPreference = function() {}\n \n-// Server close function\n+/**\n+ * @ignore\n+ */\n+Server.prototype._isUsed = function() {  \n+  return this._used;\n+}\n+\n+/**\n+ * @ignore\n+ */\n Server.prototype.close = function(callback) {  \n   // Remove all local listeners\n   this.removeAllListeners();\n@@ -148,7 +170,7 @@\n     // Remove all the listeners on the pool so it does not fire messages all over the place\n",
					"match": false,
					"packageHash": "2150ada9c3c3b25a9baa950697bc7dd6c8dfc319982d767e8e4a317b3edbf999",
					"size": 23988,
					"sourceHash": "2509622ad0acf9deda2227f721c9bc9a58e2ac9d418b1c75fe584cc42bcac5b3",
					"status": "content"
				},
				"lib/mongodb/connection/simple_emitter.js": {
					"match": false,
					"packageHash": "06f23ea1be542085b58435016ba2d0bd7ead99822d13837161357e0110f777cc",
					"size": 1760,
					"status": "missing-in-source"
				},
				"lib/mongodb/cursor.js": {
					"diff": "--- published/lib/mongodb/cursor.js\n+++ rebuilt/lib/mongodb/cursor.js\n@@ -1,10 +1,8 @@\n var QueryCommand = require('./commands/query_command').QueryCommand,\n   GetMoreCommand = require('./commands/get_more_command').GetMoreCommand,\n   KillCursorCommand = require('./commands/kill_cursor_command').KillCursorCommand,\n-  Long = require('./bson/long').Long,\n+  Long = require('bson').Long,\n   CursorStream = require('./cursorstream'),\n-  debug = require('util').debug,\n-  inspect = require('util').inspect,\n   utils = require('./utils');\n \n /**\n@@ -230,23 +228,33 @@\n  * Sets the limit parameter of this cursor to the given value.\n  *\n  * @param {Number} limit the new limit.\n- * @param {Function} callback this will be called after executing this method. The first parameter will contain an error object when the limit given is not a valid number or when the cursor is already closed while the second parameter will contain a reference to this object upon successful execution.\n+ * @param {Function} [callback] this optional callback will be called after executing this method. The first parameter will contain an error object when the limit given is not a valid number or when the cursor is already closed while the second parameter will contain a reference to this object upon successful execution.\n  * @return {Cursor} an instance of this object.\n  * @api public\n  */\n Cursor.prototype.limit = function(limit, callback) {\n-  callback = callback || function(){};\n-\n   if(this.tailable) {\n-    callback(new Error(\"Tailable cursor doesn't support limit\"), null);\n+    if(callback) {\n+      callback(new Error(\"Tailable cursor doesn't support limit\"), null);\n+    } else {\n+      throw new Error(\"Tailable cursor doesn't support limit\");\n+    }    \n   } else if(this.queryRun == true || this.state == Cursor.CLOSED) {\n-    callback(new Error(\"Cursor is closed\"), null);\n+    if(callback) {\n+      callback(new Error(\"Cursor is closed\"), null);      \n+    } else {\n+      throw new Error(\"Cursor is closed\");\n+    }\n   } else {\n     if(limit != null && limit.constructor != Number) {\n-      callback(new Error(\"limit requires an integer\"), null);\n+      if(callback) {\n+        callback(new Error(\"limit requires an integer\"), null);        \n+      } else {        \n+        throw new Error(\"limit requires an integer\");\n+      }\n     } else {\n       this.limitValue = limit;\n-      callback(null, this);\n+      if(callback) return callback(null, this);\n     }\n   }\n \n@@ -257,7 +265,7 @@\n  * Sets the skip parameter of this cursor to the given value.\n  *\n  * @param {Number} skip the new skip value.\n- * @param {Function} callback this will be called after executing this method. The first parameter will contain an error object when the skip value given is not a valid number or when the cursor is already closed while the second parameter will contain a reference to this object upon successful execution.\n+ * @param {Function} [callback] this optional callback will be called after executing this method. The first parameter will contain an error object when the skip value given is not a valid number or when the cursor is already closed while the second parameter will contain a reference to this object upon successful execution.\n  * @return {Cursor} an instance of this object.\n  * @api public\n  */\n@@ -284,7 +292,7 @@\n  * Sets the batch size parameter of this cursor to the given value.\n  *\n  * @param {Number} batchSize the new batch size.\n- * @param {Function} callback this will be called after executing this method. The first parameter will contain an error object when the batchSize given is not a valid number or when the cursor is already closed while the second parameter will contain a reference to this object upon successful execution.\n+ * @param {Function} [callback] this optional callback will be called after executing this method. The first parameter will contain an error object when the batchSize given is not a valid number or when the cursor is already closed while the second parameter will contain a reference to this object upon successful execution.\n  * @return {Cursor} an instance of this object.\n  * @api public\n  */\n@@ -318,11 +326,12 @@\n  */\n var limitRequest = function(self) {\n   var requestedLimit = self.limitValue;\n-\n-  if(self.limitValue > 0) {\n-    if (self.batchSizeValue > 0) {\n-      requestedLimit = self.limitValue < self.batchSizeValue ?\n-        self.limitValue : self.batchSizeValue;\n+  var absLimitValue = Math.abs(self.limitValue);\n+  var absBatchValue = Math.abs(self.batchSizeValue);\n+  \n+  if(absLimitValue > 0) {\n+    if (absBatchValue > 0) {\n+      requestedLimit = Math.min(absLimitValue, absBatchValue);\n     }\n   } else {\n     requestedLimit = self.batchSizeValue;\n@@ -473,14 +482,25 @@\n     }\n   }\n   try {\n-    var getMoreCommand = new GetMoreCommand(self.db, self.collectionName, limitRequest(self), self.cursorId);\n+    var getMoreCommand = new GetMoreCommand(\n+        self.db\n+      , self.collectionName\n+      , limitRequest(self)\n",
					"match": false,
					"packageHash": "0a56ecc04ee513942e0611538beabb8de7a26385f8b1ffd5a55fddb1cee25b37",
					"size": 24730,
					"sourceHash": "c4a6fb5b596bb88a2e03a3d00859e3cb8ae2ac573e12fa196743abfbf01737ea",
					"status": "content"
				},
				"lib/mongodb/cursorstream.js": {
					"diff": "--- published/lib/mongodb/cursorstream.js\n+++ rebuilt/lib/mongodb/cursorstream.js\n@@ -18,6 +18,8 @@\n  * @return {Stream}\n  */\n function CursorStream(cursor) {\n+  if(!(this instanceof CursorStream)) return new CursorStream(cursor);\n+  \n   Stream.call(this);\n \n   this.readable = true;\n",
					"match": false,
					"packageHash": "3d53b3cbda7277e2c76923fea1afe47c4a8792a760b954c361057ab39de3240d",
					"size": 2775,
					"sourceHash": "0e80e052fb49e079d8b9a5c5f957370f0780cd5e677ec1b8638aafa7e7ea4b2e",
					"status": "content"
				},
				"lib/mongodb/db.js": {
					"diff": "--- published/lib/mongodb/db.js\n+++ rebuilt/lib/mongodb/db.js\n@@ -4,19 +4,15 @@\n  */\n var QueryCommand = require('./commands/query_command').QueryCommand,\n   DbCommand = require('./commands/db_command').DbCommand,\n-  BinaryParser = require('./bson/binary_parser').BinaryParser,\n   MongoReply = require('./responses/mongo_reply').MongoReply,\n   Admin = require('./admin').Admin,\n   Collection = require('./collection').Collection,\n   Server = require('./connection/server').Server,\n-  ReplSetServers = require('./connection/repl_set_servers').ReplSetServers,\n+  ReplSet = require('./connection/repl_set').ReplSet,\n   Cursor = require('./cursor').Cursor,\n   EventEmitter = require('events').EventEmitter,\n   inherits = require('util').inherits,\n-  crypto = require('crypto'),\n-  debug = require('util').debug,\n-  inspect = require('util').inspect,\n-  b = require('./bson/bson');\n+  crypto = require('crypto');\n \n /**\n  * Internal class for callback storage \n@@ -58,10 +54,24 @@\n  * @param {Object} [options] additional options for the collection.\n  */\n function Db(databaseName, serverConfig, options) {\n+\n+  if(!(this instanceof Db)) return new Db(databaseName, serverConfig, options);\n+  \n   EventEmitter.call(this);\n   this.databaseName = databaseName;\n-  this.serverConfig = serverConfig;\n+  this.serverConfig = serverConfig;  \n   this.options = options == null ? {} : options;  \n+  // State to check against if the user force closed db\n+  this._applicationClosed = false;\n+  // Fetch the override flag if any\n+  var overrideUsedFlag = this.options['override_used_flag'] == null ? false : this.options['override_used_flag'];  \n+  // Verify that nobody is using this config\n+  if(!overrideUsedFlag && typeof this.serverConfig == 'object' && this.serverConfig._isUsed()) {\n+    throw new Error(\"A Server or ReplSet instance cannot be shared across multiple Db instances\");\n+  } else if(!overrideUsedFlag && typeof this.serverConfig == 'object'){\n+    // Set being used\n+    this.serverConfig._used = true;    \n+  }\n   \n   // Ensure we have a valid db name\n   validateDatabaseName(databaseName);\n@@ -70,29 +80,32 @@\n   try {\n     this.native_parser = this.options.native_parser;\n     // The bson lib\n-    var bsonLib = this.options.native_parser ? require('../../external-libs/bson') : new require('./bson/bson');\n+    var bsonLib = this.bsonLib = this.options.native_parser ? require('bson').BSONNative : new require('bson').BSONPure;\n     // Fetch the serializer object\n     var BSON = bsonLib.BSON;\n     // Create a new instance\n-    this.bson = new BSON([b.Long, b.ObjectID, b.Binary, b.Code, b.DBRef, b.Symbol, b.Double, b.Timestamp, b.MaxKey, b.MinKey]);\n+    this.bson = new BSON([bsonLib.Long, bsonLib.ObjectID, bsonLib.Binary, bsonLib.Code, bsonLib.DBRef, bsonLib.Symbol, bsonLib.Double, bsonLib.Timestamp, bsonLib.MaxKey, bsonLib.MinKey]);\n     // Backward compatibility to access types\n     this.bson_deserializer = bsonLib;\n     this.bson_serializer = bsonLib;\n   } catch (err) {\n     // If we tried to instantiate the native driver\n-    throw \"Native bson parser not compiled, please compile or avoid using native_parser=true\";\n+    var msg = \"Native bson parser not compiled, please compile \"\n+            + \"or avoid using native_parser=true\";\n+    throw Error(err);\n   }\n-  \n+\n   // Internal state of the server\n   this._state = 'disconnected';\n   \n-  this.pkFactory = this.options.pk == null ? b.ObjectID : this.options.pk;  \n+  this.pkFactory = this.options.pk == null ? bsonLib.ObjectID : this.options.pk;  \n   this.forceServerObjectId = this.options.forceServerObjectId != null ? this.options.forceServerObjectId : false;\n   // Added strict\n   this.strict = this.options.strict == null ? false : this.options.strict;\n   this.notReplied ={};\n   this.isInitializing = true;\n   this.auths = [];\n+  this.openCalled = false;\n   \n   // Command queue, keeps a list of incoming commands that need to be executed once the connection is up\n   this.commands = [];  \n@@ -218,11 +231,22 @@\n  */\n Db.prototype.open = function(callback) {\n   var self = this; \n+  \n+  // Check that the user has not called this twice\n+  if(this.openCalled) {\n+    // Close db\n+    this.close();\n+    // Throw error\n+    throw new Error(\"db object already connecting, open cannot be called multiple times\");\n+  }\n",
					"match": false,
					"packageHash": "a7e6e4d49c07e038080769ecc3cfe88a8b32654285797ce4b0dc871b0c88a779",
					"size": 58381,
					"sourceHash": "8975ea6eee925ca6f0b33ba4cb074d8de4c712ad9540ccd346aeb97e626a7e93",
					"status": "content"
				},
				"lib/mongodb/gridfs/chunk.js": {
					"diff": "--- published/lib/mongodb/gridfs/chunk.js\n+++ rebuilt/lib/mongodb/gridfs/chunk.js\n@@ -1,12 +1,8 @@\n-var BinaryParser = require('../bson/binary_parser').BinaryParser,\n-  Binary = require('../bson/binary').Binary,\n-  ObjectID = require('../bson/objectid').ObjectID,\n-  sys = require('util'),\n-  debug = require('util').debug,\n-  inspect = require('util').inspect;\n+var Binary = require('bson').Binary,\n+  ObjectID = require('bson').ObjectID;\n \n /**\n- * Class for representing a signle chunk in GridFS.\n+ * Class for representing a single chunk in GridFS.\n  *\n  * @class\n  *\n@@ -21,6 +17,8 @@\n  * @see Chunk#buildMongoObject\n  */\n var Chunk = exports.Chunk = function(file, mongoObject) {\n+  if(!(this instanceof Chunk)) return new Chunk(file, mongoObject);\n+  \n   this.file = file;\n   var self = this;\n   var mongoObjectFinal = mongoObject == null ? {} : mongoObject;\n@@ -30,17 +28,17 @@\n   this.data = new Binary();\n \n   if(mongoObjectFinal.data == null) {\n-  } else if(mongoObjectFinal.data.constructor == String) {\n+  } else if(typeof mongoObjectFinal.data == \"string\") {\n     var buffer = new Buffer(mongoObjectFinal.data.length);\n     buffer.write(mongoObjectFinal.data, 'binary', 0);\n     this.data = new Binary(buffer);\n-  } else if(mongoObjectFinal.data.constructor == Array) {\n+  } else if(Array.isArray(mongoObjectFinal.data)) {\n     var buffer = new Buffer(mongoObjectFinal.data.length);\n     buffer.write(mongoObjectFinal.data.join(''), 'binary', 0);\n     this.data = new Binary(buffer);\n   } else if(mongoObjectFinal.data instanceof Binary || Object.prototype.toString.call(mongoObjectFinal.data) == \"[object Binary]\") {    \n     this.data = mongoObjectFinal.data;\n-  } else if(mongoObjectFinal.data instanceof Buffer) {\n+  } else if(Buffer.isBuffer(mongoObjectFinal.data)) {\n   } else {\n     throw Error(\"Illegal chunk format\");\n   }\n@@ -74,7 +72,8 @@\n Chunk.prototype.write = function(data, callback) {\n   this.data.write(data, this.internalPosition);\n   this.internalPosition = this.data.length();\n-  callback(null, this);\n+  if(callback != null) return callback(null, this);\n+  return this;\n };\n \n /**\n",
					"match": false,
					"packageHash": "31c59ec7a413ca329a451ef2aeb3b2001f5552a5bbd1180c20398c9c199df917",
					"size": 6661,
					"sourceHash": "ebb1d349b3e79a84bc1a2f0a2d8bb5679a6f63325d9d48d0665c1296119ff3a5",
					"status": "content"
				},
				"lib/mongodb/gridfs/grid.js": {
					"diff": "--- published/lib/mongodb/gridfs/grid.js\n+++ rebuilt/lib/mongodb/gridfs/grid.js\n@@ -1,5 +1,5 @@\n var GridStore = require('./gridstore').GridStore,\n-  ObjectID = require('../bson/objectid').ObjectID;\n+  ObjectID = require('bson').ObjectID;\n \n /**\n  * A class representation of a simple Grid interface.\n@@ -10,6 +10,9 @@\n  * @return {Grid}\n  */\n function Grid(db, fsName) {\n+\n+  if(!(this instanceof Grid)) return new Grid(db, fsName);\n+  \n   this.db = db;\n   this.fsName = fsName == null ? GridStore.DEFAULT_ROOT_COLLECTION : fsName;\n } \n@@ -32,7 +35,7 @@\n   options['root'] = options['root'] == null ? this.fsName : options['root'];\n     \n   // Return if we don't have a buffer object as data\n-  if(!(data instanceof Buffer)) return callback(new Error(\"Data object must be a buffer object\"), null);    \n+  if(!(Buffer.isBuffer(data))) return callback(new Error(\"Data object must be a buffer object\"), null);    \n   // Get filename if we are using it\n   var filename = options['filename'];\n   // Create gridstore\n",
					"match": false,
					"packageHash": "325e314daa31e7b261f5c469eee7fc72ab8f92534024b01e0f44a935178debec",
					"size": 3416,
					"sourceHash": "2b8f34d347f7cff63ec859c8eb5e7f43212b384cd72adfcfb7c997e2caf6eae8",
					"status": "content"
				},
				"lib/mongodb/gridfs/gridstore.js": {
					"diff": "--- published/lib/mongodb/gridfs/gridstore.js\n+++ rebuilt/lib/mongodb/gridfs/gridstore.js\n@@ -6,15 +6,12 @@\n  * chunks of split files behind the scenes. More information about GridFS can be\n  * found <a href=\"http://www.mongodb.org/display/DOCS/GridFS\">here</a>.\n  */\n-var BinaryParser = require('../bson/binary_parser').BinaryParser,\n-  Chunk = require('./chunk').Chunk,\n+var Chunk = require('./chunk').Chunk,\n   DbCommand = require('../commands/db_command').DbCommand,\n-  ObjectID = require('../bson/objectid').ObjectID,\n+  ObjectID = require('bson').ObjectID,\n   Buffer = require('buffer').Buffer,\n   fs = require('fs'),\n   util = require('util'),\n-  debug = require('util').debug,\n-  inspect = require('util').inspect,\n   ReadStream = require('./readstream').ReadStream;\n \n var REFERENCE_BY_FILENAME = 0,\n@@ -36,19 +33,35 @@\n  *\n  * @class Represents the GridStore.\n  * @param {Db} db A database instance to interact with.\n- * @param {String|ObjectID} fileIdObject ObjectID or the name for the file.\n+ * @param {ObjectID} id an unique ObjectID for this file\n+ * @param {String} [filename] optional a filename for this file, no unique constrain on the field\n  * @param {String} mode set the mode for this file.\n  * @param {Object} options optional properties to specify. Recognized keys:\n  * @return {GridStore}\n  */\n-function GridStore(db, fileIdObject, mode, options) {\n+function GridStore(db, id, filename, mode, options) {\n+  if(!(this instanceof GridStore)) return new GridStore(db, id, filename, mode, options);\n+\n   var self = this;\n   this.db = db;  \n+  var _filename = filename;\n+\n+  if(typeof filename == 'string' && typeof mode == 'string') {\n+    _filename = filename;  \n+  } else if(typeof filename == 'string' && typeof mode == 'object' && mode != null) {\n+    var _mode = mode;\n+    mode = filename;\n+    options = _mode;    \n+    _filename = id;\n+  } else if(typeof filename == 'string' && mode == null) {\n+    mode = filename;\n+    _filename = id;\n+  }\n   \n   // set grid referencetype\n-  this.referenceBy = typeof fileIdObject == 'string' ? 0 : 1;\n-  this.filename = fileIdObject;\n-  this.fileId = fileIdObject;\n+  this.referenceBy = typeof id == 'string' ? 0 : 1;\n+  this.filename = _filename;\n+  this.fileId = typeof id == 'string' ? new ObjectID() : id;\n   \n   // Set up the rest\n   this.mode = mode == null ? \"r\" : mode;\n@@ -57,6 +70,8 @@\n   this.position = 0;\n   // Set default chunk size\n   this.internalChunkSize = this.options['chunkSize'] == null ? Chunk.DEFAULT_CHUNK_SIZE : this.options['chunkSize'];  \n+  // Previous chunk size\n+  this.previousChunkSize = 0;\n \n   /**\n    * Returns the current chunksize of the file.\n@@ -78,7 +93,7 @@\n          this.internalChunkSize = value;\n        }\n      }\n-  });  \n+  });\n \n   /**\n    * The md5 checksum for this file.\n@@ -93,8 +108,8 @@\n    , get: function () {\n        return this.internalMd5;\n      }\n-  });  \n-};\n+  });\n+}\n \n /**\n  * Opens the file from the database and initialize this object. Also creates a\n@@ -115,25 +130,21 @@\n   if((self.mode == \"w\" || self.mode == \"w+\") && self.db.serverConfig.primary != null) {\n     // Get files collection\n     self.collection(function(err, collection) {\n-      // Ensure index on files Collection\n-      collection.ensureIndex([['filename', 1], ['uploadDate', -1]], function(err, index) {\n-\n-        // Get chunk collection\n-        self.chunkCollection(function(err, chunkCollection) {\n-          // Ensure index on chunk collection\n",
					"match": false,
					"packageHash": "4c5331e3a343d352ebcdd99e0c5b89b794f412ebbc094bcbc6691a859e2eee08",
					"size": 39904,
					"sourceHash": "3431d98442b60a3a8125b38249d63dfe6a81338d3bf41d9b86b2e8e71c0c3aac",
					"status": "content"
				},
				"lib/mongodb/gridfs/readstream.js": {
					"diff": "--- published/lib/mongodb/gridfs/readstream.js\n+++ rebuilt/lib/mongodb/gridfs/readstream.js\n@@ -30,7 +30,8 @@\n   this.paused = false;\n   this.readable = true;\n   this.pendingChunk = null;\n-\n+  this.executing = false;  \n+  \n   var self = this;\n   process.nextTick(function() {\n     self._execute();\n@@ -65,12 +66,15 @@\n \n   var gstore = this.gstore;\n   var self = this;\n+  // Set that we are executing\n+  this.executing = true;\n \n   var last = false;\n   var toRead = 0;\n \n   if ((gstore.currentChunk.length() - gstore.currentChunk.position + 1 + self.completedLength) >= self.finalLength) {\n     toRead = self.finalLength - self.completedLength;\n+    self.executing = false;\n     last = true;\n   } else {\n     toRead = gstore.currentChunk.length();\n@@ -78,23 +82,24 @@\n \n   var data = gstore.currentChunk.readSlice(toRead);\n   \n-  if (data != null) {\n+  if(data != null) {\n     self.completedLength += data.length;\n     self.pendingChunk = null;\n     self.emit(\"data\", data);\n   }\n \n-  if (last === true) {\n+  if(last === true) {\n     self.readable = false;\n     self.emit(\"end\");\n-    if (self.autoclose === true) {\n-      if (gstore.mode[0] == \"w\") {\n+    \n+    if(self.autoclose === true) {\n+      if(gstore.mode[0] == \"w\") {\n         gstore.close(function(err, doc) {\n           if (err) {\n             self.emit(\"error\", err);\n             return;\n           }\n-          self.readable = false;\n+          self.readable = false;          \n           self.emit(\"close\", doc);\n         });\n       } else {\n@@ -104,15 +109,19 @@\n     }\n   } else {\n     gstore._nthChunk(gstore.currentChunk.chunkNumber + 1, function(err, chunk) {\n-      if (err) {\n+      if(err) {\n         self.readable = false;\n         self.emit(\"error\", err);\n+        self.executing = false;\n         return;\n       }\n+\n       self.pendingChunk = chunk;\n-      if (self.paused === true) {\n+      if(self.paused === true) {\n+        self.executing = false;\n         return;\n       }\n+\n       gstore.currentChunk = self.pendingChunk;\n       self._execute();\n     });\n@@ -126,7 +135,9 @@\n  * @api public\n  */\n ReadStream.prototype.pause = function() {\n-  this.paused = true;\n+  if(!this.executing) {\n+    this.paused = true;    \n+  }\n };\n \n /**\n@@ -148,6 +159,10 @@\n  * @api public\n  */\n ReadStream.prototype.resume = function() {\n+  if(this.paused === false || !this.readable) {\n+    return;\n+  }\n+  \n   this.paused = false;\n",
					"match": false,
					"packageHash": "9cfe456cb72ccba690e9390283489fec6d48b4324e181ffcd4b1455f846b2ad6",
					"size": 3725,
					"sourceHash": "298c9a5f2fa37071875ed26c5cf044cc1a719b8adbc9482ef9f4dbc56dd7444a",
					"status": "content"
				},
				"lib/mongodb/index.js": {
					"diff": "--- published/lib/mongodb/index.js\n+++ rebuilt/lib/mongodb/index.js\n@@ -1,23 +1,11 @@\n-\n try {\n-  exports.BSONPure = require('./bson/bson');\n-  exports.BSONNative = require('../../external-libs/bson');\n+  exports.BSONPure = require('bson').BSONPure;\n+  exports.BSONNative = require('bson').BSONNative;\n } catch(err) {\n   // do nothing\n }\n \n-[ 'bson/binary_parser'\n-  , 'bson/binary'\n-  , 'bson/code'\n-  , 'bson/db_ref'\n-  , 'bson/double'\n-  , 'bson/max_key'\n-  , 'bson/min_key'\n-  , 'bson/objectid'\n-  , 'bson/symbol'\n-  , 'bson/timestamp'\n-  , 'bson/long'\n-  , 'commands/base_command'\n+[ 'commands/base_command'\n   , 'commands/db_command'\n   , 'commands/delete_command'\n   , 'commands/get_more_command'\n@@ -30,7 +18,7 @@\n   , 'collection'\n   , 'connection/connection'\n   , 'connection/server'\n-  , 'connection/repl_set_servers'\n+  , 'connection/repl_set'\n   , 'cursor'\n   , 'db'\n   , 'gridfs/grid'\n@@ -40,25 +28,31 @@\n   \tfor (var i in module) {\n   \t\texports[i] = module[i];\n     }\n+\n+    // backwards compat\n+    exports.ReplSetServers = exports.ReplSet;\n+    \n+    // Add BSON Classes\n+    exports.Binary = require('bson').Binary;\n+    exports.Code = require('bson').Code;\n+    exports.DBRef = require('bson').DBRef;\n+    exports.Double = require('bson').Double;\n+    exports.Long = require('bson').Long;\n+    exports.MinKey = require('bson').MinKey;\n+    exports.MaxKey = require('bson').MaxKey;\n+    exports.ObjectID = require('bson').ObjectID;\n+    exports.Symbol = require('bson').Symbol;\n+    exports.Timestamp = require('bson').Timestamp;  \n+    \n+    // Add BSON Parser\n+    exports.BSON = require('bson').BSONPure.BSON;\n });\n \n-// Exports all the classes for the NATIVE JS BSON Parser\n-exports.native = function() {\n+// Exports all the classes for the PURE JS BSON Parser\n+exports.pure = function() {\n   var classes = {};\n   // Map all the classes\n-  [ 'bson/binary_parser'\n-    , 'bson/binary'\n-    , 'bson/code'\n-    , 'bson/db_ref'\n-    , 'bson/double'\n-    , 'bson/max_key'\n-    , 'bson/min_key'\n-    , 'bson/objectid'\n-    , 'bson/symbol'\n-    , 'bson/timestamp'\n-    , 'bson/long'\n-    , '../../external-libs/bson/bson'\n-    , 'commands/base_command'\n+  [ 'commands/base_command'\n     , 'commands/db_command'\n     , 'commands/delete_command'\n     , 'commands/get_more_command'\n@@ -71,7 +65,7 @@\n     , 'collection'\n     , 'connection/connection'\n     , 'connection/server'\n-    , 'connection/repl_set_servers'\n+    , 'connection/repl_set'\n     , 'cursor'\n     , 'db'\n     , 'gridfs/grid'\n@@ -82,27 +76,34 @@\n     \t\tclasses[i] = module[i];\n       }\n   });\n+\n+  // backwards compat\n",
					"match": false,
					"packageHash": "6c42e731633b890fae1ed4fe17f5c889dd224fad70a8eba3e83aafa8fc5544ff",
					"size": 3099,
					"sourceHash": "f177a8277bbee6a3ec1c3e002bda2026d47cad3da7c164edb7f615a0b9c7b360",
					"status": "content"
				},
				"lib/mongodb/responses/mongo_reply.js": {
					"diff": "--- published/lib/mongodb/responses/mongo_reply.js\n+++ rebuilt/lib/mongodb/responses/mongo_reply.js\n@@ -1,6 +1,4 @@\n-var Long = require('../bson/long').Long,\n-  debug = require('util').debug,\n-  inspect = require('util').inspect;\n+var Long = require('bson').Long;\n \n /**\n   Reply message from mongo db\n",
					"match": false,
					"packageHash": "b56592bc4c043f07a4f590daa776252548e4ef2ea5bd8d2c4bd984272e51100b",
					"size": 6200,
					"sourceHash": "2a7cc4f286e5792d1ac34e4e92fc1586b483f6f974fb93afbf63d6d80d64e842",
					"status": "content"
				},
				"lib/mongodb/utils.js": {
					"diff": "--- published/lib/mongodb/utils.js\n+++ rebuilt/lib/mongodb/utils.js\n@@ -41,4 +41,34 @@\n   }\n \n   return orderBy;\n-};\n\\ No newline at end of file\n+};\n+\n+exports.encodeInt = function(value) {\n+  var buffer = new Buffer(4);\n+  buffer[3] = (value >> 24) & 0xff;      \n+  buffer[2] = (value >> 16) & 0xff;\n+  buffer[1] = (value >> 8) & 0xff;\n+  buffer[0] = value & 0xff;\n+  return buffer;\n+}\n+\n+exports.encodeIntInPlace = function(value, buffer, index) {\n+  buffer[index + 3] = (value >> 24) & 0xff;\t\t\t\n+\tbuffer[index + 2] = (value >> 16) & 0xff;\n+\tbuffer[index + 1] = (value >> 8) & 0xff;\n+\tbuffer[index] = value & 0xff;\n+}\n+\n+exports.encodeCString = function(string) {\n+  var buf = new Buffer(string, 'utf8');\n+  return [buf, new Buffer([0])];\n+}\n+\n+exports.decodeUInt32 = function(array, index) {\n+  return array[index] | array[index + 1] << 8 | array[index + 2] << 16 | array[index + 3] << 24;\n+}\n+\n+// Decode the int\n+exports.decodeUInt8 = function(array, index) {\n+  return array[index];\n+}\n",
					"match": false,
					"packageHash": "939bbfe2c9defd39ab258fb2fb76b8aa6e43f11e066a44e119eb97dc12808d50",
					"size": 1302,
					"sourceHash": "ff5f09bdbf592d3edda38f3f4f29fa7da9fab88c3ef340077b86c9ecce38cd94",
					"status": "content"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,7 +1,7 @@\n { \"name\" :            \"mongodb\"\n , \"description\" :     \"A node.js driver for MongoDB\"\n , \"keywords\" :        [\"mongodb\", \"mongo\", \"driver\", \"db\"]\n-, \"version\" :         \"0.9.8-5\"\n+, \"version\" :         \"0.9.9-8\"\n , \"author\" :          \"Christian Amor Kvalheim <christkv@gmail.com>\"\n , \"contributors\" :  [ \"Aaron Heckmann\",\n                       \"Christoph Pojer\",\n@@ -57,20 +57,24 @@\n                     , \"url\" :   \"http://github.com/christkv/node-mongodb-native.git\" }\n , \"bugs\" :          { \"mail\" :  \"node-mongodb-native@googlegroups.com\"\n                     , \"url\" :   \"http://github.com/christkv/node-mongodb-native/issues\" }\n-, \"os\" :            [ \"linux\"\n-                    , \"darwin\"\n-                    , \"freebsd\" ]\n+, \"dependencies\" : {\n+  \"bson\": \"0.0.4\"\n+}                    \n , \"devDependencies\": {\n-      \"dox\": \"0.1.3\"\n+      \"dox\": \"0.2.0\"\n     , \"uglify-js\": \"1.2.5\"\n     , \"ejs\": \"0.6.1\"\n-    , \"nodeunit\": \"0.6.4\"\n+    , \"nodeunit\": \"0.7.3\"\n+    , \"github3\": \">=0.3.0\"\n+\t  , \"markdown\": \"0.3.1\"\n+\t  , \"gleak\": \"0.2.3\"\n+\t  , \"step\": \"0.0.5\"\n   }\n , \"config\":         { \"native\" : false }                    \n , \"main\":             \"./lib/mongodb/index\"\n , \"directories\" :   { \"lib\" : \"./lib/mongodb\" }\n , \"engines\" :       { \"node\" : \">=0.4.0\" }\n-, \"scripts\": { \"install\" : \"node install.js\" }\n+, \"scripts\": { \"test\" : \"make test_pure\" }\n , \"licenses\" :    [ { \"type\" :  \"Apache License, Version 2.0\"\n                     , \"url\" :   \"http://www.apache.org/licenses/LICENSE-2.0\" } ]\n }\n",
					"match": false,
					"packageHash": "f67b7da80c43f5b7033d8fb303c0477bf8247b58a67913f33f9536b90e8a7b4b",
					"size": 3017,
					"sourceHash": "3e819dd4d5c4f71977047355855ffb75eb246f9cfed7b07d12c2abb32fdb8bc5",
					"status": "content"
				},
				"test/admin_test.js": {
					"match": false,
					"packageHash": "5d3cd0340bf6a21e5d8a7c6fa44abf9babd629abb4c06887544c2dececa67022",
					"size": 22098,
					"status": "missing-in-source"
				},
				"test/authentication_test.js": {
					"match": false,
					"packageHash": "4cb054059592ca3f87a0d738ac6ac7c5f0ba2553d28bfb89143a3810d875308d",
					"size": 5200,
					"status": "missing-in-source"
				},
				"test/auxilliary/authentication_test.js": {
					"match": false,
					"packageHash": "4a4a410c739b27a25a258c5a526ddf2c82229590e22a8f41c128c1675564ffba",
					"size": 6785,
					"status": "missing-in-source"
				},
				"test/auxilliary/repl_set_ssl_test.js": {
					"match": false,
					"packageHash": "2268c684a94a3e4ad11941a98ed9c6560ff6aaed8870ba73db488164bfda03ae",
					"size": 2193,
					"status": "missing-in-source"
				},
				"test/auxilliary/replicaset_auth_test.js": {
					"match": false,
					"packageHash": "6a4fffac1d8e3f2ec8c2ae68e432447098edc6538589f61508b17bda7e07fc42",
					"size": 7015,
					"status": "missing-in-source"
				},
				"test/auxilliary/single_server_kill_reconnect.js": {
					"match": false,
					"packageHash": "373a8db10719effaacb1482573cbde9a68227351abf2f81af40336daef7b7e2c",
					"size": 5650,
					"status": "missing-in-source"
				},
				"test/auxilliary/ssl_test.js": {
					"match": false,
					"packageHash": "8d0ab4358b3621a9d33c5ec27f73331f37f205255cfc0718786643d9f4583096",
					"size": 2494,
					"status": "missing-in-source"
				},
				"test/bson/bson_test.js": {
					"match": false,
					"packageHash": "a93d1d9e7f05867c705492eb92f53b72f4a474205c33b1a9ec5deb2e3855eff3",
					"size": 61778,
					"status": "missing-in-source"
				},
				"test/bson/commands_test.js": {
					"match": false,
					"packageHash": "65fcb18e63c7704521dd00c5634342854e8a1dc6963e98e25f5822dfe73a5c83",
					"size": 5016,
					"status": "missing-in-source"
				},
				"test/bson_types_test.js": {
					"match": false,
					"packageHash": "c6add747348b6e07c002e0acd483da9d01bd29b6145df70715d76fc34b7456c6",
					"size": 5826,
					"status": "missing-in-source"
				},
				"test/certificates/mycert.pem": {
					"match": false,
					"packageHash": "b58108b5dd45b1d0779b402004309b7c7f2cbd1a525f9611770079754a4f9697",
					"size": 2021,
					"status": "missing-in-source"
				},
				"test/collection_test.js": {
					"match": false,
					"packageHash": "6761fafca65e3da63b0c649cb965a7b526e066513011d81eb8aafc72b8064253",
					"size": 38005,
					"status": "missing-in-source"
				},
				"test/connect_test.js": {
					"match": false,
					"packageHash": "7da7ad0624da465833eb7b6740cb99df48367be9cf4a43408f549543399976b3",
					"size": 3738,
					"status": "missing-in-source"
				},
				"test/connection/connection_pool_test.js": {
					"match": false,
					"packageHash": "0b5e5c374613a44a4a015f2569ba7e27ae625901ba2b2fb88520b60d54ae336e",
					"size": 3110,
					"status": "missing-in-source"
				},
				"test/connection/message_parser_test.js": {
					"match": false,
					"packageHash": "39364458921c82336c677f619623d46846e6d1673566a0637bb6ed9b3ec41f46",
					"size": 13895,
					"status": "missing-in-source"
				},
				"test/connection_test.js": {
					"match": false,
					"packageHash": "607d4254e7a3744ed1d4a2fc9bd8a04ff5eaf8fa158b103c04df76afd423630e",
					"size": 5342,
					"status": "missing-in-source"
				},
				"test/cursor_test.js": {
					"match": false,
					"packageHash": "3a000cd58a206e3217a85442043add77873e008c7aa33b5131706e408b79a49e",
					"size": 55199,
					"status": "missing-in-source"
				},
				"test/cursorstream_test.js": {
					"match": false,
					"packageHash": "54c4386baa26af8b4587f32759811c465d28d69f2c29f3daf0bc2b335616cf01",
					"size": 6525,
					"status": "missing-in-source"
				},
				"test/custom_pk_test.js": {
					"match": false,
					"packageHash": "60d0f54e3e48c02a3aee641736b5e239b0755cb4acc4ef0248fd7563e362fc9d",
					"size": 3097,
					"status": "missing-in-source"
				},
				"test/db_test.js": {
					"match": false,
					"packageHash": "24e558d25dc44863c7f498610deed10fef81c64b73a60d684bcd400c83430ab1",
					"size": 44796,
					"status": "missing-in-source"
				},
				"test/error_test.js": {
					"match": false,
					"packageHash": "6d99e8f4922d532a8fb3f09895fc55ad586ddace86d0af3147c58f535fbd0dc6",
					"size": 11918,
					"status": "missing-in-source"
				},
				"test/exception_handling_test.js": {
					"match": false,
					"packageHash": "5002f84b9902c545e68cf90e580a8062be525475443477d812ee0fa8bebe050a",
					"size": 2827,
					"status": "missing-in-source"
				},
				"test/find_test.js": {
					"match": false,
					"packageHash": "346771afa2abdee0dbcc00ae43a969902b965702d5080ddc1a59866d724bd656",
					"size": 54248,
					"status": "missing-in-source"
				},
				"test/geo_search_test.js": {
					"match": false,
					"packageHash": "3501453ee90b508966089815e695cf2ff5c1eee9f1d9b22292c0638ddc20bbf9",
					"size": 4354,
					"status": "missing-in-source"
				},
				"test/gridstore/grid_store_file_test.js": {
					"match": false,
					"packageHash": "f5c1d6889a8273fd1281b9f9a069e1ca84aec7332b1e4fade81330e9bffdbfc5",
					"size": 31082,
					"status": "missing-in-source"
				},
				"test/gridstore/grid_store_stream_test.js": {
					"match": false,
					"packageHash": "a8dea5df3abc13719a2226f58654018e742f32eb35c99f9bf5f662e774bf8e8e",
					"size": 8873,
					"status": "missing-in-source"
				},
				"test/gridstore/grid_store_test.js": {
					"match": false,
					"packageHash": "190c8165861c3d875e88a502f3b093e45569774ac60491d328e9039b23f416ba",
					"size": 42169,
					"status": "missing-in-source"
				},
				"test/gridstore/grid_test.js": {
					"match": false,
					"packageHash": "b165f9bdc3c4f6105ef98109b5183b955fe2f07907a02a8da105ffc023e52e91",
					"size": 5222,
					"status": "missing-in-source"
				},
				"test/gridstore/iya_logo_final_bw.jpg": {
					"match": false,
					"packageHash": "fee907eb6666fc164dd837943ef9317b17ef74d8fc7580ef9d8d450a4998a4ce",
					"size": 74008,
					"status": "missing-in-source"
				},
				"test/gridstore/readstream_test.js": {
					"match": false,
					"packageHash": "393d9e5f7ac175db9f446fd18a0300abff5473d4366cd8fe61311875a02db6e7",
					"size": 7308,
					"status": "missing-in-source"
				},
				"test/gridstore/test_gs_weird_bug.png": {
					"match": false,
					"packageHash": "357ae8923961baeaf8eb1d434f5a3f8d9ac51ae0dbb2ed412e2687615f757ebc",
					"size": 52184,
					"status": "missing-in-source"
				},
				"test/gridstore/test_gs_working_field_read.pdf": {
					"match": false,
					"packageHash": "c866f44c43c7554e4b25394fa52901ee8c8c176649d4cd7f4dd4e92e8d4bd4f8",
					"size": 130253,
					"status": "missing-in-source"
				},
				"test/index_test.js": {
					"match": false,
					"packageHash": "d31add9c7297643ec762ea1bb7820d6325ca0047173e91a2547955fe70ac5a22",
					"size": 24498,
					"status": "missing-in-source"
				},
				"test/insert_test.js": {
					"match": false,
					"packageHash": "d79e14f424eb77e3ab45fb7525cc70dda5d7f489461c227e44210b004b8c5b83",
					"size": 37436,
					"status": "missing-in-source"
				},
				"test/logging_test.js": {
					"match": false,
					"packageHash": "5ad6ff1307b21aac6ab8a980fede7f7f4580538cb0a8116b1c50b81c4f7deb8e",
					"size": 2532,
					"status": "missing-in-source"
				},
				"test/manual_tests/grids_fs_compatibility_test.js": {
					"match": false,
					"packageHash": "a290b68420ff723bab8a3ded3a60f97dd55c23b02d63274b807fbf8185699f59",
					"size": 718,
					"status": "missing-in-source"
				},
				"test/manual_tests/issue_replicaset_test.js": {
					"match": false,
					"packageHash": "2100e25d61bf08c949b824ce055e31413a54a923f42a4799a9ca152b648b4cf5",
					"size": 1334,
					"status": "missing-in-source"
				},
				"test/manual_tests/manual_larger_queries.js": {
					"match": false,
					"packageHash": "2d63d29065d467e22e71307f2ef3ed3767138244fd50ed106ec8548ee9d37ec9",
					"size": 5839,
					"status": "missing-in-source"
				},
				"test/manual_tests/manual_lock.js": {
					"match": false,
					"packageHash": "3fa8c80948b3e2fb6a75058b2506324a7e2c101614ef027391f352b954fbc29b",
					"size": 2394,
					"status": "missing-in-source"
				},
				"test/manual_tests/replicaset_test.js": {
					"match": false,
					"packageHash": "75aede839390a0e5ba582fa25b8e645f14d8ca04227366e7396ce4f36f82a4b2",
					"size": 1918,
					"status": "missing-in-source"
				},
				"test/manual_tests/server_load.js": {
					"match": false,
					"packageHash": "605fc5914779f8e5974f5f2443f9a04dace10eeaf7a9718f8c81de8b4859b843",
					"size": 3759,
					"status": "missing-in-source"
				},
				"test/manual_tests/simple_test.js": {
					"match": false,
					"packageHash": "c76aafd152e0f49f65f924c36288eb19f86607c067fb0b53b9ade4fdb5f0746c",
					"size": 796,
					"status": "missing-in-source"
				},
				"test/manual_tests/single_test.js": {
					"match": false,
					"packageHash": "7cd2977bf2a07d47114b203a72da79bdfcfc9d21a557441059a319b13a42c547",
					"size": 1517,
					"status": "missing-in-source"
				},
				"test/manual_tests/test.js": {
					"match": false,
					"packageHash": "31bf1ee11ead9bf0b80c78a48d13780a13052511764e06f952237355237b0268",
					"size": 2338,
					"status": "missing-in-source"
				},
				"test/map_reduce_test.js": {
					"match": false,
					"packageHash": "77034622846c669e98f2132525e000e4962d1c49d57995e764b8e535ee822828",
					"size": 17407,
					"status": "missing-in-source"
				},
				"test/multiple_dbs_on_connection_pool_test.js": {
					"match": false,
					"packageHash": "438953e7276f85bff1e2bc6bf06c43b36302638c32fc7978ebaa2f59a10257c9",
					"size": 8504,
					"status": "missing-in-source"
				},
				"test/objectid_test.js": {
					"match": false,
					"packageHash": "0c25d0c7fb5e3f17ecb0e69f4a356cc44486a65ace2f4f47dd1723bb261f91b9",
					"size": 10257,
					"status": "missing-in-source"
				},
				"test/raw_test.js": {
					"match": false,
					"packageHash": "dcfc30844a7eabcf39e308102857f2fc9990712814c62d2464c9009b34713822",
					"size": 14750,
					"status": "missing-in-source"
				},
				"test/reaper_test.js": {
					"match": false,
					"packageHash": "127fee02570c62d2662f2fae0d9804524fc1277a1d43f1b4acd9ad644b42b20e",
					"size": 2648,
					"status": "missing-in-source"
				},
				"test/regexp_test.js": {
					"match": false,
					"packageHash": "ccd8d4c8ead6eda4122d37b93d619f4500f97dc588dabd1d4ddeff9a7e2ca629",
					"size": 3814,
					"status": "missing-in-source"
				},
				"test/remove_test.js": {
					"match": false,
					"packageHash": "143f1a80e3969579bf46964593767373ca9eb2ecd0e0190a47879fc91f5e5e2e",
					"size": 4907,
					"status": "missing-in-source"
				},
				"test/replicaset/changing_replicaset_test.js": {
					"match": false,
					"packageHash": "41392c237678264f39d35f631518ef661fe3832af7ccd8b958e966d2e702512b",
					"size": 10083,
					"status": "missing-in-source"
				},
				"test/replicaset/connect_test.js": {
					"match": false,
					"packageHash": "183d0b391116a6c1d237521ef96bffa285b9886e72490cd35b6d7e9440395a75",
					"size": 14390,
					"status": "missing-in-source"
				},
				"test/replicaset/count_test.js": {
					"match": false,
					"packageHash": "264516b1bbd42f03b69c8d91566da08ccf3a3d319246fbfdd09531cf2235965b",
					"size": 6742,
					"status": "missing-in-source"
				},
				"test/replicaset/insert_test.js": {
					"match": false,
					"packageHash": "fa5f823e7e0cf2f19e76103aab57660b8e2e19c7d590455c948b7af9f88c8b17",
					"size": 19659,
					"status": "missing-in-source"
				},
				"test/replicaset/query_secondaries_test.js": {
					"match": false,
					"packageHash": "2e3f83f89c6570ad22635c795995f4222a09a68761802432ee74e54f70348c0b",
					"size": 8649,
					"status": "missing-in-source"
				},
				"test/replicaset/read_preference_replicaset_test.js": {
					"match": false,
					"packageHash": "187caf94492d3bd45a70c5c3d275c116824a70e666479d9ffda8c0286022650d",
					"size": 17012,
					"status": "missing-in-source"
				},
				"test/replicaset/read_preferences_single_test.js": {
					"match": false,
					"packageHash": "7685234e65f18a72980f4c19aa9aa75f5884b16a942fa1242bf5b14f8f541a06",
					"size": 15049,
					"status": "missing-in-source"
				},
				"test/replicaset/tags_test.js": {
					"match": false,
					"packageHash": "62f3ea52113af48428c45ebb40eac22d6a8c45f00550980a72f821a9f5055ea4",
					"size": 13304,
					"status": "missing-in-source"
				},
				"test/replicaset/two_server_tests.js": {
					"match": false,
					"packageHash": "27ae4c4ae8a5bf8cd3847ac2c66ac61d54b186c01f4921f1bd3b1d77704a1ff5",
					"size": 4540,
					"status": "missing-in-source"
				},
				"test/streaming_test.js": {
					"match": false,
					"packageHash": "f9553f904c9248d75ed51e2a775157c4c243128d632577c56fb247a9f3807d77",
					"size": 4208,
					"status": "missing-in-source"
				},
				"test/tools/keyfile.txt": {
					"match": false,
					"packageHash": "58800aef534e5a1004302db4a5caa14a1e2310829f363d4d210a93dabe2e214c",
					"size": 53,
					"status": "missing-in-source"
				},
				"test/tools/replica_set_manager.js": {
					"match": false,
					"packageHash": "6e085788aa3e882b80e59fd089286194937aa4321b6da459135ee16c13aa4bd4",
					"size": 20141,
					"status": "missing-in-source"
				},
				"test/tools/server_manager.js": {
					"match": false,
					"packageHash": "c4e6f10626506de9dd78575a7528555bc03a7c45ffae97c307d2f6b44ccd3335",
					"size": 5081,
					"status": "missing-in-source"
				},
				"test/tools/sharding_manager.js": {
					"match": false,
					"packageHash": "69bf6fa9739f96ee61d5b0176458731da833a4f71b70328cd4c92fb01b204978",
					"size": 5541,
					"status": "missing-in-source"
				},
				"test/unicode_test.js": {
					"match": false,
					"packageHash": "72de8312dff2ef342f4dd5e341117e8fc4aa6aa990562e00f04c1749f7358bd4",
					"size": 5976,
					"status": "missing-in-source"
				},
				".travis.yml": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/mongodb/connection/repl_set.js": {
					"match": false,
					"status": "missing-in-package"
				}
			},
			"summary": {
				"differentFiles": 28,
				"matchingFiles": 8,
				"missingInPackage": 2,
				"missingInSource": 250,
				"score": 0.027777777777777776,
				"totalFiles": 288
			}
		}
	}
]
