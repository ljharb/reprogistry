[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-07T00:58:27.074Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "solhint@1.4.0",
			"name": "solhint",
			"version": "1.4.0",
			"location": "https://registry.npmjs.org/solhint/-/solhint-1.4.0.tgz",
			"integrity": "sha512-gVWxEtn0F+LXGQtwRkieTUlfjYuztzy/U5A1MGf+gZUEtMKRzkq1/Yqi8jtRIXG8ld4B3JagpmGB14nAG+WhAQ==",
			"publishedAt": "2018-10-10T19:57:54.914Z",
			"publishedWith": {
				"node": "8.9.4",
				"npm": "6.4.1"
			}
		},
		"source": {
			"integrity": "sha512-7WHBhhxxBNCBlfW/0IiTqlQrYdlw3jC11a2XzjP3R6ryY9jMJ6C1l33FSzHm2igE8XJevQt2vCZTfId/Ta6Rkw==",
			"location": "git+https://github.com/protofire/solhint.git",
			"spec": "github:protofire/solhint#4b4f33cbe59d4269a2c931669553de5280cd6651"
		},
		"comparisonHash": "9ef46a5bd31291e57cbab41e2f17c57bd6da0b5b",
		"diff": {
			"files": {
				".coveralls.yml": {
					"match": false,
					"packageHash": "3503e54ebbc3c4efbef1e74905c7d53b567ba69538a5bcd489df888554c4dc14",
					"size": 45,
					"status": "missing-in-source"
				},
				".eslintignore": {
					"match": false,
					"packageHash": "5d4e08013be47f23c7fb94ad220b0b25259d67ab7458226dfa1483aaab4f507b",
					"size": 25,
					"status": "missing-in-source"
				},
				".eslintrc.js": {
					"match": false,
					"packageHash": "1355c8d564ce82bdfe8db7d9b3748b3d3be8c55af7db730793dc493a3ba676e5",
					"size": 982,
					"status": "missing-in-source"
				},
				".gitmodules": {
					"match": false,
					"packageHash": "6804ba1af0c9e01ffedbb0c8ad3b6fed70a7618a54feb063d6866c8b9f559bc9",
					"size": 106,
					"status": "missing-in-source"
				},
				".prettierrc": {
					"match": false,
					"packageHash": "cddea3c5baf43c7e3f0f0ea2cd17e25cbaf931f895ec23498fde84bd021824e9",
					"size": 64,
					"status": "missing-in-source"
				},
				".travis.yml": {
					"match": false,
					"packageHash": "957ef2b854a3ee2f52c9e2f65f2ad8a52745f0b3e5d5a3ab6c0949b0392817dc",
					"size": 41,
					"status": "missing-in-source"
				},
				"CONTRIBUTING.md": {
					"match": false,
					"packageHash": "16531b67d90e4fac5335d83619f3f51d38ad57be2a2b3af156c6ba97aa02319b",
					"size": 2388,
					"status": "missing-in-source"
				},
				"LICENSE": {
					"diff": "--- published/LICENSE\n+++ rebuilt/LICENSE\n@@ -1,6 +1,6 @@\n MIT License\n \n-Copyright (c) 2017 Protofire\n+Copyright (c) 2017-2025 Protofire\n \n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n",
					"match": false,
					"packageHash": "d33472b63a07063bc0fe317168df4d9357b1dd4ecc1b4d883c9ba8d9f9970a9f",
					"size": 1066,
					"sourceHash": "e5861604064204c86fec2ce66c86607489c1afecc034fe741dff1d17dd0aece1",
					"status": "content"
				},
				"README.md": {
					"diff": "--- published/README.md\n+++ rebuilt/README.md\n@@ -1,16 +1,22 @@\n-# Solhint Project\n-\n-[![Build Status](https://travis-ci.org/protofire/solhint.svg?branch=master)](https://travis-ci.org/protofire/solhint)\n+<p align=\"center\">\n+  <a href=\"https://protofire.io/solhint\" target=\"_blank\"><img src=\"solhint.png\"></a>\n+</p>\n+<p align=\"center\">\n+  By <a href=\"https://protofire.io/\" target=\"_blank\">Protofire</a>\n+</p>\n+\n+[![](https://img.shields.io/badge/Solhint%20Website-cyan)](https://protofire.io/solhint)\n+[![](https://img.shields.io/badge/Join%20Our%20Discord-magenta)](https://discord.gg/4TYGq3zpjs)\n+[![Donate with Ethereum](https://img.shields.io/badge/Donate-ETH-blue)](https://etherscan.io/address/0xA81705c8C247C413a19A244938ae7f4A0393944e)\n [![NPM version](https://badge.fury.io/js/solhint.svg)](https://npmjs.org/package/solhint)\n-[![Coverage Status](https://coveralls.io/repos/github/protofire/solhint/badge.svg?branch=master)](\n-https://coveralls.io/github/protofire/solhint?branch=master)\n [![MIT licensed](https://img.shields.io/badge/license-MIT-blue.svg)](https://raw.githubusercontent.com/protofire/solhint/master/LICENSE)\n-[![dependencies Status](https://david-dm.org/protofire/solhint/status.svg)](https://david-dm.org/protofire/solhint)\n-[![devDependencies Status](https://david-dm.org/protofire/solhint/dev-status.svg)](https://david-dm.org/protofire/solhint?type=dev)\n \n This is an open source project for linting [Solidity](http://solidity.readthedocs.io/en/develop/) code. This project\n provides both **Security** and **Style Guide** validations.\n-\n+<br>\n+[VISIT OUR WEBSITE](https://protofire.io/solhint)<br>\n+[JOIN OUR DISCORD SERVER](https://discord.gg/4TYGq3zpjs)\n+<br>\n ## Installation\n \n You can install Solhint using **npm**:\n@@ -19,15 +25,21 @@\n npm install -g solhint\n \n # verify that it was installed correctly\n-solhint -V\n+solhint --version\n ```\n \n ## Usage\n \n-For linting Solidity files you need to run Solhint with one or more [Globs](https://en.wikipedia.org/wiki/Glob_(programming)) as arguments. For example, to lint all files inside `contracts` directory, you can do:\n+First initialize a configuration file, if you don't have one:\n \n ```sh\n-solhint \"contracts/**/*.sol\"\n+solhint --init\n+```\n+\n+This will create a `.solhint.json` file with the recommended rules enabled. Then run Solhint with one or more [Globs](https://en.wikipedia.org/wiki/Glob_(programming)) as arguments. For example, to lint all files inside `contracts` directory, you can do:\n+\n+```sh\n+solhint 'contracts/**/*.sol'\n ```\n \n To lint a single file:\n@@ -36,118 +48,242 @@\n solhint contracts/MyToken.sol\n ```\n \n-Solhint command description:\n+Run `solhint` without arguments to get more information:\n \n ```text\n Usage: solhint [options] <file> [...other_files]\n \n Linter for Solidity programming language\n \n-\n Options:\n \n-  -V, --version                              output the version number\n-  -f, --formatter [name]                     report formatter name (stylish, table, tap, unix)\n-  -w, --max-warnings [maxWarningsNumber]     number of warnings to trigger nonzero\n-  -q --quiet                                 report errors only - default: false\n-  --ignore-path [file_name]                  file to use as your .solhintignore\n-  -h, --help                                 output usage information\n-\n-\n+  -V, --version                           output the version number\n+  -f, --formatter [name]                  report formatter name (stylish, table, tap, unix, json, compact, sarif)\n+  -w, --max-warnings [maxWarningsNumber]  number of allowed warnings, works in quiet mode as well\n+  -c, --config [file_name]                file to use as your rules configuration file (not compatible with multiple configs)\n+  -q, --quiet                             report errors only - default: false\n+  --ignore-path [file_name]               file to use as your .solhintignore\n+  --fix                                   automatically fix problems and show report\n+  --cache                                 only lint files that changed since last run\n+  --cache-location                        path to the cache file\n+  --noPrompt                              do not suggest to backup files when any `fix` option is selected\n+  --init                                  create configuration file for solhint\n+  --disc                                  do not check for solhint updates\n+  --save                                  save report to file on current folder\n+  --noPoster                              remove discord poster\n+  -h, --help                              output usage information\n \n Commands:\n \n-  stdin [options]         put source code to stdin of this utility\n",
					"match": false,
					"packageHash": "3be101212d87adeeb4779006440d9b38ac195e1916cc8b44ab6ba140f7bdd96c",
					"size": 6276,
					"sourceHash": "7646da0bf540c24a5d4282837da4763c86a48715875573913afc26862a3da4c5",
					"status": "content"
				},
				"docs/_config.yml": {
					"match": false,
					"packageHash": "e4d45cbc0999c845b7d625eb6d7d629ff018c65ef0f2b62241194e6ab84ce83b",
					"size": 163,
					"status": "missing-in-source"
				},
				"docs/_includes/head.html": {
					"match": false,
					"packageHash": "5110020b0fb5b8f5964f966b09efc96c8ff93559b7e0a48c0d7392cf4930edd1",
					"size": 472,
					"status": "missing-in-source"
				},
				"docs/_includes/page-footer.html": {
					"match": false,
					"packageHash": "58d82692b141dae44397a58e4c76deb9a96849ee119e89e1b869742e7ac416bd",
					"size": 123,
					"status": "missing-in-source"
				},
				"docs/_includes/page-header.html": {
					"match": false,
					"packageHash": "876b386342fcdeb3c4168f11fed689e3c3cd4442067e644a4644606579ca2105",
					"size": 260,
					"status": "missing-in-source"
				},
				"docs/_layouts/default.html": {
					"match": false,
					"packageHash": "e3bddc010d01d7e8fe4f0aab43d6230c55c568cb31efd43b568dbe02d65815a5",
					"size": 215,
					"status": "missing-in-source"
				},
				"docs/configuration.md": {
					"match": false,
					"packageHash": "98d501ded76e1574462947a441c82d1f54678792a1682bb667e4eaea5201f282",
					"size": 1812,
					"status": "missing-in-source"
				},
				"docs/css/cayman.css": {
					"match": false,
					"packageHash": "7d377e28c70c5f1743e0df0de5b8ead3896b6ccf5c515460561cf70d3211aafe",
					"size": 8212,
					"status": "missing-in-source"
				},
				"docs/css/normalize.css": {
					"match": false,
					"packageHash": "31fec437ba4c9a546180e4b957314edc7f8f4abe1ce0785a6cfdac1f910b14c8",
					"size": 7821,
					"status": "missing-in-source"
				},
				"docs/index.md": {
					"match": false,
					"packageHash": "4155bb142e686dbb581f0c7fb0b99e9cd1aa84025bca28817c7956de11c3495f",
					"size": 3187,
					"status": "missing-in-source"
				},
				"docs/rules.md": {
					"match": false,
					"packageHash": "25c9c42b05c53c67f2eebb447275181a605815c2440ca97f29e73b5ab9338eef",
					"size": 7577,
					"status": "missing-in-source"
				},
				"docs/use-in-app.md": {
					"match": false,
					"packageHash": "643a7d8fdbd83a255f18664e3e3781be4bb521108a553b1924db6d61d1769ad5",
					"size": 2014,
					"status": "missing-in-source"
				},
				"lib/comment-directive-parser.js": {
					"diff": "--- published/lib/comment-directive-parser.js\n+++ rebuilt/lib/comment-directive-parser.js\n@@ -1,21 +1,22 @@\n class CommentDirectiveParser {\n   constructor(tokens) {\n-    this.lastLine = tokens.tokenSource.line\n+    const lastToken = tokens[tokens.length - 1]\n+    this.lastLine = lastToken ? lastToken.loc.end.line : 0\n     this.ruleStore = new RuleStore(this.lastLine)\n \n     this.parseComments(tokens)\n   }\n \n   parseComments(tokens) {\n-    const items = tokens.filterForChannel(0, tokens.tokens.length - 1, 1)\n-    if (items) {\n-      items.forEach(this.onComment.bind(this))\n-    }\n+    const items = tokens.filter(\n+      (token) => token.type === 'Keyword' && /^(\\/\\/|\\/\\*)/.test(token.value)\n+    )\n+    items.forEach((item) => this.onComment(item))\n   }\n \n   onComment(lexema) {\n-    const text = lexema.text\n-    const curLine = lexema.line\n+    const text = lexema.value\n+    const curLine = lexema.loc.start.line\n     const ruleStore = this.ruleStore\n \n     if (text.includes('solhint-disable-line')) {\n@@ -34,6 +35,16 @@\n       return\n     }\n \n+    if (text.includes('solhint-disable-previous-line')) {\n+      const rules = this.parseRuleIds(text, 'solhint-disable-previous-line')\n+\n+      if (curLine > 0) {\n+        ruleStore.disableRules(curLine - 1, rules)\n+      }\n+\n+      return\n+    }\n+\n     if (text.includes('solhint-disable')) {\n       const rules = this.parseRuleIds(text, 'solhint-disable')\n \n@@ -50,16 +61,12 @@\n   }\n \n   parseRuleIds(text, start) {\n-    const ruleIds = text\n-      .replace('//', '')\n-      .replace('/*', '')\n-      .replace('*/', '')\n-      .replace(start, '')\n+    const ruleIds = text.replace('//', '').replace('/*', '').replace('*/', '').replace(start, '')\n \n     const rules = ruleIds\n       .split(',')\n-      .map(curRule => curRule.trim())\n-      .filter(i => i.length > 0)\n+      .map((curRule) => curRule.trim())\n+      .filter((i) => i.length > 0)\n \n     return rules.length > 0 ? rules : 'all'\n   }\n@@ -95,7 +102,7 @@\n   }\n \n   disableRulesToEndOfFile(startLine, rules) {\n-    this._toEndOfFile(startLine, i => this.disableRules(i, rules))\n+    this._toEndOfFile(startLine, (i) => this.disableRules(i, rules))\n   }\n \n   enableRules(curLine, rules) {\n@@ -103,16 +110,18 @@\n       this.disableAllByLine[curLine] = false\n     } else {\n       const lineRules = this.disableRuleByLine[curLine]\n-      rules.forEach(curRule => lineRules.delete(curRule))\n+      rules.forEach((curRule) => lineRules.delete(curRule))\n     }\n   }\n \n   enableRulesToEndOfFile(startLine, rules) {\n-    this._toEndOfFile(startLine, i => this.enableRules(i, rules))\n+    this._toEndOfFile(startLine, (i) => this.enableRules(i, rules))\n   }\n \n   isRuleEnabled(line, ruleId) {\n-    return !this.disableAllByLine[line] && !this.disableRuleByLine[line].has(ruleId)\n+    const allRulesDisabled = this.disableAllByLine[line]\n+    const ruleDisabled = this.disableRuleByLine[line] && this.disableRuleByLine[line].has(ruleId)\n+    return !allRulesDisabled && !ruleDisabled\n   }\n \n   _toEndOfFile(from, callback) {\n",
					"match": false,
					"packageHash": "8938fffe2d5969c1cd13ee8392f9da18ad77cfaf7a511cbb1b4dd84f649fb045",
					"size": 3082,
					"sourceHash": "cbfdc3417216e0eaf434446204fa2a44057eb93025afd823223cf6ad6d27b62f",
					"status": "content"
				},
				"lib/common/blank-line-counter.js": {
					"diff": "--- published/lib/common/blank-line-counter.js\n+++ rebuilt/lib/common/blank-line-counter.js\n@@ -23,7 +23,7 @@\n \n   calcTokenLines(ctx) {\n     if (this.tokenLines.size === 0) {\n-      ctx.parser._input.tokens.forEach(i => this.addTokenLinesToMap(i))\n+      ctx.parser._input.tokens.forEach((i) => this.addTokenLinesToMap(i))\n     }\n   }\n \n",
					"match": false,
					"packageHash": "4b472b03ac4e993ee22f0cdbd13e3cddc866b9cacb199506399b450b1877a28d",
					"size": 974,
					"sourceHash": "0208c73376174989b04068cac86a7d36356658ddd0c669855b9ee5bbe3f6d2cd",
					"status": "content"
				},
				"lib/common/identifier-naming.js": {
					"diff": "--- published/lib/common/identifier-naming.js\n+++ rebuilt/lib/common/identifier-naming.js\n@@ -4,26 +4,51 @@\n \n module.exports = {\n   isMixedCase(text) {\n-    return match(text, /[_]*[a-z]+[a-zA-Z0-9$]*[_]?/)\n+    return match(text, /[_]*[a-z$]+[a-zA-Z0-9$]*[_]?/)\n   },\n \n   isNotMixedCase(text) {\n     return !this.isMixedCase(text)\n   },\n \n-  isCamelCase(text) {\n-    return match(text, /[A-Z]+[a-zA-Z0-9$]*/)\n+  isCapWords(text) {\n+    return match(text, /[A-Z$]+[a-zA-Z0-9$]*/)\n   },\n \n-  isNotCamelCase(text) {\n-    return !this.isCamelCase(text)\n+  isNotCapWords(text) {\n+    return !this.isCapWords(text)\n   },\n \n   isUpperSnakeCase(text) {\n-    return match(text, /[A-Z0-9]+[_A-Z0-9]*/)\n+    return match(text, /_{0,2}[A-Z0-9$]+[_A-Z0-9$]*/)\n   },\n \n   isNotUpperSnakeCase(text) {\n     return !this.isUpperSnakeCase(text)\n-  }\n+  },\n+\n+  hasLeadingUnderscore(text) {\n+    return text && text[0] === '_'\n+  },\n+\n+  isFoundryTestCase(text) {\n+    // PREVIOUS VERSION\n+    // → strict version: requires that after `test...` the first character must be uppercase (CamelCase enforced)\n+    // const regexTest = /^test(Fork)?(Fuzz)?(Fail)?(_)?[A-Z](Revert(If_|When_){1})?\\w{1,}$/\n+    // PREVIOUS VERSION\n+    // → strict version: requires that after `invariant` or `statefulFuzz` the first character must be uppercase (CamelCase enforced)\n+    // const regexInvariant = /^(invariant|statefulFuzz)(_)?[A-Z]\\w{1,}$/\n+\n+    // this one checks test functions with optional suffixes (Fork, Fuzz, Fail, RevertIf_, RevertWhen_, etc.)\n+    // now it only requires that after those, at least one word character exists (no CamelCase enforcement)\n+    const regexTest = /^test(Fork)?(Fuzz)?(Fail)?(_)?(Revert(If_|When_){1})?\\w{1,}$/\n+    const matchRegexTest = match(text, regexTest)\n+\n+    // this one checks invariant or statefulFuzz functions, with optional underscore,\n+    // followed by at least one word character (no CamelCase enforcement)\n+    const regexInvariant = /^(invariant|statefulFuzz)(_)?\\w{1,}$/\n+    const matchRegexInvariant = match(text, regexInvariant)\n+\n+    return matchRegexTest || matchRegexInvariant\n+  },\n }\n",
					"match": false,
					"packageHash": "b01def806a4bc889712e2a3c927c83d81aff728cb29641a594a8c0b2d3b9c0d1",
					"size": 541,
					"sourceHash": "f60a11d0f990e032ff83308e47b1fccf9b9b802d0c3f41fa425c7ddf3ca0b4bf",
					"status": "content"
				},
				"lib/common/statements-indent-validator.js": {
					"diff": "--- published/lib/common/statements-indent-validator.js\n+++ rebuilt/lib/common/statements-indent-validator.js\n@@ -98,15 +98,15 @@\n   }\n \n   syntaxMatch(ctx) {\n-    const childs = ctx.children\n-    const syntaxMatchers = this.items.filter(i => i.syntaxMatch)\n+    const children = ctx.children\n+    const syntaxMatchers = this.items.filter((i) => i.syntaxMatch)\n \n-    if (!childs || childs.length === 0 || syntaxMatchers.length !== childs.length) {\n+    if (!children || children.length === 0 || syntaxMatchers.length !== children.length) {\n       return false\n     }\n \n-    for (let i = 0; i < childs.length; i += 1) {\n-      if (!syntaxMatchers[i].syntaxMatch(childs[i])) {\n+    for (let i = 0; i < children.length; i += 1) {\n+      if (!syntaxMatchers[i].syntaxMatch(children[i])) {\n         return false\n       }\n     }\n@@ -115,7 +115,7 @@\n   }\n \n   validate(callback) {\n-    return this.items.filter(i => i.listenError).forEach(i => i.listenError(callback))\n+    return this.items.filter((i) => i.listenError).forEach((i) => i.listenError(callback))\n   }\n \n   get lastItem() {\n",
					"match": false,
					"packageHash": "8ef6c53f069ec0bc1ea73fd0419a99b53a912d777ba1ce8534014a74817f747f",
					"size": 4722,
					"sourceHash": "514fd36b2460b714ec21a2358ca44e4efcef539a43e008f0284a8fc887437d6c",
					"status": "content"
				},
				"lib/common/tokens.js": {
					"diff": "--- published/lib/common/tokens.js\n+++ rebuilt/lib/common/tokens.js\n@@ -117,7 +117,7 @@\n   }\n }\n \n-const AlignValidatable = type =>\n+const AlignValidatable = (type) =>\n   class extends type {\n     isIncorrectAligned() {\n       return !this.isCorrectAligned()\n@@ -143,5 +143,5 @@\n   prevTokenFromToken,\n   BaseTokenList,\n   Token,\n-  AlignValidatable\n+  AlignValidatable,\n }\n",
					"match": false,
					"packageHash": "b88dab18dd814a5c79a5240cf873c6d8e5e57edb832c6057b051c6601b43cce9",
					"size": 2782,
					"sourceHash": "a4a85537fd51c4675c11f8f0d1acff0344758a99a72b3c4e36e3bfd39fd6d486",
					"status": "content"
				},
				"lib/common/tree-traversing.js": {
					"diff": "--- published/lib/common/tree-traversing.js\n+++ rebuilt/lib/common/tree-traversing.js\n@@ -1,6 +1,6 @@\n class TreeTraversing {\n-  statementNotContains(ctx, type) {\n-    const statement = this.findParentStatement(ctx)\n+  statementNotContains(node, type) {\n+    const statement = this.findParentStatement(node)\n \n     if (!statement) {\n       return false\n@@ -11,42 +11,45 @@\n     return itemOfType !== null\n   }\n \n-  findParentStatement(ctx) {\n-    while (ctx.parentCtx != null && ctx.parentCtx.constructor.name !== 'StatementContext') {\n-      ctx = ctx.parentCtx\n+  findParentStatement(node) {\n+    while (node.parent != null && !node.parent.type.includes('Statement')) {\n+      node = node.parent\n     }\n \n-    return ctx.parentCtx\n+    return node.parent\n   }\n \n-  findParentType(ctx, type) {\n-    while (ctx.parentCtx != null && ctx.parentCtx.constructor.name !== type) {\n-      ctx = ctx.parentCtx\n+  findParentType(node, type) {\n+    while (node.parent !== undefined && node.parent.type !== type) {\n+      node = node.parent\n     }\n \n-    return ctx.parentCtx\n+    return node.parent || null\n   }\n \n-  findDownType(ctx, type) {\n-    if (!ctx || ctx.constructor.name === type) {\n-      return ctx\n-    } else if (ctx.children) {\n-      const items = ctx.children.map(i => this.findDownType(i, type)).filter(i => i !== null)\n-\n-      return (items.length > 0 && items[0]) || null\n+  findDownType(node, type) {\n+    if (!node || node.type === type) {\n+      return node\n     } else {\n       return null\n     }\n   }\n \n-  findTypeInChildren(ctx, type) {\n-    if (ctx.children) {\n-      const items = ctx.children.filter(i => i.constructor.name === type)\n-\n-      return (items.length > 0 && items[0]) || null\n-    } else {\n-      return null\n+  /**\n+   * Traverses the tree up and checks `predicate` in each node.\n+   *\n+   * @returns {boolean}\n+   */\n+  someParent(node, predicate) {\n+    let parent = node.parent\n+    while (parent) {\n+      if (predicate(parent)) {\n+        return true\n+      }\n+      parent = parent.parent\n     }\n+\n+    return false\n   }\n \n   *findIdentifier(ctx) {\n@@ -72,20 +75,19 @@\n   return typeName[0].toLowerCase() + typeName.substring(1)\n }\n \n-TreeTraversing.hasMethodCalls = function hasMethodCalls(ctx, methodNames) {\n-  const text = ctx.getText()\n-\n-  return methodNames.some(i => text.includes(`${i}(`))\n+TreeTraversing.hasMethodCalls = function hasMethodCalls(node, methodNames) {\n+  const text = node.memberName\n+  return methodNames.includes(text)\n }\n \n-TreeTraversing.findPropertyInParents = function findPropertyInParents(ctx, property) {\n-  let curCtx = ctx\n+TreeTraversing.findPropertyInParents = function findPropertyInParents(node, property) {\n+  let curNode = node\n \n-  while (curCtx !== null && !curCtx[property]) {\n-    curCtx = curCtx.parentCtx\n+  while (curNode !== undefined && !curNode[property]) {\n",
					"match": false,
					"packageHash": "7d06029221196916d6dfff7d2bbf7aa543840e1bcd8fd2a548c8ca4ad50e3616",
					"size": 2055,
					"sourceHash": "9ff01f1086b022a1882781eecf734179d343133ab25ec21c28adb461157ce18b",
					"status": "content"
				},
				"lib/common/utils.js": {
					"diff": "--- published/lib/common/utils.js\n+++ rebuilt/lib/common/utils.js\n@@ -1,18 +1,33 @@\n-module.exports = {\n-  getLocFromIndex(text, index) {\n-    let line = 1\n-    let column = 0\n-    let i = 0\n-    while (i < index) {\n-      if (text[i] === '\\n') {\n-        line++\n-        column = 0\n-      } else {\n-        column++\n-      }\n-      i++\n-    }\n+const fs = require('fs')\n+const path = require('path')\n \n-    return { line, column }\n+const getLocFromIndex = (text, index) => {\n+  let line = 1\n+  let column = 0\n+  let i = 0\n+  while (i < index) {\n+    if (text[i] === '\\n') {\n+      line++\n+      column = 0\n+    } else {\n+      column++\n+    }\n+    i++\n   }\n+\n+  return { line, column }\n+}\n+\n+const walkSync = (dir, filelist = []) => {\n+  fs.readdirSync(dir).forEach((file) => {\n+    filelist = fs.statSync(path.join(dir, file)).isDirectory()\n+      ? walkSync(path.join(dir, file), filelist)\n+      : filelist.concat(path.join(dir, file))\n+  })\n+  return filelist\n+}\n+\n+module.exports = {\n+  getLocFromIndex,\n+  walkSync,\n }\n",
					"match": false,
					"packageHash": "3056ee61623546eadea20e6a436dc3b895dfe605c20d2d0d5945b4b01c8c8664",
					"size": 281,
					"sourceHash": "9db5fc7fd96aee22b60d7aed55177310058a5dacbff82940ae0db3472bc5de0a",
					"status": "content"
				},
				"lib/config.js": {
					"diff": "--- published/lib/config.js\n+++ rebuilt/lib/config.js\n@@ -1,43 +1,62 @@\n const _ = require('lodash')\n-const { RULES } = require('./constants')\n \n module.exports = {\n   from(configVals) {\n-    return _.assign(configVals, this)\n+    return _.assign({ rules: {} }, configVals, this)\n   },\n \n   getNumberByPath(path, defaultValue) {\n     const configVal = _.get(this, path)\n-    return _.isNumber(configVal) && configVal > 0 ? configVal : defaultValue\n+    return _.isNumber(configVal) ? configVal : defaultValue\n+  },\n+\n+  getBooleanByPath(path, defaultValue) {\n+    const configVal = _.get(this, path)\n+    return _.isBoolean(configVal) ? configVal : defaultValue\n   },\n \n   getNumber(ruleName, defaultValue) {\n     return this.getNumberByPath(`rules[\"${ruleName}\"][1]`, defaultValue)\n   },\n \n-  getRulesDisabledByDefault() {\n-    const { PRETTIER } = RULES\n-    return [PRETTIER]\n+  getObjectPropertyNumber(ruleName, ruleProperty, defaultValue) {\n+    return this.getNumberByPath(`rules[\"${ruleName}\"][1][${ruleProperty}]`, defaultValue)\n   },\n \n-  isRuleDisabledByDefault(ruleId) {\n-    const rules = module.exports.getRulesDisabledByDefault()\n-    return rules.includes(ruleId)\n+  getObjectPropertyBoolean(ruleName, ruleProperty, defaultValue) {\n+    return this.getBooleanByPath(`rules[\"${ruleName}\"][1][${ruleProperty}]`, defaultValue)\n   },\n \n-  validateDisabledByDefault(rulesConfig, rulesToCheck) {\n-    const rulesArrayOfObjects = []\n-\n-    for (const ruleToCheck of rulesToCheck) {\n-      const { rule, instance } = ruleToCheck\n+  getObjectPropertyString(ruleName, ruleProperty, defaultValue) {\n+    const path = `rules[\"${ruleName}\"][1][${ruleProperty}]`\n+    const configVal = _.get(this, path)\n+    return _.isString(configVal) ? configVal : defaultValue\n+  },\n \n-      const isConfigured = rulesConfig && rulesConfig[rule]\n-      const isEnabledByDefault = !module.exports.isRuleDisabledByDefault(rule)\n+  getObjectPropertyArray(ruleName, ruleProperty, index, defaultValue) {\n+    const path = `rules[\"${ruleName}\"][${index}][${ruleProperty}]`\n+    const configVal = _.get(this, path)\n+    return _.isArray(configVal) ? configVal : defaultValue\n+  },\n \n-      if (isConfigured || isEnabledByDefault) {\n-        rulesArrayOfObjects.push(instance)\n-      }\n+  getStringFromArray(ruleName, defaultValue) {\n+    if (this.rules && this.rules[ruleName]) {\n+      const ruleValue = this.rules[ruleName]\n+      return Array.isArray(ruleValue) ? ruleValue[1] : defaultValue\n+    } else {\n+      return defaultValue\n     }\n-    return rulesArrayOfObjects\n-  }\n+  },\n+\n+  getArray(ruleName, defaultValue) {\n+    const path = `rules[\"${ruleName}\"][1]`\n+    const configVal = _.get(this, path)\n+    return _.isArray(configVal) ? configVal : defaultValue\n+  },\n+\n+  getObject(ruleName, defaultValue) {\n+    const path = `rules[\"${ruleName}\"][1]`\n+    const configVal = _.get(this, path)\n+    return _.isObject(configVal) ? configVal : defaultValue\n+  },\n }\n",
					"match": false,
					"packageHash": "b9b542b30159d1372d99d93ff56601ab0186c4d5f394f889147ee08aa5fc5f6f",
					"size": 1129,
					"sourceHash": "bbc0f35ff511c0f5935fb7f6195fba1dd8a4c20e25834dc6bda1bda0c2af4caa",
					"status": "content"
				},
				"lib/constants.js": {
					"match": false,
					"packageHash": "46b4f2a30a53d1560289420aef1324f1c7f32f3cef0ac1c3905ca5d3f13d17ba",
					"size": 107,
					"status": "missing-in-source"
				},
				"lib/grammar/Solidity.tokens": {
					"match": false,
					"packageHash": "dbaa29103fc19f8eb01ae5ebd336f9c60d8b1b2fa08922337c9999dc5a413404",
					"size": 2238,
					"status": "missing-in-source"
				},
				"lib/grammar/SolidityLexer.js": {
					"match": false,
					"packageHash": "cd08b1e25dacbdfde5bf3528ae650e8cc581d07ff06150cf5b463c6d25c54a14",
					"size": 94289,
					"status": "missing-in-source"
				},
				"lib/grammar/SolidityLexer.tokens": {
					"match": false,
					"packageHash": "dbaa29103fc19f8eb01ae5ebd336f9c60d8b1b2fa08922337c9999dc5a413404",
					"size": 2238,
					"status": "missing-in-source"
				},
				"lib/grammar/SolidityListener.js": {
					"match": false,
					"packageHash": "2e6e89f6472b10d741d88d77f78c6f146e3f23619d20c4450f2cc6d7df97591d",
					"size": 23437,
					"status": "missing-in-source"
				},
				"lib/grammar/SolidityParser.js": {
					"match": false,
					"packageHash": "eed552ad3ae0012618bbe97872a7e33f9f1d41d1ed08d4392bbdbda86fbfd7ef",
					"size": 325569,
					"status": "missing-in-source"
				},
				"lib/index.js": {
					"diff": "--- published/lib/index.js\n+++ rebuilt/lib/index.js\n@@ -1,43 +1,145 @@\n const fs = require('fs')\n-const antlr4 = require('antlr4')\n+const path = require('path')\n+const parser = require('@solidity-parser/parser')\n const glob = require('glob')\n const ignore = require('ignore')\n-const SolidityLexer = require('./grammar/SolidityLexer').SolidityLexer\n-const SolidityParser = require('./grammar/SolidityParser').SolidityParser\n+const astParents = require('ast-parents')\n+const { applyExtends, loadConfigForFile } = require('./config/config-file')\n const Reporter = require('./reporter')\n const TreeListener = require('./tree-listener')\n const checkers = require('./rules/index')\n+const { readCache, writeCache, shouldLint, updateCacheEntry } = require('./cache/cache-manager')\n+\n+function parseInput(inputStr) {\n+  try {\n+    // first we try to parse the string as we normally do\n+    return parser.parse(inputStr, { loc: true, range: true })\n+  } catch (e) {\n+    // using 'loc' may throw when inputStr is empty or only has comments\n+    return parser.parse(inputStr, {})\n+  }\n+}\n \n function processStr(inputStr, config = {}, fileName = '') {\n-  const chars = new antlr4.InputStream(inputStr)\n-  const lexer = new SolidityLexer(chars)\n-  const tokens = new antlr4.CommonTokenStream(lexer)\n-  const parser = new SolidityParser(tokens)\n-  parser.buildParseTrees = true\n+  config = applyExtends(config)\n+\n+  let ast\n+  try {\n+    ast = parseInput(inputStr)\n+  } catch (e) {\n+    if (e instanceof parser.ParserError) {\n+      const reporter = new Reporter([], config)\n+      for (const error of e.errors) {\n+        reporter.addReport(\n+          error.line,\n+          error.column,\n+          Reporter.SEVERITY.ERROR,\n+          `Parse error: ${error.message}`\n+        )\n+      }\n+      return reporter\n+    } else {\n+      throw e\n+    }\n+  }\n \n-  const tree = parser.sourceUnit()\n+  const tokens = parser.tokenize(inputStr, { loc: true, range: true })\n   const reporter = new Reporter(tokens, config)\n+  const listener = new TreeListener(checkers(reporter, config, inputStr, tokens, fileName))\n \n-  const listener = new TreeListener(checkers(reporter, config, inputStr, fileName))\n-  antlr4.tree.ParseTreeWalker.DEFAULT.walk(listener, tree)\n+  astParents(ast)\n+  parser.visit(ast, listener)\n \n   return reporter\n }\n \n-function processFile(file, config) {\n-  const report = processStr(fs.readFileSync(file).toString(), config, file)\n+function processAndCache(file, config, cacheState = null) {\n+  const useCache = config?.cache\n+\n+  const code = fs.readFileSync(file, 'utf8')\n+\n+  if (useCache && cacheState) {\n+    const { cacheData, updatedCache } = cacheState\n+    if (!shouldLint(file, code, config, cacheData)) {\n+      const emptyReport = new Reporter([], config)\n+      emptyReport.file = file\n+      emptyReport.skipped = true\n+      return { report: emptyReport, updatedCache }\n+    }\n+  }\n+\n+  const report = processStr(code, config, file)\n   report.file = file\n \n-  return report\n+  const hasErrors = report.reports.some((r) => r.severity === 2)\n+\n+  if (useCache && cacheState && !hasErrors) {\n+    updateCacheEntry(file, code, config, cacheState.updatedCache)\n+  }\n+\n+  return { report, updatedCache: cacheState?.updatedCache }\n }\n \n-function processPath(path, config) {\n",
					"match": false,
					"packageHash": "626473241f8f56a9cd3df05bf02115375c1ea9a42fa417e79a0e48f7f410e696",
					"size": 1381,
					"sourceHash": "52f825cb30562a390d4d959c8eaa09be8f210eb5275f1119a51d7c450c15fa1a",
					"status": "content"
				},
				"lib/reporter.js": {
					"diff": "--- published/lib/reporter.js\n+++ rebuilt/lib/reporter.js\n@@ -1,38 +1,41 @@\n const CommentDirectiveParser = require('./comment-directive-parser')\n \n class Reporter {\n-  constructor(tokenStream, config) {\n-    this.commentDirectiveParser = new CommentDirectiveParser(tokenStream)\n+  constructor(tokens, config) {\n+    this.commentDirectiveParser = new CommentDirectiveParser(tokens)\n     this.reports = []\n-    this.tokenStream = tokenStream\n     this.config = config.rules || {}\n   }\n \n-  addReport(line, column, severity, message, ruleId) {\n-    this.reports.push({ line, column, severity, message, ruleId })\n+  addReport(line, column, severity, message, ruleId, fix) {\n+    this.reports.push({ line, column, severity, message, ruleId, fix })\n   }\n \n-  addMessage(interval, defaultSeverity, message, ruleId) {\n-    const line = this.tokenStream.get(interval.start).line\n-    const charAtLine = this.tokenStream.get(interval.start).column\n-\n-    this.addMessageExplicitLine(line, charAtLine, defaultSeverity, message, ruleId)\n+  addMessage(loc, defaultSeverity, message, ruleId, fix) {\n+    this.addMessageExplicitLine(\n+      loc.start.line,\n+      loc.start.column,\n+      defaultSeverity,\n+      message,\n+      ruleId,\n+      fix\n+    )\n   }\n \n-  addMessageExplicitLine(line, column, defaultSeverity, message, ruleId) {\n+  addMessageExplicitLine(line, column, defaultSeverity, message, ruleId, fix) {\n     const configSeverity = this.severityOf(ruleId)\n \n     if (this.config[ruleId] !== false && this.commentDirectiveParser.isRuleEnabled(line, ruleId)) {\n-      this.addReport(line, column + 1, configSeverity || defaultSeverity, message, ruleId)\n+      this.addReport(line, column + 1, configSeverity || defaultSeverity, message, ruleId, fix)\n     }\n   }\n \n-  error(ctx, ruleId, message) {\n-    this.addMessage(ctx.getSourceInterval(), Reporter.SEVERITY.ERROR, message, ruleId)\n+  error(ctx, ruleId, message, fix) {\n+    this.addMessage(ctx.loc, Reporter.SEVERITY.ERROR, message, ruleId, fix)\n   }\n \n-  warn(ctx, ruleId, message) {\n-    this.addMessage(ctx.getSourceInterval(), Reporter.SEVERITY.WARN, message, ruleId)\n+  warn(ctx, ruleId, message, fix) {\n+    this.addMessage(ctx.loc, Reporter.SEVERITY.WARN, message, ruleId, fix)\n   }\n \n   errorAt(line, column, ruleId, message) {\n@@ -63,7 +66,7 @@\n   }\n \n   _countReportsWith(severity) {\n-    return this.reports.filter(i => i.severity === severity).length\n+    return this.reports.filter((i) => i.severity === severity).length\n   }\n \n   get messages() {\n",
					"match": false,
					"packageHash": "36cb3445677022ad53c93941ab8dce2d822863010932bf9f4dcee5498666e09e",
					"size": 2234,
					"sourceHash": "35302fd8a4909764ab90695e0a6d43c802b16ce2a31b14dc0e147c3e961f4772",
					"status": "content"
				},
				"lib/rules/align/array-declaration.js": {
					"match": false,
					"packageHash": "ab6ecce14c7ce7b464c406968aaccc8dd111854ef61a0caa2afd366e5c42b6ac",
					"size": 854,
					"status": "missing-in-source"
				},
				"lib/rules/align/brackets-align.js": {
					"match": false,
					"packageHash": "99a0fb9dc2216243e52847faf50638bf60c11bfb30a903d8c730ea6a60c254a4",
					"size": 2191,
					"status": "missing-in-source"
				},
				"lib/rules/align/expression-align.js": {
					"match": false,
					"packageHash": "2eaaaabe1fd26473694c0b4dc355139aec67b36bfb6b0f92040d7115126f6fe5",
					"size": 1974,
					"status": "missing-in-source"
				},
				"lib/rules/align/indent.js": {
					"match": false,
					"packageHash": "e73fcae352b9666c023a4561d93568642d19e1b24e8d16f6746d013abe8309de",
					"size": 9298,
					"status": "missing-in-source"
				},
				"lib/rules/align/index.js": {
					"match": false,
					"packageHash": "5612cf3e25d57774966a14d8bf3a2012a841ea51c9713a9ed7c2d94d11341c0a",
					"size": 904,
					"status": "missing-in-source"
				},
				"lib/rules/align/no-mix-tabs-and-spaces.js": {
					"match": false,
					"packageHash": "a9606150f627bc4dc54a1e71675263de1b5079ca2926d3993d6f2bd6b3c0df85",
					"size": 972,
					"status": "missing-in-source"
				},
				"lib/rules/align/no-spaces-before-semicolon.js": {
					"match": false,
					"packageHash": "45cd788b05d7ecea6c6564fa0df3000501b796e43a9c52491f8bc3a345cb3668",
					"size": 1059,
					"status": "missing-in-source"
				},
				"lib/rules/align/space-after-comma.js": {
					"match": false,
					"packageHash": "ae7b753e8f24ff44c6bcd25de8bf023aff8f44c11f5f1d9a303594b94598e1ef",
					"size": 1795,
					"status": "missing-in-source"
				},
				"lib/rules/align/statements-align.js": {
					"match": false,
					"packageHash": "41d28b5047308761c70f924404a64d3fef45b8ec9dd48c02fe9cc742386e5ea0",
					"size": 3374,
					"status": "missing-in-source"
				},
				"lib/rules/base-checker.js": {
					"diff": "--- published/lib/rules/base-checker.js\n+++ rebuilt/lib/rules/base-checker.js\n@@ -1,19 +1,106 @@\n+const chalk = require('chalk')\n+const Ajv = require('ajv')\n+const ajvErrors = require('ajv-errors')\n+// eslint-disable-next-line import/no-extraneous-dependencies\n+const betterAjvErrors = require('better-ajv-errors').default\n+\n class BaseChecker {\n-  constructor(reporter) {\n+  constructor(reporter, ruleId, meta) {\n     this.reporter = reporter\n+    this.ruleId = ruleId\n+    this.meta = meta\n+    this.enabled = true\n+    if (!reporter) return\n+\n+    const userConfig = reporter.config[ruleId]\n+    if (userConfig === undefined) return\n+\n+    // build schema related to userConfig and meta.schema\n+    const buildSchema = () => {\n+      const base = {\n+        type: 'object',\n+        properties: {\n+          severity: {\n+            enum: ['error', 'warn', 'off'],\n+            description: 'Severity level of the rule.',\n+          },\n+        },\n+        required: ['severity'],\n+        additionalProperties: false,\n+      }\n+\n+      if (Array.isArray(userConfig) && userConfig.length > 1 && meta.schema) {\n+        base.properties.options = {\n+          type: 'object',\n+          properties: {\n+            value: {\n+              ...meta.schema,\n+              errorMessage: meta.schema.description, // used by ajv-errors\n+            },\n+          },\n+          required: ['value'],\n+          additionalProperties: false,\n+        }\n+      }\n+\n+      return base\n+    }\n+\n+    const data =\n+      Array.isArray(userConfig) && userConfig.length > 1\n+        ? { severity: userConfig[0], options: { value: userConfig[1] } }\n+        : { severity: userConfig }\n+\n+    // build schema and cache by the actual content of the schema\n+    const schema = buildSchema()\n+    const schemaKey = ruleId + '//' + JSON.stringify(schema)\n+\n+    if (!BaseChecker.validators.has(schemaKey)) {\n+      const validate = BaseChecker.ajv.compile(schema)\n+      BaseChecker.validators.set(schemaKey, validate)\n+    }\n+\n+    const validate = BaseChecker.validators.get(schemaKey)\n+\n+    if (!validate(data)) {\n+      this.enabled = false\n+      let message = ''\n+      try {\n+        message =\n+          betterAjvErrors(validate.schema, data, validate.errors, {\n+            format: 'cli',\n+            indent: 2,\n+            json: JSON.stringify(data, null, 2),\n+          }) || ''\n+      } catch (_) {\n+        // noop\n+      }\n+      console.warn(\n+        chalk.yellow(`[solhint] Warning: invalid configuration for rule '${ruleId}':\\n${message}`)\n+      )\n+    }\n   }\n \n-  error(ctx, ruleId, message) {\n-    this.reporter.error(ctx, ruleId, message)\n+  error(ctx, msg, fix) {\n+    this.addReport('error', ctx, msg, fix)\n   }\n \n-  errorAt(line, column, ruleId, message) {\n-    this.reporter.errorAt(line, column, ruleId, message)\n+  warn(ctx, msg, fix) {\n+    this.addReport('warn', ctx, msg, fix)\n   }\n \n-  warn(ctx, ruleId, message) {\n",
					"match": false,
					"packageHash": "deaf26cb9d4d7100f355ad1d5387fb94db23293a6c190eb46276441bd94b42a7",
					"size": 380,
					"sourceHash": "3b03f4c5c936e84e985c5008f0e38fdbc745e9b945a4bee18781962b46de3f06",
					"status": "content"
				},
				"lib/rules/best-practises/code-complexity.js": {
					"match": false,
					"packageHash": "74b312bee6e909820e461fda2c5aa38d08c0a06101a42b4c8e02404deecaa9ae",
					"size": 1865,
					"status": "missing-in-source"
				},
				"lib/rules/best-practises/fallback-must-be-payable.js": {
					"match": false,
					"packageHash": "5edcb7d1094ffcd051ea44873ba1d8ff93fa4c942347ef5aa7dd8e0b097f58af",
					"size": 833,
					"status": "missing-in-source"
				},
				"lib/rules/best-practises/function-max-lines.js": {
					"match": false,
					"packageHash": "d3ab09104f46eec7d532a7027a1907e9b120a5aff6a3731871bc667649c62c59",
					"size": 1384,
					"status": "missing-in-source"
				},
				"lib/rules/best-practises/index.js": {
					"match": false,
					"packageHash": "25af349ff471357e40c968156f99e72daafef25843ab3fe0361947175b60d1ad",
					"size": 826,
					"status": "missing-in-source"
				},
				"lib/rules/best-practises/max-line-length.js": {
					"match": false,
					"packageHash": "bb0fe9d41d18e75aac199dc035ad356dde6c6a57771a78546c6c12ff6db3b40a",
					"size": 737,
					"status": "missing-in-source"
				},
				"lib/rules/best-practises/max-states-count.js": {
					"match": false,
					"packageHash": "812c5fd375fbf9fac58c47e912baf35c1c23ae9c143717d69f51f7d4c77faaeb",
					"size": 1684,
					"status": "missing-in-source"
				},
				"lib/rules/best-practises/no-empty-blocks.js": {
					"match": false,
					"packageHash": "690aca1eb24ee7f7ef98f345c4a97003d3ede460cfc4397dde745a53b57ad801",
					"size": 1140,
					"status": "missing-in-source"
				},
				"lib/rules/best-practises/no-unused-vars.js": {
					"match": false,
					"packageHash": "38266a342f736ab3ef60a6ccb846053fd78e61f589a9af367b9ade01eea761ad",
					"size": 3727,
					"status": "missing-in-source"
				},
				"lib/rules/deprecations/base-deprecation.js": {
					"diff": "--- published/lib/rules/deprecations/base-deprecation.js\n+++ rebuilt/lib/rules/deprecations/base-deprecation.js\n@@ -1,15 +1,15 @@\n-const BaseChecker = require('./../base-checker')\n+const BaseChecker = require('../base-checker')\n \n class BaseDeprecation extends BaseChecker {\n-  constructor(reporter) {\n-    super(reporter)\n+  constructor(reporter, ruleId, meta) {\n+    super(reporter, ruleId, meta)\n     this.active = false\n     this.deprecationVersion() // to ensure we have one.\n   }\n \n-  exitPragmaDirective(ctx) {\n-    const pragma = ctx.children[1].getText()\n-    const value = ctx.children[2].getText()\n+  PragmaDirective(node) {\n+    const pragma = node.name\n+    const value = node.value\n     if (pragma === 'solidity') {\n       const contextVersion = value.replace(/[^0-9.]/g, '').split('.')\n       const deprecationAt = this.deprecationVersion().split('.')\n",
					"match": false,
					"packageHash": "2a2b2811ef4269beede92c96bb7c92d4d19f5e068a3ad25477ee5af64df2d502",
					"size": 850,
					"sourceHash": "bec8fa7e91e88626527be16ef85aa6cf15bb7223ec25980ea770f4504cdad298",
					"status": "content"
				},
				"lib/rules/deprecations/constructor-syntax.js": {
					"diff": "--- published/lib/rules/deprecations/constructor-syntax.js\n+++ rebuilt/lib/rules/deprecations/constructor-syntax.js\n@@ -1,28 +1,43 @@\n const BaseDeprecation = require('./base-deprecation')\n-const TreeTraversing = require('./../../common/tree-traversing')\n \n-const traversing = new TreeTraversing()\n+const ruleId = 'constructor-syntax'\n+const meta = {\n+  type: 'best-practices',\n+\n+  docs: {\n+    description: 'Constructors should use the new constructor keyword.',\n+    category: 'Best Practices Rules',\n+  },\n+\n+  recommended: true,\n+  defaultSetup: 'warn',\n+\n+  schema: null,\n+}\n \n class ConstructorSyntax extends BaseDeprecation {\n+  constructor(reporter) {\n+    super(reporter, ruleId, meta)\n+  }\n+\n   deprecationVersion() {\n     return '0.4.22'\n   }\n \n-  exitFunctionDefinition(ctx) {\n-    if (this.active) {\n-      const contract = traversing.findParentType(ctx, 'ContractDefinitionContext')\n-      const contractName = contract.children[1].getText()\n-      const functionName = ctx.children[1].getText()\n-      if (functionName === contractName) {\n-        this.warn(ctx, 'constructor-syntax', 'Constructors should use the new constructor keyword.')\n-      }\n-    }\n+  PragmaDirective(node) {\n+    super.PragmaDirective(node)\n   }\n \n-  exitConstructorDefinition(ctx) {\n-    if (!this.active) {\n-      const message = 'Constructor keyword not available before 0.4.22 (' + this.version + ')'\n-      this.error(ctx, 'constructor-syntax', message)\n+  FunctionDefinition(node) {\n+    if (node.isConstructor) {\n+      if (node.name === null) {\n+        if (!this.active) {\n+          const message = 'Constructor keyword not available before 0.4.22 (' + this.version + ')'\n+          this.error(node, message)\n+        }\n+      } else if (this.active) {\n+        this.warn(node, 'Constructors should use the new constructor keyword.')\n+      }\n     }\n   }\n }\n",
					"match": false,
					"packageHash": "148a78e4b4320c7c4357febf22f6078754c3226f88df0aa4f1d4b9a3431a3da2",
					"size": 928,
					"sourceHash": "658558aeaae167b14c6bb66a9233b3f57ec7941d985158ed38a4aeb9f3e89054",
					"status": "content"
				},
				"lib/rules/deprecations/index.js": {
					"diff": "--- published/lib/rules/deprecations/index.js\n+++ rebuilt/lib/rules/deprecations/index.js\n@@ -1,3 +1,3 @@\n const ConstructorSyntax = require('./constructor-syntax')\n \n-module.exports = reporter => [new ConstructorSyntax(reporter)]\n+module.exports = (reporter) => [new ConstructorSyntax(reporter)]\n",
					"match": false,
					"packageHash": "184428512637eb8cdcd34eff897fa7dffad0bea78bf2918a44ac00c7c57d3164",
					"size": 122,
					"sourceHash": "3c3f00879b55968ed5e54c888017c9b7a896e1719946e9c8e5f2b708e61860d9",
					"status": "content"
				},
				"lib/rules/index.js": {
					"diff": "--- published/lib/rules/index.js\n+++ rebuilt/lib/rules/index.js\n@@ -1,22 +1,127 @@\n+const chalk = require('chalk')\n+const _ = require('lodash')\n const security = require('./security/index')\n const naming = require('./naming/index')\n const order = require('./order/index')\n-const align = require('./align/index')\n-const bestPractises = require('./best-practises/index')\n+const bestPractices = require('./best-practices/index')\n const deprecations = require('./deprecations/index')\n const miscellaneous = require('./miscellaneous/index')\n-const configObject = require('./../config')\n+const gasConsumption = require('./gas-consumption/index')\n+const configObject = require('../config')\n+const { validSeverityMap } = require('../config/config-validator')\n \n-module.exports = function checkers(reporter, configVals, inputSrc, fileName) {\n+const notifyRuleDeprecated = _.memoize((ruleId, deprecationMessage) => {\n+  const message = deprecationMessage\n+    ? `[solhint] Warning: rule '${ruleId}' is deprecated, ${deprecationMessage}.`\n+    : `[solhint] Warning: rule '${ruleId}' is deprecated.`\n+  console.warn(chalk.yellow(message))\n+})\n+\n+const notifyRuleDoesntExist = _.memoize((ruleId) => {\n+  console.warn(chalk.yellow(`[solhint] Warning: Rule '${ruleId}' doesn't exist`))\n+})\n+\n+module.exports = function checkers(reporter, configVals, inputSrc, tokens, fileName) {\n   const config = configObject.from(configVals)\n+  const { rules } = config\n+  const meta = {\n+    reporter,\n+    config,\n+    inputSrc,\n+    tokens,\n+    fileName,\n+  }\n+  const plugins = config.plugins || []\n+\n+  const allRules = [...coreRules(meta), ...pluginsRules(plugins, meta)]\n+\n+  const enabledRules = allRules.filter((coreRule) => ruleEnabled(coreRule, rules))\n+\n+  // show warnings for deprecated rules\n+  for (const rule of enabledRules) {\n+    if (rule.meta && rule.meta.deprecated) {\n+      notifyRuleDeprecated(rule.ruleId, rule.meta.deprecationMessage)\n+    }\n+  }\n+\n+  const configRules = Object.keys(config.rules)\n+  const allRuleIds = allRules.map((rule) => rule.ruleId)\n+  for (const rule of configRules) {\n+    if (!allRuleIds.includes(rule)) {\n+      notifyRuleDoesntExist(rule)\n+    }\n+  }\n+\n+  return enabledRules\n+}\n+\n+function coreRules(meta) {\n+  const { reporter, config, inputSrc, tokens, fileName } = meta\n \n   return [\n-    ...security(reporter, config),\n-    ...order(reporter, config),\n+    ...bestPractices(reporter, config, inputSrc, tokens),\n+    ...deprecations(reporter),\n+    ...miscellaneous(reporter, config, tokens, fileName),\n     ...naming(reporter, config),\n-    ...align(reporter, config),\n-    ...deprecations(reporter, config),\n-    ...bestPractises(reporter, config),\n-    ...miscellaneous(reporter, config, inputSrc, fileName)\n+    ...order(reporter, tokens),\n+    ...security(reporter, config, inputSrc),\n+    ...gasConsumption(reporter, config),\n   ]\n }\n+\n+function loadPlugin(pluginName, { reporter, config, inputSrc, fileName }) {\n+  let plugins\n+  try {\n+    plugins = require(`solhint-plugin-${pluginName}`)\n+  } catch (e) {\n+    console.error(\n+      chalk.red(\n+        `[solhint] Error: Could not load solhint-plugin-${pluginName}, make sure it's installed.`\n+      )\n+    )\n+    process.exit(1)\n+  }\n+\n+  if (!Array.isArray(plugins)) {\n+    console.warn(\n+      chalk.yellow(\n",
					"match": false,
					"packageHash": "a06c3ab2133392ce9df2e8007118365304fd0a293a44fb797c28c15941ec312b",
					"size": 787,
					"sourceHash": "e1c710445752d53dff6f89998bb51896d5a4370146c06f8a1c7138a5506fc142",
					"status": "content"
				},
				"lib/rules/miscellaneous/index.js": {
					"diff": "--- published/lib/rules/miscellaneous/index.js\n+++ rebuilt/lib/rules/miscellaneous/index.js\n@@ -1,20 +1,15 @@\n-const Prettier = require('./prettier')\n const QuotesChecker = require('./quotes')\n-const { RULES } = require('../../constants')\n+const ComprehensiveInterfaceChecker = require('./comprehensive-interface')\n+const DuplicatedImportsChecker = require('./duplicated-imports')\n+const ImportPathChecker = require('./import-path-check')\n+const FoundryNoBlockTimeNumberChecker = require('./foundry-no-block-time-number')\n \n-module.exports = function checkers(reporter, config, inputSrc, fileName) {\n-  const { rules, validateDisabledByDefault } = config\n-\n-  const rulesToCheck = [\n-    {\n-      rule: RULES.QUOTES,\n-      instance: new QuotesChecker(reporter, config)\n-    },\n-    {\n-      rule: RULES.PRETTIER,\n-      instance: new Prettier(reporter, config, inputSrc, fileName)\n-    }\n+module.exports = function checkers(reporter, config, tokens, fileName) {\n+  return [\n+    new QuotesChecker(reporter, config, tokens),\n+    new ComprehensiveInterfaceChecker(reporter, config, tokens),\n+    new DuplicatedImportsChecker(reporter),\n+    new ImportPathChecker(reporter, config, fileName),\n+    new FoundryNoBlockTimeNumberChecker(reporter, config, fileName),\n   ]\n-\n-  return validateDisabledByDefault(rules, rulesToCheck)\n }\n",
					"match": false,
					"packageHash": "dcf641440cb8d1f24cd34b910da572873a4702e3e476347c2f14035050386457",
					"size": 543,
					"sourceHash": "517a340a5cc89bc96c782ca9bee99f80aa10b86446a26f9e7a953e133a27b77f",
					"status": "content"
				},
				"lib/rules/miscellaneous/prettier.js": {
					"match": false,
					"packageHash": "bfcacc2fef1baf8a271c1d53cf36259ffde636fefa740305bddbcd3f98c53deb",
					"size": 2136,
					"status": "missing-in-source"
				},
				"lib/rules/miscellaneous/quotes.js": {
					"diff": "--- published/lib/rules/miscellaneous/quotes.js\n+++ rebuilt/lib/rules/miscellaneous/quotes.js\n@@ -1,47 +1,145 @@\n const BaseChecker = require('../base-checker')\n-const { RULES } = require('../../constants')\n+const { severityDescription, formatEnum } = require('../../doc/utils')\n+\n+const ruleId = 'quotes'\n+\n+const DEFAULT_SEVERITY = 'error'\n+const DEFAULT_QUOTES_TYPE = 'double'\n+const QUOTE_TYPES = ['single', 'double']\n+const ERR_DESCRIPTION = `Options need to be one of ${formatEnum(QUOTE_TYPES)}`\n+\n+const meta = {\n+  type: 'miscellaneous',\n+\n+  docs: {\n+    description: `Enforces the use of double or simple quotes as configured for string literals. Values must be 'single' or 'double'.`,\n+    category: 'Miscellaneous',\n+    options: [\n+      {\n+        description: severityDescription,\n+        default: DEFAULT_SEVERITY,\n+      },\n+      {\n+        description: `Type of quotes. Must be one of ${formatEnum(QUOTE_TYPES)}`,\n+        default: DEFAULT_QUOTES_TYPE,\n+      },\n+    ],\n+    examples: {\n+      good: [\n+        {\n+          description: 'Configured with double quotes',\n+          code: require('../../fixtureCases/miscellaneous/string-with-double-quotes'),\n+        },\n+        {\n+          description: 'Configured with single quotes',\n+          code: require('../../fixtureCases/miscellaneous/string-with-single-quotes'),\n+        },\n+        {\n+          description: 'Configured with double quotes',\n+          code: 'string private constant STR = \"You shall \\'pass\\' !\";',\n+        },\n+        {\n+          description: 'Configured with single quotes',\n+          code: 'string private constant STR = \\'You shall \"pass\" !\\';',\n+        },\n+      ],\n+      bad: [\n+        {\n+          description: 'Configured with single quotes',\n+          code: require('../../fixtureCases/miscellaneous/string-with-double-quotes'),\n+        },\n+        {\n+          description: 'Configured with double quotes',\n+          code: require('../../fixtureCases/miscellaneous/string-with-single-quotes'),\n+        },\n+      ],\n+    },\n+    notes: [\n+      {\n+        note: 'This rule allows to put a double quote inside single quote string and vice versa',\n+      },\n+    ],\n+  },\n+\n+  recommended: true,\n+  defaultSetup: [DEFAULT_SEVERITY, DEFAULT_QUOTES_TYPE],\n+  fixable: true,\n+  schema: {\n+    type: 'string',\n+    enum: QUOTE_TYPES,\n+    description: ERR_DESCRIPTION + ' and a String.',\n+  },\n+}\n \n class QuotesChecker extends BaseChecker {\n-  constructor(reporter, config) {\n-    super(reporter)\n+  constructor(reporter, config, tokens) {\n+    super(reporter, ruleId, meta)\n+    this.tokens = tokens\n+    this.visitedNodes = new Set()\n \n-    const quoteType = config.rules && config.rules.quotes && config.rules.quotes[1]\n-    this.quoteType = (['double', 'single'].includes(quoteType) && quoteType) || 'double'\n+    const quoteType = config && config.rules && config.rules.quotes && config.rules.quotes[1]\n+    this.quoteType = (QUOTE_TYPES.includes(quoteType) && quoteType) || DEFAULT_QUOTES_TYPE\n     this.incorrectQuote = this.quoteType === 'single' ? '\"' : \"'\"\n   }\n \n-  exitPrimaryExpression(ctx) {\n-    this.validateQuotes(ctx)\n+  StringLiteral(node) {\n+    const token = this.tokens.find(\n+      (token) =>\n+        token.loc.start.line === node.loc.start.line &&\n+        token.loc.start.column === node.loc.start.column\n+    )\n",
					"match": false,
					"packageHash": "3a816a5bce86de3de8da421354c0f8eaea6b2e931bade8723e2feedd732f6c22",
					"size": 1212,
					"sourceHash": "32d3469f8353c77678f0be7b9dfcd00f06ad210016fca0450bfbfa1206fb762d",
					"status": "content"
				},
				"lib/rules/naming/contract-library-style.js": {
					"match": false,
					"packageHash": "38e262fae93c99575e5d34bf1a4ab54c44f896dc6725574c950388bb06e15a29",
					"size": 713,
					"status": "missing-in-source"
				},
				"lib/rules/naming/event-name-style.js": {
					"match": false,
					"packageHash": "ad2aa1a37e1b14fb1eff437499ced445bda3552ca13b5d392d817b1d680e1714",
					"size": 438,
					"status": "missing-in-source"
				},
				"lib/rules/naming/forbidden-names.js": {
					"match": false,
					"packageHash": "735375c2a0735813d4a2c976514e46bc8e4d05d28cc3e0a33cbe3adc91d5f752",
					"size": 388,
					"status": "missing-in-source"
				},
				"lib/rules/naming/func-name-style.js": {
					"match": false,
					"packageHash": "2a0abca2b26fa71682adc055b7fbc1e894182b650ecf1a3bcb97e23e5fa68a8b",
					"size": 906,
					"status": "missing-in-source"
				},
				"lib/rules/naming/func-params-style.js": {
					"match": false,
					"packageHash": "7c6ccfeffbd631e02c437349ca80139b610e3f4659e3294ed699d0397887e501",
					"size": 814,
					"status": "missing-in-source"
				},
				"lib/rules/naming/index.js": {
					"diff": "--- published/lib/rules/naming/index.js\n+++ rebuilt/lib/rules/naming/index.js\n@@ -1,19 +1,38 @@\n-const FunctionNameStyleChecker = require('./func-name-style')\n-const FunctionParamNameStyleChecker = require('./func-params-style')\n-const VarNameStyleChecker = require('./var-name-style')\n-const EventNameStyleChecker = require('./event-name-style')\n-const ModifierNameStyleChecker = require('./modifier-name-style')\n-const ContractNameStyleChecker = require('./contract-library-style')\n-const ForbiddenNamesChecker = require('./forbidden-names')\n+const ConstNameSnakecaseChecker = require('./const-name-snakecase')\n+const ContractNameCapWordsChecker = require('./contract-name-capwords')\n+const EventNameCapWordsChecker = require('./event-name-capwords')\n+const FuncNameMixedcaseChecker = require('./func-name-mixedcase')\n+const FuncParamNameMixedcaseChecker = require('./func-param-name-mixedcase')\n+const ModifierNameMixedcaseChecker = require('./modifier-name-mixedcase')\n+const PrivateVarsLeadingUnderscoreChecker = require('./private-vars-leading-underscore')\n+const UseForbiddenNameChecker = require('./use-forbidden-name')\n+const VarNameMixedcaseChecker = require('./var-name-mixedcase')\n+const NamedParametersMappingChecker = require('./named-parameters-mapping')\n+const ImmutableVarsNamingChecker = require('./immutable-vars-naming')\n+const FunctionNamedParametersChecker = require('./func-named-parameters')\n \n-module.exports = function checkers(reporter) {\n+// 👇 old (alias with deprecation)\n+const FoundryTestFunctionsChecker = require('./foundry-test-functions')\n+// 👇 new name\n+const FoundryTestFunctionNamingChecker = require('./foundry-test-function-naming')\n+\n+module.exports = function checkers(reporter, config) {\n   return [\n-    new FunctionNameStyleChecker(reporter),\n-    new FunctionParamNameStyleChecker(reporter),\n-    new VarNameStyleChecker(reporter),\n-    new EventNameStyleChecker(reporter),\n-    new ModifierNameStyleChecker(reporter),\n-    new ContractNameStyleChecker(reporter),\n-    new ForbiddenNamesChecker(reporter)\n+    new ConstNameSnakecaseChecker(reporter),\n+    new ContractNameCapWordsChecker(reporter),\n+    new EventNameCapWordsChecker(reporter),\n+    new FuncNameMixedcaseChecker(reporter),\n+    new FuncParamNameMixedcaseChecker(reporter),\n+    new ModifierNameMixedcaseChecker(reporter),\n+    new PrivateVarsLeadingUnderscoreChecker(reporter, config),\n+    new UseForbiddenNameChecker(reporter),\n+    new VarNameMixedcaseChecker(reporter, config),\n+    new NamedParametersMappingChecker(reporter),\n+    new ImmutableVarsNamingChecker(reporter, config),\n+    new FunctionNamedParametersChecker(reporter, config),\n+\n+    // 👇 call both\n+    new FoundryTestFunctionsChecker(reporter, config),\n+    new FoundryTestFunctionNamingChecker(reporter, config),\n   ]\n }\n",
					"match": false,
					"packageHash": "e4da440f41ef30e530045ccf0ca5be5a1c0cf3ae6f52e0aa8675e162fcb4dcbf",
					"size": 807,
					"sourceHash": "0e8221145d6d6bc18ce1d7394248c520b219a71a5c7831a687e4f325ef1e9ab6",
					"status": "content"
				},
				"lib/rules/naming/modifier-name-style.js": {
					"match": false,
					"packageHash": "ccda4e5e066cc308449e441d1abca42836e29af8bc89e3cffa4007eacf6f4f56",
					"size": 453,
					"status": "missing-in-source"
				},
				"lib/rules/naming/var-name-style.js": {
					"match": false,
					"packageHash": "3eed93e27332df44050c6d251c895d7f800150b74e196336b26ed10c28edf772",
					"size": 1373,
					"status": "missing-in-source"
				},
				"lib/rules/order/function-order.js": {
					"match": false,
					"packageHash": "4a17bcffca7c5293b683d1ca2c64ad9c9d48d6d454b4d20e8927d05d52112931",
					"size": 5410,
					"status": "missing-in-source"
				},
				"lib/rules/order/imports-on-top.js": {
					"diff": "--- published/lib/rules/order/imports-on-top.js\n+++ rebuilt/lib/rules/order/imports-on-top.js\n@@ -1,24 +1,42 @@\n-const BaseChecker = require('./../base-checker')\n-const { typeOf } = require('./../../common/tree-traversing')\n+const BaseChecker = require('../base-checker')\n+\n+const ruleId = 'imports-on-top'\n+const meta = {\n+  type: 'order',\n+\n+  docs: {\n+    description: `Import statements must be on top.`,\n+    category: 'Style Guide Rules',\n+  },\n+\n+  recommended: true,\n+  defaultSetup: 'warn',\n+\n+  schema: null,\n+}\n \n class ImportsOnTopChecker extends BaseChecker {\n-  exitSourceUnit(ctx) {\n+  constructor(reporter) {\n+    super(reporter, ruleId, meta)\n+  }\n+\n+  SourceUnit(node) {\n     let hasContractDef = false\n-    for (let i = 0; ctx.children && i < ctx.children.length; i += 1) {\n-      const curItem = ctx.children[i]\n+    for (let i = 0; node.children && i < node.children.length; i += 1) {\n+      const curItem = node.children[i]\n \n-      if (typeOf(curItem) === 'contractDefinition') {\n+      if (curItem.type === 'ContractDefinition') {\n         hasContractDef = true\n       }\n \n-      if (hasContractDef && typeOf(curItem) === 'importDirective') {\n+      if (hasContractDef && curItem.type === 'ImportDirective') {\n         this._error(curItem)\n       }\n     }\n   }\n \n-  _error(ctx) {\n-    this.error(ctx, 'imports-on-top', 'Import statements must be on top')\n+  _error(node) {\n+    this.error(node, 'Import statements must be on top')\n   }\n }\n \n",
					"match": false,
					"packageHash": "8459c84a5532065e1cc9015690e935e4f0e223b8e47e35b715ff48b56e5bc1e0",
					"size": 668,
					"sourceHash": "654ab4b2644f9a7379e0807a70a2d0dfcc108e893fc492515f32be30a4cd5b31",
					"status": "content"
				},
				"lib/rules/order/index.js": {
					"diff": "--- published/lib/rules/order/index.js\n+++ rebuilt/lib/rules/order/index.js\n@@ -1,15 +1,13 @@\n-const VisibilityModifierOrderChecker = require('./visibility-modifier-order')\n const ImportsOnTopChecker = require('./imports-on-top')\n-const SeparateTopLevelByTwoLinesChecker = require('./separate-top-level-by-two-lines')\n-const FunctionOrderChecker = require('./function-order')\n-const OneLineBetweenContractPartsChecker = require('./one-line-between-contract-parts')\n+const VisibilityModifierOrderChecker = require('./visibility-modifier-order')\n+const OrderingChecker = require('./ordering')\n+const ImportsOrderChecker = require('./imports-order')\n \n-module.exports = function order(reporter) {\n+module.exports = function order(reporter, tokens) {\n   return [\n-    new VisibilityModifierOrderChecker(reporter),\n     new ImportsOnTopChecker(reporter),\n-    new SeparateTopLevelByTwoLinesChecker(reporter),\n-    new FunctionOrderChecker(reporter),\n-    new OneLineBetweenContractPartsChecker(reporter)\n+    new VisibilityModifierOrderChecker(reporter, tokens),\n+    new OrderingChecker(reporter),\n+    new ImportsOrderChecker(reporter),\n   ]\n }\n",
					"match": false,
					"packageHash": "0c19533c266711c1482407c533be58015672ca5b87432b729ddb671a284b0de3",
					"size": 663,
					"sourceHash": "3e2e83f02427cf0b413ca8861590487d2c8b11f0d17dee433434c3f3d2cfd692",
					"status": "content"
				},
				"lib/rules/order/one-line-between-contract-parts.js": {
					"match": false,
					"packageHash": "436751a7fa5d1906faa0690a90e4d3225cec3c69ea835ecbc2d7dbdee6a243a5",
					"size": 1237,
					"status": "missing-in-source"
				},
				"lib/rules/order/separate-top-level-by-two-lines.js": {
					"match": false,
					"packageHash": "22e8b36870de5a8ed01990b28804d356f10948619c693d925dceae54333f483d",
					"size": 1378,
					"status": "missing-in-source"
				},
				"lib/rules/order/visibility-modifier-order.js": {
					"diff": "--- published/lib/rules/order/visibility-modifier-order.js\n+++ rebuilt/lib/rules/order/visibility-modifier-order.js\n@@ -1,30 +1,93 @@\n-const BaseChecker = require('./../base-checker')\n+const BaseChecker = require('../base-checker')\n \n-class VisibilityModifierOrderChecker extends BaseChecker {\n-  exitModifierList(ctx) {\n-    if (this.containsVisibilityModifier(ctx)) {\n-      const firstModifier = ctx.children[0]\n+const ruleId = 'visibility-modifier-order'\n+const meta = {\n+  type: 'order',\n+\n+  docs: {\n+    description: `Visibility modifier must be first in list of modifiers.`,\n+    category: 'Style Guide Rules',\n+    examples: {\n+      good: [\n+        {\n+          description: 'Visibility modifier placed first',\n+          code: require('../../fixtureCases/order/visibility-modifier-first'),\n+        },\n+      ],\n+      bad: [\n+        {\n+          description: 'Visibility modifier not placed first',\n+          code: require('../../fixtureCases/order/visibility-modifier-not-first'),\n+        },\n+      ],\n+    },\n+  },\n \n-      if (!this.containsVisibilityModifier(firstModifier)) {\n-        this._error(firstModifier)\n-      }\n-    }\n+  recommended: true,\n+  defaultSetup: 'warn',\n+\n+  schema: null,\n+}\n+\n+class VisibilityModifierOrderChecker extends BaseChecker {\n+  constructor(reporter, tokens) {\n+    super(reporter, ruleId, meta)\n+    this.tokens = tokens\n   }\n \n-  containsVisibilityModifier(ctx) {\n-    const text = ctx.getText()\n+  getTokensWithoutFunctionParams(node) {\n+    const parametersCount = node.parameters.length\n+    const nodeStart = parametersCount\n+      ? node.parameters[parametersCount - 1].loc.end\n+      : node.loc.start\n+    const lastParamIndex = this.tokens.findIndex(\n+      (token) =>\n+        token.loc.start.line === nodeStart.line && token.loc.start.column === nodeStart.column\n+    )\n+\n+    // discard parameters\n+    return this.tokens.slice(lastParamIndex + 1)\n+  }\n \n-    const hasInternal = text.includes('internal')\n-    const hasExternal = text.includes('external')\n-    const hasPrivate = text.includes('private')\n-    const hasPublic = text.includes('public')\n+  FunctionDefinition(node) {\n+    if (node.visibility !== 'default' && (node.stateMutability || node.modifiers.length)) {\n+      const functionTokens = []\n+      const nodeEnd = node.loc.end\n+      const tokens = this.getTokensWithoutFunctionParams(node)\n+\n+      for (let i = 0, n = tokens.length; i < n; ++i) {\n+        const token = tokens[i]\n+\n+        if (functionTokens.length && token.value === '{') break\n+\n+        const {\n+          type,\n+          loc: { start },\n+        } = token\n+\n+        if (start.line <= nodeEnd.line && ['Keyword', 'Identifier'].includes(type)) {\n+          functionTokens.push(token)\n+        }\n+      }\n \n-    return hasExternal || hasInternal || hasPrivate || hasPublic\n+      const visibilityIndex = functionTokens.findIndex((t) => t.value === node.visibility)\n+      const stateMutabilityIndex = functionTokens.findIndex((t) => t.value === node.stateMutability)\n+      const modifierIndex = node.modifiers.length\n+        ? functionTokens.findIndex((t) => t.value === node.modifiers[0].name)\n+        : -1\n+\n+      if (\n+        (stateMutabilityIndex > -1 && visibilityIndex > stateMutabilityIndex) ||\n+        (modifierIndex > -1 && visibilityIndex > modifierIndex)\n",
					"match": false,
					"packageHash": "8df2ce2263faf98b9558aebd8c0c82635817fbe3c5f55a4d8e1663cebdf5d589",
					"size": 882,
					"sourceHash": "aeed2e4d85a545a0ec19d6735530df451d0ba1d26d9fc87b8596e7497dc2b1b2",
					"status": "content"
				},
				"lib/rules/security/avoid-deprecations.js": {
					"match": false,
					"packageHash": "88017cdfa66964d9b16893acf9af739c02c71f70d02ccc3cbbe39d94bc24c8ca",
					"size": 597,
					"status": "missing-in-source"
				},
				"lib/rules/security/avoid-low-level-calls.js": {
					"diff": "--- published/lib/rules/security/avoid-low-level-calls.js\n+++ rebuilt/lib/rules/security/avoid-low-level-calls.js\n@@ -1,16 +1,81 @@\n-const BaseChecker = require('./../base-checker')\n-const { hasMethodCalls } = require('./../../common/tree-traversing')\n+/* eslint-disable no-fallthrough */\n+/* eslint-disable default-case */\n+const BaseChecker = require('../base-checker')\n+const { hasMethodCalls } = require('../../common/tree-traversing')\n+const LOW_LEVEL_CALLS = require('../../fixtureCases/security/low-level-calls')\n+\n+const WARN_LOW_LEVEL_CALLS = LOW_LEVEL_CALLS[0]\n+const ALLOWED_LOW_LEVEL_CALLS = LOW_LEVEL_CALLS[1]\n+\n+const ruleId = 'avoid-low-level-calls'\n+const meta = {\n+  type: 'security',\n+\n+  docs: {\n+    description: `Avoid to use low level calls.`,\n+    category: 'Security Rules',\n+    examples: {\n+      good: [\n+        {\n+          description: 'Using low level calls to transfer funds',\n+          code: ALLOWED_LOW_LEVEL_CALLS.join('\\n'),\n+        },\n+      ],\n+      bad: [\n+        {\n+          description: 'Using low level calls',\n+          code: WARN_LOW_LEVEL_CALLS.join('\\n'),\n+        },\n+      ],\n+    },\n+  },\n+\n+  recommended: true,\n+  defaultSetup: 'warn',\n+\n+  schema: null,\n+}\n \n class AvoidLowLevelCallsChecker extends BaseChecker {\n-  exitExpression(ctx) {\n-    if (hasMethodCalls(ctx, ['call', 'callcode', 'delegatecall'])) {\n-      this._warn(ctx)\n+  constructor(reporter) {\n+    super(reporter, ruleId, meta)\n+  }\n+\n+  FunctionCall(node) {\n+    switch (node.expression.type) {\n+      case 'MemberAccess':\n+        if (\n+          // can add 'value' in the array of hasMethodCalls() and remove the || condition but seems out of place\n+          hasMethodCalls(node.expression, ['call', 'callcode', 'delegatecall']) ||\n+          (node.expression.expression.memberName === 'call' && // this is for anyAddress.call.value(code)()\n+            node.expression.memberName === 'value')\n+        ) {\n+          return this._warn(node)\n+        }\n+      case 'NameValueExpression':\n+        // Allow low level method calls for transferring funds\n+        //\n+        // See:\n+        //\n+        // - https://solidity-by-example.org/sending-ether/\n+        // - https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/\n+        if (\n+          node.expression.expression.memberName === 'call' &&\n+          node.expression.arguments.type === 'NameValueList' &&\n+          node.expression.arguments.names.includes('value')\n+        ) {\n+          return\n+        }\n+\n+        if (hasMethodCalls(node.expression.expression, ['call', 'callcode', 'delegatecall'])) {\n+          return this._warn(node)\n+        }\n     }\n   }\n \n   _warn(ctx) {\n     const message = 'Avoid to use low level calls.'\n-    this.warn(ctx, 'avoid-low-level-calls', message)\n+    this.warn(ctx, message)\n   }\n }\n \n",
					"match": false,
					"packageHash": "06b70b460059281cc01989b20a0b74a51843cdaae4c0991776f78852eaa79e97",
					"size": 469,
					"sourceHash": "0b85386b59e36dbc4a278ded8f7233fa4edaae1d50cf0ac0ac3514c090b4bd37",
					"status": "content"
				},
				"lib/rules/security/avoid-tx-origin.js": {
					"diff": "--- published/lib/rules/security/avoid-tx-origin.js\n+++ rebuilt/lib/rules/security/avoid-tx-origin.js\n@@ -1,29 +1,29 @@\n-const BaseChecker = require('./../base-checker')\n+const BaseChecker = require('../base-checker')\n \n-class AvoidTxOriginChecker extends BaseChecker {\n-  exitExpression(ctx) {\n-    // expression1 '.' expression2\n-    const { expression1, dot, expression2 } = this._nodes(ctx)\n+const ruleId = 'avoid-tx-origin'\n+const meta = {\n+  type: 'security',\n \n-    if (dot && expression1.getText() === 'tx' && expression2.getText() === 'origin') {\n-      this.error(ctx, 'avoid-tx-origin', 'Avoid to use tx.origin')\n-    }\n-  }\n+  docs: {\n+    description: `Avoid to use tx.origin.`,\n+    category: 'Security Rules',\n+  },\n \n-  _nodes(ctx) {\n-    if (!this._isDotExpression(ctx)) {\n-      return {}\n-    }\n+  recommended: true,\n+  defaultSetup: 'warn',\n \n-    return {\n-      expression1: ctx.children[0],\n-      dot: ctx.children[1],\n-      expression2: ctx.children[2]\n-    }\n+  schema: null,\n+}\n+\n+class AvoidTxOriginChecker extends BaseChecker {\n+  constructor(reporter) {\n+    super(reporter, ruleId, meta)\n   }\n \n-  _isDotExpression(ctx) {\n-    return ctx.children && ctx.children[1] && ctx.children[1].getText() === '.'\n+  MemberAccess(node) {\n+    if (node.expression.name === 'tx' && node.memberName === 'origin') {\n+      this.error(node, 'Avoid to use tx.origin')\n+    }\n   }\n }\n \n",
					"match": false,
					"packageHash": "d7002372576d2f838bbf91632a69335ff169b5a3c70ce0191e59b13709a1b05e",
					"size": 739,
					"sourceHash": "c5241868147c1e8ef858caf61296bcb451cdbae590b54e837eac19b217ad0601",
					"status": "content"
				},
				"lib/rules/security/explicit-visibility.js": {
					"match": false,
					"packageHash": "7034fe7d4da579cf31a4ec03dd70cd121e82d02b13ee314c069cb9f57e9ff193",
					"size": 923,
					"status": "missing-in-source"
				},
				"lib/rules/security/external-call.js": {
					"match": false,
					"packageHash": "9155e70ae7239308666161902259c8ad8624ce0d3618092c59bef89bba9da1da",
					"size": 894,
					"status": "missing-in-source"
				},
				"lib/rules/security/fixed-compiler.js": {
					"match": false,
					"packageHash": "dea047f24c526bf29c8c223b30c253def64006edfcc73c0bb44d5d44b93d7b05",
					"size": 614,
					"status": "missing-in-source"
				},
				"lib/rules/security/index.js": {
					"diff": "--- published/lib/rules/security/index.js\n+++ rebuilt/lib/rules/security/index.js\n@@ -1,33 +1,39 @@\n-const ExternalCallChecker = require('./external-call')\n-const CompilerVersionChecker = require('./fixed-compiler')\n-const ExplicitVisibilityChecker = require('./explicit-visibility')\n-const AvoidDeprecationsChecker = require('./avoid-deprecations')\n-const KeepFallbackSimpleChecker = require('./keep-fallback-simple')\n-const NoSimilarFuncEventNamesChecker = require('./no-similar-func-event-names')\n-const MultipleSendCallsInTxChecker = require('./multiple-send-calls-in-tx')\n-// const MarkUntrustedContractsChecker = require('./mark-unstrusted-contracts');\n+const AvoidCallValueChecker = require('./avoid-call-value')\n+const AvoidLowLevelCallsChecker = require('./avoid-low-level-calls')\n+const AvoidSha3Checker = require('./avoid-sha3')\n+const AvoidSuicideChecker = require('./avoid-suicide')\n+const AvoidThrowChecker = require('./avoid-throw')\n const AvoidTxOriginChecker = require('./avoid-tx-origin')\n-const NotRelyOnTimeChecker = require('./not-rely-on-time')\n+const CheckSendResultChecker = require('./check-send-result')\n+const CompilerVersionChecker = require('./compiler-version')\n+const FuncVisibilityChecker = require('./func-visibility')\n+const MultipleSendsChecker = require('./multiple-sends')\n+const NoComplexFallbackChecker = require('./no-complex-fallback')\n const NoInlineAssemblyChecker = require('./no-inline-assembly')\n const NotRelyOnBlockHashChecker = require('./not-rely-on-block-hash')\n+const NotRelyOnTimeChecker = require('./not-rely-on-time')\n const ReentrancyChecker = require('./reentrancy')\n-const AvoidLowLevelCallsChecker = require('./avoid-low-level-calls')\n+const StateVisibilityChecker = require('./state-visibility')\n+const ImmutableB4DeclarationChecker = require('./no-immutable-before-declaration')\n \n-module.exports = function security(reporter) {\n+module.exports = function security(reporter, config, inputSrc) {\n   return [\n-    new ExternalCallChecker(reporter),\n-    new CompilerVersionChecker(reporter),\n-    new ExplicitVisibilityChecker(reporter),\n-    new AvoidDeprecationsChecker(reporter),\n-    new KeepFallbackSimpleChecker(reporter),\n-    new NoSimilarFuncEventNamesChecker(reporter),\n-    new MultipleSendCallsInTxChecker(reporter),\n-    // new MarkUntrustedContractsChecker(reporter),\n+    new AvoidCallValueChecker(reporter),\n+    new AvoidLowLevelCallsChecker(reporter),\n+    new AvoidSha3Checker(reporter),\n+    new AvoidSuicideChecker(reporter),\n+    new AvoidThrowChecker(reporter),\n     new AvoidTxOriginChecker(reporter),\n-    new NotRelyOnTimeChecker(reporter),\n+    new CheckSendResultChecker(reporter),\n+    new CompilerVersionChecker(reporter, config),\n+    new FuncVisibilityChecker(reporter, config),\n+    new MultipleSendsChecker(reporter),\n+    new NoComplexFallbackChecker(reporter),\n     new NoInlineAssemblyChecker(reporter),\n     new NotRelyOnBlockHashChecker(reporter),\n-    new ReentrancyChecker(reporter),\n-    new AvoidLowLevelCallsChecker(reporter)\n+    new NotRelyOnTimeChecker(reporter),\n+    new ReentrancyChecker(reporter, inputSrc),\n+    new StateVisibilityChecker(reporter),\n+    new ImmutableB4DeclarationChecker(reporter),\n   ]\n }\n",
					"match": false,
					"packageHash": "e25cfd664045d451fd89cb0f5c6b44f366ed616374043e168e14cdd76ad6d917",
					"size": 1600,
					"sourceHash": "b7d45fa4c6340e93db6c99fb561b5c6fbdfbd84c2347e83f41f0340c2f11f1b1",
					"status": "content"
				},
				"lib/rules/security/keep-fallback-simple.js": {
					"match": false,
					"packageHash": "1123061c827fa678171035b4f8a8c615cc8ac62da598beb5481909dc9c158d30",
					"size": 940,
					"status": "missing-in-source"
				},
				"lib/rules/security/mark-unstrusted-contracts.js": {
					"match": false,
					"packageHash": "f4c3c8e0d69b6ab09e368226e13a1445eafdc6a288fe993b8dd9ead7d601381e",
					"size": 885,
					"status": "missing-in-source"
				},
				"lib/rules/security/multiple-send-calls-in-tx.js": {
					"match": false,
					"packageHash": "5d3350a8940c4ce2d2108d447334c908f175706c36b730c12f77ced79c1243c5",
					"size": 1449,
					"status": "missing-in-source"
				},
				"lib/rules/security/no-inline-assembly.js": {
					"diff": "--- published/lib/rules/security/no-inline-assembly.js\n+++ rebuilt/lib/rules/security/no-inline-assembly.js\n@@ -1,13 +1,31 @@\n-const BaseChecker = require('./../base-checker')\n+const BaseChecker = require('../base-checker')\n+\n+const ruleId = 'no-inline-assembly'\n+const meta = {\n+  type: 'security',\n+\n+  docs: {\n+    description: `Avoid to use inline assembly. It is acceptable only in rare cases.`,\n+    category: 'Security Rules',\n+  },\n+\n+  recommended: true,\n+  defaultSetup: 'warn',\n+\n+  schema: null,\n+}\n \n class NoInlineAssemblyChecker extends BaseChecker {\n-  exitInlineAssemblyStatement(ctx) {\n-    this.error(ctx)\n+  constructor(reporter) {\n+    super(reporter, ruleId, meta)\n+  }\n+\n+  InlineAssemblyStatement(node) {\n+    this.error(node)\n   }\n \n-  error(ctx) {\n-    const message = 'Avoid to use inline assembly. It is acceptable only in rare cases'\n-    super.warn(ctx, 'no-inline-assembly', message)\n+  error(node) {\n+    this.warn(node, 'Avoid to use inline assembly. It is acceptable only in rare cases')\n   }\n }\n \n",
					"match": false,
					"packageHash": "2f3f730582de1b84da4d93e92e6fa966604391d4d982dfa5bdf2dc18cc7b1fb0",
					"size": 366,
					"sourceHash": "5b1dea93740bc8818a92724b3251422d411c277e6d32770ce4fefd90091565f5",
					"status": "content"
				},
				"lib/rules/security/no-similar-func-event-names.js": {
					"match": false,
					"packageHash": "22149558c3324c761a5e976a6f730d23e7eb8d5c17dd2c56c7a0b64b8acf1ed2",
					"size": 867,
					"status": "missing-in-source"
				},
				"lib/rules/security/not-rely-on-block-hash.js": {
					"diff": "--- published/lib/rules/security/not-rely-on-block-hash.js\n+++ rebuilt/lib/rules/security/not-rely-on-block-hash.js\n@@ -1,18 +1,33 @@\n-const BaseChecker = require('./../base-checker')\n+const BaseChecker = require('../base-checker')\n+\n+const ruleId = 'not-rely-on-block-hash'\n+const meta = {\n+  type: 'security',\n+\n+  docs: {\n+    description: `Do not rely on \"block.blockhash\". Miners can influence its value.`,\n+    category: 'Security Rules',\n+  },\n+\n+  recommended: true,\n+  defaultSetup: 'warn',\n+\n+  schema: null,\n+}\n \n class NotRelyOnBlockHashChecker extends BaseChecker {\n-  exitExpression(ctx) {\n-    if (ctx.getText() === 'block.blockhash') {\n-      this._warn(ctx)\n+  constructor(reporter) {\n+    super(reporter, ruleId, meta)\n+  }\n+\n+  MemberAccess(node) {\n+    if (node.expression.name === 'block' && node.memberName === 'blockhash') {\n+      this._warn(node)\n     }\n   }\n \n-  _warn(ctx) {\n-    this.warn(\n-      ctx,\n-      'not-rely-on-block-hash',\n-      'Do not rely on \"block.blockhash\". Miners can influence its value.'\n-    )\n+  _warn(node) {\n+    this.warn(node, 'Do not rely on \"block.blockhash\". Miners can influence its value.')\n   }\n }\n \n",
					"match": false,
					"packageHash": "52919475946559b842ca79e62c9125b48a041d26e4234ad0bc4f6e0cdc86ba40",
					"size": 411,
					"sourceHash": "584becea4a8f2f6f4be189ded5886c1ec6f3cb98e4faf46799b9cf3c6f3a55e4",
					"status": "content"
				},
				"lib/rules/security/not-rely-on-time.js": {
					"diff": "--- published/lib/rules/security/not-rely-on-time.js\n+++ rebuilt/lib/rules/security/not-rely-on-time.js\n@@ -1,22 +1,39 @@\n-const BaseChecker = require('./../base-checker')\n+const BaseChecker = require('../base-checker')\n+\n+const ruleId = 'not-rely-on-time'\n+const meta = {\n+  type: 'security',\n+\n+  docs: {\n+    description: `Avoid making time-based decisions in your business logic.`,\n+    category: 'Security Rules',\n+  },\n+\n+  recommended: false,\n+  defaultSetup: 'warn',\n+\n+  schema: null,\n+}\n \n class NotRelyOnTimeChecker extends BaseChecker {\n-  exitIdentifier(ctx) {\n-    this._textNotAllowed(ctx, 'now')\n+  constructor(reporter) {\n+    super(reporter, ruleId, meta)\n   }\n \n-  exitExpression(ctx) {\n-    this._textNotAllowed(ctx, 'block.timestamp')\n+  Identifier(node) {\n+    if (node.name === 'now') {\n+      this._warn(node)\n+    }\n   }\n \n-  _textNotAllowed(ctx, avoidedName) {\n-    if (ctx.getText() === avoidedName) {\n-      this._warn(ctx)\n+  MemberAccess(node) {\n+    if (node.expression.name === 'block' && node.memberName === 'timestamp') {\n+      this._warn(node)\n     }\n   }\n \n-  _warn(ctx) {\n-    this.warn(ctx, 'not-rely-on-time', 'Avoid to make time-based decisions in your business logic')\n+  _warn(node) {\n+    this.warn(node, 'Avoid making time-based decisions in your business logic')\n   }\n }\n \n",
					"match": false,
					"packageHash": "fb9fd1bfc49dccb8224f069d6d84cbdfb5f197fe047c0ba3d88213e5bbb62dc7",
					"size": 515,
					"sourceHash": "b48d630a7b9851b1a3e63dc5523cf3474dc8998a841ab89f54807664cc266a6f",
					"status": "content"
				},
				"lib/rules/security/reentrancy.js": {
					"diff": "--- published/lib/rules/security/reentrancy.js\n+++ rebuilt/lib/rules/security/reentrancy.js\n@@ -1,53 +1,98 @@\n const _ = require('lodash')\n-const BaseChecker = require('./../base-checker')\n-const TreeTraversing = require('./../../common/tree-traversing')\n+const BaseChecker = require('../base-checker')\n+const TreeTraversing = require('../../common/tree-traversing')\n \n-const { typeOf, hasMethodCalls, findPropertyInParents } = TreeTraversing\n+const { hasMethodCalls, findPropertyInParents } = TreeTraversing\n+\n+const ruleId = 'reentrancy'\n+const meta = {\n+  type: 'security',\n+\n+  docs: {\n+    description: `Possible reentrancy vulnerabilities. Avoid state changes after transfer.`,\n+    category: 'Security Rules',\n+    examples: {\n+      good: [\n+        {\n+          description: 'Invulnerable Contract 1',\n+          code: require('../../fixtureCases/security/reentrancy-invulnerable')[0],\n+        },\n+        {\n+          description: 'Invulnerable Contract 2',\n+          code: require('../../fixtureCases/security/reentrancy-invulnerable')[1],\n+        },\n+        {\n+          description: 'Invulnerable Contract 3',\n+          code: require('../../fixtureCases/security/reentrancy-invulnerable')[2],\n+        },\n+      ],\n+      bad: [\n+        {\n+          description: 'Vulnerable Contract 1',\n+          code: require('../../fixtureCases/security/reentrancy-vulnerable')[0],\n+        },\n+        {\n+          description: 'Vulnerable Contract 2',\n+          code: require('../../fixtureCases/security/reentrancy-vulnerable')[1],\n+        },\n+      ],\n+    },\n+  },\n+\n+  recommended: true,\n+  defaultSetup: 'warn',\n+\n+  schema: null,\n+}\n \n class ReentrancyChecker extends BaseChecker {\n-  enterContractDefinition(ctx) {\n-    ctx.stateDeclarationScope = new StateDeclarationScope()\n-    const scope = ctx.stateDeclarationScope\n+  constructor(reporter, inputSrc) {\n+    super(reporter, ruleId, meta)\n+    this.inputSrc = inputSrc\n+  }\n+\n+  ContractDefinition(node) {\n+    node.stateDeclarationScope = new StateDeclarationScope()\n+    const scope = node.stateDeclarationScope\n \n-    new ContractDefinition(ctx).stateDefinitions().forEach(i => scope.trackStateDeclaration(i))\n+    new ContractDefinition(node).stateDefinitions().forEach((i) => scope.trackStateDeclaration(i))\n   }\n \n-  enterFunctionDefinition(ctx) {\n-    ctx.effects = new Effects(StateDeclarationScope.of(ctx))\n+  FunctionDefinition(node) {\n+    node.effects = new Effects(StateDeclarationScope.of(node))\n   }\n \n-  enterExpression(ctx) {\n-    this._checkAssignment(ctx)\n-    this._checkSendCall(ctx)\n+  ExpressionStatement(node) {\n+    this._checkAssignment(node)\n   }\n \n-  _checkAssignment(ctx) {\n-    const effects = Effects.of(ctx)\n-    const assignOperator = AssignOperator.of(ctx)\n+  MemberAccess(node) {\n+    this._checkSendCall(node)\n+  }\n+\n+  _checkAssignment(node) {\n+    const assignOperator = AssignOperator.of(node, this.inputSrc)\n+    const effects = Effects.of(node)\n \n     if (assignOperator && effects && effects.isNotAllowed(assignOperator)) {\n-      this._warn(ctx)\n+      this._warn(node)\n     }\n   }\n \n",
					"match": false,
					"packageHash": "facb08621f589d2bd77597d6ffba5e98d783777283cc317bef20972f33af6ab7",
					"size": 3154,
					"sourceHash": "e002aa44ce57a0647e82c2b4c3e73032f25337c519e17a70982fdd928d8550a7",
					"status": "content"
				},
				"lib/tree-listener.js": {
					"diff": "--- published/lib/tree-listener.js\n+++ rebuilt/lib/tree-listener.js\n@@ -1,23 +1,18 @@\n-const SolidityListener = require('./grammar/SolidityListener').SolidityListener\n-\n-class SecurityErrorListener extends SolidityListener {\n+class SecurityErrorListener {\n   constructor(checkers) {\n-    super()\n     this.listenersMap = {}\n \n-    checkers.forEach(i => this.addChecker(i))\n+    checkers.forEach((i) => this.addChecker(i))\n   }\n \n   addChecker(newChecker) {\n-    const listenerMethods = Object.getOwnPropertyNames(SolidityListener.prototype)\n+    const listenerMethods = Object.getOwnPropertyNames(newChecker.constructor.prototype)\n \n-    const usedListenerMethods = listenerMethods\n-      .filter(i => i !== 'constructor')\n-      .filter(i => !!newChecker[i])\n+    const usedListenerMethods = listenerMethods.filter((i) => /^[A-Z]/.test(i))\n \n-    usedListenerMethods.forEach(methodName => this.addNewListener(methodName, newChecker))\n+    usedListenerMethods.forEach((methodName) => this.addNewListener(methodName, newChecker))\n \n-    usedListenerMethods.forEach(methodName => {\n+    usedListenerMethods.forEach((methodName) => {\n       this[methodName] = this.notifyListenersOn(methodName)\n     })\n   }\n@@ -33,7 +28,7 @@\n   }\n \n   notifyListenersOn(methodName) {\n-    return ctx => this.listenersFor(methodName).forEach(fn => quite(fn)(ctx))\n+    return (ctx) => this.listenersFor(methodName).forEach((fn) => quite(fn)(ctx))\n   }\n }\n \n",
					"match": false,
					"packageHash": "0e9c2d4f92d6276fde84b2b59a6e3cf138e691131bd21b38e53fa87ed2a758f1",
					"size": 1307,
					"sourceHash": "0a2c5f0ac052c9e646fab08babc0c94375486cccbf12efe76dc038e7d8257542",
					"status": "content"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,8 +1,8 @@\n {\n   \"name\": \"solhint\",\n-  \"version\": \"1.4.0\",\n+  \"version\": \"6.0.2\",\n   \"description\": \"Solidity Code Linter\",\n-  \"main\": \"solhint.js\",\n+  \"main\": \"lib/index.js\",\n   \"keywords\": [\n     \"solidity\",\n     \"linter\",\n@@ -16,40 +16,70 @@\n   \"homepage\": \"https://protofire.github.io/solhint/\",\n   \"repository\": \"https://github.com/protofire/solhint\",\n   \"scripts\": {\n-    \"exec-tests\": \"nyc -x \\\"**/grammar/**\\\" mocha && nyc report --reporter=text-lcov | coveralls\",\n-    \"test\": \"npm run exec-tests\",\n-    \"test-only\": \"mocha\",\n-    \"generate\": \"(cd ./solidity-antlr4; java org.antlr.v4.Tool ./Solidity.g4 -Dlanguage=JavaScript -o ../lib/grammar)\",\n-    \"lint\": \"eslint .\"\n+    \"exec-tests\": \"nyc mocha --recursive && nyc report\",\n+    \"test:coverage\": \"npm run exec-tests\",\n+    \"test\": \"mocha --recursive\",\n+    \"lint\": \"eslint .\",\n+    \"generate-rulesets\": \"node scripts/generate-rulesets.js && prettier --write conf/rulesets\",\n+    \"docs\": \"node scripts/generate-rule-docs.js\",\n+    \"prepublishOnly\": \"npm run lint && npm run test && npm run generate-rulesets\",\n+    \"local:e2e\": \"bash -c 'set -xeuo pipefail && rm solhint*tgz -f && npm pack && npm i -g solhint*tgz && (npm run ci:e2e);npm uninstall -g solhint'\",\n+    \"ci:e2e\": \"mocha e2e/test.js e2e/formatters-test.js e2e/autofix-test.js --timeout 10000\"\n   },\n   \"bin\": {\n     \"solhint\": \"solhint.js\"\n   },\n+  \"files\": [\n+    \"/conf/\",\n+    \"/lib/\",\n+    \"/solhint.js\"\n+  ],\n   \"author\": \"Ilya Drabenia <ilya.drobenya@gmail.com>\",\n+  \"contributors\": [\n+    \"Diego Bale <diego.bale@protofire.io>\"\n+  ],\n   \"license\": \"MIT\",\n   \"dependencies\": {\n-    \"antlr4\": \"4.7.1\",\n-    \"commander\": \"2.18.0\",\n-    \"eslint\": \"^5.6.0\",\n-    \"fast-diff\": \"^1.1.2\",\n-    \"glob\": \"7.1.3\",\n-    \"ignore\": \"^4.0.6\",\n-    \"lodash\": \"^4.17.11\",\n-    \"prettier-linter-helpers\": \"^1.0.0\"\n+    \"@solidity-parser/parser\": \"^0.20.2\",\n+    \"ajv\": \"^6.12.6\",\n+    \"ajv-errors\": \"^1.0.1\",\n+    \"antlr4\": \"^4.13.1-patch-1\",\n+    \"ast-parents\": \"^0.0.1\",\n+    \"better-ajv-errors\": \"^2.0.2\",\n+    \"chalk\": \"^4.1.2\",\n+    \"commander\": \"^10.0.0\",\n+    \"cosmiconfig\": \"^8.0.0\",\n+    \"fast-diff\": \"^1.2.0\",\n+    \"glob\": \"^8.0.3\",\n+    \"ignore\": \"^5.2.4\",\n+    \"js-yaml\": \"^4.1.0\",\n+    \"latest-version\": \"^7.0.0\",\n+    \"lodash\": \"^4.17.21\",\n+    \"pluralize\": \"^8.0.0\",\n+    \"semver\": \"^7.5.2\",\n+    \"table\": \"^6.8.1\",\n+    \"text-table\": \"^0.2.0\"\n   },\n   \"devDependencies\": {\n-    \"assert\": \"1.4.1\",\n-    \"coveralls\": \"^3.0.2\",\n-    \"eslint-config-airbnb-base\": \"^13.1.0\",\n-    \"eslint-config-prettier\": \"^3.1.0\",\n-    \"eslint-plugin-import\": \"^2.14.0\",\n-    \"eslint-plugin-prettier\": \"^2.6.2\",\n-    \"mocha\": \"^5.2.0\",\n-    \"mocha-lcov-reporter\": \"1.3.0\",\n-    \"nyc\": \"^13.0.1\"\n+    \"assert\": \"^2.0.0\",\n+    \"chai\": \"^4.3.7\",\n+    \"eslint\": \"^8.56.0\",\n+    \"eslint-config-airbnb-base\": \"^15.0.0\",\n+    \"eslint-config-prettier\": \"^9.1.0\",\n+    \"eslint-plugin-import\": \"^2.29.1\",\n+    \"eslint-plugin-prettier\": \"^4.2.1\",\n+    \"get-stream\": \"^6.0.0\",\n+    \"markdown-table\": \"^2.0.0\",\n+    \"mocha\": \"^10.2.0\",\n+    \"mocha-lcov-reporter\": \"^1.3.0\",\n+    \"nyc\": \"^15.1.0\",\n+    \"rimraf\": \"^6.0.1\",\n+    \"shelljs\": \"^0.8.5\",\n+    \"sinon\": \"^20.0.0\",\n+    \"spawn-sync\": \"^2.0.0\",\n",
					"match": false,
					"packageHash": "73d2a541ef1951a5b650afbf33e779e50ec733711847c1ed9a269cb7663d5d66",
					"size": 1496,
					"sourceHash": "d3c8f38a97403e05c771069d5f5c3734a57b31a083c1afa5defa32bdd00debd8",
					"status": "content"
				},
				"scripts/build-grammar.sh": {
					"match": false,
					"packageHash": "36321faf7897cf0e228675ce7b7c22b20de037bd84f1b88c093acf69781ca557",
					"size": 264,
					"status": "missing-in-source"
				},
				"solhint.js": {
					"diff": "--- published/solhint.js\n+++ rebuilt/solhint.js\n@@ -1,177 +1,479 @@\n #!/usr/bin/env node\n-\n const program = require('commander')\n const _ = require('lodash')\n const fs = require('fs')\n const process = require('process')\n+const readline = require('readline')\n+const chalk = require('chalk')\n+const path = require('path')\n+\n const linter = require('./lib/index')\n+const { loadConfig, loadConfigForFile } = require('./lib/config/config-file')\n+const { validate } = require('./lib/config/config-validator')\n+const applyFixes = require('./lib/apply-fixes')\n+const ruleFixer = require('./lib/rule-fixer')\n+const packageJson = require('./package.json')\n+\n+const EXIT_CODES = { BAD_OPTIONS: 255, OK: 0, REPORTED_ERRORS: 1 }\n+\n+const normalizePath = (p) => p.replace(/\\\\/g, '/')\n \n function init() {\n-  program.version('1.1.10')\n+  const version = packageJson.version\n+  program.version(version)\n \n   program\n+    .name('solhint')\n     .usage('[options] <file> [...other_files]')\n-    .option('-f, --formatter [name]', 'report formatter name (stylish, table, tap, unix)')\n     .option(\n-      '-w, --max-warnings [maxWarningsNumber]',\n-      'number of warnings to trigger nonzero exit code'\n+      '-f, --formatter [name]',\n+      'report formatter name (stylish, table, tap, unix, json, compact, sarif)'\n     )\n+    .option('-w, --max-warnings [maxWarningsNumber]', 'number of allowed warnings')\n+    .option('-c, --config [file_name]', 'file to use as your .solhint.json')\n     .option('-q, --quiet', 'report errors only - default: false')\n     .option('--ignore-path [file_name]', 'file to use as your .solhintignore')\n+    .option('--fix', 'automatically fix problems. Skips fixes in report')\n+    .option('--cache', 'Only lint files that changed since last run')\n+    .option('--cache-location [file_name]', 'Path to the cache file')\n+    .option('--noPrompt', 'do not suggest to backup files when any `fix` option is selected')\n+    .option('--init', 'create configuration file for solhint')\n+    .option('--disc', 'do not check for solhint updates')\n+    .option('--save', 'save report to file in current folder')\n+    .option('--noPoster', 'remove discord poster')\n     .description('Linter for Solidity programming language')\n     .action(execMainAction)\n \n   program\n-    .command('stdin')\n-    .description('linting of source code data provided to STDIN')\n+    .command('stdin', null, { noHelp: false })\n     .option('--filename [file_name]', 'name of file received using STDIN')\n+    .description(\n+      'linting of source code data provided to STDIN\\nEx: echo \"contract Foo { function f1()external view returns(uint256) {} }\" | solhint stdin\\nEx: solhint stdin --filename \"./pathToFilename\" -f table'\n+    )\n     .action(processStdin)\n \n   program\n-    .command('init-config')\n-    .description('create in current directory configuration file for solhint')\n+    .command('init-config', null, { noHelp: true })\n+    .description('create configuration file for solhint')\n     .action(writeSampleConfigFile)\n \n-  program.parse(process.argv)\n+  program\n+    .command('list-rules', null, { noHelp: false })\n+    .description('display covered rules of current configuration files')\n+    .action(listRules)\n \n-  if (program.args.length < 1) {\n+  if (process.argv.length <= 2) {\n     program.help()\n   }\n+\n+  program.parse(process.argv)\n+}\n+\n+const readIgnore = _.memoize(() => {\n+  let ignoreFile = '.solhintignore'\n+  try {\n+    if (program.opts().ignorePath) {\n+      ignoreFile = program.opts().ignorePath\n+    }\n+\n+    const ignoreArray = fs\n+      .readFileSync(ignoreFile)\n+      .toString()\n+      .split('\\n')\n+      .map((i) => i.trim())\n+      .filter((i) => i.length > 0)\n+    return ignoreArray\n+  } catch (e) {\n",
					"match": false,
					"packageHash": "07f794cbd124976e288bf69377b135a302baa25a0ca6ee62153b0ede57209dd0",
					"size": 4750,
					"sourceHash": "0722be2da3fb979462f8457deaa006f80e38e548040b12687a3b19067046fcdc",
					"status": "content"
				},
				"solidity-antlr4/.git": {
					"match": false,
					"packageHash": "e927d1a71df568f7f39fafe833dbe9f3642f4e8037642dd29151e7556329344a",
					"size": 40,
					"status": "missing-in-source"
				},
				"solidity-antlr4/.travis.yml": {
					"match": false,
					"packageHash": "a6b28883d4cd4cccdf78715f8423cf1d780f82d793a74c0a9cfb5603383b0e1b",
					"size": 38,
					"status": "missing-in-source"
				},
				"solidity-antlr4/LICENSE": {
					"match": false,
					"packageHash": "1fa38267fb274da7b77ac7997f1c75c2d413d8ee0ec86f552bc42e1362f96a86",
					"size": 1075,
					"status": "missing-in-source"
				},
				"solidity-antlr4/README.md": {
					"match": false,
					"packageHash": "fd9080b6a384035625bb06aacd5bbcb0abf4a5056a12a33821226d0a329e91da",
					"size": 276,
					"status": "missing-in-source"
				},
				"solidity-antlr4/Solidity.g4": {
					"match": false,
					"packageHash": "54355b566017fdf47a4cdd712eae55084e8b4e05ccc2645271588f360c7289d1",
					"size": 11332,
					"status": "missing-in-source"
				},
				"solidity-antlr4/run-tests.sh": {
					"match": false,
					"packageHash": "8118cb4f1c5340a0ebc3affedeb55b35497e640ba0bc66469013f82110b09957",
					"size": 540,
					"status": "missing-in-source"
				},
				"solidity-antlr4/test.sol": {
					"match": false,
					"packageHash": "72ab7bb207518960117d5b99da85d1da0930d6df50cb48dc71a445416e0fd80c",
					"size": 9249,
					"status": "missing-in-source"
				},
				"test/align-rules.js": {
					"match": false,
					"packageHash": "a018e067e64fbbead4d58f51ec242c63e7adbc162cce6f4d2b5e00ade2701c7c",
					"size": 19184,
					"status": "missing-in-source"
				},
				"test/best-practise-rules.js": {
					"match": false,
					"packageHash": "7e99cbe5328f6d10f3b199cc133b1bac0ef2bb57659432cad9fcdaecc6fe0704",
					"size": 6898,
					"status": "missing-in-source"
				},
				"test/code-complexity-rules.js": {
					"match": false,
					"packageHash": "fcb354c9782cbf9f9339d06278e9254336c2955db66065b17a381b7ff3afa1ac",
					"size": 2709,
					"status": "missing-in-source"
				},
				"test/comment-directives.js": {
					"match": false,
					"packageHash": "98bcf92af0bcf38e4969b2357513350e5f7235931fd581288c3b541f47e2d9e7",
					"size": 3475,
					"status": "missing-in-source"
				},
				"test/common/asserts.js": {
					"match": false,
					"packageHash": "4ca83e2f97f98140caca2e287d2d7f6c10a9755259edecbd0ed2a763dc84612c",
					"size": 1372,
					"status": "missing-in-source"
				},
				"test/common/configs.js": {
					"match": false,
					"packageHash": "3f98801294fcddd4799db81ca857ed64eb134bc6202f96ac772ea3b7776f7f94",
					"size": 588,
					"status": "missing-in-source"
				},
				"test/common/contract-builder.js": {
					"match": false,
					"packageHash": "c251ebb06a6bdbe4b218530eb1dfaff2aab3134ade6f1f05e6c1b184d45ca454",
					"size": 501,
					"status": "missing-in-source"
				},
				"test/common/utils.js": {
					"match": false,
					"packageHash": "fc1ae2b4a99b3d03d7671e69f965cb854574f66a046c38f5ca487a35539c84f9",
					"size": 458,
					"status": "missing-in-source"
				},
				"test/deprecation-rules.js": {
					"match": false,
					"packageHash": "a6690f8309eadf69d10cfd57c7932c0e16027461d7544b50c82787bd4934f3cd",
					"size": 2687,
					"status": "missing-in-source"
				},
				"test/expression-rules.js": {
					"match": false,
					"packageHash": "89dce3a69c9ca9e189d2aef22d516d9dfc1981a577f68bcc0d93f55c5606d49c",
					"size": 1796,
					"status": "missing-in-source"
				},
				"test/files-linting.js": {
					"match": false,
					"packageHash": "9a515f484c46424708bb6959478f3bb2a9113a0d2771830d5d4c2ce58e1bb046",
					"size": 943,
					"status": "missing-in-source"
				},
				"test/naming-rules.js": {
					"match": false,
					"packageHash": "758bdd87e2269f80ebce6e0261e7b3b30c09ddfca267fb419561671928b22f5a",
					"size": 4810,
					"status": "missing-in-source"
				},
				"test/ordering-rules.js": {
					"match": false,
					"packageHash": "859f4a2ddc0ecfb26cc8c21493a81b32bc586202757af7aa78bfeaa6a5d72fd9",
					"size": 3752,
					"status": "missing-in-source"
				},
				"test/prettier-rules.js": {
					"match": false,
					"packageHash": "8f512f8a1fe61b4a7d9388023a6a79c41f3a254f796200d1d019127196270cce",
					"size": 1794,
					"status": "missing-in-source"
				},
				"test/quotes-rules.js": {
					"match": false,
					"packageHash": "22a97f7e1d56b9bcd27b88eb75ba249ebe9b7d14440839f9c37b9abaccf1a1b3",
					"size": 2274,
					"status": "missing-in-source"
				},
				"test/rule-config.js": {
					"match": false,
					"packageHash": "0a0cfb7440e087df1c1eea03e8c7c77cbc79b7db42270bf4a56d851ae64b3835",
					"size": 1222,
					"status": "missing-in-source"
				},
				"test/security-rules.js": {
					"match": false,
					"packageHash": "7fbe888e066e7cebcfd6557370724821a5d3afed8b0910bb3edfd83416517fc2",
					"size": 8554,
					"status": "missing-in-source"
				},
				"test/statement-rules.js": {
					"match": false,
					"packageHash": "5fd4aba268a03074587adf19cda155d45315bb637a4d09fb1c36e205286adc16",
					"size": 2409,
					"status": "missing-in-source"
				},
				"conf/rulesets/solhint-all.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"conf/rulesets/solhint-recommended.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/apply-fixes.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/cache/cache-manager.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/common/ajv.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/common/ast-types.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/common/contract-builder.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/common/errors.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/config/config-file.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/config/config-schema.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/config/config-validator.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/doc/utils.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/array_declaration.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/array_declaration_with_spaces.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/correctly_aligned_function_brackets.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/correctly_indented_contract.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/expression_with_mixed_tabs_and_spaces.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/expressions_with_correct_comma_align.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/expressions_with_correct_indents.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/expressions_with_correct_semicolon_align.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/expressions_with_incorrect_comma_align.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/expressions_with_incorrect_indents.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/expressions_with_incorrect_semicolon_align.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/incorrectly_aligned_forloop_brackets.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/incorrectly_aligned_function_brackets.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/incorrectly_indented_contract.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/statements_with_correct_indents.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/align/statements_with_incorrect_indents.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/best-practices/--fallback-not-payable.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/best-practices/--fallback-payable.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/best-practices/code-complexity-high.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/best-practices/code-complexity-low.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/best-practices/explicit-types.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/best-practices/no-unused-private-funcs.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/best-practices/number-of-states-high.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/best-practices/number-of-states-low.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/best-practices/one-contract-per-file.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/best-practices/require-with-reason.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/best-practices/require-without-reason.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/gas-consumption/gas-struct-packing-data.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/miscellaneous/duplicated-imports-data.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/miscellaneous/import-path-check.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/miscellaneous/public-function-no-override.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/miscellaneous/public-function-with-override.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/miscellaneous/string-with-double-quotes.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/miscellaneous/string-with-single-quotes.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/naming/func-named-parameters.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/naming/named-parameters-mapping.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/order/ordering-correct.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/order/ordering-incorrect.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/order/visibility-modifier-first.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/order/visibility-modifier-not-first.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/security/contracts-with-free-functions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/security/functions-with-visibility.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/security/functions-without-visibility.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/security/low-level-calls.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/security/no-immutable-before-declaration.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/security/reentrancy-invulnerable.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/fixtureCases/security/reentrancy-vulnerable.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/formatters/LICENSE": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/formatters/README.md": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/formatters/compact.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/formatters/json.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/formatters/sarif.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/formatters/stylish.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/formatters/table.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/formatters/tap.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/formatters/unix.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/load-rules.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rule-fixer.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/code-complexity.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/explicit-types.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/function-max-lines.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/index.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/interface-starts-with-i.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/max-line-length.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/max-states-count.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/no-console.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/no-empty-blocks.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/no-global-import.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/no-unused-import.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/no-unused-private-funcs.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/no-unused-vars.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/one-contract-per-file.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/payable-fallback.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/reason-string.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/best-practices/use-natspec.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/gas-consumption/gas-calldata-parameters.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/gas-consumption/gas-custom-errors.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/gas-consumption/gas-increment-by-one.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/gas-consumption/gas-indexed-events.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/gas-consumption/gas-length-in-loops.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/gas-consumption/gas-multitoken1155.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/gas-consumption/gas-named-return-values.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/gas-consumption/gas-small-strings.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/gas-consumption/gas-strict-inequalities.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/gas-consumption/gas-struct-packing.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/gas-consumption/index.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/miscellaneous/comprehensive-interface.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/miscellaneous/duplicated-imports.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/miscellaneous/foundry-no-block-time-number.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/miscellaneous/import-path-check.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/const-name-snakecase.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/contract-name-capwords.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/event-name-capwords.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/foundry-test-function-naming.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/foundry-test-functions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/func-name-mixedcase.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/func-named-parameters.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/func-param-name-mixedcase.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/immutable-vars-naming.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/modifier-name-mixedcase.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/named-parameters-mapping.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/private-vars-leading-underscore.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/use-forbidden-name.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/naming/var-name-mixedcase.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/order/imports-order.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/order/ordering.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/security/avoid-call-value.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/security/avoid-sha3.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/security/avoid-suicide.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/security/avoid-throw.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/security/check-send-result.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/security/compiler-version.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/security/func-visibility.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/security/multiple-sends.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/security/no-complex-fallback.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/security/no-immutable-before-declaration.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/rules/security/state-visibility.js": {
					"match": false,
					"status": "missing-in-package"
				}
			},
			"summary": {
				"differentFiles": 33,
				"matchingFiles": 1,
				"missingInPackage": 129,
				"missingInSource": 86,
				"score": 0.004016064257028112,
				"totalFiles": 249
			}
		}
	}
]
