[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-06T05:28:01.194Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "doctoc@2.2.1",
			"name": "doctoc",
			"version": "2.2.1",
			"location": "https://registry.npmjs.org/doctoc/-/doctoc-2.2.1.tgz",
			"integrity": "sha512-qNJ1gsuo7hH40vlXTVVrADm6pdg30bns/Mo7Nv1SxuXSM1bwF9b4xQ40a6EFT/L1cI+Yylbyi8MPI4G4y7XJzQ==",
			"publishedAt": "2022-09-22T16:04:35.736Z",
			"publishedWith": {
				"node": "16.14.2",
				"npm": "8.12.2"
			}
		},
		"source": {
			"integrity": "sha512-uHUPPVnNOe4Iou8GPh/OSKywautMiwAzJwDHgn3ZdsTtI5C3w0R0KUSKICbkAVdCM+wrmPTIxn6WU93BTQ80WQ==",
			"location": "git://github.com/thlorenz/doctoc.git",
			"spec": "github:thlorenz/doctoc#8e1c2bd8fa51a564c8674e9a0b6e2c880ffc134b"
		},
		"comparisonHash": "9ef46a5bd31291e57cbab41e2f17c57bd6da0b5b",
		"diff": {
			"files": {
				"README.md": {
					"diff": "--- published/README.md\n+++ rebuilt/README.md\n@@ -8,27 +8,67 @@\n **Table of Contents**  *generated with [DocToc](https://github.com/thlorenz/doctoc)*\n \n - [Installation](#installation)\n+- [Configuring Table of Contents](#configuring-table-of-contents)\n+  - [TOC title text](#toc-title-text)\n+  - [Min. heading level](#min-heading-level)\n+  - [Max. heading level](#max-heading-level)\n+  - [Include all headings](#include-all-headings)\n - [Usage](#usage)\n   - [Adding toc to all files in a directory and sub directories](#adding-toc-to-all-files-in-a-directory-and-sub-directories)\n+  - [Ignoring individual files](#ignoring-individual-files)\n   - [Update existing doctoc TOCs effortlessly](#update-existing-doctoc-tocs-effortlessly)\n   - [Adding toc to individual files](#adding-toc-to-individual-files)\n     - [Examples](#examples)\n   - [Using doctoc to generate links compatible with other sites](#using-doctoc-to-generate-links-compatible-with-other-sites)\n     - [Example](#example)\n   - [Specifying location of toc](#specifying-location-of-toc)\n-  - [Specifying a custom TOC title](#specifying-a-custom-toc-title)\n-  - [Specifying a maximum heading level for TOC entries](#specifying-a-maximum-heading-level-for-toc-entries)\n+  - [Performing a dry run](#performing-a-dry-run)\n   - [Printing to stdout](#printing-to-stdout)\n+  - [Only update existing ToC](#only-update-existing-toc)\n   - [Usage as a `git` hook](#usage-as-a-git-hook)\n   - [Docker image](#docker-image)\n \n <!-- END doctoc generated TOC please keep comment here to allow auto update -->\n \n-\n ## Installation\n \n     npm install -g doctoc\n \n+## Configuring Table of Contents\n+\n+### TOC title text\n+\n+Use the `--title` option to specify a (Markdown-formatted) custom TOC title; e.g., `doctoc --title '**Contents**' .` From then on, you can simply run `doctoc <file>` and doctoc will keep the title you specified.\n+\n+Alternatively, to blank out the title, use the `--notitle` option. This will simply remove the title from the TOC.\n+\n+### Min. heading level\n+\n+Use the `--minlevel` option to limit TOC entries to headings only at or above the specified level; e.g., `doctoc --minlevel 2 .`\n+\n+By default,\n+\n+- the min level used is 1 if it is not set\n+\n+Note: Currently supported values are only 1 and 2.\n+\n+### Max. heading level\n+\n+Use the `--maxlevel` option to limit TOC entries to headings only up to the specified level; e.g., `doctoc --maxlevel 3 .`\n+\n+By default,\n+\n+- no limit is placed on Markdown-formatted headings,\n+- whereas headings from embedded HTML are limited to 4 levels.\n+\n+### Include all headings\n+\n+Use the `--all` option to include all headings in the TOC regardless of their location\n+\n+By default,\n+\n+- Only headings below the TOC will be included\n+\n ## Usage\n \n In its simplest usage, you can pass one or more files or folders to the\n@@ -38,8 +78,8 @@\n \n ### Adding toc to all files in a directory and sub directories\n \n-Go into the directory that contains you local git project and type:\n-    \n+Go into the directory that contains your local git project and type:\n+\n     doctoc .\n \n This will update all markdown files in the current directory and all its\n@@ -49,6 +89,7 @@\n specified](#using-doctoc-to-generate-links-compatible-with-other-sites).\n \n ### Ignoring individual files\n+\n In order to ignore a specific file when running `doctoc` on an entire directory, just add `<!-- DOCTOC SKIP -->` to the top of the file you wish to ignore.\n \n ### Update existing doctoc TOCs effortlessly\n@@ -89,14 +130,14 @@\n \n By default, doctoc places the toc at the top of the file. You can indicate to have it placed elsewhere with the following format:\n \n-```\n+```markdown\n <!-- START doctoc -->\n <!-- END doctoc -->\n",
					"match": false,
					"packageHash": "f82024f20af89f2cf53e914dedfa6a7ac381ac7e8575d3a81e0defe983fce46b",
					"size": 5613,
					"sourceHash": "f783f752c986bdda13d322dd6d52c779c2b50dc235fe356c92505fc973595f93",
					"status": "content"
				},
				"doctoc.js": {
					"diff": "--- published/doctoc.js\n+++ rebuilt/doctoc.js\n@@ -12,11 +12,10 @@\n function cleanPath(path) {\n   var homeExpanded = (path.indexOf('~') === 0) ? process.env.HOME + path.substr(1) : path;\n \n-  // Escape all spaces\n-  return homeExpanded.replace(/\\s/g, '\\\\ ');\n+  return homeExpanded;\n }\n \n-function transformAndSave(files, mode, maxHeaderLevel, title, notitle, entryPrefix, processAll, stdOut, updateOnly) {\n+function transformAndSave(files, mode, maxHeaderLevel, minHeaderLevel, title, notitle, entryPrefix, processAll, stdOut, updateOnly, dryRun) {\n   if (processAll) {\n     console.log('--all flag is enabled. Including headers before the TOC location.')\n   }\n@@ -30,7 +29,7 @@\n   var transformed = files\n     .map(function (x) {\n       var content = fs.readFileSync(x.path, 'utf8')\n-        , result = transform(content, mode, maxHeaderLevel, title, notitle, entryPrefix, processAll, updateOnly);\n+        , result = transform(content, mode, maxHeaderLevel, minHeaderLevel, title, notitle, entryPrefix, processAll, updateOnly);\n       result.path = x.path;\n       return result;\n     });\n@@ -45,24 +44,35 @@\n   }\n \n   unchanged.forEach(function (x) {\n-    console.log('\"%s\" is up to date', x.path);\n+    if (stdOut) {\n+      console.log('==================\\n\\n\"%s\" is up to date', x.path)\n+    }\n+    else {\n+      console.log('\"%s\" is up to date', x.path);\n+    }\n   });\n \n   changed.forEach(function (x) { \n     if (stdOut) {\n       console.log('==================\\n\\n\"%s\" should be updated', x.path)\n-    } else {\n+    } else if (dryRun) {\n+      console.log('\"%s\" should be updated but wasn\\'t due to dry run.', x.path);\n+    }\n+    else {\n       console.log('\"%s\" will be updated', x.path);\n       fs.writeFileSync(x.path, x.data, 'utf8');\n     }\n   });\n+  if (dryRun && changed.length > 0) {\n+    process.exitCode = 1;\n+  }\n }\n \n function printUsageAndExit(isErr) {\n \n   var outputFunc = isErr ? console.error : console.info;\n \n-  outputFunc('Usage: doctoc [mode] [--entryprefix prefix] [--notitle | --title title] [--maxlevel level] [--all] [--update-only] <path> (where path is some path to a directory (e.g., .) or a file (e.g., README.md))');\n+  outputFunc('Usage: doctoc [mode] [--entryprefix prefix] [--notitle | --title title] [--maxlevel level] [--minlevel level] [--all] [--update-only] <path> (where path is some path to a directory (e.g., .) or a file (e.g., README.md))');\n   outputFunc('\\nAvailable modes are:');\n   for (var key in modes) {\n     outputFunc('  --%s\\t%s', key, modes[key]);\n@@ -83,8 +93,8 @@\n var mode = modes['github'];\n \n var argv = minimist(process.argv.slice(2)\n-    , { boolean: [ 'h', 'help', 'T', 'notitle', 's', 'stdout', 'all' , 'u', 'update-only'].concat(Object.keys(modes))\n-    , string: [ 'title', 't', 'maxlevel', 'm', 'entryprefix' ]\n+    , { boolean: [ 'h', 'help', 'T', 'notitle', 's', 'stdout', 'all' , 'u', 'update-only', 'd', 'dryrun'].concat(Object.keys(modes))\n+    , string: [ 'title', 't', 'maxlevel', 'm', 'minlevel', 'n', 'entryprefix' ]\n     , unknown: function(a) { return (a[0] == '-' ? (console.error('Unknown option(s): ' + a), printUsageAndExit(true)) : true); }\n     });\n \n@@ -104,9 +114,17 @@\n var processAll = argv.all;\n var stdOut = argv.s || argv.stdout\n var updateOnly = argv.u || argv['update-only']\n+var dryRun = argv.d || argv.dryrun || false;\n \n var maxHeaderLevel = argv.m || argv.maxlevel;\n-if (maxHeaderLevel && isNaN(maxHeaderLevel) || maxHeaderLevel < 0) { console.error('Max. heading level specified is not a positive number: ' + maxHeaderLevel), printUsageAndExit(true); }\n+if (maxHeaderLevel && isNaN(maxHeaderLevel)) { console.error('Max. heading level specified is not a number: ' + maxHeaderLevel), printUsageAndExit(true); }\n+\n+var minHeaderLevel = argv.n || argv.minlevel || 1;\n+if (minHeaderLevel && isNaN(minHeaderLevel) || minHeaderLevel < 0) { console.error('Min. heading level specified is not a positive number: ' + minHeaderLevel), printUsageAndExit(true); }\n+else if (minHeaderLevel && minHeaderLevel > 2) { console.error('Min. heading level: ' + minHeaderLevel + ' is not currently supported as greater than 2'), printUsageAndExit(true); }\n+\n+if (maxHeaderLevel && maxHeaderLevel < minHeaderLevel) { console.error('Max. heading level: ' + maxHeaderLevel + ' is less than the defined Min. heading level: ' + minHeaderLevel), printUsageAndExit(true); }\n+\n \n for (var i = 0; i < argv._.length; i++) {\n   var target = cleanPath(argv._[i])\n@@ -120,9 +138,14 @@\n     files = [{ path: target }];\n   }\n \n-  transformAndSave(files, mode, maxHeaderLevel, title, notitle, entryPrefix, processAll, stdOut, updateOnly);\n+  transformAndSave(files, mode, maxHeaderLevel, minHeaderLevel, title, notitle, entryPrefix, processAll, stdOut, updateOnly, dryRun);\n",
					"match": false,
					"packageHash": "b5d6545672e5d73156c95bb951a603d72d755b0a98ea73c3eb56709895bbeec1",
					"size": 3964,
					"sourceHash": "b676f190d2aeade284a13aafe11860444d0bb1f05b21681bdfe9fddc9e1c9cc5",
					"status": "content"
				},
				"lib/get-html-headers.js": {
					"diff": "--- published/lib/get-html-headers.js\n+++ rebuilt/lib/get-html-headers.js\n@@ -25,18 +25,18 @@\n   })\n }\n \n-function rankify(headers, max) {\n+function rankify(headers, max, min) {\n   return headers\n     .map(function (x) {\n       x.rank = parseInt(x.tag.slice(1), 10);\n       return x;\n     })\n     .filter(function (x) {\n-      return x.rank <= max;\n+      return x.rank <= max && x.rank >= min;\n     })\n }\n \n-var go = module.exports = function (lines, maxHeaderLevel) {\n+var go = module.exports = function (lines, maxHeaderLevel, minHeaderLevel) {\n   var source = md.parse(lines.join('\\n'))\n     .children\n     .filter(function(node) {\n@@ -82,6 +82,6 @@\n \n   headers = addLinenos(lines, headers)\n   // consider anything past h4 to small to warrant a link, may be made configurable in the future\n-  headers = rankify(headers, maxHeaderLevel);\n+  headers = rankify(headers, maxHeaderLevel, minHeaderLevel);\n   return headers;\n }\n",
					"match": false,
					"packageHash": "8cf4ee17c542459c631e08004c783cd88e6933986f8077f75af62dd6c6979dea",
					"size": 2300,
					"sourceHash": "35f6cb214fa67ce009b1ebfce55669875019399b98a85697b8ae84d3ca86171d",
					"status": "content"
				},
				"lib/transform.js": {
					"diff": "--- published/lib/transform.js\n+++ rebuilt/lib/transform.js\n@@ -9,7 +9,7 @@\n var start = '<!-- START doctoc generated TOC please keep comment here to allow auto update -->\\n' +\n             '<!-- DON\\'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->'\n   , end   = '<!-- END doctoc generated TOC please keep comment here to allow auto update -->'\n-  , skipTag = '<!-- DOCTOC SKIP -->';\n+  , skipTag = '<!-- DOCTOC SKIP -->\\n';\n \n \n function matchesStart(line) {\n@@ -32,7 +32,7 @@\n }\n \n \n-function getMarkdownHeaders (lines, maxHeaderLevel) {\n+function getMarkdownHeaders (lines, maxHeaderLevel, minHeaderLevel) {\n   function extractText (header) {\n     return header.children\n       .map(function (x) {\n@@ -42,7 +42,7 @@\n         else if (x.type === md.Syntax.Image) {\n           // Images (at least on GitHub, untested elsewhere) are given a hyphen\n           // in the slug. We can achieve this behavior by adding an '*' to the\n-          // TOC entry. Think of it as a \"magic char\" that represents the iamge.\n+          // TOC entry. Think of it as a \"magic char\" that represents the image.\n           return '*';\n         }\n         else {\n@@ -57,7 +57,7 @@\n       return x.type === md.Syntax.Header;\n     })\n     .map(function (x) {\n-      return !maxHeaderLevel || x.depth <= maxHeaderLevel\n+      return x.depth >= minHeaderLevel && (!maxHeaderLevel || x.depth <= maxHeaderLevel)\n         ? { rank :  x.depth\n           , name :  extractText(x)\n           , line :  x.loc.start.line\n@@ -108,17 +108,19 @@\n   return info.hasStart ? lines[info.startIdx + 2] : defaultTitle;\n }\n \n-exports = module.exports = function transform(content, mode, maxHeaderLevel, title, notitle, entryPrefix, processAll, updateOnly) {\n-  if (content.indexOf(skipTag) !== -1) return { transformed: false };\n+exports = module.exports = function transform(content, mode, maxHeaderLevel, minHeaderLevel, title, notitle, entryPrefix, processAll, updateOnly) {\n+  var index = content.indexOf(skipTag);\n+  if (index === 0 || (index >= 0 && content[index-1] === '\\n')) return { transformed: false };\n \n   mode = mode || 'github.com';\n   entryPrefix = entryPrefix || '-';\n+  minHeaderLevel = minHeaderLevel || 1;\n \n   // only limit *HTML* headings by default\n   var maxHeaderLevelHtml = maxHeaderLevel || 4;\n \n   var lines = content.split('\\n')\n-    , info = updateSection.parse(lines, matchesStart, matchesEnd)\n+    , info = updateSection.parse(lines, matchesStart, matchesEnd);\n \n   if (!info.hasStart && updateOnly) {\n     return { transformed: false };\n@@ -131,8 +133,8 @@\n   var currentToc = info.hasStart && lines.slice(info.startIdx, info.endIdx + 1).join('\\n')\n     , linesToToc = getLinesToToc(lines, currentToc, info, processAll);\n \n-  var headers = getMarkdownHeaders(linesToToc, maxHeaderLevel)\n-    .concat(getHtmlHeaders(linesToToc, maxHeaderLevelHtml))\n+  var headers = getMarkdownHeaders(linesToToc, maxHeaderLevel, minHeaderLevel)\n+    .concat(getHtmlHeaders(linesToToc, maxHeaderLevelHtml, minHeaderLevel))\n \n   headers.sort(function (a, b) {\n     return a.line - b.line;\n@@ -162,10 +164,11 @@\n \n   var wrappedToc =  start + '\\n' + toc + '\\n' + end;\n \n-  if (currentToc === toc) return { transformed: false };\n-\n-  var data = updateSection(lines.join('\\n'), wrappedToc, matchesStart, matchesEnd, true);\n-  return { transformed : true, data : data, toc: toc, wrappedToc: wrappedToc };\n+  var data;\n+  if (currentToc != wrappedToc){\n+    data = updateSection(lines.join('\\n'), wrappedToc, matchesStart, matchesEnd, true);\n+  }\n+  return { transformed : currentToc != wrappedToc, data : data, toc: toc, wrappedToc: wrappedToc };\n };\n \n exports.start = start;\n",
					"match": false,
					"packageHash": "4c7229796fe133a4d26bc3db7b960a0480fa667dc6516567a6d3e222d57a6321",
					"size": 5188,
					"sourceHash": "31fef2a3c2fe2bafd5522beb6e5dacf2863dba30e9def9a51d1f0af90555749e",
					"status": "content"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -2,13 +2,14 @@\n   \"author\": \"Thorsten Lorenz <thlorenz@gmx.de> (thlorenz.com)\",\n   \"name\": \"doctoc\",\n   \"description\": \"Generates TOC for markdown files of local git repo.\",\n-  \"version\": \"2.2.1\",\n+  \"version\": \"2.2.0\",\n   \"repository\": {\n     \"type\": \"git\",\n     \"url\": \"git://github.com/thlorenz/doctoc.git\"\n   },\n   \"scripts\": {\n-    \"test\": \"set -e; for t in test/*.js; do node $t; done\"\n+    \"test\": \"set -e; for t in test/*.js; do node $t; done\",\n+    \"doctoc\": \"node doctoc.js README.md --update-only\"\n   },\n   \"files\": [\n     \"lib\"\n@@ -17,7 +18,7 @@\n   \"bin\": \"doctoc.js\",\n   \"dependencies\": {\n     \"@textlint/markdown-to-ast\": \"^12.1.1\",\n-    \"anchor-markdown-header\": \"^0.6.0\",\n+    \"anchor-markdown-header\": \"^0.7.0\",\n     \"htmlparser2\": \"^7.2.0\",\n     \"minimist\": \"^1.2.6\",\n     \"underscore\": \"^1.13.2\",\n",
					"match": false,
					"packageHash": "6f2214ad90638cc17bd6af9d24e3f69f8aa7bb981e62447ddbee3add58dcbcdd",
					"size": 861,
					"sourceHash": "cdb16ecfdcae59b9da6de65a47ee2735bed9d1e3d38dee07c1ec08a8a53174ba",
					"status": "content"
				}
			},
			"summary": {
				"differentFiles": 5,
				"matchingFiles": 2,
				"missingInPackage": 0,
				"missingInSource": 0,
				"score": 0.2857142857142857,
				"totalFiles": 7
			}
		}
	}
]
