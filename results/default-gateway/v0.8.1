[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-18T19:40:37.022Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:5.0.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "default-gateway@0.8.1",
			"name": "default-gateway",
			"version": "0.8.1",
			"location": "https://registry.npmjs.org/default-gateway/-/default-gateway-0.8.1.tgz",
			"integrity": "sha512-qt0daeSPs7IVSPzYRuwwaFHIVe9q2PsqxNLAn6+WbRdGUTOlkX4E9foQ4dGttv5OuzMODGwJrQi66jvrsAACpA==",
			"publishedAt": "2017-06-08T12:11:31.743Z",
			"publishedWith": {
				"node": "8.0.0",
				"npm": "5.0.3"
			},
			"dependencies": {
				"async": "2.4.1",
				"xml2js": "^0.4.17"
			}
		},
		"source": {
			"integrity": "sha512-yHRjtPHAzo7ArcZxqWEPUJM2HszkaSVLF1z464T/MvVFBi13dXbpL14xOZrTjUBoc8XN/BeGXuS0MNLFTh36oQ==",
			"location": "git+https://github.com/silverwind/default-gateway.git",
			"spec": "github:silverwind/default-gateway#61cefd319c02d93d11435cd3f422d9335b4d09ec"
		},
		"comparisonHash": "9ef46a5bd31291e57cbab41e2f17c57bd6da0b5b",
		"diff": {
			"files": {
				"LICENSE": {
					"match": false,
					"packageHash": "118cb1621ab563e3fb48ae1776f2528a4e40fc2150deb2c29106fbd340948d2b",
					"size": 1085,
					"status": "missing-in-source"
				},
				"README.md": {
					"diff": "--- published/README.md\n+++ rebuilt/README.md\n@@ -1,124 +1,44 @@\n # default-gateway\n+[![](https://img.shields.io/npm/v/default-gateway.svg?style=flat)](https://www.npmjs.org/package/default-gateway) [![](https://img.shields.io/npm/dm/default-gateway.svg)](https://www.npmjs.org/package/default-gateway) [![](https://packagephobia.com/badge?p=default-gateway)](https://packagephobia.com/result?p=default-gateway)\n \n-A Node.js module to get **default gateway** and **default interface**.\n+Obtains the machine's default gateway through `exec` calls to OS routing ints.\n \n-100% Pure Java**Script**ðŸ˜½\n+- On Linux and Android, the `ip` command must be available (usually provided by the `iproute2` package).\n+- On Unix (and macOS), the `netstat` command must be available.\n+- On Windows, `wmic` must be available.\n+- On IBM i, the `db2util` command must be available (provided by the `db2util` package).\n \n-This module depends on following commands by using [chid_process](https://nodejs.org/api/child_process.html) provided by Node.js.\n-\n-- win32\n-\t- `wmic path Win32_NetworkAdapterConfiguration get *`\n-\t- `wmic path Win32_NetworkAdapter get *`\n-- darwin\n-    - `netstat -rn -f inet`\n-    - `netstat -rn -f inet6`\n-- linux\n-    - `netstat -rn -A inet`\n-    - `netstat -rn -A inet6`\n-\n-## Installation\n-\n-```bash\n-npm install default-gateway\n-```\n-\n-## API\n-\n-### collect(callback)\n-\n-Asynchronously collects a object which contains interface names, families (IPv4 or IPv6), and addresses. The `callback` gets two arguments `(error, data)`.\n-\n-#### Example 1\n-\n-How to get default gateway and default interface.\n-\n-An example code: `example1.js`\n-\n-```js\n-var defaultGateway = require('default-gateway');\n-defaultGateway(function(error, data) {\n-  console.log(data);\n-});\n-```\n-\n-An example output:\n+## Usage\n \n ```js\n-{ en4:\n-   [ { family: 'IPv4', address: '192.168.1.1' },\n-     { family: 'IPv6', address: 'fe80::20b:a2ff:fede:2886%en4' } ],\n-  en0:\n-   [ { family: 'IPv4', address: '192.168.1.1' },\n-     { family: 'IPv6', address: 'fe80::20b:a2ff:fede:2886%en0' } ],\n-  en8:\n-   [ { family: 'IPv4', address: '192.168.1.1' },\n-     { family: 'IPv6', address: 'fe80::20b:a2ff:fede:2886%en8' } ] }\n-```\n-\n-#### Example 2\n+import {gateway4async, gateway4sync, gateway6async, gateway6sync} from \"default-gateway\";\n \n-How to get default interface from `os.networkInterfaces()`.\n+const {gateway, version, int} = await gateway4async();\n+// gateway = '1.2.3.4', version = 4, int = 'en1'\n \n-An example code: `example2.js`\n-\n-```js\n-var os = require('os');\n-var defaultGateway = require('default-gateway');\n-defaultGateway(function(error, data) {\n-  names = Object.keys(data);\n-  // names[0] is 'en4'\n-  console.log(os.networkInterfaces()[names[0]]);\n-});\n-```\n+const {gateway, version, int} = await gateway6async();\n+// gateway = '2001:db8::1', version = 6,int = 'en2'\n \n-An example output:\n+const {gateway, version, int} = gateway4sync();\n+// gateway = '1.2.3.4', version = 4, int = 'en1'\n \n-```js\n-[ { address: 'fe80::6a5b:35ff:fe96:cc05',\n-    netmask: 'ffff:ffff:ffff:ffff::',\n-    family: 'IPv6',\n-    mac: '00:00:00:00:00:00',\n-    scopeid: 14,\n-    internal: false },\n-  { address: '2001:a0ae:7c22:0:6a5b:35ff:fe96:cc05',\n",
					"match": false,
					"packageHash": "5858a92ada4eefb19ced3d0b2cbfc863417780483d28cc4d947795e95f97c5a2",
					"size": 2559,
					"sourceHash": "1808ae3c64e1bb2ff7e4de38e83abdb20b0bdc2638f073a8ebe4f16053956a2d",
					"status": "content"
				},
				"darwin.js": {
					"match": false,
					"packageHash": "8cfc7e179b63ed7c078ad77a630d20aae54c0e45be967073bbd5c51b85029286",
					"size": 2099,
					"status": "missing-in-source"
				},
				"index.js": {
					"diff": "--- published/index.js\n+++ rebuilt/index.js\n@@ -1,13 +1,266 @@\n-\"use strict\";\n+import {isIP} from \"node:net\";\n+import {execa, execaSync} from \"execa\";\n+import {platform, type, release, networkInterfaces} from \"node:os\";\n \n-const os = require(\"os\");\n+const plat = platform();\n+const dests = new Set([\"default\", \"0.0.0.0\", \"0.0.0.0/0\", \"::\", \"::/0\"]);\n+let promise, sync;\n \n-module.exports = cb => {\n-  const platform = os.platform();\n+if (plat === \"linux\") {\n+  const parse = (stdout, family) => {\n+    for (const line of (stdout || \"\").trim().split(\"\\n\")) {\n+      const results = /default( via .+?)?( dev .+?)( |$)/.exec(line) || [];\n+      const gateway = (results[1] || \"\").substring(5);\n+      const iface = (results[2] || \"\").substring(5);\n+      if (gateway && isIP(gateway)) { // default via 1.2.3.4 dev en0\n+        return {gateway, version: family, int: (iface ?? null)};\n+      } else if (iface && !gateway) { // default via dev en0\n+        const interfaces = networkInterfaces();\n+        const addresses = interfaces[iface];\n+        for (const addr of addresses || []) {\n+          if (Number(family.substring(3)) === family && isIP(addr.address)) {\n+            return {gateway: addr.address, version: family, int: (iface ?? null)};\n+          }\n+        }\n+      }\n+    }\n+    throw new Error(\"Unable to determine default gateway\");\n+  };\n \n-  if (/^linux|darwin|win32$/.test(platform)) {\n-    return require(\"./\" + platform)(cb);\n-  } else {\n-    throw new Error(\"Unsupported Platform: \" + platform);\n+  promise = async family => {\n+    const {stdout} = await execa(\"ip\", [`-${family}`, \"r\"]);\n+    return parse(stdout, family);\n+  };\n+\n+  sync = family => {\n+    const {stdout} = execaSync(\"ip\", [`-${family}`, \"r\"]);\n+    return parse(stdout, family);\n+  };\n+} else if (plat === \"darwin\") {\n+  // The IPv4 gateway is in column 3 in Darwin 19 (macOS 10.15 Catalina) and higher,\n+  // previously it was in column 5\n+  const v4IfaceColumn = parseInt(release()) >= 19 ? 3 : 5;\n+\n+  const parse = (stdout, family) => {\n+    for (const line of (stdout || \"\").trim().split(\"\\n\")) {\n+      const results = line.split(/ +/) || [];\n+      const target = results[0];\n+      const gateway = results[1];\n+      const iface = results[family === 4 ? v4IfaceColumn : 3];\n+      if (dests.has(target) && gateway && isIP(gateway)) {\n+        return {gateway, version: family, int: (iface ?? null)};\n+      }\n+    }\n+    throw new Error(\"Unable to determine default gateway\");\n+  };\n+\n+  promise = async family => {\n+    const {stdout} = await execa(\"netstat\", [\"-rn\", \"-f\", family === 4 ? \"inet\" : \"inet6\"]);\n+    return parse(stdout, family);\n+  };\n+\n+  sync = family => {\n+    const {stdout} = execaSync(\"netstat\", [\"-rn\", \"-f\", family === 4 ? \"inet\" : \"inet6\"]);\n+    return parse(stdout, family);\n+  };\n+} else if (plat === \"win32\") {\n+  const gwArgs = \"path Win32_NetworkAdapterConfiguration where IPEnabled=true get DefaultIPGateway,GatewayCostMetric,IPConnectionMetric,Index /format:table\".split(\" \");\n+  const ifArgs = index => `path Win32_NetworkAdapter where Index=${index} get NetConnectionID,MACAddress /format:table`.split(\" \");\n+\n+  const spawnOpts = {\n+    windowsHide: true,\n+  };\n+\n+  // Parsing tables like this. The final metric is GatewayCostMetric + IPConnectionMetric\n+  //\n+  // DefaultIPGateway             GatewayCostMetric  Index  IPConnectionMetric\n+  // {\"1.2.3.4\", \"2001:db8::1\"}   {0, 256}           12     25\n+  // {\"2.3.4.5\"}                  {25}               12     55\n+  function parseGwTable(gwTable, family) { // eslint-disable-line no-inner-declarations\n+    let [bestGw, bestMetric, bestId] = [null, null, null];\n+\n+    for (let line of (gwTable || \"\").trim().split(/\\r?\\n/).splice(1)) {\n+      line = line.trim();\n+      const [_, gwArr, gwCostsArr, id, ipMetric] = /({.+?}) +({.+?}) +([0-9]+) +([0-9]+)/.exec(line) || [];\n+      if (!gwArr) continue;\n+\n+      const gateways = (gwArr.match(/\"(.+?)\"/g) || []).map(match => match.substring(1, match.length - 1));\n+      const gatewayCosts = (gwCostsArr.match(/[0-9]+/g) || []);\n+\n",
					"match": false,
					"packageHash": "5390cb05ed9ff7d06f51ed06d640cd65e832d48490affe4ad1ef4c47b387a7d5",
					"size": 266,
					"sourceHash": "742771a3c45c2ea971a9613166dfc04844cc11de87a5c547e23fc6d674f89ada",
					"status": "content"
				},
				"linux.js": {
					"match": false,
					"packageHash": "be9ade0fe3c462e4fd605974a8c586981a03ddb636b00ef5c133b027d6d842f2",
					"size": 2099,
					"status": "missing-in-source"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,45 +1,28 @@\n {\n   \"name\": \"default-gateway\",\n-  \"version\": \"0.8.1\",\n-  \"description\": \"A Node.js module to get default gateway and default interface.\",\n-  \"author\": \"silverwind <me@silverwind.io>\",\n+  \"version\": \"7.2.2\",\n+  \"description\": \"Get the default network gateway, cross-platform.\",\n+  \"author\": \"silverwind\",\n   \"repository\": \"silverwind/default-gateway\",\n-  \"scripts\": {\n-    \"test\": \"mocha\"\n+  \"license\": \"BSD-2-Clause\",\n+  \"type\": \"module\",\n+  \"sideEffects\": false,\n+  \"exports\": \"./index.js\",\n+  \"engines\": {\n+    \"node\": \">= 16\"\n   },\n-  \"os\": [\n-    \"win32\",\n-    \"darwin\",\n-    \"linux\"\n-  ],\n   \"files\": [\n-    \"index.js\",\n-    \"darwin.js\",\n-    \"linux.js\",\n-    \"win32.js\"\n-  ],\n-  \"keywords\": [\n-    \"win32\",\n-    \"darwin\",\n-    \"linux\",\n-    \"net\",\n-    \"network\",\n-    \"gateway\",\n-    \"child_process\",\n-    \"wmi\",\n-    \"route\"\n+    \"./index.js\"\n   ],\n-  \"license\": \"MIT\",\n   \"dependencies\": {\n-    \"async\": \"2.4.1\",\n-    \"xml2js\": \"^0.4.17\"\n+    \"execa\": \"^7.1.1\"\n   },\n   \"devDependencies\": {\n-    \"chai\": \"4.0.2\",\n-    \"mocha\": \"3.4.2\",\n-    \"mocha-clean\": \"1.0.0\"\n-  },\n-  \"engines\": {\n-    \"node\": \">=4\"\n+    \"eslint\": \"8.43.0\",\n+    \"eslint-config-silverwind\": \"73.0.4\",\n+    \"updates\": \"14.2.9\",\n+    \"versions\": \"11.0.1\",\n+    \"vitest\": \"0.32.2\",\n+    \"vitest-config-silverwind\": \"5.0.0\"\n   }\n }\n",
					"match": false,
					"packageHash": "4c4add4982ee04e36cfc34ee38384f5124fb5ade11bd047fc661632d5043300a",
					"size": 777,
					"sourceHash": "2257e924b17504e7c23ead193bd10622e2eb114114eaa11515c16e1130637199",
					"status": "content"
				},
				"win32.js": {
					"match": false,
					"packageHash": "ddf7e3b4291445598848588cd7777b86d33caa3a4bd5919b02680f791d081355",
					"size": 3839,
					"status": "missing-in-source"
				}
			},
			"summary": {
				"differentFiles": 3,
				"matchingFiles": 0,
				"missingInPackage": 0,
				"missingInSource": 4,
				"score": 0,
				"totalFiles": 7
			}
		},
		"prodDependencies": [
			{
				"name": "cross-spawn",
				"version": "7.0.3"
			},
			{
				"name": "execa",
				"version": "7.1.1"
			},
			{
				"name": "get-stream",
				"version": "6.0.1"
			},
			{
				"name": "human-signals",
				"version": "4.3.1"
			},
			{
				"name": "is-stream",
				"version": "3.0.0"
			},
			{
				"name": "isexe",
				"version": "2.0.0"
			},
			{
				"name": "merge-stream",
				"version": "2.0.0"
			},
			{
				"name": "mimic-fn",
				"version": "4.0.0"
			},
			{
				"name": "npm-run-path",
				"version": "5.1.0"
			},
			{
				"name": "path-key",
				"version": "4.0.0"
			},
			{
				"name": "onetime",
				"version": "6.0.0"
			},
			{
				"name": "path-key",
				"version": "3.1.1"
			},
			{
				"name": "shebang-command",
				"version": "2.0.0"
			},
			{
				"name": "shebang-regex",
				"version": "3.0.0"
			},
			{
				"name": "signal-exit",
				"version": "3.0.7"
			},
			{
				"name": "strip-final-newline",
				"version": "3.0.0"
			},
			{
				"name": "which",
				"version": "2.0.2"
			}
		]
	}
]
