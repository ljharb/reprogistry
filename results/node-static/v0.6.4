[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-07T06:44:08.260Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "node-static@0.6.4",
			"name": "node-static",
			"version": "0.6.4",
			"location": "https://registry.npmjs.org/node-static/-/node-static-0.6.4.tgz",
			"integrity": "sha512-FNIgvWyh9vU6mZj6mgDlO1+crhbAj6z+xE5fA2oZZBYUiCtUK+pK1FEZ7+2dZ/sJpW/WRvaxX+jQUGTlqK5Rxg==",
			"publishedAt": "2012-10-19T12:14:15.120Z",
			"publishedWith": {
				"node": "v0.6.19",
				"npm": "1.1.25"
			}
		},
		"source": {
			"integrity": "sha512-wH5dsUw6GOpwsVv/Nany991pnPx1VJHSvUFqTD3PRRGTGiGfAoDwHcrqjBE5mKXUvWWJ9X6YXG3mOHydH9MR+g==",
			"location": "git://github.com/cloudhead/node-static.git",
			"spec": "github:cloudhead/node-static#HEAD"
		},
		"comparisonHash": "9ef46a5bd31291e57cbab41e2f17c57bd6da0b5b",
		"diff": {
			"files": {
				".npmignore": {
					"match": false,
					"packageHash": "1c816e63b21e11aadddd354a47857455460a2b034ab318ea56e3de9aecc1cf42",
					"size": 28,
					"status": "missing-in-source"
				},
				"LICENSE": {
					"diff": "--- published/LICENSE\n+++ rebuilt/LICENSE\n@@ -1,4 +1,5 @@\n-Copyright (c) 2010 Alexis Sellier\n+Copyright (c) 2010-14 Alexis Sellier\n+Copyright (c) 2021 Brett Zamir\n \n Permission is hereby granted, free of charge, to any person obtaining\n a copy of this software and associated documentation files (the\n",
					"match": false,
					"packageHash": "23454a628fae63cd9c9451d8c051ce95dff7d5ad0f9967f431ef8c411b6a2935",
					"size": 1058,
					"sourceHash": "93194f248f41174067f19906bcfb5c95fe535578b68aa3e6cd484017e3e3e73e",
					"status": "content"
				},
				"README.md": {
					"diff": "--- published/README.md\n+++ rebuilt/README.md\n@@ -1,179 +1,360 @@\n-node-static\n-===========\n+# node-static\n+\n+[![Node.js CI status](https://github.com/http://github.com/cloudhead/node-static/workflows/Node.js%20CI/badge.svg)](https://github.com/http://github.com/cloudhead/node-static/actions)\n \n > a simple, *rfc 2616 compliant* file streaming module for [node](http://nodejs.org)\n \n-node-static has an in-memory file cache, making it highly efficient.\n node-static understands and supports *conditional GET* and *HEAD* requests.\n-node-static was inspired by some of the other static-file serving modules out there,\n-such as node-paperboy and antinode.\n+node-static was inspired by some of the other static-file serving modules out\n+there, such as node-paperboy and antinode.\n \n-Synopsis\n---------\n+## Installation\n \n-    var static = require('node-static');\n+```sh\n+$ npm install node-static\n+```\n \n-    //\n-    // Create a node-static server instance to serve the './public' folder\n-    //\n-    var file = new(static.Server)('./public');\n-\n-    require('http').createServer(function (request, response) {\n-        request.addListener('end', function () {\n-            //\n-            // Serve files!\n-            //\n-            file.serve(request, response);\n-        });\n-    }).listen(8080);\n+## Set-up\n \n-API\n----\n+### ESM\n \n-### Creating a node-static Server #\n+```js\n+import {Server, version, mime} from 'node-static';\n \n-Creating a file server instance is as simple as:\n+// OR:\n+// import * as statik from 'node-static';\n+```\n \n-    new static.Server();\n+### CommonJS\n \n-This will serve files in the current directory. If you want to serve files in a specific\n-directory, pass it as the first argument:\n+```js\n+const statik = require('node-static');\n+```\n \n-    new static.Server('./public');\n+## Usage\n \n-You can also specify how long the client is supposed to cache the files node-static serves:\n+```js\n+import http from 'node:http';\n \n-    new static.Server('./public', { cache: 3600 });\n+//\n+// Create a node-static server instance to serve the './public' folder\n+//\n+const file = new statik.Server('./public');\n \n-This will set the `Cache-Control` header, telling clients to cache the file for an hour.\n-This is the default setting.\n+http.createServer(function (request, response) {\n+    request.addListener('end', function () {\n+        //\n+        // Serve files!\n+        //\n+        file.serve(request, response);\n+    }).resume();\n+}).listen(8080);\n+```\n \n-### Serving files under a directory #\n+## API\n \n-To serve files under a directory, simply call the `serve` method on a `Server` instance, passing it\n-the HTTP request and response object:\n+### Creating a node-static Server\n \n-    var fileServer = new static.Server('./public');\n+Creating a file server instance is as simple as:\n \n-    require('http').createServer(function (request, response) {\n",
					"match": false,
					"packageHash": "28e81528dbb233fd51e855705d38ffffc1fcf8f1762481515f375aaca2ff300f",
					"size": 5299,
					"sourceHash": "e66cf3854cf86b2c5c33942c158bd715e255178ea103b6e3f5f11329f380aeb3",
					"status": "content"
				},
				"benchmark/node-static-0.3.0.txt": {
					"match": false,
					"packageHash": "194f80b38a3a5682e72570a1951ef7d9bb56e419d00288f2747486db1eb45d11",
					"size": 1303,
					"status": "missing-in-source"
				},
				"bin/cli.js": {
					"diff": "--- published/bin/cli.js\n+++ rebuilt/bin/cli.js\n@@ -1,104 +1,145 @@\n #!/usr/bin/env node\n \n-var fs = require('fs'),\n-    path = require('path'),\n-    tty = require('tty'),\n-    statik = require('./../lib/node-static');\n-\n-    var argv = require('optimist')\n-        .usage([\n-            'USAGE: $0 [-p <port>] [<directory>]',\n-            'simple, rfc 2616 compliant file streaming module for node']\n-            .join('\\n\\n'))\n-        .option('port', {\n-            alias: 'p',\n-            'default': 8080,\n-            description: 'TCP port at which the files will be served'\n-        })\n-        .option('cache', {\n-            alias: 'c',\n-            description: '\"Cache-Control\" header setting, defaults to 3600'\n-        })\n-        .option('version', {\n-            alias: 'v',\n-            description: 'node-static version'\n-        })\n-        .option('headers', {\n-            alias: 'H',\n-            description: 'additional headers (in JSON format)'\n-        })\n-        .option('header-file', {\n-            alias: 'f',\n-            description: 'JSON file of additional headers'\n-        })\n-        .option('help', {\n-            alias: 'h',\n-            description: 'display this help message'\n-        })\n-        .argv;\n-\n-    var dir = argv._[0] || '.';\n-\n-    var trainwreck = fs.readFileSync(path.join(__dirname, '../etc/trainwreck.jpg')),\n-\t\t\t\tnotFound = fs.readFileSync(path.join(__dirname, '../etc/404.html'))\n-        .toString()\n-        .replace('{{trainwreck}}', trainwreck.toString('base64'));\n-\n-    var colors = require('colors');\n-\n-    var log = function(request, response, statusCode) {\n-        var d = new Date();\n-        var seconds = d.getSeconds() < 10? '0'+d.getSeconds() : d.getSeconds(),\n-            datestr = d.getHours() + ':' + d.getMinutes() + ':' + seconds,\n-            line = datestr + ' [' + response.statusCode + ']: ' + request.url,\n-            colorized = line;\n-        if (tty.isatty(process.stdout.fd))\n-            colorized = (response.statusCode >= 500) ? line.red.bold :\n-                        (response.statusCode >= 400) ? line.red :\n-                        line;\n-        console.log(colorized);\n-    };\n+import http from 'http';\n+import fs from 'fs';\n+import tty from 'tty';\n+\n+import {cliBasics} from 'command-line-basics';\n+import colors from 'colors/safe.js';\n+\n+import * as statik from './../lib/node-static.js';\n+\n+const args = await cliBasics(\n+    import.meta.dirname + '/optionDefinitions.js',\n+    {\n+        packageJsonPath: import.meta.dirname + '/../package.json'\n+    }\n+);\n+if (!args) { // cliBasics handled\n+    process.exit(0);\n+}\n \n-    var file, options;\n+const dir = args.directory || '.';\n \n-if (argv.help){\n-    require('optimist').showHelp(console.log);\n-    process.exit(0);\n+/**\n+ * @param {http.IncomingMessage} request\n+ * @param {http.ServerResponse<http.IncomingMessage> & {\n+ *   req: http.IncomingMessage;\n+ * }} response\n+ * @param {number} [statusCode]\n+ */\n+const log = function(request, response, statusCode) {\n+    const d = new Date();\n+    /* c8 ignore next 3 -- Time-dependent */\n+    const seconds = d.getSeconds() < 10 ? '0' + d.getSeconds() : d.getSeconds(),\n+        minutes = d.getMinutes() < 10 ? '0' + d .getMinutes() : d.getMinutes(),\n",
					"match": false,
					"packageHash": "ba4075a755bff1c8a73c219c528ccad8506dc1915dd2d8afee98d55fad7a3877",
					"size": 3125,
					"sourceHash": "11eb8af49c90d0bdccd82afdeee2e30648fcdb3b8b2c2acd9e869d1934609034",
					"status": "content"
				},
				"etc/404.html": {
					"match": false,
					"packageHash": "4603d9906ecef9781a119d45436389ecfe23cbd9a76768245b79605ea9f5b9ab",
					"size": 505,
					"status": "missing-in-source"
				},
				"etc/trainwreck.jpg": {
					"match": false,
					"packageHash": "389e92b52917346c01dde56b57f9fc0f3001fda48a4851de57fcfaf49726009c",
					"size": 543733,
					"status": "missing-in-source"
				},
				"examples/file-server.js": {
					"diff": "--- published/examples/file-server.js\n+++ rebuilt/examples/file-server.js\n@@ -1,24 +1,20 @@\n-var static = require('../lib/node-static');\n+import http from 'http';\n+import * as statik from '../lib/node-static.js';\n \n //\n // Create a node-static server to serve the current directory\n //\n-var file = new(static.Server)('.', { cache: 7200, headers: {'X-Hello':'World!'} });\n+const file = new statik.Server('.', { cache: 7200, headers: {'X-Hello':'World!'} });\n \n-require('http').createServer(function (request, response) {\n-    request.addListener('end', function () {\n-        //\n-        // Serve files!\n-        //\n-        file.serve(request, response, function (err, res) {\n-            if (err) { // An error as occured\n-                console.error(\"> Error serving \" + request.url + \" - \" + err.message);\n-                response.writeHead(err.status, err.headers);\n-                response.end();\n-            } else { // The file was served successfully\n-                console.log(\"> \" + request.url + \" - \" + res.message);\n-            }\n-        });\n+http.createServer(function (request, response) {\n+    file.serve(request, response, function (err, res) {\n+        if (err) { // An error has occurred\n+            console.error(\"> Error serving \" + request.url + \" - \" + err.message);\n+            response.writeHead(err.status, err.headers);\n+            response.end();\n+        } else { // The file was served successfully\n+            console.log(\"> \" + request.url + \" - \" + res.message);\n+        }\n     });\n }).listen(8080);\n \n",
					"match": false,
					"packageHash": "0f407da1c386d2853b7ca12c8ed2c7e005f8d6118a759631fde326e4ee9e9427",
					"size": 883,
					"sourceHash": "9a8702f8c73131f3813b5a435325bbeda9a5a13ba2a11f12634e7df1c55a0946",
					"status": "content"
				},
				"lib/node-static/mime.js": {
					"match": false,
					"packageHash": "e45bf55e90f74455958eaf35c3260886e5f1b1dae4297bb42be8a8d6c4bee8dd",
					"size": 4254,
					"status": "missing-in-source"
				},
				"lib/node-static/util.js": {
					"match": false,
					"packageHash": "f166863e818f5e5614d6f3b7e5a91aa5d45ca6666d3aa24877223fd159c1a265",
					"size": 944,
					"status": "missing-in-source"
				},
				"lib/node-static.js": {
					"diff": "--- published/lib/node-static.js\n+++ rebuilt/lib/node-static.js\n@@ -1,269 +1,839 @@\n-var fs     = require('fs')\n-  , events = require('events')\n-  , buffer = require('buffer')\n-  , http   = require('http')\n-  , url    = require('url')\n-  , path   = require('path');\n-\n-exports.version = [0, 6, 4];\n-\n-var mime = require('./node-static/mime');\n-var util = require('./node-static/util');\n-\n-// In-memory file store\n-exports.store = {};\n-exports.indexStore = {};\n+import fs from 'node:fs';\n+import events from 'node:events';\n+import http from 'node:http';\n+import path from 'node:path';\n+// import buffer from 'node:buffer';\n+\n+import {isHiddenFile as isHiddenFileOrDirectory} from 'is-hidden-file';\n+import mime from 'mime';\n+import {minimatch} from 'minimatch';\n+import {mstat} from './node-static/mstat.js';\n+import {gzip} from './node-static/gzip.js';\n+\n+\n+/**\n+ * @typedef {{\n+ *   status: number,\n+ *   headers: http.OutgoingHttpHeaders,\n+ *   message?: string\n+ * }} ResultInfo\n+ */\n+\n+/**\n+ * @typedef {(\n+ *   status: number,\n+ *   headers: http.OutgoingHttpHeaders,\n+ *   streaming?: boolean\n+ * ) => void} Finish\n+ */\n+\n+const pkg = JSON.parse(\n+    // @ts-expect-error Works fine\n+    fs.readFileSync(\n+        new URL('../package.json', import.meta.url)\n+    )\n+);\n+\n+const version = pkg.version.split('.');\n+\n+/**\n+ * @param {string} p\n+ * @param {(err: NodeJS.ErrnoException | null, stats?: fs.Stats) => void} callback\n+ */\n+function tryStat(p, callback) {\n+    try {\n+        fs.stat(p, callback);\n+    } catch (e) {\n+        callback(/** @type {NodeJS.ErrnoException} */ (e));\n+    }\n+}\n \n-exports.Server = function (root, options) {\n-    if (root && (typeof(root) === 'object')) { options = root; root = null }\n+/**\n+ * @typedef {(\n+ *     file: string,\n+ *     pathname: string|null,\n+ *     req: http.IncomingMessage,\n+ *     res: http.ServerResponse\n+ *   ) => import('node:stream').Transform} TransformCallback\n+ */\n+\n+/**\n+ * @typedef {{\n+ *   indexFile?: string,\n+ *   directoryCallback?: (\n+ *     pathname: string,\n+ *     req: http.IncomingMessage,\n+ *     res: http.ServerResponse<http.IncomingMessage> & {\n+ *       req: http.IncomingMessage;\n+ *     }\n+ *   ) => void,\n+ *   gzip?: boolean|RegExp,\n+ *   gzipOnly?: \"allow\"|\"require\",\n+ *   gzipAuto?: boolean,\n+ *   headers?: http.OutgoingHttpHeaders,\n+ *   serverInfo?: string|null,\n+ *   cache?: null|boolean|number|Record<string, number>,\n+ *   serveHidden?: boolean,\n+ *   defaultExtension?: string,\n+ *   transform?: TransformCallback\n+ * }} ServerOptions\n+ */\n",
					"match": false,
					"packageHash": "7a6e21fc3bdb46ba88e8b67d6b379bd354f3801bb65b94109e51cc2e1be7cbcb",
					"size": 8834,
					"sourceHash": "0e0a7c70f0b75589a3e12b37630b1108489e82fac63e94a59ab7a82eb35e3676",
					"status": "content"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,36 +1,90 @@\n {\n-  \"name\" : \"node-static\",\n-  \"description\" : \"simple, compliant file streaming module for node\",\n-  \"url\" : \"http://github.com/cloudhead/node-static\",\n-  \"keywords\" : [\"http\", \"static\", \"file\", \"server\"],\n-  \"author\" : \"Alexis Sellier <self@cloudhead.net>\",\n-  \"contributors\" : [\n-    {\n-      \"name\": \"Pablo Cantero\",\n-      \"email\": \"pablo@pablocantero.com\"\n+  \"name\": \"node-static\",\n+  \"version\": \"0.8.0\",\n+  \"description\": \"simple, compliant file streaming module for node\",\n+  \"author\": \"Alexis Sellier <alexis@cloudhead.io>\",\n+  \"contributors\": [\n+    \"Pablo Cantero <pablo@pablocantero.com>\",\n+    \"Ionică Bizău <bizauionica@gmail.com>\",\n+    \"Brett Zamir\"\n+  ],\n+  \"type\": \"module\",\n+  \"main\": \"./lib/node-static.js\",\n+  \"exports\": {\n+    \".\": {\n+      \"types\": \"./dist/lib/node-static.d.ts\",\n+      \"import\": \"./lib/node-static.js\",\n+      \"require\": \"./dist/node-static.cjs\"\n     }\n+  },\n+  \"license\": \"MIT\",\n+  \"bin\": {\n+    \"static\": \"bin/cli.js\"\n+  },\n+  \"keywords\": [\n+    \"http\",\n+    \"static\",\n+    \"file\",\n+    \"server\"\n   ],\n   \"repository\": {\n     \"type\": \"git\",\n     \"url\": \"http://github.com/cloudhead/node-static\"\n   },\n-  \"main\" : \"./lib/node-static\",\n   \"scripts\": {\n-    \"test\": \"vows --spec --isolate\"\n+    \"prepublishOnly\": \"npm run build\",\n+    \"tsc\": \"tsc\",\n+    \"gzip\": \"node test/gzip.js\",\n+    \"build\": \"rollup -c && tsc -p tsconfig-prod.json\",\n+    \"start\": \"./bin/cli.js\",\n+    \"lint\": \"eslint .\",\n+    \"mocha\": \"mocha test/integration --parallel\",\n+    \"test\": \"c8 npm run mocha\"\n   },\n-  \"bin\": {\n-    \"static\": \"bin/cli.js\"\n+  \"dependencies\": {\n+    \"colors\": \"1.4.0\",\n+    \"command-line-basics\": \"^3.0.0\",\n+    \"is-hidden-file\": \"^1.1.2\",\n+    \"mime\": \"^3.0.0\",\n+    \"minimatch\": \"^9.0.0\"\n+  },\n+  \"c8\": {\n+    \"check-coverage\": true,\n+    \"branches\": 100,\n+    \"functions\": 100,\n+    \"lines\": 100,\n+    \"statements\": 100,\n+    \"exclude\": [\n+      \"dist\",\n+      \"test\"\n+    ]\n+  },\n+  \"devDependencies\": {\n+    \"@eslint/js\": \"^9.37.0\",\n+    \"@types/chai\": \"^5.2.2\",\n+    \"@types/mime\": \"^3.0.4\",\n+    \"@types/mocha\": \"^10.0.10\",\n+    \"@types/node\": \"^24.7.2\",\n+    \"@types/node-fetch\": \"^2.6.13\",\n+    \"@types/node-gzip\": \"^1.1.3\",\n+    \"c8\": \"^10.1.3\",\n+    \"chai\": \"^6.2.0\",\n+    \"eslint\": \"^9.37.0\",\n+    \"globals\": \"^16.4.0\",\n+    \"mocha\": \"^11.7.4\",\n+    \"node-fetch\": \"^2.6.6\",\n+    \"rollup\": \"^4.52.4\",\n+    \"typescript\": \"^5.9.3\"\n+  },\n+  \"engines\": {\n+    \"node\": \"^20.11.0 || >= 22.0.0\"\n   },\n-  \"license\" : \"MIT\",\n-  \"dependencies\" : {\n-    \"optimist\": \">=0.3.4\",\n",
					"match": false,
					"packageHash": "ae65640ac3eee74777626a0e91800bbb23c61cfa436d1b119a383171122607fe",
					"size": 827,
					"sourceHash": "c29b6eb482548b57b38e0b43d0039cdef713691531164cbfeb82203cf4aebe9d",
					"status": "content"
				},
				"test/fixtures/hello.txt": {
					"match": false,
					"packageHash": "b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9",
					"size": 11,
					"status": "missing-in-source"
				},
				"test/fixtures/index.html": {
					"match": false,
					"packageHash": "74180e4ebea936da79957a093be70e1899eb56dd517dbd4422e0bc128f828e4e",
					"size": 98,
					"status": "missing-in-source"
				},
				"test/integration/node-static-test.js": {
					"match": false,
					"packageHash": "da40b7d6b53e06f0ebaed0967b9061ef951a462fd432a7dbe8cb6f49f54efcab",
					"size": 4444,
					"status": "missing-in-source"
				},
				".editorconfig": {
					"match": false,
					"status": "missing-in-package"
				},
				".github/workflows/node.js.yml": {
					"match": false,
					"status": "missing-in-package"
				},
				".ncurc.cjs": {
					"match": false,
					"status": "missing-in-package"
				},
				"CHANGES.md": {
					"match": false,
					"status": "missing-in-package"
				},
				"bin/optionDefinitions.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"dist/node-static.cjs": {
					"match": false,
					"status": "missing-in-package"
				},
				"eslint.config.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"examples/file-server.cjs": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/node-static/gzip.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/node-static/mstat.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"tsconfig-prod.json": {
					"match": false,
					"status": "missing-in-package"
				},
				"tsconfig.json": {
					"match": false,
					"status": "missing-in-package"
				}
			},
			"summary": {
				"differentFiles": 6,
				"matchingFiles": 0,
				"missingInPackage": 12,
				"missingInSource": 9,
				"score": 0,
				"totalFiles": 27
			}
		}
	}
]
