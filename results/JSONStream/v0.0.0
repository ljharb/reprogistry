[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-05T20:23:08.265Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:2.15.11",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "JSONStream@0.0.0",
			"name": "JSONStream",
			"version": "0.0.0",
			"location": "https://registry.npmjs.org/JSONStream/-/JSONStream-0.0.0.tgz",
			"integrity": "sha512-o/SqiAq4d9heBrFt+wnNGfBmy550NhyxwGCo6H3nq+VBggNiSWdt9y6q0M3I9nznjFAxOxiXwS6cMFw1IclhVQ==",
			"publishedAt": "2011-09-23T11:01:40.295Z",
			"publishedWith": {
				"node": "v0.4.12",
				"npm": "1.0.27"
			}
		},
		"source": {
			"integrity": null,
			"location": "git://github.com/dominictarr/JSONStream.git",
			"spec": "github:dominictarr/JSONStream#HEAD"
		},
		"comparisonHash": "8a2a8dcbb729bf3ee9216e490c955701f0ddebe1",
		"diff": {
			"files": {
				".gitignore": {
					"match": false,
					"packageHash": "a1cd9589c07a23e3a67e8c6017e10a46d26085a85c7b55dee70192c788b1d1f8",
					"size": 42,
					"status": "missing-in-source"
				},
				"examples/all_docs.js": {
					"diff": "--- published/examples/all_docs.js\n+++ rebuilt/examples/all_docs.js\n@@ -2,7 +2,7 @@\n   , JSONStream = require('JSONStream')\n   , es = require('event-stream')\n \n-var parser = JSONStream.parse(['rows', /./]) //emit parts that match this path (any element of the rows array)\n+var parser = JSONStream.parse(['rows', true]) //emit parts that match this path (any element of the rows array)\n   , req = request({url: 'http://isaacs.couchone.com/registry/_all_docs'})\n   , logger = es.mapSync(function (data) {  //create a stream that logs to stderr,\n     console.error(data)\n",
					"match": false,
					"packageHash": "cc547c8e39fa2ae51ce4fe4b9a87e1e33c6f6385627a760212199be53d523fdb",
					"size": 458,
					"sourceHash": "1492c7523d8c43f3db5c3ae6e87a725b535f408d6151dcd8b351b929268944a8",
					"status": "content"
				},
				"index.js": {
					"diff": "--- published/index.js\n+++ rebuilt/index.js\n@@ -1,80 +1,247 @@\n+'use strict'\n \n var Parser = require('jsonparse')\n-  , Stream = require('stream').Stream\n+  , through = require('through')\n+\n+var bufferFrom = Buffer.from && Buffer.from !== Uint8Array.from\n \n /*\n \n   the value of this.stack that creationix's jsonparse has is weird.\n-  \n+\n   it makes this code ugly, but his problem is way harder that mine,\n   so i'll forgive him.\n-  \n-  \n \n */\n \n-exports.parse = function (path) {\n-  \n-  var stream = new Stream()\n+exports.parse = function (path, map) {\n+  var header, footer\n   var parser = new Parser()\n-  var count = 0\n-  if(!path.length)\n+  var stream = through(function (chunk) {\n+    if('string' === typeof chunk)\n+      chunk = bufferFrom ? Buffer.from(chunk) : new Buffer(chunk)\n+    parser.write(chunk)\n+  },\n+  function (data) {\n+    if(data)\n+      stream.write(data)\n+    if (header)\n+        stream.emit('header', header)\n+    if (footer)\n+      stream.emit('footer', footer)\n+    stream.queue(null)\n+  })\n+\n+  if('string' === typeof path)\n+    path = path.split('.').map(function (e) {\n+      if (e === '$*')\n+        return {emitKey: true}\n+      else if (e === '*')\n+        return true\n+      else if (e === '') // '..'.split('.') returns an empty string\n+        return {recurse: true}\n+      else\n+        return e\n+    })\n+\n+\n+  var count = 0, _key\n+  if(!path || !path.length)\n     path = null\n-  parser.onValue = function () {\n-    if(!this.root && this.stack.length == 1){\n-      stream.root = this.value\n-      }\n-    if(!path || this.stack.length !== path.length)\n-      return\n-    var _path = []\n-    for( var i = 0; i < (path.length - 1); i++) {\n+\n+  parser.onValue = function (value) {\n+    if (!this.root)\n+      stream.root = value\n+\n+    if(! path) return\n+\n+    var i = 0 // iterates on path\n+    var j  = 0 // iterates on stack\n+    var emitKey = false;\n+    var emitPath = false;\n+    while (i < path.length) {\n       var key = path[i]\n-      var c = this.stack[1 + (+i)]\n-      \n-      if(!c) {\n-        console.log(c, this.stack.length)\n-        return\n+      var c\n+      j++\n+\n+      if (key && !key.recurse) {\n+        c = (j === this.stack.length) ? this : this.stack[j]\n+        if (!c) return\n+        if (! check(key, c.key)) {\n+          setHeaderFooter(c.key, value)\n+          return\n+        }\n+        emitKey = !!key.emitKey;\n+        emitPath = !!key.emitPath;\n",
					"match": false,
					"packageHash": "725256c1e4a6d9be336ebf6d68b45a9e8278f739df7f593f318215b3bd39f585",
					"size": 1594,
					"sourceHash": "7b5957eaea88b1bb6709767543f7072693774a04cabbf6cb0dfee8c436f3bee3",
					"status": "content"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,13 +1,40 @@\n-{ \"name\": \"JSONStream\"\n-, \"version\": \"0.0.0\"\n-, \"description\": \"rawStream.pipe(JSONStream.parse()).pipe(streamOfObjects)\"\n-, \"homepage\": \"http://github.com/dominictarr/JSONStream\"\n-, \"repository\": \n-  { \"type\": \"git\"\n-  , \"url\": \"https://github.com/dominictarr/JSONStream.git\" }\n-, \"dependencies\": {\n-    \"jsonparse\": \"0.0.1\"\n+{\n+  \"name\": \"JSONStream\",\n+  \"version\": \"1.3.5\",\n+  \"description\": \"rawStream.pipe(JSONStream.parse()).pipe(streamOfObjects)\",\n+  \"homepage\": \"http://github.com/dominictarr/JSONStream\",\n+  \"repository\": {\n+    \"type\": \"git\",\n+    \"url\": \"git://github.com/dominictarr/JSONStream.git\"\n+  },\n+  \"license\": \"(MIT OR Apache-2.0)\",\n+  \"keywords\": [\n+    \"json\",\n+    \"stream\",\n+    \"streaming\",\n+    \"parser\",\n+    \"async\",\n+    \"parsing\"\n+  ],\n+  \"dependencies\": {\n+    \"jsonparse\": \"^1.2.0\",\n+    \"through\": \">=2.2.7 <3\"\n+  },\n+  \"devDependencies\": {\n+    \"it-is\": \"~1\",\n+    \"assertions\": \"~2.2.2\",\n+    \"render\": \"~0.1.1\",\n+    \"trees\": \"~0.0.3\",\n+    \"event-stream\": \"~0.7.0\",\n+    \"tape\": \"~2.12.3\"\n+  },\n+  \"bin\": \"./bin.js\",\n+  \"author\": \"Dominic Tarr <dominic.tarr@gmail.com> (http://bit.ly/dominictarr)\",\n+  \"scripts\": {\n+    \"test\": \"node test/run.js\"\n+  },\n+  \"optionalDependencies\": {},\n+  \"engines\": {\n+    \"node\": \"*\"\n   }\n-, \"devDependencies\": {}\n-, \"author\": \"Dominic Tarr <dominic.tarr@gmail.com> (http://bit.ly/dominictarr)\"\n-, \"scripts\": { \"test\": \"meta-test test/*.js\" } }\n\\ No newline at end of file\n+}\n",
					"match": false,
					"packageHash": "d3bf2549df42e7368131ecf5b9a33bc70c61c41664d8c474d9dc08206937130f",
					"size": 474,
					"sourceHash": "6c3e9f2eebd7710a81709f5c788615fd773116d73ecb1c64fa04cc5039bf0c62",
					"status": "content"
				},
				"readme.markdown": {
					"diff": "--- published/readme.markdown\n+++ rebuilt/readme.markdown\n@@ -2,50 +2,55 @@\n \n streaming JSON.parse and stringify\n \n+![](https://secure.travis-ci.org/dominictarr/JSONStream.png?branch=master)\n+\n+## install\n+```npm install JSONStream```\n+\n ## example\n \n-in node v0.4.x\n-```js\n+``` js\n \n var request = require('request')\n   , JSONStream = require('JSONStream')\n   , es = require('event-stream')\n \n-var parser = JSONStream.parse(['rows', /./]) //emit parts that match this path (any element of the rows array)\n-  , req = request({url: 'http://isaacs.couchone.com/registry/_all_docs'})\n+request({url: 'http://isaacs.couchone.com/registry/_all_docs'})\n+  .pipe(JSONStream.parse('rows.*'))\n+  .pipe(es.mapSync(function (data) {\n+    console.error(data)\n+    return data\n+  }))\n ```\n-in node 0.4.x\n \n-``` js\n+## JSONStream.parse(path)\n \n-req.pipe(parser)\n-parser.pipe(es.log(''))\n+parse stream of values that match a path\n \n+``` js\n+  JSONStream.parse('rows.*.doc')\n ```\n \n-in node v0.5.x\n+The `..` operator is the recursive descent operator from [JSONPath](http://goessner.net/articles/JsonPath/), which will match a child at any depth (see examples below).\n \n-```js\n-req.pipe(parser).pipe(es.log(''))\n-\n-```\n+If your keys have keys that include `.` or `*` etc, use an array instead.\n+`['row', true, /^doc/]`.\n \n-## JSONStream.parse(path)\n+If you use an array, `RegExp`s, booleans, and/or functions. The `..` operator is also available in array representation, using `{recurse: true}`.\n+any object that matches the path will be emitted as 'data' (and `pipe`d down stream)\n \n-usally, a json API will return a list of objects.  \n+If `path` is empty or null, no 'data' events are emitted.\n \n-`path` should be an array of property names and/or `RedExp`s.\n-any object that matches the path will be emitted as 'data' (and `pipe()`d down stream)\n+If you want to have keys emitted, you can prefix your `*` operator with `$`: `obj.$*` - in this case the data passed to the stream is an object with a `key` holding the key and a `value` property holding the data.\n \n-if `path` is empty or null, or if no matches are made:\n-JSONStream.parse will only emit 'data' once, emitting the root object.\n+### Examples\n \n-for example, couchdb returns views like this:\n+query a couchdb view:\n \n ``` bash\n-curl -sS localhost:5984/tests/_all_docs\n+curl -sS localhost:5984/tests/_all_docs&include_docs=true\n ```\n-returns this:\n+you will get something like this:\n \n ``` js\n {\"total_rows\":129,\"offset\":0,\"rows\":[\n@@ -56,29 +61,147 @@\n       \"_id\":  \"change1_0.6995461115147918\"\n     , \"_rev\": \"1-e240bae28c7bb3667f02760f6398d508\",\"hello\":1}\n   },\n-{\"id\":\"change2_0.6995461115147918\",\"key\":\"change2_0.6995461115147918\",\"value\":{\"rev\":\"1-13677d36b98c0c075145bb8975105153\"},\"doc\":{\"_id\":\"change2_0.6995461115147918\",\"_rev\":\"1-13677d36b98c0c075145bb8975105153\",\"hello\":2}},\n-...\n+  { \"id\":\"change2_0.6995461115147918\"\n+  , \"key\":\"change2_0.6995461115147918\"\n+  , \"value\":{\"rev\":\"1-13677d36b98c0c075145bb8975105153\"}\n+  , \"doc\":{\n+      \"_id\":\"change2_0.6995461115147918\"\n+    , \"_rev\":\"1-13677d36b98c0c075145bb8975105153\"\n+    , \"hello\":2\n+    }\n+  },\n ]}\n \n ```\n \n-we are probably interested in the `rows.*.docs`  \n",
					"match": false,
					"packageHash": "a101b4c396400a52752d356b3c093c5865b427cebbdf27660de5eac9d19fc94e",
					"size": 1982,
					"sourceHash": "19743ac82dc8ab2992800d6006a71aa0dc29aa368c6907cd80d48f5ce905427d",
					"status": "content"
				},
				"test/test.js": {
					"diff": "--- published/test/test.js\n+++ rebuilt/test/test.js\n@@ -17,9 +17,9 @@\n parser.on('data', function (data) {\n   called ++\n   it.has({\n-    id: it.isString(),\n-    value: {rev: it.isString()},\n-    key:it.isString()\n+    id: it.typeof('string'),\n+    value: {rev: it.typeof('string')},\n+    key:it.typeof('string')\n   })\n   parsed.push(data)\n })\n@@ -32,4 +32,4 @@\n   it(called).equal(expected.rows.length)\n   it(parsed).deepEqual(expected.rows)\n   console.error('PASSED')\n-})\n\\ No newline at end of file\n+})\n",
					"match": false,
					"packageHash": "416aa42d02ce23735eb9327e992c0e40df1f1599200295aa025401e2b3247c36",
					"size": 729,
					"sourceHash": "6960a1fe2e24c572a57703db189fdab0d7411e1d13a33fc01510e2a3133e86da",
					"status": "content"
				},
				".travis.yml": {
					"match": false,
					"status": "missing-in-package"
				},
				"LICENSE.APACHE2": {
					"match": false,
					"status": "missing-in-package"
				},
				"LICENSE.MIT": {
					"match": false,
					"status": "missing-in-package"
				},
				"bin.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/bool.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/browser.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/destroy_missing.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/doubledot1.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/doubledot2.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/empty.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/error_contents.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/fixtures/couch_sample.json": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/fixtures/depth.json": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/fixtures/error.json": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/fixtures/header_footer.json": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/fn.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/gen.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/header_footer.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/issues.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/keys.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/map.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/multiple_objects.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/multiple_objects_error.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/null.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/parsejson.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/run.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/stringify.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/stringify_object.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"test/two-ways.js": {
					"match": false,
					"status": "missing-in-package"
				}
			},
			"summary": {
				"differentFiles": 5,
				"matchingFiles": 2,
				"missingInPackage": 29,
				"missingInSource": 1,
				"score": 0.05405405405405406,
				"totalFiles": 37
			}
		}
	}
]
