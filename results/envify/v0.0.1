[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-06T06:15:13.297Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "envify@0.0.1",
			"name": "envify",
			"version": "0.0.1",
			"location": "https://registry.npmjs.org/envify/-/envify-0.0.1.tgz",
			"integrity": "sha512-4LztHtJ7/d8nTsFPUVVG7enxv+BTFObj2X+53xsw/chZXTF+8zwY0jTMcC5FX/AwRNdmILFL9iYxSdqhhXpW/Q==",
			"publishedAt": "2013-06-12T08:02:33.463Z",
			"publishedWith": {
				"node": null,
				"npm": "1.1.71"
			}
		},
		"source": {
			"integrity": null,
			"location": "git://github.com/hughsk/envify.git",
			"spec": "github:hughsk/envify#HEAD"
		},
		"comparisonHash": "9ef46a5bd31291e57cbab41e2f17c57bd6da0b5b",
		"diff": {
			"files": {
				"README.md": {
					"diff": "--- published/README.md\n+++ rebuilt/README.md\n@@ -1,4 +1,4 @@\n-# envify #\n+# envify  [![Build Status](https://secure.travis-ci.org/hughsk/envify.png?branch=master)](http://travis-ci.org/hughsk/envify) [![stable](http://hughsk.github.io/stability-badges/dist/stable.svg)](http://github.com/hughsk/stability-badges) #\n \n Selectively replace Node-style environment variables with plain strings.\n Available as a standalone CLI tool and a\n@@ -45,6 +45,16 @@\n [UglifyJS2](https://github.com/mishoo/UglifyJS)), the above code would be\n stripped out completely.\n \n+However, if you bundled the same script with `NODE_ENV` set to `development`:\n+\n+``` javascript\n+if (\"development\" === \"development\") {\n+  console.log('development only')\n+}\n+```\n+\n+The `if` statement will evaluate to `true`, so the code won't be removed.\n+\n ## CLI Usage ##\n \n With browserify:\n@@ -59,6 +69,15 @@\n envify index.js > bundle.js\n ```\n \n+You can also specify additional custom environment variables using\n+browserify's [subarg](http://github.com/substack/subarg) syntax, which is\n+available in versions 3.25.0 and above:\n+\n+``` bash\n+browserify index.js -t [ envify --NODE_ENV development ] > bundle.js\n+browserify index.js -t [ envify --NODE_ENV production  ] > bundle.js\n+```\n+\n ## Module Usage ##\n \n **require('envify')**\n@@ -76,7 +95,7 @@\n   , envify = require('envify/custom')\n   , fs = require('fs')\n \n-var bundle = browserify('main.js')\n+var b = browserify('main.js')\n   , output = fs.createWriteStream('bundle.js')\n \n b.transform(envify({\n@@ -84,3 +103,43 @@\n }))\n b.bundle().pipe(output)\n ```\n+\n+## Purging `process.env` ##\n+\n+By default, environment variables that are not defined will be left untouched.\n+This is because in some cases, you might want to run an envify transform over\n+your source more than once, and removing these values would make that\n+impossible.\n+\n+However, if any references to `process.env` are remaining after transforming\n+your source with envify, browserify will automatically insert its shim for\n+Node's process object, which will increase the size of your bundle. This weighs\n+in at around 2KB, so if you're trying to be conservative with your bundle size\n+you can \"purge\" these remaining variables such that any missing ones are simply\n+replaced with undefined.\n+\n+To do so through the command-line, simply use the subarg syntax and include\n+`purge` after `envify`, e.g.:\n+\n+``` bash\n+browserify index.js -t [ envify purge --NODE_ENV development ]\n+```\n+\n+Or if you're using the module API, you can pass `_: \"purge\"` into your\n+arguments like so:\n+\n+``` javascript\n+b.transform(envify({\n+    _: 'purge'\n+  , NODE_ENV: 'development'\n+}))\n+```\n+\n+## Contributors ##\n+\n+* [hughsk](http://github.com/hughsk)\n+* [benjamn](http://github.com/benjamn)\n+* [zag2art](http://github.com/zag2art)\n+* [bjoerge](http://github.com/bjoerge)\n+* [andreypopp](http://github.com/andreypopp)\n+* [jupl](http://github.com/jupl)\n",
					"match": false,
					"packageHash": "0c64881f45faff5c5eb38d775a09a017927c5c70717cbc4eb6654df19829cb16",
					"size": 1813,
					"sourceHash": "8f5f68048ede8bf34fc0f1accfe29d3111020906d2e38ffb41913ddea1eb7dc0",
					"status": "content"
				},
				"custom.js": {
					"diff": "--- published/custom.js\n+++ rebuilt/custom.js\n@@ -1,50 +1,91 @@\n-var through = require('through')\n-  , falafel = require('falafel')\n+var esprima = require('esprima')\n+  , through = require('through')\n \n-module.exports = function(env) {\n-  env = env || process.env || {}\n-  return envify\n-\n-  function envify(file) {\n-    var buffer = ''\n-\n-    return through(function(data) {\n-      buffer += data\n-    }, function processFile() {\n-      var output = falafel(buffer, function(node) {\n-        if (!(\n-          node.type === 'Identifier' &&\n-          node.name === 'process' &&\n-          node.parent &&\n-          node.parent.property &&\n-          node.parent.property.type === 'Identifier' &&\n-          node.parent.property.name === 'env' &&\n-          node.parent.parent &&\n-          node.parent.parent.property &&\n-        ( node.parent.parent.property.name ||\n-          node.parent.parent.property.value ) &&\n-        ( node.parent.parent.parent\n-        ? node.parent.parent.parent.type !== 'AssignmentExpression'\n-        : true )\n-        )) return\n-\n-        var key = node.parent.parent.property.name ||\n-                  node.parent.parent.property.value\n-\n-        if (!(key in env)) return\n-\n-        node.parent.parent.update(\n-          env[key] ? JSON.stringify(env[key]) :\n-          env[key] === false ? 'false'        :\n-          env[key] === null ? 'null'          :\n-          env[key] === '' ? '\"\"'              :\n-          env[key] === 0 ? '0'                :\n-          'undefined'\n+var processEnvPattern = /\\bprocess\\.env\\b/\n+\n+module.exports = function(rootEnv) {\n+  rootEnv = rootEnv || process.env || {}\n+\n+  return function envify(file, argv) {\n+    if (/\\.json$/.test(file)) return through()\n+\n+    var Syntax = esprima.Syntax\n+    var buffer = []\n+    argv = argv || {}\n+\n+    return through(write, flush)\n+\n+    function write(data) {\n+      buffer.push(data)\n+    }\n+\n+    function transform(source, envs) {\n+      var args  = [].concat(envs[0]._ || []).concat(envs[1]._ || [])\n+      var purge = args.indexOf('purge') !== -1\n+      var replacements = []\n+\n+      function match(node) {\n+        return (\n+          node.type === Syntax.MemberExpression\n+          && node.object.type === Syntax.MemberExpression\n+          && node.object.computed === false\n+          && node.object.object.type === Syntax.Identifier\n+          && node.object.object.name === 'process'\n+          && node.object.property.type === Syntax.Identifier\n+          && node.object.property.name === 'env'\n+          && (node.computed ? node.property.type === Syntax.Literal : node.property.type === Syntax.Identifier)\n         )\n+      }\n+\n+      esprima.parse(source, { tolerant: true }, function(node, meta) {\n+        if (match(node)) {\n+          var key = node.property.name || node.property.value\n+          for (var i = 0; i < envs.length; i++) {\n+            var value = envs[i][key]\n+            if (value !== undefined) {\n+              replacements.push({ node: node, meta: meta, value: JSON.stringify(value) })\n+              return\n+            }\n+          }\n+          if (purge) {\n+            replacements.push({ node: node, meta: meta, value: undefined })\n+          }\n+        } else if (node.type === Syntax.AssignmentExpression) {\n+          for (var i = 0; i < replacements.length; ++i) {\n+            if (replacements[i].node === node.left) {\n+              replacements.splice(i, 1)\n",
					"match": false,
					"packageHash": "3f263fae010c542980bfb32f54e36f0bae77279cc4866004be215f5d4d3a302e",
					"size": 1430,
					"sourceHash": "45cf7d62a903f040d650f8cc1c9f72e3706e20fd1804ecc55515690b74d2431a",
					"status": "content"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,10 +1,10 @@\n {\n   \"name\": \"envify\",\n-  \"version\": \"0.0.1\",\n+  \"version\": \"4.1.0\",\n   \"description\": \"Selectively replace Node-style environment variables with plain strings.\",\n   \"main\": \"index.js\",\n   \"scripts\": {\n-    \"test\": \"node test.js\"\n+    \"test\": \"node test.js | tap-spec\"\n   },\n   \"bin\": {\n     \"envify\": \"bin/envify\"\n@@ -16,16 +16,20 @@\n   \"author\": \"Hugh Kennedy <hughskennedy@gmail.com> (http://hughskennedy.com/)\",\n   \"license\": \"MIT\",\n   \"devDependencies\": {\n-    \"tape\": \"~0.3.3\"\n+    \"tap-spec\": \"^4.1.1\",\n+    \"tape\": \"^4.6.0\"\n   },\n   \"dependencies\": {\n-    \"through\": \"~2.3.4\",\n-    \"falafel\": \"~0.2.1\"\n+    \"esprima\": \"^4.0.0\",\n+    \"through\": \"~2.3.4\"\n   },\n   \"keywords\": [\n     \"environment\",\n     \"variables\",\n     \"browserify\",\n+    \"browserify-transform\",\n+    \"transform\",\n+    \"source\",\n     \"configuration\"\n   ]\n }\n",
					"match": false,
					"packageHash": "f6b6a7c7d76a06c7d4c427ea94acb6c9860e8d75eca31b0d34e93cbdc54fb599",
					"size": 658,
					"sourceHash": "f1d8f35134dd7f8b286c5ed03ea25c5ea42845db9ba0f9654707f7813a1903a2",
					"status": "content"
				},
				"test.js": {
					"match": false,
					"packageHash": "5f1669fd4da0a4b1e911f6ab884fa5e893a159140341da643cd8660a38312f54",
					"size": 1243,
					"status": "missing-in-source"
				}
			},
			"summary": {
				"differentFiles": 3,
				"matchingFiles": 2,
				"missingInPackage": 0,
				"missingInSource": 1,
				"score": 0.3333333333333333,
				"totalFiles": 6
			}
		}
	}
]
