[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-01T16:35:49.651Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:2.15.11",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "jasmine-node@1.0.19",
			"name": "jasmine-node",
			"version": "1.0.19",
			"location": "https://registry.npmjs.org/jasmine-node/-/jasmine-node-1.0.19.tgz",
			"integrity": "sha512-6rjJd6gT8bGAorInBNJ00Wu2NqAdnGXviozL0HU1UFEvbAAEwxoeT67N7uYAD3EXjfsce7hEd9ZS8gt0xd+Jyw==",
			"publishedAt": "2012-01-18T05:38:54.359Z",
			"publishedWith": {
				"node": "v0.6.6",
				"npm": "1.0.106"
			}
		},
		"source": {
			"integrity": null,
			"location": "git://github.com/mhevery/jasmine-node.git",
			"spec": "github:mhevery/jasmine-node#HEAD"
		},
		"comparisonHash": "8a2a8dcbb729bf3ee9216e490c955701f0ddebe1",
		"diff": {
			"files": {
				".externalToolBuilders/jasmineSpecs.launch": {
					"match": false,
					"packageHash": "d7c441ef93697e83145b6edf78145d290ae73ba7b55c2dbcb8a412cbe29af8c4",
					"size": 1407,
					"status": "missing-in-source"
				},
				".gitignore": {
					"match": false,
					"packageHash": "cdaa6bf4765f807265fdbd67d230a168e1b60fecbd29d231210164d47d224e5f",
					"size": 106,
					"status": "missing-in-source"
				},
				".idea/.name": {
					"match": false,
					"packageHash": "0181761b9246d5104f1460aa95b1313896fa1f06a79f5bdc944e6f64c7b099fc",
					"size": 12,
					"status": "missing-in-source"
				},
				".idea/encodings.xml": {
					"match": false,
					"packageHash": "0234e0fa9139efc865c3e6b2099a91944493dd7867b5e883ae5e10511cc239e9",
					"size": 166,
					"status": "missing-in-source"
				},
				".idea/jasmine-node.iml": {
					"match": false,
					"packageHash": "c1274ebfefd9b3af0c027b8053a601987e579048c720e49921b89a3452b3bb0b",
					"size": 283,
					"status": "missing-in-source"
				},
				".idea/misc.xml": {
					"match": false,
					"packageHash": "ef977473b36ae001079781f73582fa1334ba6e1f0da8ca98ae850d5772987c8d",
					"size": 258,
					"status": "missing-in-source"
				},
				".idea/modules.xml": {
					"match": false,
					"packageHash": "81e113f2d3a8635bbde54e449afaa415df9bf48e514d49abe54310ba5611e03b",
					"size": 278,
					"status": "missing-in-source"
				},
				".idea/scopes/scope_settings.xml": {
					"match": false,
					"packageHash": "c1818c37eb63a10bcd7c575502aff53cdbff43df30419ccd9c4f6bf7792af4d0",
					"size": 139,
					"status": "missing-in-source"
				},
				".idea/vcs.xml": {
					"match": false,
					"packageHash": "39d2088d50982be95f641e6640f075539365395989d88f39083b43613c2682d8",
					"size": 182,
					"status": "missing-in-source"
				},
				".idea/workspace.xml": {
					"match": false,
					"packageHash": "b0e694f28d0305b284d5de5014a46d21ff2aa71672d6f250d35df8b7693e59e7",
					"size": 22685,
					"status": "missing-in-source"
				},
				"LICENSE": {
					"diff": "--- published/LICENSE\n+++ rebuilt/LICENSE\n@@ -1,5 +1,6 @@\n The MIT License\n \n+Copyright (c) 2018-present Christopher J. Brody and other contributors\n Copyright (c) 2010 Adam Abrons and Misko Hevery http://getangular.com\n \n Permission is hereby granted, free of charge, to any person obtaining a copy\n",
					"match": false,
					"packageHash": "3faf24dde4ebde9e6ab64bd617bffa9ed7675bd38d396052c342eec7b653be30",
					"size": 1112,
					"sourceHash": "83c22660380f5d75d59733f2e886aeb927950080e723bab7702f3bcd2b713fff",
					"status": "content"
				},
				"README.md": {
					"diff": "--- published/README.md\n+++ rebuilt/README.md\n@@ -1,56 +1,314 @@\n jasmine-node\n ======\n \n-This node.js module makes the wonderful Pivotal Lab's jasmine\n-(http://github.com/pivotal/jasmine) spec framework available in\n-node.js.\n+[![LICENSE](https://img.shields.io/github/license/mhevery/jasmine-node.svg?style=flat-square)](./LICENSE)\n+[![npm](https://img.shields.io/npm/v/jasmine-node.svg?style=flat-square)](https://www.npmjs.com/package/jasmine-node)\n+[![contributors](https://img.shields.io/badge/contributors-many-purple.svg?style=flat-square)](https://github.com/mhevery/jasmine-node/graphs/contributors)\n+\n+This node.js module makes the wonderful [Pivotal Lab's jasmine](http://github.com/pivotal/jasmine)\n+spec framework (version 1) available in node.js.\n+\n+\n+Project status\n+--------------\n+\n+This project is now in maintenance mode. It is recommended to use the `jasmine` or `jasmine-npm`\n+package whenever possible.\n+\n+\n+jasmine\n+-------\n+\n+Version `1.3.1` of Jasmine is currently included with node-jasmine. This is a forked version from the\n+[Karma project](https://github.com/karma-runner/karma-jasmine), which allows you to use the\n+`ddescribe` and `iit` functions to run individual suites or specs.\n+\n+NOTICE: BETA `2.0.0` Support in the `Jasmine2.0` branch (with rewrite in CoffeeScript) is now abandoned and no longer supported.\n+\n+Supported Node.js versions\n+--------------------------\n+\n+* Current:\n+  - 10\n+  - 12\n+* Deprecated:\n+  - 8 (EOL in December 2019)\n+  - 6 (already past EOL)\n+  - 4 (already past EOL)\n+\n+Older versions of Node.js are no longer supported. It is *highly* recommended to upgrade to a supported version of Node.js.\n+\n+what's new\n+----------\n+*  Growl notifications with the `--growl` flag (requires Growl to be installed)\n+*  Ability to test specs written in Literate CoffeeScript\n+*  Teamcity Reporter reinstated.\n+*  Ability to specify multiple files to test via list in command line\n+*  Ability to suppress stack trace with `--noStack`\n+*  Async tests now run in the expected context instead of the global one\n+*  `--config` flag that allows you to assign variables to process.env\n+*  Terminal Reporters are now available in the Jasmine Object #184\n+*  Done is now available in all timeout specs #199\n+*  `afterEach` is available in requirejs #179\n+*  Editors that replace instead of changing files should work with autotest #198\n+*  Jasmine Mock Clock now works!\n+*  Autotest now works!\n+*  Using the latest Jasmine!\n+*  Verbose mode tabs `describe` blocks much more accurately!\n+*  `--coffee` now allows specs written in Literate CoffeeScript (`.litcoffee`)\n \n install\n ------\n-    npm install jasmine-node -g\n+\n+To install the latest official version, use NPM:\n+\n+```sh\n+npm install jasmine-node -g\n+```\n+\n+To install the latest _bleeding edge_ version, clone this repository and check\n+out the `beta` branch.\n \n usage\n ------\n \n-Write the specifications for your code in *.js and *.coffee files in the \n-spec/ directory (note: your specification files must end with either \n-.spec.js or .spec.coffee; otherwise jasmine-node won't find them!). You \n-can use sub-directories to better organise your specs.\n+Write the specifications for your code in `*.js` and `*.coffee` files in the `spec/` directory.\n+You can use sub-directories to better organise your specs. In the specs use `describe()`, `it()` etc. exactly\n+as you would in client-side jasmine specs.\n+\n+**Note**: your specification files must be named as `*spec.js`, `*spec.coffee` or `*spec.litcoffee`,\n+which matches the regular expression `/spec\\.(js|coffee|litcoffee)$/i`;\n+otherwise jasmine-node won't find them!\n+For example, `sampleSpecs.js` is wrong, `sampleSpec.js` is right.\n \n If you have installed the npm package, you can run it with:\n \n-    jasmine-node\n+```sh\n+jasmine-node spec/\n+```\n",
					"match": false,
					"packageHash": "70d6c8eb63fbb3560b8fdd5492b21138b53175fd45ab29ee93ee77d2a9f1b431",
					"size": 1459,
					"sourceHash": "c581d8bcbc3af0e9472c16e3a620ba441cd633c8a6b58783c9edf3dd941d59e0",
					"status": "content"
				},
				"bin/jasmine-node": {
					"diff": "--- published/bin/jasmine-node\n+++ rebuilt/bin/jasmine-node\n@@ -3,5 +3,4 @@\n if( !process.env.NODE_ENV ) process.env.NODE_ENV = 'test';\n \n var path = require('path');\n-var fs   = require('fs');\n require(path.join(__dirname,'../lib/jasmine-node/cli.js'));\n",
					"match": false,
					"packageHash": "c05ef026e74240c72186e73f65510b73f81a08526a6dd927c3de9346dda8fbec",
					"size": 195,
					"sourceHash": "065fa9eab36541b48e7032b2d8ec9f05786dff68682e2fd38e3dca1bbf92925c",
					"status": "content"
				},
				"lib/jasmine-node/async-callback.js": {
					"diff": "--- published/lib/jasmine-node/async-callback.js\n+++ rebuilt/lib/jasmine-node/async-callback.js\n@@ -1,41 +1,61 @@\n (function() {\n-  var withoutAsync = {};\n+    var withoutAsync = {};\n \n-  [\"it\", \"beforeEach\", \"afterEach\"].forEach(function(jasmineFunction) {\n-    withoutAsync[jasmineFunction] = jasmine.Env.prototype[jasmineFunction];\n-    return jasmine.Env.prototype[jasmineFunction] = function() {\n-      var args = Array.prototype.slice.call(arguments, 0);\n-      var specFunction = args.pop();\n-      if (specFunction.length === 0) {\n-        args.push(specFunction);\n-      } else {\n-        args.push(function() {\n-          return asyncSpec(specFunction, this);\n-        });\n-      }\n-      return withoutAsync[jasmineFunction].apply(this, args);\n-    };\n-  });\n+    [\"it\", \"beforeEach\", \"afterEach\"].forEach(function(jasmineFunction) {\n+        withoutAsync[jasmineFunction] = jasmine.Env.prototype[jasmineFunction];\n+        return jasmine.Env.prototype[jasmineFunction] = function() {\n+            var args = Array.prototype.slice.call(arguments, 0);\n+            var timeout = null;\n+            if (isLastArgumentATimeout(args)) {\n+                timeout = args.pop();\n+                // The changes to the jasmine test runner causes undef to be passed when\n+                // calling all it()'s now. If the last argument isn't a timeout and the\n+                // last argument IS undefined, let's just pop it off. Since out of bounds\n+                // items are undefined anyways, *hopefully* removing an undef item won't\n+                // hurt.\n+            } else if (args[args.length-1] == undefined) {\n+                args.pop();\n+            }\n+            if (isLastArgumentAnAsyncSpecFunction(args))\n+            {\n+                var specFunction = args.pop();\n+                args.push(function() {\n+                    return asyncSpec(specFunction, this, timeout);\n+                });\n+            }\n+            return withoutAsync[jasmineFunction].apply(this, args);\n+        };\n+    });\n+\n+    function isLastArgumentATimeout(args)\n+    {\n+        return args.length > 0 && (typeof args[args.length-1]) === \"number\";\n+    }\n \n-  function asyncSpec(specFunction, spec, timeout) {\n-    if (timeout == null) timeout = 1000;\n-    var done = false;\n-    spec.runs(function() {\n-      try {\n-        return specFunction(function(error) {\n-          done = true;\n-          if (error != null) return spec.fail(error);\n+    function isLastArgumentAnAsyncSpecFunction(args)\n+    {\n+        return args.length > 0 && (typeof args[args.length-1]) === \"function\" && args[args.length-1].length > 0;\n+    }\n+\n+    function asyncSpec(specFunction, spec, timeout) {\n+        if (timeout == null) timeout = jasmine.getEnv().defaultTimeoutInterval || 1000;\n+        var done = false;\n+        spec.runs(function() {\n+            try {\n+                return specFunction.call(spec, function(error) {\n+                    done = true;\n+                    if (error != null) return spec.fail(error);\n+                });\n+            } catch (e) {\n+                done = true;\n+                throw e;\n+            }\n         });\n-      } catch (e) {\n-        done = true;\n-        throw e;\n-      }\n-    });\n-    return spec.waitsFor(function() {\n-      if (done === true) {\n-        return true;\n-      }\n-    }, \"spec to complete\", timeout);\n-  };\n+        return spec.waitsFor(function() {\n+            if (done === true) {\n+                return true;\n+            }\n+        }, \"spec to complete\", timeout);\n+    };\n \n }).call(this);\n",
					"match": false,
					"packageHash": "e27d0ec3bdcca57fbdef97428641220e83d22098ac070ca0856e79d5937747c8",
					"size": 1126,
					"sourceHash": "e34511e51497b88fa2da7dfa7ff9645bc1502690ebcf9fcf7930bb40de23cbd3",
					"status": "content"
				},
				"lib/jasmine-node/autotest.js": {
					"diff": "--- published/lib/jasmine-node/autotest.js\n+++ rebuilt/lib/jasmine-node/autotest.js\n@@ -1,9 +1,10 @@\n-\n-var findit = require('findit');\n+var walkdir = require('walkdir');\n var collection = require('./spec-collection');\n var path = require('path');\n var fs = require('fs');\n var child_process = require('child_process');\n+var gaze = require('gaze');\n+var _ = require('underscore');\n \n var baseArgv = [];\n \n@@ -18,55 +19,100 @@\n     child.stdout.on('data', function(data) {\n         process.stdout.write(data);\n     });\n+    child.stderr.on('data', function(data) {\n+        process.stderr.write(data);\n+    });\n     if(typeof callback == 'function') {\n         child.on('exit', callback);\n     }\n }\n \n+var last_run_successful = false;\n+\n var run_everything = function() {\n     // run the suite when it starts\n     var argv = [].concat(baseArgv);\n-    run_external(argv.shift(), argv, function() { console.log(arguments) });\n+    run_external(argv.shift(), argv, function (code) {\n+        last_run_successful = code === 0\n+    });\n }\n \n-var last_run_succesful = true;\n+exports.start = function(loadpaths, watchFolders, patterns) {\n+    var watchPatterns;\n \n-exports.start = function(loadpath, pattern) {\n-    var finder = findit.find(loadpath);\n-    var files = [];\n-\n-    finder.on('file', function(file, stat) {\n-        var basename = path.basename(file);\n-        if(pattern.test(basename)) {\n-            fs.watchFile(file, function(prev, curr) {\n-                if(!curr.isFile()) {\n-                    fs.unwatchFile(file);\n-                    return;\n-                }\n-                if(prev.mtime.getTime() != curr.mtime.getTime()) {\n-                    console.log(\"Changed \" + basename);\n+    loadpaths.forEach(function(loadpath){\n \n-                    // narrow down a pattern to reduce the specs runned\n-                    var match = path.basename(file, path.extname(file)) + \".*\";\n-                    match = match.replace(new RegExp(\"spec\", \"i\"), \"\");\n-\n-                    // so we need to rerun the jasmine suite\n-                    var argv = [].concat(baseArgv, [\"--match\", match]);\n-                    run_external(argv.shift(), argv, function(code) {\n-                        // run everything if we fixed some bugs\n-                        if(code == 0) {\n-                            if(!last_run_succesful) {\n-                                run_everything();\n-                            }\n-                            last_run_succesful = true;\n-                        } else {\n-                            last_run_succesful = false;\n-                        }\n-                    });\n+      // If loadpath is just a single file, we should just watch that file\n+      stats = fs.statSync(loadpath);\n+      if (stats.isFile()) {\n+        watchPatterns = loadpath;\n+      } else {\n+        watchPatterns = patterns.map(function(p) { \n+          return path.join(loadpath, p);\n+        });\n+      }\n+\n+      changedFunc = function(event, file) {\n+        console.log(file + ' was changed');\n+\n+        var match = path.basename(file, path.extname(file)) + \".*\";\n+        match = match.replace(new RegExp(\"spec\", \"i\"), \"\");\n+\n+        var argv = [].concat(baseArgv, [\"--match\", match]);\n+        run_external(argv.shift(), argv, function(code) {\n+            // run everything if we fixed some bugs\n+            if(code == 0) {\n+                if(!last_run_successful) {\n+                    run_everything();\n                 }\n-            });\n-        }\n",
					"match": false,
					"packageHash": "5dce9d66f0b20efdf8d15a5c1e83462d4052b2f397be319ff37bc6281827caf9",
					"size": 2310,
					"sourceHash": "2ed33ccf7b194b0d84b4ee16d90a603b3732cae77ab132549afcff2d30c16cfe",
					"status": "content"
				},
				"lib/jasmine-node/cli.js": {
					"diff": "--- published/lib/jasmine-node/cli.js\n+++ rebuilt/lib/jasmine-node/cli.js\n@@ -1,6 +1,10 @@\n-var jasmine = require('./index');\n var util,\n-    Path= require('path');\n+    Path= require('path'),\n+    fs  = require('fs');\n+\n+var jasmine = require('./index');\n+\n+\n try {\n   util = require('util')\n } catch(e) {\n@@ -9,19 +13,32 @@\n \n var helperCollection = require('./spec-collection');\n \n-var specFolder = null;\n+var specFolders = [];\n+var watchFolders = [];\n \n+// The following line keeps the jasmine setTimeout in the proper scope\n+jasmine.setTimeout = jasmine.getGlobal().setTimeout;\n+jasmine.setInterval = jasmine.getGlobal().setInterval;\n for (var key in jasmine)\n   global[key] = jasmine[key];\n \n var isVerbose = false;\n var showColors = true;\n+// Disable if we're not on a TTY\n+if (!process.stdout.isTTY) {\n+    showColors = false;\n+}\n var teamcity = process.env.TEAMCITY_PROJECT_NAME || false;\n var useRequireJs = false;\n-var extentions = \"js\";\n+var extensions = \"js\";\n var match = '.';\n+var matchall = false;\n var autotest = false;\n var useHelpers = true;\n+var forceExit = false;\n+var captureExceptions = false;\n+var includeStackTrace = true;\n+var growl = false;\n \n var junitreport = {\n   report: false,\n@@ -31,12 +48,15 @@\n }\n \n var args = process.argv.slice(2);\n+var existsSync = fs.existsSync || Path.existsSync;\n \n while(args.length) {\n   var arg = args.shift();\n \n   switch(arg)\n   {\n+    case '--version':\n+      printVersion();\n     case '--color':\n       showColors = true;\n       break;\n@@ -48,21 +68,39 @@\n       isVerbose = true;\n       break;\n     case '--coffee':\n-      require('coffee-script');\n-      extentions = \"js|coffee\";\n+      try {\n+        require('coffeescript/register'); // support CoffeeScript >=1.7.0\n+      } catch ( e ) {\n+        require('coffeescript'); // support CoffeeScript <=1.6.3\n+      }\n+      extensions = \"js|coffee|litcoffee\";\n       break;\n     case '-m':\n     case '--match':\n       match = args.shift();\n       break;\n+    case '--matchall':\n+      matchall = true;\n+      break;\n     case '--junitreport':\n         junitreport.report = true;\n         break;\n+    case '--output':\n+        junitreport.savePath = args.shift();\n+        break;\n     case '--teamcity':\n         teamcity = true;\n         break;\n+    case '--requireJsSetup':\n+        var setup = args.shift();\n+\n+        if(!existsSync(setup))\n+          throw new Error(\"RequireJS setup '\" + setup + \"' doesn't exist!\");\n",
					"match": false,
					"packageHash": "e1299df8252741a2c32070db50865b8cc239680c13b7d6200ba53e1206b167da",
					"size": 4092,
					"sourceHash": "88dd00cc19947a9ff13ddd44ab9aad2469d6137b0fc8229cc9a464a50de1f5b6",
					"status": "content"
				},
				"lib/jasmine-node/index.js": {
					"diff": "--- published/lib/jasmine-node/index.js\n+++ rebuilt/lib/jasmine-node/index.js\n@@ -1,4 +1,5 @@\n var fs = require('fs');\n+var mkdirp = require('mkdirp');\n var util;\n try {\n   util = require('util')\n@@ -8,50 +9,71 @@\n \n var path = require('path');\n \n-var filename = __dirname + '/jasmine-2.0.0.rc1.js';\n-global.window = {\n-  setTimeout: setTimeout,\n-  clearTimeout: clearTimeout,\n-  setInterval: setInterval,\n-  clearInterval: clearInterval\n-};\n+var filename = __dirname + '/jasmine-1.3.1.js';\n+var isWindowUndefined = typeof global.window === 'undefined';\n+if (isWindowUndefined) {\n+  global.window = {\n+    setTimeout: setTimeout,\n+    clearTimeout: clearTimeout,\n+    setInterval: setInterval,\n+    clearInterval: clearInterval\n+  };\n+}\n \n var src = fs.readFileSync(filename);\n-var jasmine;\n-var minorVersion = process.version.match(/\\d\\.(\\d)\\.\\d/)[1];\n-switch (minorVersion) {\n-  case \"1\":\n-  case \"2\":\n-    jasmine = process.compile(src + '\\njasmine;', filename);\n-    break;\n-  default:\n-    jasmine = require('vm').runInThisContext(src + \"\\njasmine;\", filename);\n-}\n+// Put jasmine in the global context, this is somewhat like running in a\n+// browser where every file will have access to `jasmine`\n+var jasmine = require('vm').runInThisContext(src + \"\\njasmine;\", filename);\n \n-delete global.window;\n+\n+if (isWindowUndefined) {\n+  delete global.window;\n+}\n require(\"./async-callback\");\n require(\"jasmine-reporters\");\n+var nodeReporters = require('./reporter').jasmineNode;\n+jasmine.TerminalVerboseReporter = nodeReporters.TerminalVerboseReporter;\n+jasmine.TerminalReporter = nodeReporters.TerminalReporter;\n+jasmine.TeamcityReporter = nodeReporters.TeamcityReporter;\n+jasmine.GrowlReporter = require('jasmine-growl-reporter');\n \n-var jasmineNode = require('./reporter').jasmineNode;\n \n-jasmine.loadHelpersInFolder=function(folder, matcher)\n-{\n+jasmine.loadHelpersInFolder = function(folder, matcher) {\n+  // Check to see if the folder is actually a file, if so, back up to the\n+  // parent directory and find some helpers\n+  folderStats = fs.statSync(folder);\n+  if (folderStats.isFile()) {\n+    folder = path.dirname(folder);\n+  }\n+\n   var helpers = [],\n       helperCollection = require('./spec-collection');\n \n-  helperCollection.load(folder, matcher);\n+  helperCollection.load([folder], matcher);\n   helpers = helperCollection.getSpecs();\n \n-  for (var i = 0, len = helpers.length; i < len; ++i)\n-  {\n+  for (var i = 0, len = helpers.length; i < len; ++i) {\n     var file = helpers[i].path();\n-    var helper= require(file.replace(/\\.*$/, \"\"));\n-    for (var key in helper)\n+\n+    try {\n+      var helper = require(file.replace(/\\.*$/, \"\"));\n+    } catch (e) {\n+      console.log(\"Exception loading helper: \" + file)\n+      console.log(e);\n+      throw e; // If any of the helpers fail to load, fail everything\n+    }\n+\n+    for (var key in helper) {\n       global[key]= helper[key];\n+    }\n   }\n };\n \n function removeJasmineFrames(text) {\n+  if (!text) {\n",
					"match": false,
					"packageHash": "48a54801f04baceee65e96bef06caed16ced9424aab694cc37703d188f5cf4af",
					"size": 4234,
					"sourceHash": "26931c94e53c49851e0bd3fd709831a43ce2bd3521396900b3e132661e13b3ae",
					"status": "content"
				},
				"lib/jasmine-node/jasmine-2.0.0.rc1.js": {
					"match": false,
					"packageHash": "e3f81663ae36dc9c084c4f50fe6b91d6a9f4c5320b689f19b0318c5fe06e1348",
					"size": 66828,
					"status": "missing-in-source"
				},
				"lib/jasmine-node/reporter.js": {
					"diff": "--- published/lib/jasmine-node/reporter.js\n+++ rebuilt/lib/jasmine-node/reporter.js\n@@ -9,39 +9,30 @@\n     util = require('sys')\n   }\n \n-  if (! jasmineNode) {\n-    var jasmineNode = {};\n-  }\n-\n+  var jasmineNode = {};\n   //\n   // Helpers\n   //\n   function noop() {}\n \n-  jasmineNode.ANSIColors = {\n-    pass:    function() { return '\\033[32m'; }, // Green\n-    fail:    function() { return '\\033[31m'; }, // Red\n-    neutral: function() { return '\\033[0m';  }  // Normal\n-  };\n-\n-  jasmineNode.NoColors = {\n-    pass:    function() { return ''; },\n-    fail:    function() { return ''; },\n-    neutral: function() { return ''; }\n-  };\n \n   jasmineNode.TerminalReporter = function(config) {\n-    this.print_ = config.print || util.print;\n-    this.color_ = config.color ? jasmineNode.ANSIColors : jasmineNode.NoColors;\n+    this.print_ = config.print || function (str) { process.stdout.write(util.format(str)); };\n+    this.color_ = config.color ? this.ANSIColors : this.NoColors;\n \n     this.started_ = false;\n     this.finished_ = false;\n \n+    this.callback_ = config.onComplete || false\n+\n     this.suites_ = [];\n     this.specResults_ = {};\n     this.failures_ = [];\n+    this.includeStackTrace_ = config.includeStackTrace === false ? false : true;\n+    this.stackFilter_ = config.stackFilter || function(t) { return t; };\n   }\n \n+\n   jasmineNode.TerminalReporter.prototype = {\n     reportRunnerStarting: function(runner) {\n       this.started_ = true;\n@@ -53,6 +44,24 @@\n       }\n     },\n \n+    ANSIColors: {\n+        pass:    function() { return '\\033[32m'; }, // Green\n+        fail:    function() { return '\\033[31m'; }, // Red\n+        specTiming:  function()  { return '\\033[34m'; }, // Blue\n+        suiteTiming:  function() { return '\\033[33m'; }, // Yelow\n+        ignore:  function() { return '\\033[37m'; }, // Light Gray\n+        neutral: function() { return '\\033[0m';  }  // Normal\n+    },\n+\n+    NoColors: {\n+        pass:    function() { return ''; },\n+        fail:    function() { return ''; },\n+        specTiming:  function() { return ''; },\n+        suiteTiming: function() { return ''; },\n+        ignore:  function() { return ''; },\n+        neutral: function() { return ''; }\n+    },\n+\n     summarize_: function(suiteOrSpec) {\n       var isSuite = suiteOrSpec instanceof jasmine.Suite;\n \n@@ -105,6 +114,7 @@\n       this.printLine_(this.stringWithColor_(this.printRunnerResults_(runner), resultColor));\n \n       this.finished_ = true;\n+      if(this.callback_) { this.callback_(runner); }\n     },\n \n     reportFailures_: function() {\n@@ -123,8 +133,10 @@\n         this.printLine_('  ' + (i + 1) + ') ' + failure.spec);\n         this.printLine_('   Message:');\n         this.printLine_('     ' + this.stringWithColor_(failure.message, this.color_.fail()));\n-        this.printLine_('   Stacktrace:');\n-        this.print_('     ' + failure.stackTrace);\n+        if (this.includeStackTrace_) {\n+            this.printLine_('   Stacktrace:');\n+            this.print_('     ' + this.stackFilter_(failure.stackTrace));\n+        }\n       }\n     },\n \n@@ -135,10 +147,10 @@\n     reportSpecResults: function(spec) {\n       var result = spec.results();\n       var msg = '';\n",
					"match": false,
					"packageHash": "33326aa01d45f58ac994b4150033b503312101a0b8149b0168965be047064c3e",
					"size": 8172,
					"sourceHash": "b78744686ffa3d6f009fec7fa8077fa6c264e09c9b68fa40f4978d58963d0246",
					"status": "content"
				},
				"lib/jasmine-node/requirejs-runner.js": {
					"diff": "--- published/lib/jasmine-node/requirejs-runner.js\n+++ rebuilt/lib/jasmine-node/requirejs-runner.js\n@@ -1,41 +1,57 @@\n-exports.executeJsRunner = function(specCollection, done, jasmineEnv) {\n+exports.executeJsRunner = function(specCollection, done, jasmineEnv, setupFile) {\n   var specs,\n       specLoader = require('./requirejs-spec-loader'),\n       requirejs = require('requirejs'),\n       vm = require('vm'),\n       fs = require('fs'),\n-      template = fs.readFileSync(__dirname + '/requirejs-wrapper-template.js', 'utf8'),\n-      buildNewContext = function(){\n-        return {\n+      coffeescript = require('coffeescript'),\n+      template = fs.readFileSync(\n+        setupFile || (__dirname + '/requirejs-wrapper-template.js'),\n+        'utf8'\n+      ),\n+      ensureUnixPath = function(path){\n+        return path.replace(/^(.):/, '/$1').replace(/\\\\/g, '/');\n+      },\n+      buildNewContext = function(spec){\n+        var context = {\n           describe: describe,\n           it: it,\n           xdescribe: xdescribe,\n           xit: xit,\n+          beforeEach: beforeEach,\n+          afterEach: afterEach,\n+          spyOn: spyOn,\n+          waitsFor: waitsFor,\n+          waits: waits,\n+          runs: runs,\n           jasmine: jasmine,\n           expect: expect,\n           require: require,\n           console: console,\n           process: process,\n           module: module,\n-          specLoader: specLoader\n+          specLoader: specLoader,\n+          __dirname: spec.directory(),\n+          __filename: spec.path(),\n+          baseUrl: buildRelativeDirName(spec.directory()),\n+          csPath: __dirname + '/cs'\n         };\n+\n+        context.global = context;\n+\n+        return context;\n       },\n       buildRelativeDirName = function(dir){\n         var retVal = \"\",\n-            thisDir = process.cwd();//.replace(/.:/, '\\\\c').split('\\\\'),\n-            toDir = dir.split('/'),\n-            index = 0,\n-            colonMatches = __dirname.match(/.:/);\n+            thisDir = ensureUnixPath(process.cwd()),\n+            toDir = ensureUnixPath(dir).split('/'),\n+            index = 0;\n \n-        for(var i = 0; i < (colonMatches && colonMatches.length) || 0; i++){\n-          thisDir = thisDir.replace(colonMatches[i], '\\\\' + colonMatches[i].substring(0,1));\n-        }\n-\n-        thisDir = thisDir.split('\\\\');\n+        thisDir = thisDir.split('/');\n \n         for(; index < thisDir.length || index < toDir.length; index++) {\n           if(thisDir[index] != toDir[index]){\n-            for(var i = index; i < thisDir.length; i++){\n+            for(var i = index; i < thisDir.length-1; i++){\n               retVal += '../';\n             }\n \n@@ -51,19 +67,19 @@\n       };\n \n   specCollection.getSpecs().forEach(function(s){\n-    var script = fs.readFileSync(s.path(), 'utf8'),\n-        dir = s.directory(),\n-        colonMatches = dir.match(/.:/),\n-        wrappedScript;\n+    var script = fs.readFileSync(s.path(), 'utf8');\n \n-    for(var i = 0; i < (colonMatches && colonMatches.length) || 0; i++){\n-      dir = dir.replace(colonMatches[i], '/' + colonMatches[i].substring(0,1));\n+    if (s.filename().substr(-6).toLowerCase() == 'coffee') {\n+      script = coffeescript.compile(script);\n     }\n \n-    wrappedScript = template.replace(/#REPLACE URL#/, buildRelativeDirName(dir))\n-                            .replace(/#REPLACE TEST SCRIPT#/, script);\n-\n-    vm.runInNewContext(wrappedScript, buildNewContext(), s.path());\n+    var newContext = buildNewContext(s);\n+    newContext.setTimeout = jasmine.getGlobal().setTimeout;\n+    newContext.setInterval = jasmine.getGlobal().setInterval;\n+\n+    var vmContext = vm.createContext(newContext);\n",
					"match": false,
					"packageHash": "a773b0e98216e161d4e52f0a1fe017094e7a77df018b9a59068ab8dbf6ea45e5",
					"size": 2221,
					"sourceHash": "3d086cc38128b3be1990730b807312178720d3b4483fd2d55effa4afc861a5d3",
					"status": "content"
				},
				"lib/jasmine-node/requirejs-wrapper-template.js": {
					"diff": "--- published/lib/jasmine-node/requirejs-wrapper-template.js\n+++ rebuilt/lib/jasmine-node/requirejs-wrapper-template.js\n@@ -1,10 +1,19 @@\n-var test = function(require, define, undefined) { #REPLACE TEST SCRIPT# \n-};\n-\n-var requirejsOrig = require('requirejs'),\n+/* Setup file run before spec files to setup the context (and RequireJS\n+ * specifically) to execute the spec file.\n+ *\n+ * Defined by caller:\n+ * - Jasmine predefines\n+ * - require (Node require)\n+ * - __dirname, __filename\n+ * - baseUrl (Relative path to the directory containing this file)\n+ * - csPath (Path to require-cs module)\n+ *\n+ * See requirejs-runner source for full invocation details.\n+ */\n+var define,\n+    requirejsOrig = require('requirejs'),\n     ostring = Object.prototype.toString,\n     path = require('path'),\n-    baseUrl = '#REPLACE URL#',\n     isArray = function(it){\n       return ostring.call(it) === '[object Array]';\n     },\n@@ -29,7 +38,10 @@\n \n requirejsOrig.config({\n  baseUrl: baseUrl,\n- nodeRequire: require\n+ nodeRequire: require,\n+ paths: {\n+  cs: csPath\n+ }\n });\n \n for(var key in requirejsOrig) {\n@@ -62,4 +74,5 @@\n   return requirejsOrig.config(alteredConfig);\n };\n \n-test(requirejs, requirejs.define);\n+require = requirejs;\n+define = requirejs.define;\n",
					"match": false,
					"packageHash": "9172c07eb871e2164eb624babdeb57142370ffc76ecd54c7759a7fa22f03d9d4",
					"size": 1543,
					"sourceHash": "953f74ee62b8e5ef16bd843c45a34186cb573a3ac0e1a69da9c491d4938e1f59",
					"status": "content"
				},
				"lib/jasmine-node/spec-collection.js": {
					"diff": "--- published/lib/jasmine-node/spec-collection.js\n+++ rebuilt/lib/jasmine-node/spec-collection.js\n@@ -1,32 +1,44 @@\n-var findit = require('findit');\n+var walkdir = require('walkdir');\n var path = require('path');\n var fs = require('fs');\n-var specs = [];\n+var specs;\n \n var createSpecObj = function(path, root) {\n-    return {\n-        path: function() { return path; },\n-        relativePath: function() { return path.replace(root, '').replace(/^[\\/\\\\]/, ''); },\n-        directory: function() { return path.replace(/[\\/\\\\][\\s\\w\\.-]*$/, \"\"); },\n-        relativeDirectory: function() { return relativePath().replace(/[\\/\\\\][\\s\\w\\.-]*$/, \"\"); },\n-        filename: function() { return path.replace(/^.*[\\\\\\/]/, ''); }\n-    };\n+  return {\n+    path: function() { return path; },\n+    relativePath: function() { return path.replace(root, '').replace(/^[\\/\\\\]/, '').replace(/\\\\/g, '/'); },\n+    directory: function() { return path.replace(/[\\/\\\\][\\s\\w\\.-]*$/, \"\").replace(/\\\\/g, '/'); },\n+    relativeDirectory: function() { return relativePath().replace(/[\\/\\\\][\\s\\w\\.-]*$/, \"\").replace(/\\\\/g, '/'); },\n+    filename: function() { return path.replace(/^.*[\\\\\\/]/, ''); }\n+  };\n };\n \n-exports.load = function(loadpath, matcher) {\n-\n-    var wannaBeSpecs = findit.sync(loadpath)\n-\n+exports.load = function(loadpaths, matcher) {\n+  var wannaBeSpecs = []\n+  specs = [];\n+  loadpaths.forEach(function(loadpath){\n+    wannaBeSpecs = walkdir.sync(loadpath, { follow_symlinks: true });\n     for (var i = 0; i < wannaBeSpecs.length; i++) {\n-        var file = wannaBeSpecs[i];\n+      var file = wannaBeSpecs[i];\n+      try {\n         if (fs.statSync(file).isFile()) {\n-            if (matcher.test(path.basename(file))) {\n-                specs.push(createSpecObj(file));\n-            }\n+          if (!/.*node_modules.*/.test(path.relative(loadpath, file)) &\n+              matcher.test(path.basename(file))) {\n+            specs.push(createSpecObj(file));\n+          }\n         }\n+      } catch(e) {\n+        // nothing to do here\n+      }\n     }\n+  });\n };\n \n exports.getSpecs = function() {\n+  // Sorts spec paths in ascending alphabetical order to be able to\n+  // run tests in a deterministic order.\n+  specs.sort(function(a, b) {\n+    return a.path().localeCompare(b.path());\n+  });\n   return specs;\n };\n",
					"match": false,
					"packageHash": "23191af86c7ade6e8600c47498ebaf1eb371a4aa61251a319d3852713a54ccc0",
					"size": 963,
					"sourceHash": "0bd4974ad0864844227b51ceb474d38b780dd4f70ffeafd9ac167dd8871e2d40",
					"status": "content"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,26 +1,33 @@\n {\n-  \"name\"          : \"jasmine-node\"\n-, \"version\"       : \"1.0.19\"\n-, \"description\"   : \"DOM-less simple JavaScript BDD testing framework for Node\"\n-, \"homepage\"      : [ \"http://pivotal.github.com/jasmine\"\n-                    , \"https://github.com/mhevery/jasmine-node\"]\n-, \"repository\"    : { \"type\" : \"git\"\n-                    , \"url\"  : \"https://github.com/mhevery/jasmine-node.git\"\n-                    }\n-, \"keywords\"      : [\"testing\", \"bdd\"]\n-, \"author\"        : \"Misko Hevery <misko@hevery.com>\"\n-, \"contributors\"  : [ \"Rajan Agaskar <rajan@pivotallabs.com\"\n-                    , \"Christian Williams <xian@pivotallabs.com\"\n-                    , \"Davis W. Frank <dwfrank@pivotallabs.com>\"\n-                    , \"Matteo Collina <matteo.collina@gmail.com>\"\n-                    ]\n-, \"maintainers\"   : \"Martin HÃ¤ger <martin.haeger@gmail.com>\"\n-, \"licenses\"      : [\"MIT\"]\n-, \"dependencies\"  : { \"coffee-script\" : \">=1.0.1\"\n-                    , \"jasmine-reporters\" : \"0.1.0\"\n-                    , \"requirejs\" : \">=0.27.1\"\n-                    , \"findit\" : \">= 0.1.2\"\n-                    }\n-, \"bin\"           : \"bin/jasmine-node\"\n-, \"main\"          : \"lib/jasmine-node\"\n+  \"name\": \"jasmine-node\",\n+  \"version\": \"3.0.0\",\n+  \"description\": \"DOM-less simple JavaScript BDD testing framework for Node\",\n+  \"homepage\": \"https://github.com/mhevery/jasmine-node\",\n+  \"repository\": {\n+    \"type\": \"git\",\n+    \"url\": \"https://github.com/mhevery/jasmine-node.git\"\n+  },\n+  \"keywords\": [\n+    \"testing\",\n+    \"bdd\"\n+  ],\n+  \"author\": \"Misko Hevery <misko@hevery.com>\",\n+  \"license\": \"MIT\",\n+  \"dependencies\": {\n+    \"coffeescript\": \"~1.12.7\",\n+    \"gaze\": \"~1.1.2\",\n+    \"jasmine-growl-reporter\": \"~2.0.0\",\n+    \"jasmine-reporters\": \"~1.0.0\",\n+    \"mkdirp\": \"~0.3.5\",\n+    \"requirejs\": \"~2.3.6\",\n+    \"underscore\": \"~1.9.1\",\n+    \"walkdir\": \"~0.0.12\"\n+  },\n+  \"bin\": \"bin/jasmine-node\",\n+  \"preferGlobal\": true,\n+  \"main\": \"lib/jasmine-node\",\n+  \"scripts\": {\n+    \"test\": \"node lib/jasmine-node/cli.js spec\"\n+  },\n+  \"devDependencies\": {}\n }\n",
					"match": false,
					"packageHash": "f48597c658b8c8629dc058cca2a9aef0285a3a877907ae6cc7e00a1577fcfe60",
					"size": 1162,
					"sourceHash": "e00e45c546dcb56aaa23ce2b65fdc0c83535e72ec137d8d7e326bffafca3b9df",
					"status": "content"
				},
				"scripts/specs": {
					"diff": "--- published/scripts/specs\n+++ rebuilt/scripts/specs\n@@ -1,8 +1,37 @@\n #!/bin/bash\n \n+entry=\"node lib/jasmine-node/cli.js \"\n+\n if [ $# -ne 0 ]; then\n-  command=\"node lib/jasmine-node/cli.js $1 spec\"\n+  command=$entry\"$1 spec\"\n+  echo $command\n   $command\n else\n-  time node lib/jasmine-node/cli.js spec #/nested/uber-nested\n+  echo \"Running all tests located in the spec directory\"\n+  command=$entry\"spec\"\n+  echo $command\n+  time $command #/nested/uber-nested\n+  echo -e \"\\033[1;35m--- Should have 40 tests and 71 assertions and 1 Failure. ---\\033[0m\"\n+  echo \"\"\n+\n+  echo \"Running all tests located in the spec directory with coffee option\"\n+  command=$entry\"--coffee spec\"\n+  echo $command\n+  time $command #/nested/uber-nested\n+  echo -e \"\\033[1;35m--- Should have 40 tests and 71 assertions and 1 Failure. ---\\033[0m\"\n+  echo \"\"\n+\n+  echo \"Running all tests located in the spec directory with requirejs option\"\n+  #command=$entry\"--nohelpers --runWithRequireJs spec-requirejs\"\n+  command=$entry\"--runWithRequireJs spec\"\n+  echo $command\n+  time $command\n+  echo -e \"\\033[1;35m--- Should have 40 tests and 71 assertions and 1 Failure. ---\\033[0m\"\n+\n+  echo \"Running all tests located in the spec-requirejs directory with requirejs\"\n+  #command=$entry\"--nohelpers --runWithRequireJs spec-requirejs\"\n+  command=$entry\"--runWithRequireJs spec-requirejs\"\n+  echo $command\n+  time $command\n+  echo -e \"\\033[1;35m--- Should have 1 test and 2 assertions and 0 Failures. ---\\033[0m\"\n fi\n",
					"match": false,
					"packageHash": "99871202ebf1c6ea18a39a458b65ea05ed3f9073482b1b18a78b3f68d577c1d0",
					"size": 165,
					"sourceHash": "bc1ac0bbf2c879df1bac934a5370f66a599e83a9196875f94aac2e658a9bfe80",
					"status": "content"
				},
				"spec/AsyncSpec.coffee": {
					"diff": "--- published/spec/AsyncSpec.coffee\n+++ rebuilt/spec/AsyncSpec.coffee\n@@ -5,3 +5,7 @@\n   it 'should be timed out', ->\n     waitsFor (-> false), 'MIRACLE', 500\n \n+  doneFunc = (done) ->\n+    setTimeout(done, 10000)\n+\n+  it \"should timeout after 100 ms\", doneFunc, 100\n",
					"match": false,
					"packageHash": "c67140200e5b0d7724a6213789f0c16dede46c8438f7453532f2d476637d8539",
					"size": 289,
					"sourceHash": "81700f911477c4ac3807d50d976ff23edcc2304fd88127d8b4940a06175fe359",
					"status": "content"
				},
				"spec/TestSpec.js": {
					"diff": "--- published/spec/TestSpec.js\n+++ rebuilt/spec/TestSpec.js\n@@ -1,5 +1,100 @@\n+\n describe('jasmine-node-flat', function(){\n   it('should pass', function(){\n     expect(1+2).toEqual(3);\n   });\n-});\n\\ No newline at end of file\n+});\n+\n+describe('beforeEach Timeout', function(){\n+  beforeEach(function(done) {\n+      setTimeout(done, 1000);\n+  }, 100);\n+  it('should fail', function(){\n+    expect(1+2).toEqual(3);\n+  });\n+});\n+\n+describe('afterEach Timeout', function(){\n+  afterEach(function(done) {\n+      setTimeout(done, 1000);\n+  }, 100);\n+  it('should pass and then afterEach will fail', function(){\n+    expect(1+2).toEqual(3);\n+  });\n+});\n+\n+describe('Testing some characters', function()  {\n+    var chars = ['&', '\\'', '\"', '<', '>'];\n+    for(var i = 0; i < chars.length; i+=1)  {\n+        currentChar = chars[i];\n+        it('should reject ' + currentChar, (function(currentChar)  {\n+            expect(false).toEqual(false);\n+        })(currentChar));\n+    }\n+});\n+\n+describe('Testing waitsfor functionality', function() {\n+    it(\"Runs and then waitsFor\", function() {\n+        runs(function() {\n+            1+1;\n+        });\n+        waitsFor(function() {\n+            return true === false;\n+        }, \"the impossible\", 1000);\n+        runs(function() {\n+            expect(true).toBeTruthy();\n+        });\n+    });\n+});\n+\n+describe('root', function () {\n+\n+  describe('nested', function () {\n+\n+    xit('nested statement', function () {\n+      expect(1).toBeTruthy();\n+    });\n+\n+  });\n+\n+  it('root statement', function () {\n+    expect(1).toBeTruthy();\n+  });\n+\n+});\n+\n+describe(\"Top level describe block\", function() {\n+  it(\"first it block in top level describe\", function() {\n+    expect(true).toEqual(true);\n+  });\n+  describe(\"Second level describe block\", function() {\n+    it(\"first it block in second level describe\", function() {\n+      expect(true).toBe(true);\n+    });\n+  });\n+  it(\"second it block in top level describe\", function() {\n+    expect(true).toEqual(true);\n+  });\n+});\n+\n+describe('async', function () {\n+\n+    var request = function (str, func) {\n+        func('1', '2', 'hello world');\n+    };\n+\n+    it(\"should respond with hello world\", function(done) {\n+        request(\"http://localhost:3000/hello\", function(error, response, body){\n+            expect(body).toEqual(\"hello world\");\n+            done();\n+        });\n+    });\n+\n+    it(\"should respond with hello world\", function(done) {\n+        request(\"http://localhost:3000/hello\", function(error, response, body){\n+            expect(body).toEqual(\"hello world\");\n",
					"match": false,
					"packageHash": "e31d9c6712736ec6a38e8fe50ab01faa08898dba06a969e5e6e3f92f16d7793d",
					"size": 111,
					"sourceHash": "96a1c9b4dd8a0b96cf1475a7f38dd96047609b597bf530029d73e2c1038018e0",
					"status": "content"
				},
				"spec/async-callback_spec.js": {
					"diff": "--- published/spec/async-callback_spec.js\n+++ rebuilt/spec/async-callback_spec.js\n@@ -9,7 +9,7 @@\n     it(\"should time out if callback is not called\", function() {\n       env.describe(\"it\", function() {\n         env.it(\"doesn't wait\", function(done) {\n-          this.expect(1+2).toEqual(3);\n+          expect(1+2).toEqual(3);\n         });\n       });\n \n@@ -17,8 +17,27 @@\n \n       waitsFor(function() {\n         return env.currentRunner().results().totalCount > 0;\n+      }, 6000);\n+\n+      runs(function() {\n+        expect(env.currentRunner().results().failedCount).toEqual(1);\n+        expect(firstResult(env.currentRunner()).message).toMatch(/timeout/);;\n+      });\n+    });\n+\n+    it(\"should accept timeout for individual spec\", function() {\n+      env.describe(\"it\", function() {\n+        env.it(\"doesn't wait\", function(done) {\n+          expect(1+2).toEqual(3);\n+        }, 250);\n       });\n \n+      env.currentRunner().execute();\n+\n+      waitsFor(function() {\n+        return env.currentRunner().results().totalCount > 0;\n+      }, 500);\n+\n       runs(function() {\n         expect(env.currentRunner().results().failedCount).toEqual(1);\n         expect(firstResult(env.currentRunner()).message).toMatch(/timeout/);;\n@@ -45,7 +64,7 @@\n         expect(firstResult(env.currentRunner()).message).toEqual(\"Failed asynchronously\");\n       });\n     });\n-    \n+\n \n     it(\"should finish after callback is called\", function() {\n       env.describe(\"it\", function() {\n@@ -68,6 +87,30 @@\n       });\n     });\n \n+      it('should run in the context of the current spec', function(){\n+          var actualContext;\n+          var jasmineSpecContext;\n+          env.describe(\"it\", function() {\n+              env.it(\"register context\", function(done) {\n+                  actualContext = this;\n+                  jasmineSpecContext = env.currentSpec;\n+                  env.expect(this).toBe(jasmineSpecContext);\n+                  done();\n+              });\n+          });\n+\n+          env.currentRunner().execute();\n+\n+          waitsFor(function() {\n+              return env.currentRunner().results().totalCount > 0;\n+          }, 'tested jasmine env runner to run the test', 100);\n+\n+          runs(function() {\n+              expect(actualContext).not.toBe(global);\n+              expect(actualContext).toBe(jasmineSpecContext);\n+          });\n+      });\n+\n   });\n \n   describe(\"beforeEach\", function() {\n@@ -94,7 +137,7 @@\n       runs(function() {\n         expect(env.currentRunner().results().passedCount).toEqual(1);\n       });\n-    });\n+      });\n   });\n \n   describe(\"afterEach\", function() {\n",
					"match": false,
					"packageHash": "972de39f45aa14fb5299b507e34182406cb609c466e3bcd1ba0b1f5f053a81f2",
					"size": 3397,
					"sourceHash": "a6ac029eb047549a61b848f7b39ba2a87b470c3dc1d1900815141c12333a21c9",
					"status": "content"
				},
				"spec/reporter_spec.js": {
					"diff": "--- published/spec/reporter_spec.js\n+++ rebuilt/spec/reporter_spec.js\n@@ -16,7 +16,13 @@\n     it('initializes color_ from config', function() {\n       var config = { color: true }\n       this.reporter = new jasmineNode.TerminalReporter(config);\n-      expect(this.reporter.color_).toEqual(jasmineNode.ANSIColors);\n+      expect(this.reporter.color_).toEqual(jasmineNode.TerminalReporter.prototype.ANSIColors);\n+    });\n+\n+    it('initializes includeStackTrace_ from config', function () {\n+        var config = {}\n+        this.reporter = new jasmineNode.TerminalReporter(config);\n+        expect(this.reporter.includeStackTrace_).toBeTruthy();\n     });\n \n     it('sets the started_ flag to false', function() {\n@@ -48,6 +54,19 @@\n       this.reporter = new jasmineNode.TerminalReporter(config);\n       expect(this.reporter.failures_.length).toEqual(0);\n     });\n+\n+    it('sets the callback_ property to false by default', function() {\n+      var config = {}\n+      this.reporter = new jasmineNode.TerminalReporter(config);\n+      expect(this.reporter.callback_).toEqual(false)\n+    });\n+\n+    it('sets the callback_ property to onComplete if supplied', function() {\n+      var foo = function() { }\n+      var config = { onComplete: foo }\n+      this.reporter = new jasmineNode.TerminalReporter(config);\n+      expect(this.reporter.callback_).toBe(foo)\n+    });\n   });\n \n   describe('when the report runner starts', function() {\n@@ -70,7 +89,9 @@\n     });\n \n     it('sets the startedAt field', function() {\n-      expect(this.reporter.startedAt instanceof Date).toBeTruthy();\n+      // instanceof does not work cross-context (such as when run with requirejs)\n+      var ts = Object.prototype.toString;\n+      expect(ts.call(this.reporter.startedAt)).toBe(ts.call(new Date()));\n     });\n \n     it('buildes the suites_ collection', function() {\n@@ -124,6 +145,8 @@\n       var printRunnerResultsSpy = spyOn(this.reporter, 'printRunnerResults_').\n                           andReturn('this is the runner result');\n \n+      var callbackSpy = spyOn(this.reporter, 'callback_');\n+\n       var runner = {\n         results: function() {\n           var result = { failedCount: 0 };\n@@ -137,6 +160,7 @@\n \n       expect(failuresSpy).toHaveBeenCalled();\n       expect(this.printLineSpy).toHaveBeenCalled();\n+      expect(callbackSpy).toHaveBeenCalled();\n     });\n   });\n \n@@ -181,6 +205,9 @@\n   describe('addFailureToFailures', function() {\n     it('adds message and stackTrace to failures_', function() {\n       var spec = {\n+        suite: {\n+          getFullName: function() { return 'Suite name' }\n+        },\n         description: 'the spec',\n         results: function() {\n           var result = {\n@@ -206,7 +233,7 @@\n       var failures = this.reporter.failures_;\n       expect(failures.length).toEqual(1);\n       var failure = failures[0];\n-      expect(failure.spec).toEqual('the spec');\n+      expect(failure.spec).toEqual('Suite name the spec');\n       expect(failure.message).toEqual('the message');\n       expect(failure.stackTrace).toEqual('the stack');\n     });\n@@ -224,7 +251,15 @@\n         },\n         specs: function() {\n           var _specs = new Array();\n-          _specs.push(1);\n+          spec = {\n+            results: function() {\n+              var _results = {\n+                skipped: false\n+              }\n+              return _results;\n+            }\n+          };\n+          _specs.push(spec);\n           return _specs;\n         }\n",
					"match": false,
					"packageHash": "4bbd9ed98d2b3158098f6fc42ed48c33657c9bb884fb086a89b2b3f4afc995ea",
					"size": 12299,
					"sourceHash": "ae5dbd40252ebc3e249a274b1c28bd849b49c8b82efbc99543f6b80118210977",
					"status": "content"
				},
				"spec/sample_helper.js": {
					"diff": "--- published/spec/sample_helper.js\n+++ rebuilt/spec/sample_helper.js\n@@ -3,17 +3,13 @@\n   var objectToString = Object.prototype.toString;\n   var PRIMITIVE_TYPES = [String, Number, RegExp, Boolean, Date];\n \n-  beforeEach(function(){\n-    this.addMatchers({\n-      toHaveProperty: function(prop) {\n-        try {\n-          return prop in this.actual;\n-        }\n-        catch (e) {\n-          return false;\n-        }\n+  jasmine.Matchers.prototype.toHaveProperty = function(prop) {\n+      try {\n+        return prop in this.actual;\n       }\n-    });\n-  });\n+      catch (e) {\n+        return false;\n+      }\n+  }\n \n })();\n",
					"match": false,
					"packageHash": "0df05b857426f5b032804f7a5d694becedb1925c1e4d16268d7c785db5a6a4d2",
					"size": 362,
					"sourceHash": "144e8714ac702a52b201bfed569350dd9b2f66590f7cf32c0fb1576e9bf177e1",
					"status": "content"
				},
				"specs.sh": {
					"diff": "--- published/specs.sh\n+++ rebuilt/specs.sh\n@@ -1,3 +1,37 @@\n #!/usr/bin/env bash\n \n-./bin/jasmine-node --coffee \"$@\"\n+entry=\"node lib/jasmine-node/cli.js --noStack \"\n+\n+echo \"Running all tests located in the spec directory\"\n+command=$entry\"spec\"\n+echo $command\n+time $command #/nested/uber-nested\n+echo -e \"\\033[1;35m--- Should have 59 tests and 104 assertions and 4 Failure. ---\\033[0m\"\n+echo \"\"\n+\n+echo \"Running all tests located in the spec directory with coffee option\"\n+command=$entry\"--coffee spec\"\n+echo $command\n+time $command #/nested/uber-nested\n+echo -e \"\\033[1;35m--- Should have 64 tests and 109 assertions and 6 Failures. ---\\033[0m\"\n+echo \"\"\n+\n+echo \"Running all tests located in the spec directory with requirejs option\"\n+#command=$entry\"--nohelpers --runWithRequireJs spec-requirejs\"\n+command=$entry\"--runWithRequireJs spec\"\n+echo $command\n+time $command\n+echo -e \"\\033[1;35m--- Should have 59 tests and 104 assertions and 4 Failure. ---\\033[0m\"\n+echo \"\"\n+\n+echo \"Running all tests located in the spec-requirejs directory with requirejs, requirejs setup, and coffee option\"\n+command=$entry\"--runWithRequireJs --requireJsSetup spec-requirejs-coffee/requirejs-setup.js --coffee spec-requirejs-coffee\"\n+echo $command\n+time $command\n+echo -e \"\\033[1;35m--- Should have 2 tests and 4 assertions and 0 Failure. ---\\033[0m\"\n+\n+echo \"Running three specs file in the spec directory with coffee option\"\n+command=$entry\"--coffee spec/AsyncSpec.coffee spec/CoffeeSpec.coffee spec/SampleSpecs.js\"\n+echo $command\n+time $command\n+echo -e \"\\033[1;35m--- Should have 3 tests and 3 assertions and 2 Failure. ---\\033[0m\"\n",
					"match": false,
					"packageHash": "249cd2a64d9ec903fa93a1ed64db04ef1a1d394833d17e47804d703b30f0d08e",
					"size": 54,
					"sourceHash": "8eef7e2d39a328708d2eb4b1d65f0b9896624eb9243ffbd13c744dd67831301a",
					"status": "content"
				},
				".travis.yml": {
					"match": false,
					"status": "missing-in-package"
				},
				"bower.json": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/jasmine-node/cs.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/jasmine-node/jasmine-1.3.1.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"spec/GrammarHelper.coffee": {
					"match": false,
					"status": "missing-in-package"
				},
				"spec/HelperSpec.coffee": {
					"match": false,
					"status": "missing-in-package"
				},
				"spec/TimerSpec.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"spec/litcoffee/Litcoffee.spec.litcoffee": {
					"match": false,
					"status": "missing-in-package"
				},
				"spec-requirejs/requirejs-setup.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"spec-requirejs/requirejs-wrapper-template.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"spec-requirejs/requirejs.spec.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"spec-requirejs/requirejs.sut.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"spec-requirejs-coffee/RequireCsSpec.coffee": {
					"match": false,
					"status": "missing-in-package"
				},
				"spec-requirejs-coffee/RequireJsSpec.coffee": {
					"match": false,
					"status": "missing-in-package"
				},
				"spec-requirejs-coffee/requirecs.sut.coffee": {
					"match": false,
					"status": "missing-in-package"
				},
				"spec-requirejs-coffee/requirejs-setup.js": {
					"match": false,
					"status": "missing-in-package"
				}
			},
			"summary": {
				"differentFiles": 19,
				"matchingFiles": 7,
				"missingInPackage": 16,
				"missingInSource": 11,
				"score": 0.1320754716981132,
				"totalFiles": 53
			}
		}
	}
]
