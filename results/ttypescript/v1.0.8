[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-02T08:02:23.100Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:5.6.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "ttypescript@1.0.8",
			"name": "ttypescript",
			"version": "1.0.8",
			"location": "https://registry.npmjs.org/ttypescript/-/ttypescript-1.0.8.tgz",
			"integrity": "sha512-ptdLIB4tizhHq035rTgRYZpXCrMKXTur1INouniKxTNAaCHybVcCYg/7HAHP9xwF5WA/54JEbekesfBJJ4panA==",
			"publishedAt": "2018-03-31T11:16:12.625Z",
			"publishedWith": {
				"node": "9.9.0",
				"npm": "5.6.0"
			}
		},
		"source": {
			"integrity": null,
			"location": "git+https://github.com/cevek/ttypescript.git",
			"spec": "github:cevek/ttypescript#30c3435f6f507df094a6e9fdddc96ffcb625cc1b"
		},
		"comparisonHash": "8a2a8dcbb729bf3ee9216e490c955701f0ddebe1",
		"diff": {
			"files": {
				"lib/customRequire.js": {
					"match": false,
					"packageHash": "361984b0b9f8f7bb6057fc04eaf9ffc1376e5e29c21af07e9cf795e572764919",
					"size": 811,
					"status": "missing-in-source"
				},
				"lib/patch.js": {
					"diff": "--- published/lib/patch.js\n+++ rebuilt/lib/patch.js\n@@ -1,29 +1,34 @@\n-\"use strict\";\n-Object.defineProperty(exports, \"__esModule\", { value: true });\n-const path_1 = require(\"path\");\n-const customRequire_1 = require(\"./customRequire\");\n+const Module = require('module');\n+const path = require('path');\n require('ts-node').register({ project: __dirname + '/../ts-node-config/tsconfig.json' });\n-function default_1(ts, tsDirname) {\n+\n+function bindSecondArg(fn, secondArg) {\n+    return function(firstArg) {\n+        return fn(firstArg, secondArg);\n+    };\n+}\n+\n+module.exports = function(ts) {\n     const originCreateProgram = ts.createProgram;\n-    // (ts as any).version += '.transformers';\n-    ts.createProgram = function (rootNames, options, host, oldProgram) {\n-        const program = originCreateProgram(rootNames, options, host, oldProgram);\n-        const compilerOptions = program.getCompilerOptions();\n-        const projectDir = compilerOptions.configFilePath ? path_1.dirname(compilerOptions.configFilePath) : process.cwd();\n-        console.log('Used TypeScript from: ' + path_1.dirname(tsDirname) + ', version: ' + ts.version);\n-        // console.log('TypeScript from: ' + tsDirname);\n+    ts.version += '.transformers';\n+\n+    ts.createProgram = function() {\n+        const program = originCreateProgram.apply(this, arguments);\n         const originEmit = program.emit;\n-        program.emit = function (targetSourceFile, writeFile, cancellationToken, emitOnlyDtsFiles, customTransformers) {\n-            const transformers = getCustomTransformersFromConfig(program, compilerOptions, projectDir, customTransformers);\n-            return originEmit(targetSourceFile, writeFile, cancellationToken, emitOnlyDtsFiles, transformers);\n+        program.emit = function(sourceFile, writeFileCallback, cancellationToken, emitOnlyDtsFiles, transformers) {\n+            transformers = getCustomTransformersFromConfig(program, transformers);\n+            return originEmit(sourceFile, writeFileCallback, cancellationToken, emitOnlyDtsFiles, transformers);\n         };\n         return program;\n     };\n     return ts;\n-}\n-exports.default = default_1;\n+};\n+\n function requireTransformer(dir, module, program) {\n-    const transformer = customRequire_1.customRequire(dir, module);\n+    const m = new Module();\n+    m.filename = dir + '/index.js';\n+    m.paths = Module._nodeModulePaths(dir);\n+    const transformer = Module._load(module, m);\n     if (typeof transformer === 'function') {\n         return bindSecondArg(transformer, program);\n     }\n@@ -36,80 +41,54 @@\n     }\n     console.error(`Transformer \"${module}\" must export a function; got: ${JSON.stringify(transformer)}`);\n }\n-function addCustomTranformers(program, projectDir, transformerPathList, transformers, type) {\n-    if (transformerPathList === undefined)\n-        return;\n-    if (!Array.isArray(transformerPathList)) {\n-        console.error(`plugins.customTransformers.${type} is not an array; got: ` + JSON.stringify(transformerPathList));\n-        return transformerPathList;\n-    }\n-    for (let i = 0; i < transformerPathList.length; i++) {\n-        const transformerPath = transformerPathList[i];\n-        const transformer = requireTransformer(projectDir, transformerPath, program);\n-        if (transformer !== undefined) {\n-            if (type === 'after') {\n-                transformers.after.push(transformer);\n+\n+function getCustomTransformersFromConfig(program, { before = [], after = [] } = {}) {\n+    const transformers = { before, after };\n+    const compilerOptions = program.getCompilerOptions();\n+    const currentDir = compilerOptions.configFilePath ? path.dirname(compilerOptions.configFilePath) : process.cwd();\n+    const customTransformers = compilerOptions.plugins\n+        ? compilerOptions.plugins.reduce((t, p) => (t ? t : p.customTransformers), undefined)\n+        : undefined;\n+    if (customTransformers) {\n+        const errorPrefix = `plugins.customTransformers`;\n+        if (typeof customTransformers !== 'object' || Array.isArray(customTransformers)) {\n+            console.error(`${errorPrefix} is not an object; got: ${JSON.stringify(customTransformers)}`);\n+            return transformers;\n+        }\n+        const keys = Object.keys(customTransformers);\n+        keys.forEach(key => {\n+            if (key !== 'before' && key !== 'after') {\n+                console.error(`Unknown property: ${errorPrefix}.${key}`);\n             }\n-            else {\n-                transformers.before.unshift(transformer);\n+        });\n+        const before = customTransformers.before;\n+        const after = customTransformers.after;\n+        if (before) {\n+            if (!Array.isArray(before)) {\n+                console.error(`${errorPrefix}.before is not an array; got: ` + JSON.stringify(before));\n+                return transformers;\n",
					"match": false,
					"packageHash": "1f53a5bc8f40bbd5c9097cffd25805f79c9310c2df9c322aae9ae102a99cf690",
					"size": 5336,
					"sourceHash": "a950d15ffab04c224ead5b0f4916df2adcf077948f1ac20a1d9ed8b028ef3e62",
					"status": "content"
				}
			},
			"summary": {
				"differentFiles": 1,
				"matchingFiles": 16,
				"missingInPackage": 0,
				"missingInSource": 1,
				"score": 0.8888888888888888,
				"totalFiles": 18
			}
		}
	}
]
