[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2025-12-31T06:52:06.167Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "koa@0.21.2",
			"name": "koa",
			"version": "0.21.2",
			"location": "https://registry.npmjs.org/koa/-/koa-0.21.2.tgz",
			"integrity": "sha512-URGFUV2W1gKKI97cRnCxP8BdZISbaVkQGdokjHPt/jPkyoHkufR3R+TizRopDXw84o7Zg/MGVruENZL9jQKgMg==",
			"publishedAt": "2025-02-11T12:55:32.004Z",
			"publishedWith": {
				"node": "22.13.1",
				"npm": "10.9.2"
			}
		},
		"source": {
			"integrity": "sha512-KDDuvpfqSK0ZKEO2gCPedNjl5wYpfj+HNiuVRlbhd1A88S3M0ySkdf2V/EJ4NWt5dwh5PXCdcenrKK2IQJAxsg==",
			"location": "git+https://github.com/koajs/koa.git",
			"spec": "github:koajs/koa#f8a4c0c89ea03d54c7f6017c712842c3d1fa644a"
		},
		"comparisonHash": "8a2a8dcbb729bf3ee9216e490c955701f0ddebe1",
		"diff": {
			"files": {
				"LICENSE": {
					"diff": "--- published/LICENSE\n+++ rebuilt/LICENSE\n@@ -1,6 +1,6 @@\n (The MIT License)\n \n-Copyright (c) 2015 Koa contributors\n+Copyright (c) 2019 Koa contributors\n \n Permission is hereby granted, free of charge, to any person obtaining\n a copy of this software and associated documentation files (the\n",
					"match": false,
					"packageHash": "959e66973b1e2c60ad776d4ce047d1d095870770f1a6cbc34e993f656adcdb62",
					"size": 1079,
					"sourceHash": "16943a6ac79711e26289640dcca989be857059b938380b118bca5afc1ea4e7d7",
					"status": "content"
				},
				"Readme.md": {
					"diff": "--- published/Readme.md\n+++ rebuilt/Readme.md\n@@ -1,96 +1,287 @@\n-<img src=\"https://dl.dropboxusercontent.com/u/6396913/koa/logo.png\" alt=\"koa middleware framework for nodejs\" width=\"255px\" />\n+<img src=\"/docs/logo.png\" alt=\"Koa middleware framework for nodejs\"/>\n \n   [![gitter][gitter-image]][gitter-url]\n   [![NPM version][npm-image]][npm-url]\n-  [![build status][travis-image]][travis-url]\n+  [![build status][github-action-image]][github-action-url]\n   [![Test coverage][coveralls-image]][coveralls-url]\n+  [![OpenCollective Backers][backers-image]](#backers)\n+  [![OpenCollective Sponsors][sponsors-image]](#sponsors)\n+  [![PR's Welcome][pr-welcoming-image]][pr-welcoming-url]\n \n-  Expressive middleware for node.js using generators via [co](https://github.com/visionmedia/co)\n-  to make web applications and APIs more enjoyable to write. Koa's middleware flow in a stack-like manner allowing you to perform actions downstream, then filter and manipulate the response upstream. Koa's use of generators also greatly increases the readability and robustness of your application.\n+  Expressive HTTP middleware framework for node.js to make web applications and APIs more enjoyable to write. Koa's middleware stack flows in a stack-like manner, allowing you to perform actions downstream then filter and manipulate the response upstream.\n \n-  Only methods that are common to nearly all HTTP servers are integrated directly into Koa's small ~550 SLOC codebase. This\n-  includes things like content-negotiation, normalization of node inconsistencies, redirection, and a few others.\n+  Only methods that are common to nearly all HTTP servers are integrated directly into Koa's small ~570 SLOC codebase. This\n+  includes things like content negotiation, normalization of node inconsistencies, redirection, and a few others.\n \n-  No middleware are bundled with koa.\n+  Koa is not bundled with any middleware.\n \n ## Installation\n \n-```\n-$ npm install koa\n+Koa requires __node v18.0.0__ or higher for ES2015 and async function support.\n+\n+```sh\n+npm install koa\n ```\n \n-  Koa is supported in all versions of [iojs](https://iojs.org) without any flags.\n+## Hello Koa\n \n-  To use Koa with node, you must be running __node 0.11.16__ or higher for generator and promise support, and must run node(1)\n-  with the `--harmony-generators` or `--harmony` flag.\n+```js\n+const Koa = require('koa');\n+const app = new Koa();\n \n-## Community\n+// response\n+app.use(ctx => {\n+  ctx.body = 'Hello Koa';\n+});\n \n- - [API](docs/api/index.md) documentation\n- - [Badgeboard](https://koajs.github.io/badgeboard) and list of official modules\n- - [Examples](https://github.com/koajs/examples)\n- - [Middleware](https://github.com/koajs/koa/wiki) list\n- - [Wiki](https://github.com/koajs/koa/wiki)\n- - [G+ Community](https://plus.google.com/communities/101845768320796750641)\n- - [Reddit Community](http://reddit.com/r/koajs)\n- - [Mailing list](https://groups.google.com/forum/#!forum/koajs)\n- - [Guide](docs/guide.md)\n- - [FAQ](docs/faq.md)\n- - [中文文档](https://github.com/turingou/koa-guide)\n- - __#koajs__ on freenode\n+app.listen(3000);\n+```\n \n ## Getting started\n \n- - [Kick-Off-Koa](https://github.com/koajs/kick-off-koa) - An intro to koa via a set of self-guided workshops.\n- - [Workshop](https://github.com/koajs/workshop) - A workshop to learn the basics of koa, Express' spiritual successor.\n- - [Introduction Screencast](http://knowthen.com/episode-3-koajs-quickstart-guide/) - An introduction to installing and getting started with Koa\n+ - [Kick-Off-Koa](https://github.com/koajs/kick-off-koa) - An intro to Koa via a set of self-guided workshops.\n+ - [Guide](docs/guide.md) - Go straight to the docs.\n+\n+## Middleware\n+\n+Koa is a middleware framework that can take two different kinds of functions as middleware:\n \n-## Example\n+  * async function\n+  * common function\n+\n+Here is an example of logger middleware with each of the different functions:\n+\n+### ___async___ functions (node v7.6+)\n \n ```js\n-var koa = require('koa');\n-var app = koa();\n+app.use(async (ctx, next) => {\n+  const start = Date.now();\n+  await next();\n+  const ms = Date.now() - start;\n+  console.log(`${ctx.method} ${ctx.url} - ${ms}ms`);\n+});\n+```\n \n-// logger\n+### Common function\n",
					"match": false,
					"packageHash": "9ac379a5b3b0de4be8e86702e64f72e7ef7febba6be7f6356e612d7fdb25b748",
					"size": 3449,
					"sourceHash": "329c6cc2f798c5cc96a6761fe106583ae78c1c65d3568f27baa3e0a8694f1bfb",
					"status": "content"
				},
				"lib/application.js": {
					"diff": "--- published/lib/application.js\n+++ rebuilt/lib/application.js\n@@ -1,220 +1,333 @@\n-/**\n- * Module dependencies.\n- */\n-\n-var debug = require('debug')('koa:application');\n-var Emitter = require('events').EventEmitter;\n-var compose_es7 = require('composition');\n-var onFinished = require('on-finished');\n-var response = require('./response');\n-var compose = require('koa-compose');\n-var isJSON = require('koa-is-json');\n-var context = require('./context');\n-var request = require('./request');\n-var statuses = require('statuses');\n-var Cookies = require('cookies');\n-var accepts = require('accepts');\n-var assert = require('assert');\n-var Stream = require('stream');\n-var http = require('http');\n-var only = require('only');\n-var co = require('co');\n+'use strict'\n \n /**\n- * Application prototype.\n- */\n-\n-var app = Application.prototype;\n-\n-/**\n- * Expose `Application`.\n- */\n-\n-exports = module.exports = Application;\n-\n-/**\n- * Initialize a new `Application`.\n- *\n- * @api public\n+ * Module dependencies.\n  */\n+const util = require('node:util')\n+const debug = util.debuglog('koa:application')\n+const Emitter = require('node:events')\n+const Stream = require('node:stream')\n+const http = require('node:http')\n+const { AsyncLocalStorage } = require('node:async_hooks')\n+\n+const onFinished = require('on-finished')\n+const compose = require('koa-compose')\n+const statuses = require('statuses')\n+const { HttpError } = require('http-errors')\n+\n+const request = require('./request')\n+const response = require('./response')\n+const context = require('./context')\n+const isStream = require('./is-stream.js')\n+const only = require('./only.js')\n+\n+/** @typedef {typeof import ('./context') & {\n+ *  app: Application\n+ *  req: import('http').IncomingMessage\n+ *  res: import('http').ServerResponse\n+ *  request: KoaRequest\n+ *  response: KoaResponse\n+ *  state: any\n+ *  originalUrl: string\n+ * }} Context */\n+\n+/** @typedef {typeof import('./request')} KoaRequest */\n+\n+/** @typedef {typeof import('./response')} KoaResponse */\n+\n+/**\n+ * Expose `Application` class.\n+ * Inherits from `Emitter.prototype`.\n+ */\n+\n+module.exports = class Application extends Emitter {\n+  /**\n+   * Initialize a new `Application`.\n+   *\n+   * @api public\n+   */\n+\n+  /**\n+   *\n+   * @param {object} [options] Application options\n+   * @param {string} [options.env='development'] Environment\n+   * @param {string[]} [options.keys] Signed cookie keys\n+   * @param {boolean} [options.proxy] Trust proxy headers\n+   * @param {number} [options.subdomainOffset] Subdomain offset\n+   * @param {string} [options.proxyIpHeader] Proxy IP header, defaults to X-Forwarded-For\n+   * @param {number} [options.maxIpsCount] Max IPs read from proxy IP header, default to 0 (means infinity)\n+   * @param {function} [options.compose] Function to handle middleware composition\n+   * @param {boolean} [options.asyncLocalStorage] Enable AsyncLocalStorage, default to false\n+   *\n",
					"match": false,
					"packageHash": "272327993ab2a0afc2091977e9534e79d25dcc2712293b056c733c624e1b0cc1",
					"size": 4859,
					"sourceHash": "148c9d70309869d8e8f1256aa2a95b0138974071a1c6aa046e3c5305e0c9d8a6",
					"status": "content"
				},
				"lib/context.js": {
					"diff": "--- published/lib/context.js\n+++ rebuilt/lib/context.js\n@@ -1,18 +1,23 @@\n+'use strict'\n \n /**\n  * Module dependencies.\n  */\n \n-var createError = require('http-errors');\n-var httpAssert = require('http-assert');\n-var delegate = require('delegates');\n-var statuses = require('statuses');\n+const util = require('util')\n+const createError = require('http-errors')\n+const httpAssert = require('http-assert')\n+const delegate = require('delegates')\n+const statuses = require('statuses')\n+const Cookies = require('cookies')\n+\n+const COOKIES = Symbol('context#cookies')\n \n /**\n  * Context prototype.\n  */\n \n-var proto = module.exports = {\n+const proto = module.exports = {\n \n   /**\n    * util.inspect() implementation, which\n@@ -22,8 +27,9 @@\n    * @api public\n    */\n \n-  inspect: function(){\n-    return this.toJSON();\n+  inspect () {\n+    if (this === proto) return this\n+    return this.toJSON()\n   },\n \n   /**\n@@ -38,7 +44,7 @@\n    * @api public\n    */\n \n-  toJSON: function(){\n+  toJSON () {\n     return {\n       request: this.request.toJSON(),\n       response: this.response.toJSON(),\n@@ -46,7 +52,7 @@\n       originalUrl: this.originalUrl,\n       req: '<original node req>',\n       res: '<original node res>',\n-      socket: '<original node socket>',\n+      socket: '<original node socket>'\n     }\n   },\n \n@@ -66,27 +72,28 @@\n   assert: httpAssert,\n \n   /**\n-   * Throw an error with `msg` and optional `status`\n-   * defaulting to 500. Note that these are user-level\n+   * Throw an error with `status` (default 500) and\n+   * `msg`. Note that these are user-level\n    * errors, and the message may be exposed to the client.\n    *\n    *    this.throw(403)\n-   *    this.throw('name required', 400)\n    *    this.throw(400, 'name required')\n    *    this.throw('something exploded')\n-   *    this.throw(new Error('invalid'), 400);\n-   *    this.throw(400, new Error('invalid'));\n+   *    this.throw(new Error('invalid'))\n+   *    this.throw(400, new Error('invalid'))\n    *\n    * See: https://github.com/jshttp/http-errors\n    *\n+   * Note: `status` should only be passed as the first parameter.\n+   *\n    * @param {String|Number|Error} err, msg or status\n    * @param {String|Number|Error} [err, msg or status]\n    * @param {Object} [props]\n    * @api public\n    */\n \n-  throw: function(){\n-    throw createError.apply(null, arguments);\n+  throw (...args) {\n+    throw createError(...args)\n   },\n \n   /**\n@@ -96,45 +103,90 @@\n    * @api private\n    */\n",
					"match": false,
					"packageHash": "428719317138dd58683f2e98aacc89b1ec8ce2762630077674af5f2206575b04",
					"size": 4064,
					"sourceHash": "b45d1961d1cbd7a6460ad4a5e268ac1ecc78a14690696f6942ce3630822032fe",
					"status": "content"
				},
				"lib/request.js": {
					"diff": "--- published/lib/request.js\n+++ rebuilt/lib/request.js\n@@ -1,14 +1,23 @@\n+'use strict'\n \n /**\n  * Module dependencies.\n  */\n \n-var contentType = require('content-type');\n-var stringify = require('url').format;\n-var parse = require('parseurl');\n-var qs = require('querystring');\n-var typeis = require('type-is');\n-var fresh = require('fresh');\n+const URL = require('url').URL\n+const net = require('net')\n+const accepts = require('accepts')\n+const contentType = require('content-type')\n+const stringify = require('url').format\n+const parse = require('parseurl')\n+const sp = require('./search-params.js')\n+\n+const typeis = require('type-is')\n+const fresh = require('fresh')\n+const only = require('./only.js')\n+const util = require('util')\n+\n+const IP = Symbol('context#ip')\n \n /**\n  * Prototype.\n@@ -23,8 +32,18 @@\n    * @api public\n    */\n \n-  get header() {\n-    return this.req.headers;\n+  get header () {\n+    return this.req.headers\n+  },\n+\n+  /**\n+   * Set request header.\n+   *\n+   * @api public\n+   */\n+\n+  set header (val) {\n+    this.req.headers = val\n   },\n \n   /**\n@@ -34,8 +53,18 @@\n    * @api public\n    */\n \n-  get headers() {\n-    return this.req.headers;\n+  get headers () {\n+    return this.req.headers\n+  },\n+\n+  /**\n+   * Set request header, alias as request.header\n+   *\n+   * @api public\n+   */\n+\n+  set headers (val) {\n+    this.req.headers = val\n   },\n \n   /**\n@@ -45,8 +74,8 @@\n    * @api public\n    */\n \n-  get url() {\n-    return this.req.url;\n+  get url () {\n+    return this.req.url\n   },\n \n   /**\n@@ -55,8 +84,19 @@\n    * @api public\n    */\n \n-  set url(val) {\n-    this.req.url = val;\n+  set url (val) {\n+    this.req.url = val\n+  },\n+\n+  /**\n+   * Get the origin header.\n+   *\n+   * @return {String}\n+   * @api public\n",
					"match": false,
					"packageHash": "b264a51a5f587c3af7fcb4ed8dcc5d21bbf5c51ced26c03780aa1902fa3fd434",
					"size": 12942,
					"sourceHash": "0ba20780fb1669544a10525bd7376d50f46f94886c91330a899e2e0187f63ada",
					"status": "content"
				},
				"lib/response.js": {
					"diff": "--- published/lib/response.js\n+++ rebuilt/lib/response.js\n@@ -1,21 +1,25 @@\n+'use strict'\n \n /**\n  * Module dependencies.\n  */\n \n-var contentDisposition = require('content-disposition');\n-var ensureErrorHandler = require('error-inject');\n-var getType = require('mime-types').contentType;\n-var onFinish = require('on-finished');\n-var isJSON = require('koa-is-json');\n-var escape = require('escape-html');\n-var typeis = require('type-is').is;\n-var statuses = require('statuses');\n-var destroy = require('destroy');\n-var assert = require('assert');\n-var path = require('path');\n-var vary = require('vary');\n-var extname = path.extname;\n+const assert = require('node:assert')\n+const extname = require('node:path').extname\n+const util = require('node:util')\n+\n+const contentDisposition = require('content-disposition')\n+const onFinish = require('on-finished')\n+const escape = require('escape-html')\n+const typeis = require('type-is').is\n+const statuses = require('statuses')\n+const destroy = require('destroy')\n+const encodeUrl = require('encodeurl')\n+const vary = require('vary')\n+const getType = require('mime-types').contentType\n+\n+const isStream = require('./is-stream.js')\n+const only = require('./only.js')\n \n /**\n  * Prototype.\n@@ -30,9 +34,8 @@\n    * @api public\n    */\n \n-  get socket() {\n-    // TODO: TLS\n-    return this.ctx.req.socket;\n+  get socket () {\n+    return this.res.socket\n   },\n \n   /**\n@@ -42,9 +45,11 @@\n    * @api public\n    */\n \n-  get header() {\n-    // TODO: wtf\n-    return this.res._headers || {};\n+  get header () {\n+    const { res } = this\n+    return typeof res.getHeaders === 'function'\n+      ? res.getHeaders()\n+      : res._headers || {} // Node < 7.7\n   },\n \n   /**\n@@ -54,8 +59,8 @@\n    * @api public\n    */\n \n-  get headers() {\n-    return this.header;\n+  get headers () {\n+    return this.header\n   },\n \n   /**\n@@ -65,8 +70,8 @@\n    * @api public\n    */\n \n-  get status() {\n-    return this.res.statusCode;\n+  get status () {\n+    return this.res.statusCode\n   },\n \n   /**\n@@ -76,13 +81,15 @@\n    * @api public\n    */\n \n-  set status(code) {\n-    assert('number' == typeof code, 'status code must be a number');\n-    assert(statuses[code], 'invalid status code: ' + code);\n-    this._explicitStatus = true;\n-    this.res.statusCode = code;\n-    this.res.statusMessage = statuses[code];\n",
					"match": false,
					"packageHash": "956c59940e5bf81d6135ce1dc4ea0a4e5410c85a1a4eb1b0789f90398de8bde3",
					"size": 10329,
					"sourceHash": "2b03a5d9c80d8c436de16da10fbca36f19b7427fa949b48f7d4f856997bddf85",
					"status": "content"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,10 +1,28 @@\n {\n   \"name\": \"koa\",\n-  \"version\": \"0.21.2\",\n+  \"version\": \"3.1.1\",\n   \"description\": \"Koa web app framework\",\n   \"main\": \"lib/application.js\",\n+  \"exports\": {\n+    \".\": {\n+      \"require\": \"./lib/application.js\",\n+      \"import\": \"./dist/koa.mjs\",\n+      \"default\": \"./dist/koa.mjs\"\n+    },\n+    \"./*\": \"./*.js\",\n+    \"./*.js\": \"./*.js\",\n+    \"./package\": \"./package.json\",\n+    \"./package.json\": \"./package.json\"\n+  },\n   \"scripts\": {\n-    \"test\": \"make test\"\n+    \"test\": \"node --test\",\n+    \"test:coverage\": \"c8 --reporter=lcov --reporter=text-summary node --test\",\n+    \"lint\": \"standard\",\n+    \"lint:fix\": \"standard --fix\",\n+    \"lint:pretty\": \"standard | snazzy\",\n+    \"authors\": \"git log --format='%aN <%aE>' | sort -u > AUTHORS\",\n+    \"build\": \"gen-esm-wrapper . ./dist/koa.mjs\",\n+    \"prepare\": \"npm run build\"\n   },\n   \"repository\": \"koajs/koa\",\n   \"keywords\": [\n@@ -18,47 +36,38 @@\n   ],\n   \"license\": \"MIT\",\n   \"dependencies\": {\n-    \"accepts\": \"^1.2.2\",\n-    \"co\": \"^4.4.0\",\n-    \"composition\": \"^2.1.1\",\n-    \"content-disposition\": \"~0.5.0\",\n-    \"content-type\": \"^1.0.0\",\n-    \"cookies\": \"~0.5.0\",\n-    \"debug\": \"^2.6.9\",\n-    \"delegates\": \"0.1.0\",\n-    \"destroy\": \"^1.0.3\",\n-    \"error-inject\": \"~1.0.0\",\n-    \"escape-html\": \"~1.0.1\",\n-    \"fresh\": \"^0.3.0\",\n-    \"http-assert\": \"^1.1.0\",\n-    \"http-errors\": \"^1.2.8\",\n-    \"koa-compose\": \"^2.3.0\",\n-    \"koa-is-json\": \"^1.0.0\",\n-    \"mime-types\": \"^2.0.7\",\n-    \"on-finished\": \"^2.1.0\",\n-    \"only\": \"0.0.2\",\n-    \"parseurl\": \"^1.3.0\",\n-    \"statuses\": \"^1.2.0\",\n-    \"type-is\": \"^1.5.5\",\n-    \"vary\": \"^1.0.0\"\n+    \"accepts\": \"^1.3.8\",\n+    \"content-disposition\": \"~0.5.4\",\n+    \"content-type\": \"^1.0.5\",\n+    \"cookies\": \"~0.9.1\",\n+    \"delegates\": \"^1.0.0\",\n+    \"destroy\": \"^1.2.0\",\n+    \"encodeurl\": \"^2.0.0\",\n+    \"escape-html\": \"^1.0.3\",\n+    \"fresh\": \"~0.5.2\",\n+    \"http-assert\": \"^1.5.0\",\n+    \"http-errors\": \"^2.0.0\",\n+    \"koa-compose\": \"^4.1.0\",\n+    \"mime-types\": \"^3.0.1\",\n+    \"on-finished\": \"^2.4.1\",\n+    \"parseurl\": \"^1.3.3\",\n+    \"statuses\": \"^2.0.1\",\n+    \"type-is\": \"^2.0.1\",\n+    \"vary\": \"^1.1.2\"\n   },\n   \"devDependencies\": {\n-    \"babel\": \"^5.0.0\",\n-    \"istanbul-harmony\": \"~0.3.0\",\n-    \"make-lint\": \"^1.0.1\",\n-    \"mocha\": \"^2.0.1\",\n-    \"should\": \"^3.1.0\",\n-    \"supertest\": \"~0.15.0\",\n-    \"test-console\": \"^0.7.1\"\n+    \"c8\": \"^10.1.3\",\n+    \"gen-esm-wrapper\": \"^1.1.3\",\n+    \"snazzy\": \"^9.0.0\",\n+    \"standard\": \"^17.1.2\",\n+    \"supertest\": \"^7.1.1\"\n   },\n   \"engines\": {\n-    \"node\": \">= 0.11.16\",\n-    \"iojs\": \">= 1.0.0\"\n+    \"node\": \">= 18\"\n   },\n   \"files\": [\n+    \"dist\",\n",
					"match": false,
					"packageHash": "fbe51fcfffa636abd63b8eb1e2dd37adcae714f7acc23d4b64522acbaab41891",
					"size": 1330,
					"sourceHash": "39075751293967a94e004c83465d41287733b9d50f877a11ddca1c1cd3631cb1",
					"status": "content"
				},
				"dist/koa.mjs": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/is-stream.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/only.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/search-params.js": {
					"match": false,
					"status": "missing-in-package"
				}
			},
			"summary": {
				"differentFiles": 7,
				"matchingFiles": 0,
				"missingInPackage": 4,
				"missingInSource": 0,
				"score": 0,
				"totalFiles": 11
			}
		}
	}
]
