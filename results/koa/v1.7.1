[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2025-12-31T06:52:16.631Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "koa@1.7.1",
			"name": "koa",
			"version": "1.7.1",
			"location": "https://registry.npmjs.org/koa/-/koa-1.7.1.tgz",
			"integrity": "sha512-OWunovXTG5xliG4iVQJ2YAGa7tSDHvJiRvjEEy5WMBpkFw/O54WneFB+efsCxJoT3pRdNapSZSMvvs4bUzbkIg==",
			"publishedAt": "2025-02-11T12:56:52.885Z",
			"publishedWith": {
				"node": "22.13.1",
				"npm": "10.9.2"
			}
		},
		"source": {
			"integrity": "sha512-KDDuvpfqSK0ZKEO2gCPedNjl5wYpfj+HNiuVRlbhd1A88S3M0ySkdf2V/EJ4NWt5dwh5PXCdcenrKK2IQJAxsg==",
			"location": "git+https://github.com/koajs/koa.git",
			"spec": "github:koajs/koa#e0114b73e68323adac2484b0a43ceef9ba6118c2"
		},
		"comparisonHash": "8a2a8dcbb729bf3ee9216e490c955701f0ddebe1",
		"diff": {
			"files": {
				"LICENSE": {
					"diff": "--- published/LICENSE\n+++ rebuilt/LICENSE\n@@ -1,6 +1,6 @@\n (The MIT License)\n \n-Copyright (c) 2016 Koa contributors\n+Copyright (c) 2019 Koa contributors\n \n Permission is hereby granted, free of charge, to any person obtaining\n a copy of this software and associated documentation files (the\n",
					"match": false,
					"packageHash": "f41298b312e3956f77d1fcb81159c9f28c71ead850b54eb9cb674374cc746918",
					"size": 1079,
					"sourceHash": "16943a6ac79711e26289640dcca989be857059b938380b118bca5afc1ea4e7d7",
					"status": "content"
				},
				"Readme.md": {
					"diff": "--- published/Readme.md\n+++ rebuilt/Readme.md\n@@ -1,120 +1,201 @@\n-<img src=\"https://dl.dropboxusercontent.com/u/6396913/koa/logo.png\" alt=\"koa middleware framework for nodejs\" width=\"255px\" />\n+<img src=\"/docs/logo.png\" alt=\"Koa middleware framework for nodejs\"/>\n \n   [![gitter][gitter-image]][gitter-url]\n   [![NPM version][npm-image]][npm-url]\n-  [![build status][travis-image]][travis-url]\n+  [![build status][github-action-image]][github-action-url]\n   [![Test coverage][coveralls-image]][coveralls-url]\n   [![OpenCollective Backers][backers-image]](#backers)\n   [![OpenCollective Sponsors][sponsors-image]](#sponsors)\n+  [![PR's Welcome][pr-welcoming-image]][pr-welcoming-url]\n \n-  Expressive, light-weight HTTP framework for node.js to make web applications and APIs more enjoyable to write. Koa requests flow through middleware in a stack-like manner, allowing you to perform actions downstream then filter and manipulate the response upstream. Koa's use of generators also greatly increases the readability and robustness of your application.\n+  Expressive HTTP middleware framework for node.js to make web applications and APIs more enjoyable to write. Koa's middleware stack flows in a stack-like manner, allowing you to perform actions downstream then filter and manipulate the response upstream.\n \n-  Only methods that are common to nearly all HTTP servers are integrated directly into Koa's small ~550 SLOC codebase. This\n+  Only methods that are common to nearly all HTTP servers are integrated directly into Koa's small ~570 SLOC codebase. This\n   includes things like content negotiation, normalization of node inconsistencies, redirection, and a few others.\n \n-  Koa is not bundled with any middleware, but there is a [large collection](https://github.com/koajs/koa/wiki) of community middleware to choose from.\n+  Koa is not bundled with any middleware.\n \n ## Installation\n \n-```\n-$ npm install koa\n+Koa requires __node v18.0.0__ or higher for ES2015 and async function support.\n+\n+```sh\n+npm install koa\n ```\n \n-  Koa is supported in node v4+ and node v0.12 with the `--harmony-generators` or `--harmony` flag.\n+## Hello Koa\n \n-## Koa v2\n+```js\n+const Koa = require('koa');\n+const app = new Koa();\n \n-  Koa v2 is currently released with the `next` tag (meaning it will not be marked as latest).\n-  You can install it with semver:\n+// response\n+app.use(ctx => {\n+  ctx.body = 'Hello Koa';\n+});\n \n-```bash\n-npm install koa@next\n+app.listen(3000);\n ```\n \n-  In this new version, the middleware function signature changes to adopt async/await:\n+## Getting started\n \n-```js\n-// Koa application is now a class and requires the new operator.\n-const app = new Koa();\n+ - [Kick-Off-Koa](https://github.com/koajs/kick-off-koa) - An intro to Koa via a set of self-guided workshops.\n+ - [Guide](docs/guide.md) - Go straight to the docs.\n+\n+## Middleware\n+\n+Koa is a middleware framework that can take two different kinds of functions as middleware:\n+\n+  * async function\n+  * common function\n \n-// uses async arrow functions\n+Here is an example of logger middleware with each of the different functions:\n+\n+### ___async___ functions (node v7.6+)\n+\n+```js\n app.use(async (ctx, next) => {\n-  try {\n-    await next(); // next is now a function\n-  } catch (err) {\n-    ctx.body = { message: err.message };\n-    ctx.status = err.status || 500;\n-  }\n+  const start = Date.now();\n+  await next();\n+  const ms = Date.now() - start;\n+  console.log(`${ctx.method} ${ctx.url} - ${ms}ms`);\n });\n+```\n \n-app.use(async ctx => {\n-  const user = await User.getById(ctx.session.userid); // await instead of yield\n-  ctx.body = user; // ctx instead of this\n+### Common function\n+\n+```js\n+// Middleware normally takes two parameters (ctx, next), ctx is the context for one request,\n+// next is a function that is invoked to execute the downstream middleware. It returns a Promise with a then function for running code after completion.\n+\n",
					"match": false,
					"packageHash": "6c2c688001b9e7a47e9a0de9a9b31fe2609fe3a75b28522fc971172662dd5f33",
					"size": 13938,
					"sourceHash": "329c6cc2f798c5cc96a6761fe106583ae78c1c65d3568f27baa3e0a8694f1bfb",
					"status": "content"
				},
				"lib/application.js": {
					"diff": "--- published/lib/application.js\n+++ rebuilt/lib/application.js\n@@ -1,237 +1,333 @@\n-\n-'use strict';\n+'use strict'\n \n /**\n  * Module dependencies.\n  */\n+const util = require('node:util')\n+const debug = util.debuglog('koa:application')\n+const Emitter = require('node:events')\n+const Stream = require('node:stream')\n+const http = require('node:http')\n+const { AsyncLocalStorage } = require('node:async_hooks')\n+\n+const onFinished = require('on-finished')\n+const compose = require('koa-compose')\n+const statuses = require('statuses')\n+const { HttpError } = require('http-errors')\n+\n+const request = require('./request')\n+const response = require('./response')\n+const context = require('./context')\n+const isStream = require('./is-stream.js')\n+const only = require('./only.js')\n+\n+/** @typedef {typeof import ('./context') & {\n+ *  app: Application\n+ *  req: import('http').IncomingMessage\n+ *  res: import('http').ServerResponse\n+ *  request: KoaRequest\n+ *  response: KoaResponse\n+ *  state: any\n+ *  originalUrl: string\n+ * }} Context */\n+\n+/** @typedef {typeof import('./request')} KoaRequest */\n+\n+/** @typedef {typeof import('./response')} KoaResponse */\n+\n+/**\n+ * Expose `Application` class.\n+ * Inherits from `Emitter.prototype`.\n+ */\n+\n+module.exports = class Application extends Emitter {\n+  /**\n+   * Initialize a new `Application`.\n+   *\n+   * @api public\n+   */\n+\n+  /**\n+   *\n+   * @param {object} [options] Application options\n+   * @param {string} [options.env='development'] Environment\n+   * @param {string[]} [options.keys] Signed cookie keys\n+   * @param {boolean} [options.proxy] Trust proxy headers\n+   * @param {number} [options.subdomainOffset] Subdomain offset\n+   * @param {string} [options.proxyIpHeader] Proxy IP header, defaults to X-Forwarded-For\n+   * @param {number} [options.maxIpsCount] Max IPs read from proxy IP header, default to 0 (means infinity)\n+   * @param {function} [options.compose] Function to handle middleware composition\n+   * @param {boolean} [options.asyncLocalStorage] Enable AsyncLocalStorage, default to false\n+   *\n+   */\n+\n+  constructor (options) {\n+    super()\n+    options = options || {}\n+    this.proxy = options.proxy || false\n+    this.subdomainOffset = options.subdomainOffset || 2\n+    this.proxyIpHeader = options.proxyIpHeader || 'X-Forwarded-For'\n+    this.maxIpsCount = options.maxIpsCount || 0\n+    this.env = options.env || process.env.NODE_ENV || 'development'\n+    this.compose = options.compose || compose\n+    if (options.keys) this.keys = options.keys\n+    this.middleware = []\n+    this.context = Object.create(context)\n+    this.request = Object.create(request)\n+    this.response = Object.create(response)\n+    // util.inspect.custom support for node 6+\n+    /* istanbul ignore else */\n+    if (util.inspect.custom) {\n+      this[util.inspect.custom] = this.inspect\n+    }\n+    if (options.asyncLocalStorage) {\n+      if (options.asyncLocalStorage instanceof AsyncLocalStorage) {\n+        this.ctxStorage = options.asyncLocalStorage\n+      } else {\n+        this.ctxStorage = new AsyncLocalStorage()\n+      }\n+    }\n+  }\n \n-var debug = require('debug')('koa:application');\n-var Emitter = require('events').EventEmitter;\n-var compose_es7 = require('composition');\n-var onFinished = require('on-finished');\n",
					"match": false,
					"packageHash": "23e78b9737c1af28c0ab8bcf05950d438e65019c4433ef1f70428416fc777df0",
					"size": 5397,
					"sourceHash": "148c9d70309869d8e8f1256aa2a95b0138974071a1c6aa046e3c5305e0c9d8a6",
					"status": "content"
				},
				"lib/context.js": {
					"diff": "--- published/lib/context.js\n+++ rebuilt/lib/context.js\n@@ -1,20 +1,23 @@\n-\n-'use strict';\n+'use strict'\n \n /**\n  * Module dependencies.\n  */\n \n-var createError = require('http-errors');\n-var httpAssert = require('http-assert');\n-var delegate = require('delegates');\n-var statuses = require('statuses');\n+const util = require('util')\n+const createError = require('http-errors')\n+const httpAssert = require('http-assert')\n+const delegate = require('delegates')\n+const statuses = require('statuses')\n+const Cookies = require('cookies')\n+\n+const COOKIES = Symbol('context#cookies')\n \n /**\n  * Context prototype.\n  */\n \n-var proto = module.exports = {\n+const proto = module.exports = {\n \n   /**\n    * util.inspect() implementation, which\n@@ -24,8 +27,9 @@\n    * @api public\n    */\n \n-  inspect: function(){\n-    return this.toJSON();\n+  inspect () {\n+    if (this === proto) return this\n+    return this.toJSON()\n   },\n \n   /**\n@@ -40,7 +44,7 @@\n    * @api public\n    */\n \n-  toJSON: function(){\n+  toJSON () {\n     return {\n       request: this.request.toJSON(),\n       response: this.response.toJSON(),\n@@ -48,7 +52,7 @@\n       originalUrl: this.originalUrl,\n       req: '<original node req>',\n       res: '<original node res>',\n-      socket: '<original node socket>',\n+      socket: '<original node socket>'\n     }\n   },\n \n@@ -68,25 +72,28 @@\n   assert: httpAssert,\n \n   /**\n-   * Throw an error with `msg` and optional `status`\n-   * defaulting to 500. Note that these are user-level\n+   * Throw an error with `status` (default 500) and\n+   * `msg`. Note that these are user-level\n    * errors, and the message may be exposed to the client.\n    *\n    *    this.throw(403)\n    *    this.throw(400, 'name required')\n    *    this.throw('something exploded')\n-   *    this.throw(400, new Error('invalid'));\n+   *    this.throw(new Error('invalid'))\n+   *    this.throw(400, new Error('invalid'))\n    *\n    * See: https://github.com/jshttp/http-errors\n    *\n+   * Note: `status` should only be passed as the first parameter.\n+   *\n    * @param {String|Number|Error} err, msg or status\n    * @param {String|Number|Error} [err, msg or status]\n    * @param {Object} [props]\n    * @api public\n    */\n \n-  throw: function(){\n-    throw createError.apply(null, arguments);\n+  throw (...args) {\n+    throw createError(...args)\n   },\n \n   /**\n@@ -96,56 +103,90 @@\n    * @api private\n    */\n",
					"match": false,
					"packageHash": "5d13576d2611b8ea0ab6b5a1ba6cc73db306666e6c78afd969f90d07f8a00fbd",
					"size": 4310,
					"sourceHash": "b45d1961d1cbd7a6460ad4a5e268ac1ecc78a14690696f6942ce3630822032fe",
					"status": "content"
				},
				"lib/request.js": {
					"diff": "--- published/lib/request.js\n+++ rebuilt/lib/request.js\n@@ -1,17 +1,23 @@\n-\n-'use strict';\n+'use strict'\n \n /**\n  * Module dependencies.\n  */\n \n-var net = require('net');\n-var contentType = require('content-type');\n-var stringify = require('url').format;\n-var parse = require('parseurl');\n-var qs = require('querystring');\n-var typeis = require('type-is');\n-var fresh = require('fresh');\n+const URL = require('url').URL\n+const net = require('net')\n+const accepts = require('accepts')\n+const contentType = require('content-type')\n+const stringify = require('url').format\n+const parse = require('parseurl')\n+const sp = require('./search-params.js')\n+\n+const typeis = require('type-is')\n+const fresh = require('fresh')\n+const only = require('./only.js')\n+const util = require('util')\n+\n+const IP = Symbol('context#ip')\n \n /**\n  * Prototype.\n@@ -26,8 +32,18 @@\n    * @api public\n    */\n \n-  get header() {\n-    return this.req.headers;\n+  get header () {\n+    return this.req.headers\n+  },\n+\n+  /**\n+   * Set request header.\n+   *\n+   * @api public\n+   */\n+\n+  set header (val) {\n+    this.req.headers = val\n   },\n \n   /**\n@@ -37,8 +53,18 @@\n    * @api public\n    */\n \n-  get headers() {\n-    return this.req.headers;\n+  get headers () {\n+    return this.req.headers\n+  },\n+\n+  /**\n+   * Set request header, alias as request.header\n+   *\n+   * @api public\n+   */\n+\n+  set headers (val) {\n+    this.req.headers = val\n   },\n \n   /**\n@@ -48,8 +74,8 @@\n    * @api public\n    */\n \n-  get url() {\n-    return this.req.url;\n+  get url () {\n+    return this.req.url\n   },\n \n   /**\n@@ -58,19 +84,19 @@\n    * @api public\n    */\n \n-  set url(val) {\n-    this.req.url = val;\n+  set url (val) {\n+    this.req.url = val\n   },\n \n   /**\n-   * Get origin of URL.\n",
					"match": false,
					"packageHash": "ce0b253f1cca0250ffa757d7c74b60214f78bc25316587f963e6865d6e4e2105",
					"size": 13342,
					"sourceHash": "0ba20780fb1669544a10525bd7376d50f46f94886c91330a899e2e0187f63ada",
					"status": "content"
				},
				"lib/response.js": {
					"diff": "--- published/lib/response.js\n+++ rebuilt/lib/response.js\n@@ -1,23 +1,25 @@\n-\n-'use strict';\n+'use strict'\n \n /**\n  * Module dependencies.\n  */\n \n-var contentDisposition = require('content-disposition');\n-var ensureErrorHandler = require('error-inject');\n-var getType = require('mime-types').contentType;\n-var onFinish = require('on-finished');\n-var isJSON = require('koa-is-json');\n-var escape = require('escape-html');\n-var typeis = require('type-is').is;\n-var statuses = require('statuses');\n-var destroy = require('destroy');\n-var assert = require('assert');\n-var path = require('path');\n-var vary = require('vary');\n-var extname = path.extname;\n+const assert = require('node:assert')\n+const extname = require('node:path').extname\n+const util = require('node:util')\n+\n+const contentDisposition = require('content-disposition')\n+const onFinish = require('on-finished')\n+const escape = require('escape-html')\n+const typeis = require('type-is').is\n+const statuses = require('statuses')\n+const destroy = require('destroy')\n+const encodeUrl = require('encodeurl')\n+const vary = require('vary')\n+const getType = require('mime-types').contentType\n+\n+const isStream = require('./is-stream.js')\n+const only = require('./only.js')\n \n /**\n  * Prototype.\n@@ -32,8 +34,8 @@\n    * @api public\n    */\n \n-  get socket() {\n-    return this.ctx.req.socket;\n+  get socket () {\n+    return this.res.socket\n   },\n \n   /**\n@@ -43,10 +45,11 @@\n    * @api public\n    */\n \n-  get header() {\n-    return this.res.getHeaders\n-      ? this.res.getHeaders()\n-      : this.res._headers || {};  // Node < 8\n+  get header () {\n+    const { res } = this\n+    return typeof res.getHeaders === 'function'\n+      ? res.getHeaders()\n+      : res._headers || {} // Node < 7.7\n   },\n \n   /**\n@@ -56,8 +59,8 @@\n    * @api public\n    */\n \n-  get headers() {\n-    return this.header;\n+  get headers () {\n+    return this.header\n   },\n \n   /**\n@@ -67,8 +70,8 @@\n    * @api public\n    */\n \n-  get status() {\n-    return this.res.statusCode;\n+  get status () {\n+    return this.res.statusCode\n   },\n \n   /**\n@@ -78,15 +81,15 @@\n    * @api public\n    */\n \n-  set status(code) {\n-    if (this.headerSent) return;\n+  set status (code) {\n+    if (this.headerSent) return\n",
					"match": false,
					"packageHash": "b50ddcc740fc5a7cf6887486ca37da965102ea128bf5d71e3198e2208a30ac32",
					"size": 10709,
					"sourceHash": "2b03a5d9c80d8c436de16da10fbca36f19b7427fa949b48f7d4f856997bddf85",
					"status": "content"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,11 +1,28 @@\n {\n   \"name\": \"koa\",\n-  \"version\": \"1.7.1\",\n+  \"version\": \"3.1.1\",\n   \"description\": \"Koa web app framework\",\n   \"main\": \"lib/application.js\",\n+  \"exports\": {\n+    \".\": {\n+      \"require\": \"./lib/application.js\",\n+      \"import\": \"./dist/koa.mjs\",\n+      \"default\": \"./dist/koa.mjs\"\n+    },\n+    \"./*\": \"./*.js\",\n+    \"./*.js\": \"./*.js\",\n+    \"./package\": \"./package.json\",\n+    \"./package.json\": \"./package.json\"\n+  },\n   \"scripts\": {\n-    \"test\": \"make test\",\n-    \"update-authors\": \"git log --format='%aN <%aE>' | sort -u > AUTHORS\"\n+    \"test\": \"node --test\",\n+    \"test:coverage\": \"c8 --reporter=lcov --reporter=text-summary node --test\",\n+    \"lint\": \"standard\",\n+    \"lint:fix\": \"standard --fix\",\n+    \"lint:pretty\": \"standard | snazzy\",\n+    \"authors\": \"git log --format='%aN <%aE>' | sort -u > AUTHORS\",\n+    \"build\": \"gen-esm-wrapper . ./dist/koa.mjs\",\n+    \"prepare\": \"npm run build\"\n   },\n   \"repository\": \"koajs/koa\",\n   \"keywords\": [\n@@ -19,48 +36,38 @@\n   ],\n   \"license\": \"MIT\",\n   \"dependencies\": {\n-    \"accepts\": \"^1.2.2\",\n-    \"co\": \"^4.4.0\",\n-    \"composition\": \"^2.1.1\",\n-    \"content-disposition\": \"~0.5.0\",\n-    \"content-type\": \"^1.0.0\",\n-    \"cookies\": \"~0.8.0\",\n-    \"debug\": \"^2.6.9\",\n+    \"accepts\": \"^1.3.8\",\n+    \"content-disposition\": \"~0.5.4\",\n+    \"content-type\": \"^1.0.5\",\n+    \"cookies\": \"~0.9.1\",\n     \"delegates\": \"^1.0.0\",\n-    \"destroy\": \"^1.0.3\",\n-    \"error-inject\": \"~1.0.0\",\n-    \"escape-html\": \"~1.0.1\",\n-    \"fresh\": \"^0.5.2\",\n-    \"http-assert\": \"^1.1.0\",\n-    \"http-errors\": \"^1.2.8\",\n-    \"koa-compose\": \"^2.3.0\",\n-    \"koa-is-json\": \"^1.0.0\",\n-    \"mime-types\": \"^2.0.7\",\n-    \"on-finished\": \"^2.1.0\",\n-    \"only\": \"0.0.2\",\n-    \"parseurl\": \"^1.3.0\",\n-    \"statuses\": \"^1.2.0\",\n-    \"type-is\": \"^1.5.5\",\n-    \"vary\": \"^1.0.0\"\n+    \"destroy\": \"^1.2.0\",\n+    \"encodeurl\": \"^2.0.0\",\n+    \"escape-html\": \"^1.0.3\",\n+    \"fresh\": \"~0.5.2\",\n+    \"http-assert\": \"^1.5.0\",\n+    \"http-errors\": \"^2.0.0\",\n+    \"koa-compose\": \"^4.1.0\",\n+    \"mime-types\": \"^3.0.1\",\n+    \"on-finished\": \"^2.4.1\",\n+    \"parseurl\": \"^1.3.3\",\n+    \"statuses\": \"^2.0.1\",\n+    \"type-is\": \"^2.0.1\",\n+    \"vary\": \"^1.1.2\"\n   },\n   \"devDependencies\": {\n-    \"babel\": \"^5.0.0\",\n-    \"istanbul\": \"^0.4.0\",\n-    \"make-lint\": \"^1.0.1\",\n-    \"mocha\": \"^2.0.1\",\n-    \"should\": \"^6.0.3\",\n-    \"should-http\": \"0.0.3\",\n-    \"supertest\": \"^1.0.1\",\n-    \"test-console\": \"^0.7.1\"\n+    \"c8\": \"^10.1.3\",\n+    \"gen-esm-wrapper\": \"^1.1.3\",\n+    \"snazzy\": \"^9.0.0\",\n+    \"standard\": \"^17.1.2\",\n+    \"supertest\": \"^7.1.1\"\n   },\n   \"engines\": {\n-    \"node\": \">= 0.12.0\",\n-    \"iojs\": \">= 1.0.0\"\n+    \"node\": \">= 18\"\n   },\n   \"files\": [\n",
					"match": false,
					"packageHash": "05f3f2ed8bbd00767ead21223bc932b8f70fc4794fc134145636584d1ad1a85c",
					"size": 1416,
					"sourceHash": "39075751293967a94e004c83465d41287733b9d50f877a11ddca1c1cd3631cb1",
					"status": "content"
				},
				"dist/koa.mjs": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/is-stream.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/only.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/search-params.js": {
					"match": false,
					"status": "missing-in-package"
				}
			},
			"summary": {
				"differentFiles": 7,
				"matchingFiles": 0,
				"missingInPackage": 4,
				"missingInSource": 0,
				"score": 0,
				"totalFiles": 11
			}
		}
	}
]
