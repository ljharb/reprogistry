[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-01T19:30:45.008Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "mysql2@0.0.2",
			"name": "mysql2",
			"version": "0.0.2",
			"location": "https://registry.npmjs.org/mysql2/-/mysql2-0.0.2.tgz",
			"integrity": "sha512-p88iLxkehSU7pS/7Zc3Krxxi6GX19CZ9wwNFVViUeR+/FXkGypqYbZsUx6P83ZXjKGfo32faR75mS7WehiVU4Q==",
			"publishedAt": "2013-04-18T01:37:14.240Z",
			"publishedWith": {
				"node": null,
				"npm": "1.2.14"
			}
		},
		"source": {
			"integrity": "sha512-AEGW7QLLSuSnjCS4pk3EIqOmogegmze9h8EyrndavUQnIUcfkVal/sK7QznE+a3bc6rzPbAiui9Jcb+96tPwYA==",
			"location": "https://github.com/sidorares/node-mysql2",
			"spec": "github:sidorares/node-mysql2#HEAD"
		},
		"comparisonHash": "8a2a8dcbb729bf3ee9216e490c955701f0ddebe1",
		"diff": {
			"files": {
				".npmignore": {
					"match": false,
					"packageHash": "64b8fad686775f85a9fdf2dce50131dc08a65add546d503d1a954aed63561f9d",
					"size": 112,
					"status": "missing-in-source"
				},
				".travis.yml": {
					"match": false,
					"packageHash": "229e631fb65224620974b6e4141f12b7a3203a0380594e70603826dae957d928",
					"size": 145,
					"status": "missing-in-source"
				},
				"License": {
					"diff": "--- published/License\n+++ rebuilt/License\n@@ -1,4 +1,4 @@\n-Copyright (c) 2013 Andrey Sidorov (sidorares@yandex.ru) and contributors\n+Copyright (c) 2016 Andrey Sidorov (sidorares@yandex.ru) and contributors\n \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n",
					"match": false,
					"packageHash": "b9f4723995bb449274bf9361d69fd494bae4feecb5e5b82ac91bc19b7a214712",
					"size": 1112,
					"sourceHash": "f17f1be30bce27fe6324513a35fa61f6e6766d3028e42e45bdf668a0db7c8d4f",
					"status": "content"
				},
				"README.md": {
					"diff": "--- published/README.md\n+++ rebuilt/README.md\n@@ -1,4 +1,114 @@\n-[![Build Status](https://secure.travis-ci.org/sidorares/node-mysql2.png)](http://travis-ci.org/sidorares/node-mysql2)\n+[npm-image]: https://img.shields.io/npm/v/mysql2.svg\n+[npm-url]: https://npmjs.com/package/mysql2\n+[node-version-image]: https://img.shields.io/node/v/mysql2.svg\n+[node-version-url]: https://nodejs.org/en/download\n+[downloads-image]: https://img.shields.io/npm/dm/mysql2.svg\n+[downloads-url]: https://npmjs.com/package/mysql2\n+[license-url]: https://github.com/sidorares/node-mysql2/blob/master/License\n+[license-image]: https://img.shields.io/npm/l/mysql2.svg?maxAge=2592000\n+[node-mysql]: https://github.com/mysqljs/mysql\n+[mysqljs]: https://github.com/mysqljs\n+[mysql-native]: https://github.com/sidorares/nodejs-mysql-native\n+[sidorares]: https://github.com/sidorares\n+[TooTallNate]: https://gist.github.com/TooTallNate\n+[starttls.js]: https://gist.github.com/TooTallNate/848444\n+[node-mariasql]: https://github.com/mscdex/node-mariasql\n+[contributors]: https://github.com/sidorares/node-mysql2/graphs/contributors\n+[contributing]: https://github.com/sidorares/node-mysql2/blob/master/Contributing.md\n+[docs-base]: https://sidorares.github.io/node-mysql2/docs\n+[docs-base-zh-CN]: https://sidorares.github.io/node-mysql2/zh-CN/docs\n+[docs-base-pt-BR]: https://sidorares.github.io/node-mysql2/pt-BR/docs\n+[docs-prepared-statements]: https://sidorares.github.io/node-mysql2/docs/documentation/prepared-statements\n+[docs-mysql-server]: https://sidorares.github.io/node-mysql2/docs/documentation/mysql-server\n+[docs-promise-wrapper]: https://sidorares.github.io/node-mysql2/docs/documentation/promise-wrapper\n+[docs-authentication-switch]: https://sidorares.github.io/node-mysql2/docs/documentation/authentication-switch\n+[docs-streams]: https://sidorares.github.io/node-mysql2/docs/documentation/extras\n+[docs-typescript-docs]: https://sidorares.github.io/node-mysql2/docs/documentation/typescript-examples\n+[docs-qs-pooling]: https://sidorares.github.io/node-mysql2/docs#using-connection-pools\n+[docs-qs-first-query]: https://sidorares.github.io/node-mysql2/docs#first-query\n+[docs-qs-using-prepared-statements]: https://sidorares.github.io/node-mysql2/docs#using-prepared-statements\n+[docs-examples]: https://sidorares.github.io/node-mysql2/docs/examples\n+[docs-faq]: https://sidorares.github.io/node-mysql2/docs/faq\n+[docs-documentation]: https://sidorares.github.io/node-mysql2/docs/documentation\n+[docs-contributing]: https://sidorares.github.io/node-mysql2/docs/contributing/website\n+[coverage]: https://img.shields.io/codecov/c/github/sidorares/node-mysql2\n+[coverage-url]: https://app.codecov.io/github/sidorares/node-mysql2\n+[ci-url]: https://github.com/sidorares/node-mysql2/actions/workflows/ci-coverage.yml?query=branch%3Amaster\n+[ci-image]: https://img.shields.io/github/actions/workflow/status/sidorares/node-mysql2/ci-coverage.yml?event=push&style=flat&label=CI&branch=master\n \n-Work in progress.\n-Aims to be faster drop-in replacement driver for https://github.com/felixge/node-mysql\n+# MySQL2\n+\n+[![NPM Version][npm-image]][npm-url]\n+[![NPM Downloads][downloads-image]][downloads-url]\n+[![Node.js Version][node-version-image]][node-version-url]\n+[![GitHub Workflow Status (with event)][ci-image]][ci-url]\n+[![Codecov][coverage]][coverage-url]\n+[![License][license-image]][license-url]\n+\n+[English][docs-base] | [简体中文][docs-base-zh-CN] | [Português (BR)][docs-base-pt-BR]\n+\n+> MySQL client for Node.js with focus on performance. Supports prepared statements, non-utf8 encodings, binary log protocol, compression, ssl [much more][docs-documentation].\n+\n+**Table of Contents**\n+\n+- [History and Why MySQL2](#history-and-why-mysql2)\n+- [Installation](#installation)\n+- [Documentation](#documentation)\n+- [Acknowledgements](#acknowledgements)\n+- [Contributing](#contributing)\n+\n+## History and Why MySQL2\n+\n+MySQL2 project is a continuation of [MySQL-Native][mysql-native]. Protocol parser code was rewritten from scratch and api changed to match popular [Node MySQL][node-mysql]. MySQL2 team is working together with [Node MySQL][node-mysql] team to factor out shared code and move it under [mysqljs][mysqljs] organization.\n+\n+MySQL2 is mostly API compatible with [Node MySQL][node-mysql] and supports majority of features. MySQL2 also offers these additional features:\n+\n+- Faster / Better Performance\n+- [Prepared Statements][docs-prepared-statements]\n+- MySQL Binary Log Protocol\n+- [MySQL Server][docs-mysql-server]\n+- Extended support for Encoding and Collation\n+- [Promise Wrapper][docs-promise-wrapper]\n+- Compression\n+- SSL and [Authentication Switch][docs-authentication-switch]\n+- [Custom Streams][docs-streams]\n+- [Pooling][docs-qs-pooling]\n+\n+## Installation\n+\n+MySQL2 is free from native bindings and can be installed on Linux, Mac OS or Windows without any issues.\n+\n+```bash\n+npm install --save mysql2\n+```\n+\n+If you are using TypeScript, you will need to install `@types/node`.\n+\n+```bash\n+npm install --save-dev @types/node\n+```\n+\n+> For TypeScript documentation and examples, see [here][docs-typescript-docs].\n+\n+## Documentation\n+\n",
					"match": false,
					"packageHash": "c4190b3bacb64e269e093a1e0e9f767cbbce7bba5b38ebe7597a0f4c259aa4a4",
					"size": 224,
					"sourceHash": "735fd19fcc12984b9dcfe440cacb7e762b31bb4eef5d8ffa102261b91bbda846",
					"status": "content"
				},
				"examples/execute.js": {
					"match": false,
					"packageHash": "d8c1fe1d84c3b1506bf9167585f17e8cb6997896131f36a2e111a51fb48c0691",
					"size": 198,
					"status": "missing-in-source"
				},
				"examples/simple-select.js": {
					"match": false,
					"packageHash": "300156e24003ad9008af48b9bf47b931985f67a7a58c880754450750bec1c4b6",
					"size": 167,
					"status": "missing-in-source"
				},
				"index.js": {
					"diff": "--- published/index.js\n+++ rebuilt/index.js\n@@ -1,4 +1,77 @@\n-var Connection = require('./lib/connection');\n-module.exports.createConnection = function(opts) {\n-  return new Connection(opts);\n+'use strict';\n+\n+const SqlString = require('sqlstring');\n+\n+const ConnectionConfig = require('./lib/connection_config.js');\n+const parserCache = require('./lib/parsers/parser_cache.js');\n+\n+const Connection = require('./lib/connection.js');\n+\n+exports.createConnection = require('./lib/create_connection.js');\n+exports.connect = exports.createConnection;\n+exports.Connection = Connection;\n+exports.ConnectionConfig = ConnectionConfig;\n+\n+const Pool = require('./lib/pool.js');\n+const PoolCluster = require('./lib/pool_cluster.js');\n+const createPool = require('./lib/create_pool.js');\n+const createPoolCluster = require('./lib/create_pool_cluster.js');\n+\n+exports.createPool = createPool;\n+\n+exports.createPoolCluster = createPoolCluster;\n+\n+exports.createQuery = Connection.createQuery;\n+\n+exports.Pool = Pool;\n+\n+exports.PoolCluster = PoolCluster;\n+\n+exports.createServer = function (handler) {\n+  const Server = require('./lib/server.js');\n+  const s = new Server();\n+  if (handler) {\n+    s.on('connection', handler);\n+  }\n+  return s;\n+};\n+\n+exports.PoolConnection = require('./lib/pool_connection.js');\n+exports.authPlugins = require('./lib/auth_plugins');\n+exports.escape = SqlString.escape;\n+exports.escapeId = SqlString.escapeId;\n+exports.format = SqlString.format;\n+exports.raw = SqlString.raw;\n+\n+exports.__defineGetter__(\n+  'createConnectionPromise',\n+  () => require('./promise.js').createConnection\n+);\n+\n+exports.__defineGetter__(\n+  'createPoolPromise',\n+  () => require('./promise.js').createPool\n+);\n+\n+exports.__defineGetter__(\n+  'createPoolClusterPromise',\n+  () => require('./promise.js').createPoolCluster\n+);\n+\n+exports.__defineGetter__('Types', () => require('./lib/constants/types.js'));\n+\n+exports.__defineGetter__('Charsets', () =>\n+  require('./lib/constants/charsets.js')\n+);\n+\n+exports.__defineGetter__('CharsetToEncoding', () =>\n+  require('./lib/constants/charset_encodings.js')\n+);\n+\n+exports.setMaxParserCache = function (max) {\n+  parserCache.setMaxCache(max);\n+};\n+\n+exports.clearParserCache = function () {\n+  parserCache.clearCache();\n };\n",
					"match": false,
					"packageHash": "7ce9eedd5b8510b70fcecddee760505208d5eeb5a618396330a97d44448e1a13",
					"size": 131,
					"sourceHash": "1947f86b2e1ec51dbbd53cfadb034e776c27d282459d6229866033f9df8a1d88",
					"status": "content"
				},
				"lib/commands/command.js": {
					"diff": "--- published/lib/commands/command.js\n+++ rebuilt/lib/commands/command.js\n@@ -1,34 +1,54 @@\n-var EventEmitter = require('events').EventEmitter;\n-var util = require('util');\n+'use strict';\n \n-function Command() {\n-  EventEmitter.call(this);\n-  this.next = null;\n-}\n-util.inherits(Command, EventEmitter);\n+const EventEmitter = require('events').EventEmitter;\n+const Timers = require('timers');\n \n-Command.prototype.execute = function(packet, connection) {\n-  // TODO: hack\n-  if (!this.next) {\n-    connection._cmdBytesReceived = 0;\n-    this.next = this.start;\n+class Command extends EventEmitter {\n+  constructor() {\n+    super();\n+    this.next = null;\n   }\n \n-  if (packet && packet.isError()) {\n-    var err = packet.asError();\n-    this.emit('error', packet.asError());\n-    return true;\n+  // slow. debug only\n+  stateName() {\n+    const state = this.next;\n+    for (const i in this) {\n+      if (this[i] === state && i !== 'next') {\n+        return i;\n+      }\n+    }\n+    return 'unknown name';\n   }\n \n-  // TODO: don't return anything from execute, it's ugly and error-prone. Listen for 'end' event in connection\n-  this.next = this.next(packet, connection);\n-  if (this.next) {\n-    return false;\n-  } else {\n-    //console.log('done command!');\n+  execute(packet, connection) {\n+    if (!this.next) {\n+      this.next = this.start;\n+      connection._resetSequenceId();\n+    }\n+    if (packet && packet.isError()) {\n+      const err = packet.asError(connection.clientEncoding);\n+      err.sql = this.sql || this.query;\n+      if (this.queryTimeout) {\n+        Timers.clearTimeout(this.queryTimeout);\n+        this.queryTimeout = null;\n+      }\n+      if (this.onResult) {\n+        this.onResult(err);\n+        this.emit('end');\n+      } else {\n+        this.emit('error', err);\n+        this.emit('end');\n+      }\n+      return true;\n+    }\n+    // TODO: don't return anything from execute, it's ugly and error-prone. Listen for 'end' event in connection\n+    this.next = this.next(packet, connection);\n+    if (this.next) {\n+      return false;\n+    }\n     this.emit('end');\n     return true;\n   }\n-};\n+}\n \n module.exports = Command;\n",
					"match": false,
					"packageHash": "45bc36f649b0307ea1012118379ea09fd67b3618ac3410bb4a91b00877be8fef",
					"size": 800,
					"sourceHash": "f94521022f77fce0a0af821a063bc6ca5631f975dc167ee6bd9d4994c76be338",
					"status": "content"
				},
				"lib/commands/execute.js": {
					"diff": "--- published/lib/commands/execute.js\n+++ rebuilt/lib/commands/execute.js\n@@ -1,89 +1,112 @@\n-var Command  = require('./command');\n-var Packets  = require('../packets/index.js');\n-var util    = require('util');\n-\n-function Execute(sql, parameters, callback)\n-{\n-  Command.call(this);\n-  this.query = sql;\n-  this.onResult = callback; // TODO check felixge multi-result api\n-  this.fieldCount = 0;\n-  this.parameterCount = 0;\n-  this.fields = [];\n-  this.parameterDefinitions = [];\n-\n-  this.parameters = parameters;\n-  this.rows   = [];\n-  this.id = 0;\n-}\n-util.inherits(Execute, Command);\n+'use strict';\n \n-Execute.prototype.start = function(packet, connection) {\n-  var id = connection.statements[this.sql];\n-  if (!id) { // prepare first\n-     connection.writePacket(new Packets.PrepareStatement(this.query).toPacket(1));\n-  } else {\n-    return this.doExecute(connection);\n+const Command = require('./command.js');\n+const Query = require('./query.js');\n+const Packets = require('../packets/index.js');\n+\n+const getBinaryParser = require('../parsers/binary_parser.js');\n+const getStaticBinaryParser = require('../parsers/static_binary_parser.js');\n+\n+class Execute extends Command {\n+  constructor(options, callback) {\n+    super();\n+    this.statement = options.statement;\n+    this.sql = options.sql;\n+    this.values = options.values;\n+    this.onResult = callback;\n+    this.parameters = options.values;\n+    this.insertId = 0;\n+    this.timeout = options.timeout;\n+    this.queryTimeout = null;\n+    this._rows = [];\n+    this._fields = [];\n+    this._result = [];\n+    this._fieldCount = 0;\n+    this._rowParser = null;\n+    this._executeOptions = options;\n+    this._resultIndex = 0;\n+    this._localStream = null;\n+    this._unpipeStream = function () {};\n+    this._streamFactory = options.infileStreamFactory;\n+    this._connection = null;\n   }\n-  return Execute.prototype.resultsetHeader;\n-};\n \n-Execute.prototype.resultsetHeader = function(packet) {\n-  var header = new Packets.PreparedStatementHeader(packet);\n-  this.fieldCount     = header.fieldCount;\n-  this.parameterCount = header.parameterCount;\n-  if (this.parameterCount > 0)\n-    return Execute.prototype.readParameter;\n-  else if (this.fieldCount > 0)\n-    return Execute.prototype.readField;\n-  else\n-    return execute.prototype.parametersEOF;\n-};\n-\n-Execute.prototype.readParameter = function(packet) {\n-  var def = new Packets.ColumnDefinition(packet);\n-  this.parameterDefinitions.push(def);\n-  if (this.parameterDefinitions.length == this.parameterCount)\n-    return Execute.prototype.parametersEOF;\n-  return this.doExecute();\n-};\n-\n-Execute.prototype.readField = function(packet) {\n-  var def = new Packets.ColumnDefinition(packet);\n-  this.fields.push(def);\n-  if (this.fields.length == this.fieldCount) {\n-    return Execute.prototype.fieldsEOF;\n+  buildParserFromFields(fields, connection) {\n+    if (this.options.disableEval) {\n+      return getStaticBinaryParser(fields, this.options, connection.config);\n+    }\n+\n+    return getBinaryParser(fields, this.options, connection.config);\n+  }\n+\n+  start(packet, connection) {\n+    this._connection = connection;\n+    this.options = Object.assign({}, connection.config, this._executeOptions);\n+    this._setTimeout();\n",
					"match": false,
					"packageHash": "c1d72d2322775afbe2e5ae9b284621f0eafe0a13b90c8ce71c998a38beba98ea",
					"size": 2453,
					"sourceHash": "172f8b5e32ab499f98160aa279935c42b5c4d8093361a00f87bf3874c4ec85f1",
					"status": "content"
				},
				"lib/commands/handshake.js": {
					"match": false,
					"packageHash": "b86135f99a9acb80d69e00ad9a705982adbfb5f770256f76bf4bda0db3247f77",
					"size": 926,
					"status": "missing-in-source"
				},
				"lib/commands/index.js": {
					"diff": "--- published/lib/commands/index.js\n+++ rebuilt/lib/commands/index.js\n@@ -1,4 +1,27 @@\n-\"handshake query execute\".split(' ').forEach(function(name) {\n-  var ctor = require('./' + name);\n-  module.exports[ctor.name] = ctor;\n-});\n+'use strict';\n+\n+const ClientHandshake = require('./client_handshake.js');\n+const ServerHandshake = require('./server_handshake.js');\n+const Query = require('./query.js');\n+const Prepare = require('./prepare.js');\n+const CloseStatement = require('./close_statement.js');\n+const Execute = require('./execute.js');\n+const Ping = require('./ping.js');\n+const RegisterSlave = require('./register_slave.js');\n+const BinlogDump = require('./binlog_dump.js');\n+const ChangeUser = require('./change_user.js');\n+const Quit = require('./quit.js');\n+\n+module.exports = {\n+  ClientHandshake,\n+  ServerHandshake,\n+  Query,\n+  Prepare,\n+  CloseStatement,\n+  Execute,\n+  Ping,\n+  RegisterSlave,\n+  BinlogDump,\n+  ChangeUser,\n+  Quit,\n+};\n",
					"match": false,
					"packageHash": "f90669395830655dda1bf2944bdd8ae220c441869bf88680f90dd20e7a998e8e",
					"size": 137,
					"sourceHash": "63e2165286ffc366ebda65d30787d799988d981d9179ae1a04252374e99debf2",
					"status": "content"
				},
				"lib/commands/query.js": {
					"diff": "--- published/lib/commands/query.js\n+++ rebuilt/lib/commands/query.js\n@@ -1,87 +1,366 @@\n-var Command  = require('./command');\n-var Packets  = require('../packets/index.js');\n-var util    = require('util');\n-\n-function Query(sql, callback)\n-{\n-  Command.call(this);\n-  this.query = sql;\n-  this.onResult = callback; // TODO check felixge multi-result api\n-  this.fieldCount = 0;\n-  this.insertId   = 0;\n-  this.fields     = [];\n-  this.rows       = [];\n-}\n-util.inherits(Query, Command);\n+'use strict';\n \n-Query.prototype.start = function(packet, connection) {\n-  var cmdPacket = new Packets.Query(this.query);\n-  connection.writePacket(cmdPacket.toPacket(1));\n-  return Query.prototype.resultsetHeader;\n-};\n-\n-Query.prototype.resultsetHeader = function(packet) {\n-  var rs = new Packets.ResultSetHeader(packet);\n-  this.fieldCount = rs.fieldCount;\n-  this.insertId = rs.insertId;\n-  if (this.fieldCount === 0) {\n-    if (this.onResult)\n-      this.onResult(null, [], []);\n-    return null;\n+const process = require('process');\n+const Timers = require('timers');\n+\n+const Readable = require('stream').Readable;\n+\n+const Command = require('./command.js');\n+const Packets = require('../packets/index.js');\n+const getTextParser = require('../parsers/text_parser.js');\n+const staticParser = require('../parsers/static_text_parser.js');\n+const ServerStatus = require('../constants/server_status.js');\n+\n+const EmptyPacket = new Packets.Packet(0, Buffer.allocUnsafe(4), 0, 4);\n+\n+// http://dev.mysql.com/doc/internals/en/com-query.html\n+class Query extends Command {\n+  constructor(options, callback) {\n+    super();\n+    this.sql = options.sql;\n+    this.values = options.values;\n+    this._queryOptions = options;\n+    this.namedPlaceholders = options.namedPlaceholders || false;\n+    this.onResult = callback;\n+    this.timeout = options.timeout;\n+    this.queryTimeout = null;\n+    this._fieldCount = 0;\n+    this._rowParser = null;\n+    this._fields = [];\n+    this._rows = [];\n+    this._receivedFieldsCount = 0;\n+    this._resultIndex = 0;\n+    this._localStream = null;\n+    this._unpipeStream = function () {};\n+    this._streamFactory = options.infileStreamFactory;\n+    this._connection = null;\n   }\n-  return Query.prototype.readField;\n-};\n \n-Query.prototype.readField = function(packet) {\n-  var field = new Packets.ColumnDefinition(packet);\n-  this.fields.push(field);\n-  if (this.fields.length == this.fieldCount)\n-    return Query.prototype.fieldsEOF;\n-  return Query.prototype.readField;\n-};\n-\n-Query.prototype.fieldsEOF = function(packet) {\n-  // check EOF\n-  if (!packet.isEOF())\n-    throw \"Expected EOF packet\";\n-  // PROFILING\n-  this._fieldsEOFTime = process.hrtime();\n-  return Query.prototype.row;\n-};\n-\n-function Row(columns) {\n-  this.id = columns[0];\n-  this.name = columns[1];\n-}\n+  then() {\n+    const err =\n+      \"You have tried to call .then(), .catch(), or invoked await on the result of query that is not a promise, which is a programming error. Try calling con.promise().query(), or require('mysql2/promise') instead of 'mysql2' for a promise-compatible version of the query interface. To learn how to use async/await or Promises check out documentation at https://sidorares.github.io/node-mysql2/docs#using-promise-wrapper, or the mysql2 documentation at https://sidorares.github.io/node-mysql2/docs/documentation/promise-wrapper\";\n+    // eslint-disable-next-line\n+    console.log(err);\n+    throw new Error(err);\n+  }\n",
					"match": false,
					"packageHash": "bea807ad18d395a3b217e84ee9fbf57670243708c95fa4830c1270ab827a7816",
					"size": 2238,
					"sourceHash": "0e0cac86bcffd0b533061d28587ea0a2f9a669f82199c82cf107f94d6b756887",
					"status": "content"
				},
				"lib/connection.js": {
					"diff": "--- published/lib/connection.js\n+++ rebuilt/lib/connection.js\n@@ -1,120 +1,12 @@\n-var _            = require('underscore');\n-var net          = require('net');\n+'use strict';\n \n-var PacketParser = require('./packet_parser');\n-var Commands     = require('./commands/index.js');\n+const BaseConnection = require('./base/connection.js');\n \n-function Connection(opts)\n-{\n-  // params are encoded as url string\n-  if (typeof opts == 'string')\n-  {\n-    var url = opts;\n-    opts = {};\n-    var params = require('url').parse(url, true);\n-    opts.host = params.host;\n-    opts.database = params.pathname.substring(1);\n-    var userPass = params.auth.split(':');\n-    opts.user = userPass[0];\n-    opts.password = userPass[1];\n-    if (params.query.flags)\n-      opts.flags = params.query.flags.split(',');\n-    _.extend(opts, _.pick(params.query, 'socketPath', 'charset', 'timesone', 'insecureAuth', 'typeCast', 'supportBigNumbers', 'debug'));\n+class Connection extends BaseConnection {\n+  promise(promiseImpl) {\n+    const PromiseConnection = require('./promise/connection.js');\n+    return new PromiseConnection(this, promiseImpl);\n   }\n-  // fill defaults\n-  // if no params, connect to /var/lib/mysql/mysql.sock ( /tmp/mysql.sock on OSX )\n-  // if host is given, connect to host:3306\n-\n-  if (!opts.stream) {\n-    if (opts.socketPath)\n-      this.stream = net.connect(opts.socketPath);\n-    else\n-      this.stream = net.connect(opts.port, opts.host);\n-  } else {\n-    this.stream = stream;\n-  }\n-  this.opts = opts;\n-  this.commands = [];\n-  this.statements = {};\n-  this._cmdBytesReceived = 0;\n-\n-  var connection = this;\n-  var cnt = 0;\n-  //var startTime = process.hrtime();\n-  var handlePacket = function(packet) {\n-    if (packet) {\n-      connection._cmdBytesReceived += packet.payload.length + 4;\n-    }\n-    //if (packet)\n-    //  console.log('PACKET:', packet.payload, packet.payload.length);\n-    var done = connection.commands[0].execute(packet, connection);\n-    if (done) {\n-      connection.commands.shift();\n-      if (connection.commands.length !== 0)\n-        handlePacket(); // TODO: process.nextTick ?\n-    }\n-  };\n-  this.packetParser = new PacketParser(handlePacket);\n-  //this.stream.pipe(this.packetParser);\n-  this.stream.resume();\n-  var cnt1 = 0;\n-  // TODO: check stream instanceof net.Stream, fallback if not\n-  this.stream.ondata = function(data, start, end) {\n-    connection.packetParser._write(data.slice(start, end));\n-  };\n-  this.addCommand(new Commands.Handshake());\n }\n \n-Connection.prototype.writePacket = function(packet) {\n-  packet.writeHeader();\n-  var data = packet.payload;\n-  this.stream.write(data);\n-  //console.log('<<< ', packet.payload);\n-  //console.log('<<< ', [packet.payload.toString()]);\n-};\n-\n-Connection.prototype.addCommand = function(cmd) {\n-  this.commands.push(cmd);\n-  if (this.commands.length == 1) {\n-    this.commands[0].execute(null, this);\n-  }\n-  return cmd;\n-};\n-\n-Connection.prototype.query = function(sql, callback) {\n-  return this.addCommand(new Commands.Query(sql, callback));\n-};\n-\n-Connection.prototype.execute = function(sql, params, callback) {\n-  return this.addCommand(new Commands.Execute(sql, params, callback));\n-};\n-\n",
					"match": false,
					"packageHash": "ffe1cfb1bfe87bb38b83414380e11d8adcf6443a95220ee525cd3c5a35fafae9",
					"size": 3517,
					"sourceHash": "3282d2cb7af3032699ff7690c2451cd92d34871421bb8f53af17f553056b9b6a",
					"status": "content"
				},
				"lib/constants.js": {
					"match": false,
					"packageHash": "868d916ecca0bbf67522b7ea9016e688e4ba4d744027457c67be88c49fdb71c7",
					"size": 1122,
					"status": "missing-in-source"
				},
				"lib/packet_parser.js": {
					"diff": "--- published/lib/packet_parser.js\n+++ rebuilt/lib/packet_parser.js\n@@ -1,97 +1,195 @@\n-var Writable = require('stream').Writable || require('readable-stream').Writable;\n-var Packet   = require('./packets/packet');\n+'use strict';\n \n-// as this is very low level parser, EventEmitter is not used\n-// onPayload(sequenceId, payload) is called for each mysql packet\n-function PacketParser(onPayload)\n-{\n-  Writable.call(this);\n-\n-  // array of last payload chunks\n-  // only used when corrent payload is not complete\n-  this.buffer = [];\n-  // total length of chunks on buffer\n-  this.bufferLength = 0;\n-  this.headerLen = 0;\n-  this.headerBuff = Buffer(4);\n-\n-  this.state = 'head0';\n-\n-  // expected payload length\n-  this.length = 0;\n-  this.sequenceId = 0;\n-  this.onPayload = onPayload;\n+const Packet = require('./packets/packet.js');\n+\n+const MAX_PACKET_LENGTH = 16777215;\n+\n+function readPacketLength(b, off) {\n+  const b0 = b[off];\n+  const b1 = b[off + 1];\n+  const b2 = b[off + 2];\n+  if (b1 + b2 === 0) {\n+    return b0;\n+  }\n+  return b0 + (b1 << 8) + (b2 << 16);\n }\n-PacketParser.prototype = Object.create(\n-  Writable.prototype, { constructor: { value: PacketParser }});\n \n+class PacketParser {\n+  constructor(onPacket, packetHeaderLength) {\n+    // 4 for normal packets, 7 for comprssed protocol packets\n+    if (typeof packetHeaderLength === 'undefined') {\n+      packetHeaderLength = 4;\n+    }\n+    // array of last payload chunks\n+    // only used when current payload is not complete\n+    this.buffer = [];\n+    // total length of chunks on buffer\n+    this.bufferLength = 0;\n+    this.packetHeaderLength = packetHeaderLength;\n+    // incomplete header state: number of header bytes received\n+    this.headerLen = 0;\n+    // expected payload length\n+    this.length = 0;\n+    this.largePacketParts = [];\n+    this.firstPacketSequenceId = 0;\n+    this.onPacket = onPacket;\n+    this.execute = PacketParser.prototype.executeStart;\n+    this._flushLargePacket =\n+      packetHeaderLength === 7\n+        ? this._flushLargePacket7\n+        : this._flushLargePacket4;\n+  }\n \n-PacketParser.prototype._write = function(chunk, encoding, callback) {\n-  //console.log('>>> ', chunk);\n-  //console.log('>>> ', [chunk.toString()]);\n-  //var p = new Packet(0, chunk);\n-  //console.log('==== WRITE ===', chunk.length, this.state);\n-  //console.log(chunk);\n-  var chunkOffset = 0;\n-  while (chunkOffset < chunk.length) {\n-    //console.log(\"===================\", chunk.length, chunkOffset, this.state);\n-    //console.log(chunk.slice(chunkOffset));\n-    if (this.state == 'head0' && (chunk.length - chunkOffset) > 3) {\n-      this.length = chunk[chunkOffset] + (chunk[chunkOffset+1] << 8) + (chunk[chunkOffset+2] << 16);\n-      this.sequenceId = chunk[chunkOffset+3];\n-      var packetLength = this.length + 4;\n-      // TODO: second case seems to be most important\n-      // for example, short select with one row result in 6 packets in one chunk\n-      // worth to swap first nd second\n-      if (chunk.length - chunkOffset == packetLength) {\n-        this.onPayload(new Packet(this.sequenceId, chunk.slice(chunkOffset + 4)));\n-        return;\n-      } else if (chunk.length - chunkOffset > packetLength) { // more than one packet in chunk\n-        this.onPayload(new Packet(this.sequenceId, chunk.slice(chunkOffset + 4, chunkOffset + packetLength)));\n-        chunkOffset += packetLength;\n-      } else { // payload is incomplete\n-        this.buffer = [chunk.slice(chunkOffset + 4)];\n-        this.bufferLength = chunk.length - chunkOffset - 4;\n-        this.state = 'payload';\n-        return;\n-      }\n-    } else if (this.state == 'payload') {\n-      var remainingPayload = this.length - this.bufferLength;\n",
					"match": false,
					"packageHash": "535796ab5deb8e0c8bdad64090ace98630f42b2c513caa8c314d12ab7a76ea40",
					"size": 3774,
					"sourceHash": "ceb1db3229dc07eefee45cb57761d5995fc91c7face59da3240c1ecd6f95527f",
					"status": "content"
				},
				"lib/packets/column_definition.js": {
					"diff": "--- published/lib/packets/column_definition.js\n+++ rebuilt/lib/packets/column_definition.js\n@@ -1,22 +1,291 @@\n-//var constants = require('../constants');\n-var Packet = require('../packets/packet');\n+'use strict';\n \n-function ColumnDefinition(packet)\n-{\n-  this.catalog  = packet.readLengthCodedString();\n-  this.schema   = packet.readLengthCodedString();\n-  this.table    = packet.readLengthCodedString();\n-  this.orgTable = packet.readLengthCodedString();\n-  this.name     = packet.readLengthCodedString();\n-  this.orgName  = packet.readLengthCodedString();\n-  packet.skip(1); //  length of the following fields (always 0x0c)\n-  this.characterSet = packet.readInt16();\n-  this.columnLength = packet.readInt32();\n-  this.columnType   = packet.readInt8();\n-  this.flags        = packet.readInt16();\n-  this.decimals     = packet.readInt8();\n+const Packet = require('../packets/packet');\n+const StringParser = require('../parsers/string');\n+const CharsetToEncoding = require('../constants/charset_encodings.js');\n+\n+const fields = ['catalog', 'schema', 'table', 'orgTable', 'name', 'orgName'];\n+\n+// creating JS string is relatively expensive (compared to\n+// reading few bytes from buffer) because all string properties\n+// except for name are unlikely to be used we postpone\n+// string conversion until property access\n+//\n+// TODO: watch for integration benchmarks (one with real network buffer)\n+// there could be bad side effect as keeping reference to a buffer makes it\n+// sit in the memory longer (usually until final .query() callback)\n+// Latest v8 perform much better in regard to bufferer -> string conversion,\n+// at some point of time this optimisation might become unnecessary\n+// see https://github.com/sidorares/node-mysql2/pull/137\n+//\n+class ColumnDefinition {\n+  constructor(packet, clientEncoding) {\n+    this._buf = packet.buffer;\n+    this._clientEncoding = clientEncoding;\n+    this._catalogLength = packet.readLengthCodedNumber();\n+    this._catalogStart = packet.offset;\n+    packet.offset += this._catalogLength;\n+    this._schemaLength = packet.readLengthCodedNumber();\n+    this._schemaStart = packet.offset;\n+    packet.offset += this._schemaLength;\n+    this._tableLength = packet.readLengthCodedNumber();\n+    this._tableStart = packet.offset;\n+    packet.offset += this._tableLength;\n+    this._orgTableLength = packet.readLengthCodedNumber();\n+    this._orgTableStart = packet.offset;\n+    packet.offset += this._orgTableLength;\n+    // name is always used, don't make it lazy\n+    const _nameLength = packet.readLengthCodedNumber();\n+    const _nameStart = packet.offset;\n+    packet.offset += _nameLength;\n+    this._orgNameLength = packet.readLengthCodedNumber();\n+    this._orgNameStart = packet.offset;\n+    packet.offset += this._orgNameLength;\n+    packet.skip(1); //  length of the following fields (always 0x0c)\n+    this.characterSet = packet.readInt16();\n+    this.encoding = CharsetToEncoding[this.characterSet];\n+    this.name = StringParser.decode(\n+      this._buf,\n+      this.encoding === 'binary' ? this._clientEncoding : this.encoding,\n+      _nameStart,\n+      _nameStart + _nameLength\n+    );\n+    this.columnLength = packet.readInt32();\n+    this.columnType = packet.readInt8();\n+    this.type = this.columnType;\n+    this.flags = packet.readInt16();\n+    this.decimals = packet.readInt8();\n+  }\n+\n+  inspect() {\n+    return {\n+      catalog: this.catalog,\n+      schema: this.schema,\n+      name: this.name,\n+      orgName: this.orgName,\n+      table: this.table,\n+      orgTable: this.orgTable,\n+      characterSet: this.characterSet,\n+      encoding: this.encoding,\n+      columnLength: this.columnLength,\n+      type: this.columnType,\n+      flags: this.flags,\n+      decimals: this.decimals,\n+    };\n+  }\n+\n+  [Symbol.for('nodejs.util.inspect.custom')](depth, inspectOptions, inspect) {\n+    const Types = require('../constants/types.js');\n+    const typeNames = [];\n+    for (const t in Types) {\n+      typeNames[Types[t]] = t;\n",
					"match": false,
					"packageHash": "4e9553a763f51e76cc9545925f8162052397949ec5b043c69005097a932b6fe8",
					"size": 755,
					"sourceHash": "d491dfa7fad8f7a9e7874c8a983dccb867fa8b2bbf01e18cf84a081528c329d8",
					"status": "content"
				},
				"lib/packets/handshake.js": {
					"diff": "--- published/lib/packets/handshake.js\n+++ rebuilt/lib/packets/handshake.js\n@@ -1,23 +1,112 @@\n-//var constants = require('../constants')\n+'use strict';\n \n-function Handshake(packet)\n-{\n-  this.version         = packet.readInt8();\n-  this.serverVersion   = packet.readNullTerminatedString();\n-  this.connectionId    = packet.readInt32();\n-  this.authPluginData1 = packet.readBuffer(8);\n-  packet.skip(1);\n-  this.capabilityFlags = packet.readInt16();\n-  if (packet.haveMoreData()) {\n-    this.characterSet = packet.readInt8();\n-    this.statusFlags  = packet.readInt16();\n-    // upper 2 bytes\n-    this.capabilityFlags += packet.readInt16() << 16;\n-    this.authPluginDataLength = packet.readInt8();\n+const Packet = require('../packets/packet');\n+const ClientConstants = require('../constants/client.js');\n+\n+// https://dev.mysql.com/doc/internals/en/connection-phase-packets.html#packet-Protocol::Handshake\n+\n+class Handshake {\n+  constructor(args) {\n+    this.protocolVersion = args.protocolVersion;\n+    this.serverVersion = args.serverVersion;\n+    this.capabilityFlags = args.capabilityFlags;\n+    this.connectionId = args.connectionId;\n+    this.authPluginData1 = args.authPluginData1;\n+    this.authPluginData2 = args.authPluginData2;\n+    this.characterSet = args.characterSet;\n+    this.statusFlags = args.statusFlags;\n+    this.authPluginName = args.authPluginName;\n+  }\n+\n+  setScrambleData(cb) {\n+    require('crypto').randomBytes(20, (err, data) => {\n+      if (err) {\n+        cb(err);\n+        return;\n+      }\n+      this.authPluginData1 = data.slice(0, 8);\n+      this.authPluginData2 = data.slice(8, 20);\n+      cb();\n+    });\n+  }\n+\n+  toPacket(sequenceId) {\n+    const length = 68 + Buffer.byteLength(this.serverVersion, 'utf8');\n+    const buffer = Buffer.alloc(length + 4, 0); // zero fill, 10 bytes filler later needs to contain zeros\n+    const packet = new Packet(sequenceId, buffer, 0, length + 4);\n+    packet.offset = 4;\n+    packet.writeInt8(this.protocolVersion);\n+    packet.writeString(this.serverVersion, 'cesu8');\n+    packet.writeInt8(0);\n+    packet.writeInt32(this.connectionId);\n+    packet.writeBuffer(this.authPluginData1);\n+    packet.writeInt8(0);\n+    const capabilityFlagsBuffer = Buffer.allocUnsafe(4);\n+    capabilityFlagsBuffer.writeUInt32LE(this.capabilityFlags, 0);\n+    packet.writeBuffer(capabilityFlagsBuffer.slice(0, 2));\n+    packet.writeInt8(this.characterSet);\n+    packet.writeInt16(this.statusFlags);\n+    packet.writeBuffer(capabilityFlagsBuffer.slice(2, 4));\n+    packet.writeInt8(21); // authPluginDataLength\n     packet.skip(10);\n+    packet.writeBuffer(this.authPluginData2);\n+    packet.writeInt8(0);\n+    packet.writeString('mysql_native_password', 'latin1');\n+    packet.writeInt8(0);\n+    return packet;\n+  }\n+\n+  static fromPacket(packet) {\n+    const args = {};\n+    args.protocolVersion = packet.readInt8();\n+    args.serverVersion = packet.readNullTerminatedString('cesu8');\n+    args.connectionId = packet.readInt32();\n+    args.authPluginData1 = packet.readBuffer(8);\n+    packet.skip(1);\n+    const capabilityFlagsBuffer = Buffer.allocUnsafe(4);\n+    capabilityFlagsBuffer[0] = packet.readInt8();\n+    capabilityFlagsBuffer[1] = packet.readInt8();\n+    if (packet.haveMoreData()) {\n+      args.characterSet = packet.readInt8();\n+      args.statusFlags = packet.readInt16();\n+      // upper 2 bytes\n+      capabilityFlagsBuffer[2] = packet.readInt8();\n+      capabilityFlagsBuffer[3] = packet.readInt8();\n+      args.capabilityFlags = capabilityFlagsBuffer.readUInt32LE(0);\n+      if (args.capabilityFlags & ClientConstants.PLUGIN_AUTH) {\n+        args.authPluginDataLength = packet.readInt8();\n+      } else {\n+        args.authPluginDataLength = 0;\n+        packet.skip(1);\n+      }\n+      packet.skip(10);\n",
					"match": false,
					"packageHash": "6daf7bc162fe5ed470aed19cbd5c723a20da600b2abedcd19211331a43b8e804",
					"size": 738,
					"sourceHash": "3fefa7e904cfe55977f14e1283af62a013eca95cf6e4160d55dbddb1bbb0c55f",
					"status": "content"
				},
				"lib/packets/handshake_response.js": {
					"diff": "--- published/lib/packets/handshake_response.js\n+++ rebuilt/lib/packets/handshake_response.js\n@@ -1,67 +1,144 @@\n-var _ = require('underscore');\n-var constants = require('../constants');\n-var crypto = require('crypto');\n-var Packet = require('../packets/packet');\n-\n-function sha1(msg, msg1, msg2) {\n-  var hash = crypto.createHash('sha1');\n-  hash.update(msg);\n-  if (msg1)\n-    hash.update(msg1);\n-  if (msg2)\n-    hash.update(msg2);\n-  return hash.digest('binary');\n-}\n+'use strict';\n \n-function xor(a, b) {\n-  if (!Buffer.isBuffer(a))\n-    a = new Buffer(a, 'binary');\n-  if (!Buffer.isBuffer(b))\n-    b = new Buffer(b, 'binary');\n-  var result = new Buffer(a.length);\n-  for (var i = 0; i < a.length; i++) {\n-    result[i] = (a[i] ^ b[i]);\n+const ClientConstants = require('../constants/client.js');\n+const CharsetToEncoding = require('../constants/charset_encodings.js');\n+const Packet = require('../packets/packet.js');\n+\n+const auth41 = require('../auth_41.js');\n+\n+class HandshakeResponse {\n+  constructor(handshake) {\n+    this.user = handshake.user || '';\n+    this.database = handshake.database || '';\n+    this.password = handshake.password || '';\n+    this.passwordSha1 = handshake.passwordSha1;\n+    this.authPluginData1 = handshake.authPluginData1;\n+    this.authPluginData2 = handshake.authPluginData2;\n+    this.compress = handshake.compress;\n+    this.clientFlags = handshake.flags;\n+    // TODO: pre-4.1 auth support\n+    let authToken;\n+    if (this.passwordSha1) {\n+      authToken = auth41.calculateTokenFromPasswordSha(\n+        this.passwordSha1,\n+        this.authPluginData1,\n+        this.authPluginData2\n+      );\n+    } else {\n+      authToken = auth41.calculateToken(\n+        this.password,\n+        this.authPluginData1,\n+        this.authPluginData2\n+      );\n+    }\n+    this.authToken = authToken;\n+    this.charsetNumber = handshake.charsetNumber;\n+    this.encoding = CharsetToEncoding[handshake.charsetNumber];\n+    this.connectAttributes = handshake.connectAttributes;\n   }\n-  return result;\n-}\n \n-function token(password, scramble1, scramble2) {\n-  var scramble = Buffer(scramble1.toString('binary') + scramble2.toString('binary'));\n-  if (!password) {\n-    return new Buffer(0);\n+  serializeResponse(buffer) {\n+    const isSet = (flag) => this.clientFlags & ClientConstants[flag];\n+    const packet = new Packet(0, buffer, 0, buffer.length);\n+    packet.offset = 4;\n+    packet.writeInt32(this.clientFlags);\n+    packet.writeInt32(0); // max packet size. todo: move to config\n+    packet.writeInt8(this.charsetNumber);\n+    packet.skip(23);\n+    const encoding = this.encoding;\n+    packet.writeNullTerminatedString(this.user, encoding);\n+    let k;\n+    if (isSet('PLUGIN_AUTH_LENENC_CLIENT_DATA')) {\n+      packet.writeLengthCodedNumber(this.authToken.length);\n+      packet.writeBuffer(this.authToken);\n+    } else if (isSet('SECURE_CONNECTION')) {\n+      packet.writeInt8(this.authToken.length);\n+      packet.writeBuffer(this.authToken);\n+    } else {\n+      packet.writeBuffer(this.authToken);\n+      packet.writeInt8(0);\n+    }\n+    if (isSet('CONNECT_WITH_DB')) {\n+      packet.writeNullTerminatedString(this.database, encoding);\n+    }\n+    if (isSet('PLUGIN_AUTH')) {\n+      // TODO: pass from config\n+      packet.writeNullTerminatedString('mysql_native_password', 'latin1');\n+    }\n+    if (isSet('CONNECT_ATTRS')) {\n+      const connectAttributes = this.connectAttributes || {};\n",
					"match": false,
					"packageHash": "011573c9d1b3e4329ffee482b2ca542bdd818096650a453ea46e5a22d9716d4f",
					"size": 1872,
					"sourceHash": "7b6d4ab7ec0edb08ae3ab8fd299b50f77057bce4828014ea53a5c32dede68f53",
					"status": "content"
				},
				"lib/packets/index.js": {
					"diff": "--- published/lib/packets/index.js\n+++ rebuilt/lib/packets/index.js\n@@ -1,4 +1,152 @@\n-\"handshake handshake_response query resultset_header column_definition text_row prepare_statement prepared_statement_header\".split(' ').forEach(function(name) {\n-  var ctor = require('./' + name);\n-  module.exports[ctor.name] = ctor;\n+// This file was modified by Oracle on June 1, 2021.\n+// A utility method was introduced to generate an Error instance from a\n+// binary server packet.\n+// Modifications copyright (c) 2021, Oracle and/or its affiliates.\n+\n+// This file was modified by Oracle on September 21, 2021.\n+// The new AuthNextFactor packet is now available.\n+// Modifications copyright (c) 2021, Oracle and/or its affiliates.\n+\n+'use strict';\n+\n+const process = require('process');\n+\n+const AuthNextFactor = require('./auth_next_factor');\n+const AuthSwitchRequest = require('./auth_switch_request');\n+const AuthSwitchRequestMoreData = require('./auth_switch_request_more_data');\n+const AuthSwitchResponse = require('./auth_switch_response');\n+const BinaryRow = require('./binary_row');\n+const BinlogDump = require('./binlog_dump');\n+const ChangeUser = require('./change_user');\n+const CloseStatement = require('./close_statement');\n+const ColumnDefinition = require('./column_definition');\n+const Execute = require('./execute');\n+const Handshake = require('./handshake');\n+const HandshakeResponse = require('./handshake_response');\n+const PrepareStatement = require('./prepare_statement');\n+const PreparedStatementHeader = require('./prepared_statement_header');\n+const Query = require('./query');\n+const RegisterSlave = require('./register_slave');\n+const ResultSetHeader = require('./resultset_header');\n+const SSLRequest = require('./ssl_request');\n+const TextRow = require('./text_row');\n+\n+const ctorMap = {\n+  AuthNextFactor,\n+  AuthSwitchRequest,\n+  AuthSwitchRequestMoreData,\n+  AuthSwitchResponse,\n+  BinaryRow,\n+  BinlogDump,\n+  ChangeUser,\n+  CloseStatement,\n+  ColumnDefinition,\n+  Execute,\n+  Handshake,\n+  HandshakeResponse,\n+  PrepareStatement,\n+  PreparedStatementHeader,\n+  Query,\n+  RegisterSlave,\n+  ResultSetHeader,\n+  SSLRequest,\n+  TextRow,\n+};\n+Object.entries(ctorMap).forEach(([name, ctor]) => {\n+  module.exports[name] = ctor;\n+  // monkey-patch it to include name if debug is on\n+  if (process.env.NODE_DEBUG) {\n+    if (ctor.prototype.toPacket) {\n+      const old = ctor.prototype.toPacket;\n+      ctor.prototype.toPacket = function () {\n+        const p = old.call(this);\n+        p._name = name;\n+        return p;\n+      };\n+    }\n+  }\n });\n+\n+// simple packets:\n+const Packet = require('./packet');\n+exports.Packet = Packet;\n+\n+class OK {\n+  static toPacket(args, encoding) {\n+    args = args || {};\n+    const affectedRows = args.affectedRows || 0;\n+    const insertId = args.insertId || 0;\n+    const serverStatus = args.serverStatus || 0;\n+    const warningCount = args.warningCount || 0;\n+    const message = args.message || '';\n+\n+    let length = 9 + Packet.lengthCodedNumberLength(affectedRows);\n+    length += Packet.lengthCodedNumberLength(insertId);\n+\n+    const buffer = Buffer.allocUnsafe(length);\n+    const packet = new Packet(0, buffer, 0, length);\n+    packet.offset = 4;\n+    packet.writeInt8(0);\n+    packet.writeLengthCodedNumber(affectedRows);\n+    packet.writeLengthCodedNumber(insertId);\n+    packet.writeInt16(serverStatus);\n+    packet.writeInt16(warningCount);\n+    packet.writeString(message, encoding);\n",
					"match": false,
					"packageHash": "d1807191bca6dea5ab34a68d57941ab2358a78b697b3616b0a81cb81ddeaa0f2",
					"size": 236,
					"sourceHash": "c5ef7d814e06572bb4135e40282829a6da2d4dce38a413ef059a27dd2fbfbdba",
					"status": "content"
				},
				"lib/packets/packet.js": {
					"diff": "--- published/lib/packets/packet.js\n+++ rebuilt/lib/packets/packet.js\n@@ -1,190 +1,931 @@\n-//var BigNumber = require(\"bignumber.js\");\n-\n-function Packet(id, payload)\n-{\n-  this.sequenceId = id;\n-  this.payload = payload;\n-  this.offset = 0;\n+// This file was modified by Oracle on June 1, 2021.\n+// A comment describing some changes in the strict default SQL mode regarding\n+// non-standard dates was introduced.\n+// Modifications copyright (c) 2021, Oracle and/or its affiliates.\n+\n+'use strict';\n+\n+const ErrorCodeToName = require('../constants/errors.js');\n+const NativeBuffer = require('buffer').Buffer;\n+const Long = require('long');\n+const StringParser = require('../parsers/string.js');\n+const Types = require('../constants/types.js');\n+const INVALID_DATE = new Date(NaN);\n+\n+// this is nearly duplicate of previous function so generated code is not slower\n+// due to \"if (dateStrings)\" branching\n+const pad = '000000000000';\n+function leftPad(num, value) {\n+  const s = value.toString();\n+  // if we don't need to pad\n+  if (s.length >= num) {\n+    return s;\n+  }\n+  return (pad + s).slice(-num);\n }\n \n-// ==============================\n-// readers\n-// ==============================\n-\n-Packet.prototype.haveMoreData = function() {\n-  return this.payload.length > this.offset;\n-};\n-\n-Packet.prototype.skip = function(num) {\n-   if (!num)\n-     throw \"Bad param in skip!\"; // for some reason I keep doing skip(0) to indicate \"skip one byte which should be 0\"\n-   this.offset += num;\n-};\n-\n-Packet.prototype.readInt8 = function()\n-{\n-  return this.payload[this.offset++];\n-};\n-\n-Packet.prototype.readInt16 = function()\n-{\n-  this.offset += 2;\n-  return this.payload.readUInt16LE(this.offset - 2);\n-};\n-\n-Packet.prototype.readInt32 = function()\n-{\n-  this.offset += 4;\n-  return this.payload.readUInt32LE(this.offset - 4);\n-};\n-\n-Packet.prototype.isEOF = function() {\n-  // TODO: fix when payload replaced with buffer\n-  return this.payload[0] == 0xfe && this.payload.length < 9;\n-};\n-\n-Packet.prototype.readLengthCodedNumber = function() {\n-   var byte1 = this.readInt8();\n-   if (byte1 < 0xfb)\n-     return byte1;\n-   if (byte1 == 0xfc) {\n-     return this.readInt8() + (this.readInt8() << 8);\n-   }\n-   if (byte1 == 0xfd) {\n-     return this.readInt8() + (this.readInt8() << 8) + (this.readInt8() << 16);\n-   }\n-   if (byte1 == 0xfe) {\n-     console.trace();\n-     throw \"Implement 8bytes BigNumber\";\n-   }\n-   if (byte1 == 0xfb)\n-     return null;\n-   debugger;\n-   throw \"Should not reach here: \" + byte1;\n-};\n-\n-Packet.prototype.readBuffer = function(len) {\n-  this.offset += len;\n-  return this.payload.slice(this.offset - len, this.offset);\n-};\n-\n-Packet.prototype.readLengthCodedString = function() {\n-  var len = this.readLengthCodedNumber();\n-  // TODO: check manually first byte here to avoid polymorphic return type?\n",
					"match": false,
					"packageHash": "d37db98dd702e34df3b7ea779e4a503e4b1081e918e2d8b2a270bdd0a9e44eb0",
					"size": 4627,
					"sourceHash": "2e0440d54bcdaa988dab6515845f9f7153af5d1c77cf13df688a7957828dcfbc",
					"status": "content"
				},
				"lib/packets/prepare_statement.js": {
					"diff": "--- published/lib/packets/prepare_statement.js\n+++ rebuilt/lib/packets/prepare_statement.js\n@@ -1,20 +1,27 @@\n-//var constants = require('../constants');\n-var Packet = require('../packets/packet');\n+'use strict';\n \n-function PrepareStatement(sql)\n-{\n-  this.query = sql;\n-}\n+const Packet = require('../packets/packet');\n+const CommandCodes = require('../constants/commands');\n+const StringParser = require('../parsers/string.js');\n+const CharsetToEncoding = require('../constants/charset_encodings.js');\n+\n+class PrepareStatement {\n+  constructor(sql, charsetNumber) {\n+    this.query = sql;\n+    this.charsetNumber = charsetNumber;\n+    this.encoding = CharsetToEncoding[charsetNumber];\n+  }\n \n-PrepareStatement.prototype.toPacket = function()\n-{\n-  var length = 5 + this.query.length;\n-  var buffer = new Buffer(length);\n-  var packet = new Packet(0, buffer);\n-  packet.offset = 4;\n-  packet.writeInt8(0x16); // TODO: constants.COM_PREPARE\n-  packet.writeString(this.query);\n-  return packet;\n-};\n+  toPacket() {\n+    const buf = StringParser.encode(this.query, this.encoding);\n+    const length = 5 + buf.length;\n+    const buffer = Buffer.allocUnsafe(length);\n+    const packet = new Packet(0, buffer, 0, length);\n+    packet.offset = 4;\n+    packet.writeInt8(CommandCodes.STMT_PREPARE);\n+    packet.writeBuffer(buf);\n+    return packet;\n+  }\n+}\n \n module.exports = PrepareStatement;\n",
					"match": false,
					"packageHash": "a05b2f35fc3961308685119bab14e6e960219c40dd6c510044191675fec4572b",
					"size": 473,
					"sourceHash": "228bace8626d8180a755f5cf9864f9180de27760608b10518883b1ddd523dce3",
					"status": "content"
				},
				"lib/packets/prepared_statement_header.js": {
					"diff": "--- published/lib/packets/prepared_statement_header.js\n+++ rebuilt/lib/packets/prepared_statement_header.js\n@@ -1,14 +1,14 @@\n-//var constants = require('../constants');\n-var Packet = require('../packets/packet');\n+'use strict';\n \n-function PreparedStatementHeader(packet)\n-{\n-  packet.skip(1);     // should be 0\n-  this.id = packet.readInt32();\n-  this.fieldCount      = packet.readInt16();\n-  this.parameterCount  = packet.readInt16();\n-  packet.skip(1);     // should be 0\n-  this.warningCount = packet.readInt16();\n+class PreparedStatementHeader {\n+  constructor(packet) {\n+    packet.skip(1); // should be 0\n+    this.id = packet.readInt32();\n+    this.fieldCount = packet.readInt16();\n+    this.parameterCount = packet.readInt16();\n+    packet.skip(1); // should be 0\n+    this.warningCount = packet.readInt16();\n+  }\n }\n \n // TODO: toPacket\n",
					"match": false,
					"packageHash": "447c02440a9ed526afc2e49ef4648cb4dee5b15dee4d06f0079a23bbcc4148a1",
					"size": 432,
					"sourceHash": "871f2b27e7bc56bbf887640b08398fd3b1efb8f9f8b18f39b059affb7ea33a36",
					"status": "content"
				},
				"lib/packets/query.js": {
					"diff": "--- published/lib/packets/query.js\n+++ rebuilt/lib/packets/query.js\n@@ -1,20 +1,27 @@\n-//var constants = require('../constants');\n-var Packet = require('../packets/packet');\n+'use strict';\n \n-function Query(sql)\n-{\n-  this.query = sql;\n-}\n+const Packet = require('../packets/packet.js');\n+const CommandCode = require('../constants/commands.js');\n+const StringParser = require('../parsers/string.js');\n+const CharsetToEncoding = require('../constants/charset_encodings.js');\n+\n+class Query {\n+  constructor(sql, charsetNumber) {\n+    this.query = sql;\n+    this.charsetNumber = charsetNumber;\n+    this.encoding = CharsetToEncoding[charsetNumber];\n+  }\n \n-Query.prototype.toPacket = function()\n-{\n-  var length = 5 + this.query.length;\n-  var buffer = new Buffer(length);\n-  var packet = new Packet(0, buffer);\n-  packet.offset = 4;\n-  packet.writeInt8(3); // TODO: constants.COM_QUERY\n-  packet.writeString(this.query);\n-  return packet;\n-};\n+  toPacket() {\n+    const buf = StringParser.encode(this.query, this.encoding);\n+    const length = 5 + buf.length;\n+    const buffer = Buffer.allocUnsafe(length);\n+    const packet = new Packet(0, buffer, 0, length);\n+    packet.offset = 4;\n+    packet.writeInt8(CommandCode.QUERY);\n+    packet.writeBuffer(buf);\n+    return packet;\n+  }\n+}\n \n module.exports = Query;\n",
					"match": false,
					"packageHash": "91cef063be94943a91e798036baf60718a6b9cac97d77ad80bb4032f8ae5e5ae",
					"size": 435,
					"sourceHash": "afb37f33fd344b631b4ddd54a59ec9e9635d5ab5dd8b8b3ef008f2672c410c19",
					"status": "content"
				},
				"lib/packets/resultset_header.js": {
					"diff": "--- published/lib/packets/resultset_header.js\n+++ rebuilt/lib/packets/resultset_header.js\n@@ -1,14 +1,124 @@\n-//var constants = require('../constants');\n-var Packet = require('../packets/packet');\n+'use strict';\n \n-function ResultSetHeader(packet)\n-{\n-  this.fieldCount = packet.readLengthCodedNumber();\n-  if (packet.haveMoreData())\n-    this.insertId   = packet.readLengthCodedNumber();\n-  // TODO: extra\n-}\n+// TODO: rename to OK packet\n+// https://dev.mysql.com/doc/internals/en/packet-OK_Packet.html\n+\n+const Packet = require('./packet.js');\n+const ClientConstants = require('../constants/client.js');\n+const ServerSatusFlags = require('../constants/server_status.js');\n+\n+const EncodingToCharset = require('../constants/encoding_charset.js');\n+const sessionInfoTypes = require('../constants/session_track.js');\n \n-// TODO: toPacket\n+class ResultSetHeader {\n+  constructor(packet, connection) {\n+    const bigNumberStrings = connection.config.bigNumberStrings;\n+    const encoding = connection.serverEncoding;\n+    const flags = connection._handshakePacket.capabilityFlags;\n+    const isSet = function (flag) {\n+      return flags & ClientConstants[flag];\n+    };\n+    if (packet.buffer[packet.offset] !== 0) {\n+      this.fieldCount = packet.readLengthCodedNumber();\n+      if (this.fieldCount === null) {\n+        this.infileName = packet.readString(undefined, encoding);\n+      }\n+      return;\n+    }\n+    this.fieldCount = packet.readInt8(); // skip OK byte\n+    this.affectedRows = packet.readLengthCodedNumber(bigNumberStrings);\n+    this.insertId = packet.readLengthCodedNumberSigned(bigNumberStrings);\n+    this.info = '';\n+    if (isSet('PROTOCOL_41')) {\n+      this.serverStatus = packet.readInt16();\n+      this.warningStatus = packet.readInt16();\n+    } else if (isSet('TRANSACTIONS')) {\n+      this.serverStatus = packet.readInt16();\n+    }\n+    let stateChanges = null;\n+    if (isSet('SESSION_TRACK') && packet.offset < packet.end) {\n+      this.info = packet.readLengthCodedString(encoding);\n+\n+      if (this.serverStatus && ServerSatusFlags.SERVER_SESSION_STATE_CHANGED) {\n+        // session change info record - see\n+        // https://dev.mysql.com/doc/internals/en/packet-OK_Packet.html#cs-sect-packet-ok-sessioninfo\n+        let len =\n+          packet.offset < packet.end ? packet.readLengthCodedNumber() : 0;\n+        const end = packet.offset + len;\n+        let type, key, stateEnd;\n+        if (len > 0) {\n+          stateChanges = {\n+            systemVariables: {},\n+            schema: null,\n+            gtids: [],\n+            trackStateChange: null,\n+          };\n+        }\n+        while (packet.offset < end) {\n+          type = packet.readInt8();\n+          len = packet.readLengthCodedNumber();\n+          stateEnd = packet.offset + len;\n+          if (type === sessionInfoTypes.SYSTEM_VARIABLES) {\n+            key = packet.readLengthCodedString(encoding);\n+            const val = packet.readLengthCodedString(encoding);\n+            stateChanges.systemVariables[key] = val;\n+            if (key === 'character_set_client') {\n+              const charsetNumber = EncodingToCharset[val];\n+              // TODO - better api for driver users to handle unknown encodings?\n+              // maybe custom coverter in the config?\n+              // For now just ignore character_set_client command if there is\n+              // no known mapping from reported encoding to a charset code\n+              if (typeof charsetNumber !== 'undefined') {\n+                connection.config.charsetNumber = charsetNumber;\n+              }\n+            }\n+          } else if (type === sessionInfoTypes.SCHEMA) {\n+            key = packet.readLengthCodedString(encoding);\n+            stateChanges.schema = key;\n+          } else if (type === sessionInfoTypes.STATE_CHANGE) {\n+            stateChanges.trackStateChange =\n+              packet.readLengthCodedString(encoding);\n+          } else if (type === sessionInfoTypes.STATE_GTIDS) {\n+            // TODO: find if the first length coded string means anything. Usually comes as empty\n+            // eslint-disable-next-line no-unused-vars\n+            const _unknownString = packet.readLengthCodedString(encoding);\n+            const gtid = packet.readLengthCodedString(encoding);\n+            stateChanges.gtids = gtid.split(',');\n+          } else {\n",
					"match": false,
					"packageHash": "3a752fcccad3c6bc3e24dfcbc4ad762822119b553df415979bf308abec39e01f",
					"size": 330,
					"sourceHash": "6ff296d6e0e00fe4fe3b2e26a249cd6801ff4d80f197e1c5cf864b23bd15956d",
					"status": "content"
				},
				"lib/packets/text_row.js": {
					"diff": "--- published/lib/packets/text_row.js\n+++ rebuilt/lib/packets/text_row.js\n@@ -1,35 +1,47 @@\n-//var constants = require('../constants');\n-var Packet = require('../packets/packet');\n+'use strict';\n \n-function TextRow(columns)\n-{\n-  this.columns = columns || [];\n-}\n+const Packet = require('../packets/packet');\n \n-TextRow.fromPacket = function(packet) {\n-  packet.offset = 0;\n-  var columns = [];\n-  while(packet.haveMoreData()) {\n-    columns.push(packet.readLengthCodedString());\n+class TextRow {\n+  constructor(columns) {\n+    this.columns = columns || [];\n   }\n-  return new TextRow(columns);\n-};\n \n-TextRow.prototype.toPacket = function(sequenceId) {\n-  var buffer, i, packet, column;\n-  var length = 0;\n-  for(i=0; i < this.columns.length; ++i) {\n-    column = this.columns[i];\n-    length += Packet.lengthCodedNumberLength(column);\n-    length += column.length;\n+  static fromPacket(packet) {\n+    // packet.reset(); // set offset to starting point?\n+    const columns = [];\n+    while (packet.haveMoreData()) {\n+      columns.push(packet.readLengthCodedString());\n+    }\n+    return new TextRow(columns);\n   }\n-  buffer = new Buffer(length+4);\n-  packet = new Packet(sequenceId, buffer);\n-  packet.offset = 4;\n-  for(i=0; i < this.columns.length; ++i) {\n-    packet.writeLengthCodedString(this.columns[i]);\n+\n+  static toPacket(columns, encoding) {\n+    const sequenceId = 0; // TODO remove, this is calculated now in connecton\n+    let length = 0;\n+    columns.forEach((val) => {\n+      if (val === null || typeof val === 'undefined') {\n+        ++length;\n+        return;\n+      }\n+      length += Packet.lengthCodedStringLength(val.toString(10), encoding);\n+    });\n+    const buffer = Buffer.allocUnsafe(length + 4);\n+    const packet = new Packet(sequenceId, buffer, 0, length + 4);\n+    packet.offset = 4;\n+    columns.forEach((val) => {\n+      if (val === null) {\n+        packet.writeNull();\n+        return;\n+      }\n+      if (typeof val === 'undefined') {\n+        packet.writeInt8(0);\n+        return;\n+      }\n+      packet.writeLengthCodedString(val.toString(10), encoding);\n+    });\n+    return packet;\n   }\n-  return packet;\n-};\n+}\n \n module.exports = TextRow;\n",
					"match": false,
					"packageHash": "cf5a4b0103611e5bf60eb1d722b1c3a6aeeb55e04eebbc570d73175e41f9259e",
					"size": 859,
					"sourceHash": "b7f7047e08dcedd8247c806b444f214c42806b8f4e7b9f12f1514d5b8a1ba08f",
					"status": "content"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,28 +1,80 @@\n {\n   \"name\": \"mysql2\",\n-  \"version\": \"0.0.2\",\n-  \"description\": \"fast mysql driver\",\n+  \"version\": \"3.16.0\",\n+  \"description\": \"fast mysql driver. Implements core protocol, prepared statements, ssl and compression in native JS\",\n   \"main\": \"index.js\",\n-  \"directories\": {\n-    \"example\": \"examples\"\n-  },\n+  \"typings\": \"typings/mysql/index\",\n+  \"type\": \"commonjs\",\n   \"scripts\": {\n-    \"test\": \"./test/run.js\"\n+    \"lint\": \"eslint . && prettier --check .\",\n+    \"lint:fix\": \"eslint . --fix && prettier --write .\",\n+    \"test\": \"poku -d -r=verbose --sequential test/esm test/unit test/integration\",\n+    \"test:bun\": \"bun poku -d --sequential test/esm test/unit test/integration\",\n+    \"test:deno\": \"deno run --allow-read --allow-env --allow-run npm:poku -d --sequential --denoAllow=\\\"read,env,net,sys\\\" test/esm test/unit test/integration\",\n+    \"test:tsc-build\": \"cd \\\"test/tsc-build\\\" && npx tsc -p \\\"tsconfig.json\\\"\",\n+    \"coverage-test\": \"c8 npm run test\",\n+    \"benchmark\": \"node ./benchmarks/benchmark.js\",\n+    \"wait-port\": \"wait-on\"\n   },\n   \"repository\": {\n     \"type\": \"git\",\n-    \"url\": \"https://github.com/sidorares/node-mysql2\"\n+    \"url\": \"git+https://github.com/sidorares/node-mysql2.git\"\n   },\n+  \"homepage\": \"https://sidorares.github.io/node-mysql2/docs\",\n   \"keywords\": [\n-    \"mysql\"\n+    \"mysql\",\n+    \"client\",\n+    \"server\"\n+  ],\n+  \"files\": [\n+    \"lib\",\n+    \"typings/mysql\",\n+    \"index.js\",\n+    \"index.d.ts\",\n+    \"promise.js\",\n+    \"promise.d.ts\"\n   ],\n-  \"author\": \"Andrey Sidorov <sidorares@yandex.ru>\",\n+  \"exports\": {\n+    \".\": \"./index.js\",\n+    \"./package.json\": \"./package.json\",\n+    \"./promise\": \"./promise.js\",\n+    \"./promise.js\": \"./promise.js\"\n+  },\n+  \"engines\": {\n+    \"node\": \">= 8.0\"\n+  },\n+  \"author\": \"Andrey Sidorov <andrey.sidorov@gmail.com>\",\n   \"license\": \"MIT\",\n   \"dependencies\": {\n-    \"underscore\": \"~1.4.4\",\n-    \"readable-stream\": \"~1.0.2\"\n+    \"aws-ssl-profiles\": \"^1.1.1\",\n+    \"denque\": \"^2.1.0\",\n+    \"generate-function\": \"^2.3.1\",\n+    \"iconv-lite\": \"^0.7.0\",\n+    \"long\": \"^5.2.1\",\n+    \"lru.min\": \"^1.0.0\",\n+    \"named-placeholders\": \"^1.1.3\",\n+    \"seq-queue\": \"^0.0.5\",\n+    \"sqlstring\": \"^2.3.2\"\n   },\n   \"devDependencies\": {\n-    \"urun\": \"0.0.6\"\n+    \"@eslint/eslintrc\": \"^3.3.0\",\n+    \"@eslint/js\": \"^9.21.0\",\n+    \"@eslint/markdown\": \"^7.0.0\",\n+    \"@types/node\": \"^25.0.2\",\n+    \"@typescript-eslint/eslint-plugin\": \"^8.26.0\",\n+    \"@typescript-eslint/parser\": \"^8.26.0\",\n+    \"assert-diff\": \"^3.0.2\",\n+    \"benchmark\": \"^2.1.4\",\n+    \"c8\": \"^10.1.1\",\n+    \"error-stack-parser\": \"^2.0.3\",\n+    \"eslint-config-prettier\": \"^10.0.2\",\n+    \"eslint-plugin-async-await\": \"^0.0.0\",\n+    \"eslint-plugin-markdown\": \"^5.1.0\",\n+    \"eslint-plugin-prettier\": \"^5.2.3\",\n+    \"globals\": \"^16.0.0\",\n+    \"poku\": \"^3.0.0\",\n+    \"portfinder\": \"^1.0.28\",\n+    \"prettier\": \"^3.0.0\",\n+    \"typescript\": \"^5.0.2\"\n   }\n }\n",
					"match": false,
					"packageHash": "34eb9caf157f93dc95e2413047a39cc1c85393c4bae51480b3a32764427b6bde",
					"size": 537,
					"sourceHash": "f7d30639374ae65d3987f086d8da07210509d6c419bed3ef8f5a968021757cdd",
					"status": "content"
				},
				"test/common.js": {
					"match": false,
					"packageHash": "d5b0957dcd9be1ac39ef8fc1925b429ed3341880d571451082f6187c935557de",
					"size": 609,
					"status": "missing-in-source"
				},
				"test/create-500k-random-rows-table.sql": {
					"match": false,
					"packageHash": "c57be4eef0101997065a83c0509064cd5cd8dbb166f7364689140ddebac1714f",
					"size": 641,
					"status": "missing-in-source"
				},
				"test/integration/connection/test-insert-results.js": {
					"match": false,
					"packageHash": "c02e553cc84d77c84679f5e0235c2c85de2a0d1787b3f682031e18d9152e092a",
					"size": 1077,
					"status": "missing-in-source"
				},
				"test/integration/connection/test-select-1.js": {
					"match": false,
					"packageHash": "41936cb3c22b236a98dc51ca2795468cbff10084bd25f8d6ee85eebdf697e463",
					"size": 445,
					"status": "missing-in-source"
				},
				"test/integration/connection/test-select-empty-string.js": {
					"match": false,
					"packageHash": "07154bf82eb5e2342de07ead051e79bb311f4d289665b9336fbd9ec0567d790a",
					"size": 323,
					"status": "missing-in-source"
				},
				"test/run.js": {
					"match": false,
					"packageHash": "f60952dc82a4722b7f02af38a0ec5306337fb795dc5083033fc9e6821c85a20f",
					"size": 173,
					"status": "missing-in-source"
				},
				"index.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_41.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_plugins/caching_sha2_password.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_plugins/caching_sha2_password.md": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_plugins/index.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_plugins/mysql_clear_password.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_plugins/mysql_native_password.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_plugins/sha256_password.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/base/connection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/base/pool.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/base/pool_connection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/auth_switch.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/binlog_dump.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/change_user.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/client_handshake.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/close_statement.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/ping.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/prepare.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/quit.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/register_slave.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/server_handshake.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/compressed_protocol.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/connection_config.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/charset_encodings.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/charsets.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/client.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/commands.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/cursor.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/encoding_charset.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/errors.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/field_flags.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/server_status.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/session_track.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/ssl_profiles.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/types.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/create_connection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/create_pool.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/create_pool_cluster.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/auth_next_factor.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/auth_switch_request.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/auth_switch_request_more_data.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/auth_switch_response.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/binary_row.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/binlog_dump.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/binlog_query_statusvars.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/change_user.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/close_statement.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/execute.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/register_slave.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/ssl_request.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/parsers/binary_parser.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/parsers/parser_cache.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/parsers/static_binary_parser.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/parsers/static_text_parser.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/parsers/string.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/parsers/text_parser.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/pool.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/pool_cluster.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/pool_config.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/pool_connection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/connection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/inherit_events.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/make_done_cb.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/pool.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/pool_cluster.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/pool_connection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/prepared_statement_info.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/results_stream.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/server.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"promise.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"promise.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/LICENSE.txt": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/index.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/info.txt": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/Auth.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/Connection.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/Pool.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/PoolCluster.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/PoolConnection.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/Server.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/constants/CharsetToEncoding.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/constants/Charsets.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/constants/Types.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/constants/index.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/parsers/ParserCache.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/parsers/index.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/parsers/typeCast.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/Field.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/FieldPacket.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/OkPacket.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/ProcedurePacket.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/ResultSetHeader.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/RowDataPacket.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/index.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/params/ErrorPacketParams.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/params/OkPacketParams.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/ExecutableBase.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/Prepare.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/Query.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/QueryableBase.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/Sequence.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/promise/ExecutableBase.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/promise/QueryableBase.d.ts": {
					"match": false,
					"status": "missing-in-package"
				}
			},
			"summary": {
				"differentFiles": 20,
				"matchingFiles": 0,
				"missingInPackage": 104,
				"missingInSource": 12,
				"score": 0,
				"totalFiles": 136
			}
		}
	}
]
