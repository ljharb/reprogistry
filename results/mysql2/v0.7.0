[
	{
		"reproduceVersion": "0.0.0-local",
		"timestamp": "2026-01-01T19:31:56.356Z",
		"os": "linux",
		"arch": "x64",
		"strategy": "npm:11.7.0",
		"reproduced": false,
		"attested": false,
		"package": {
			"spec": "mysql2@0.7.0",
			"name": "mysql2",
			"version": "0.7.0",
			"location": "https://registry.npmjs.org/mysql2/-/mysql2-0.7.0.tgz",
			"integrity": "sha512-GFA5uwN6dypET5EWWAy1sE1gAKC+CFjPi8rhAcf/gWUJur9jdb6g2d2SUEeq3n6m/7WOKqq24mJdzF2/DHd4Xw==",
			"publishedAt": "2013-05-08T00:29:58.305Z",
			"publishedWith": {
				"node": null,
				"npm": "1.2.14"
			}
		},
		"source": {
			"integrity": "sha512-AEGW7QLLSuSnjCS4pk3EIqOmogegmze9h8EyrndavUQnIUcfkVal/sK7QznE+a3bc6rzPbAiui9Jcb+96tPwYA==",
			"location": "https://github.com/sidorares/node-mysql2",
			"spec": "github:sidorares/node-mysql2#HEAD"
		},
		"comparisonHash": "8a2a8dcbb729bf3ee9216e490c955701f0ddebe1",
		"diff": {
			"files": {
				".npmignore": {
					"match": false,
					"packageHash": "57e2231b7cf17857e41496a34df98a029e4f5e28c5d05055800f2e31d532bd79",
					"size": 104,
					"status": "missing-in-source"
				},
				".travis.yml": {
					"match": false,
					"packageHash": "d6ef40bd04bfff207e9f81ea90408041de007f4860088638238b741e2deb0b8f",
					"size": 145,
					"status": "missing-in-source"
				},
				"License": {
					"diff": "--- published/License\n+++ rebuilt/License\n@@ -1,4 +1,4 @@\n-Copyright (c) 2013 Andrey Sidorov (sidorares@yandex.ru) and contributors\n+Copyright (c) 2016 Andrey Sidorov (sidorares@yandex.ru) and contributors\n \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n",
					"match": false,
					"packageHash": "b9f4723995bb449274bf9361d69fd494bae4feecb5e5b82ac91bc19b7a214712",
					"size": 1112,
					"sourceHash": "f17f1be30bce27fe6324513a35fa61f6e6766d3028e42e45bdf668a0db7c8d4f",
					"status": "content"
				},
				"README.md": {
					"diff": "--- published/README.md\n+++ rebuilt/README.md\n@@ -1,4 +1,114 @@\n-[![Build Status](https://secure.travis-ci.org/sidorares/node-mysql2.png)](http://travis-ci.org/sidorares/node-mysql2) [![](https://badge.fury.io/js/mysql2.png)](https://npmjs.org/package/mysql2) [![](https://gemnasium.com/sidorares/node-mysql2.png)](https://gemnasium.com/npms/mysql2)\n+[npm-image]: https://img.shields.io/npm/v/mysql2.svg\n+[npm-url]: https://npmjs.com/package/mysql2\n+[node-version-image]: https://img.shields.io/node/v/mysql2.svg\n+[node-version-url]: https://nodejs.org/en/download\n+[downloads-image]: https://img.shields.io/npm/dm/mysql2.svg\n+[downloads-url]: https://npmjs.com/package/mysql2\n+[license-url]: https://github.com/sidorares/node-mysql2/blob/master/License\n+[license-image]: https://img.shields.io/npm/l/mysql2.svg?maxAge=2592000\n+[node-mysql]: https://github.com/mysqljs/mysql\n+[mysqljs]: https://github.com/mysqljs\n+[mysql-native]: https://github.com/sidorares/nodejs-mysql-native\n+[sidorares]: https://github.com/sidorares\n+[TooTallNate]: https://gist.github.com/TooTallNate\n+[starttls.js]: https://gist.github.com/TooTallNate/848444\n+[node-mariasql]: https://github.com/mscdex/node-mariasql\n+[contributors]: https://github.com/sidorares/node-mysql2/graphs/contributors\n+[contributing]: https://github.com/sidorares/node-mysql2/blob/master/Contributing.md\n+[docs-base]: https://sidorares.github.io/node-mysql2/docs\n+[docs-base-zh-CN]: https://sidorares.github.io/node-mysql2/zh-CN/docs\n+[docs-base-pt-BR]: https://sidorares.github.io/node-mysql2/pt-BR/docs\n+[docs-prepared-statements]: https://sidorares.github.io/node-mysql2/docs/documentation/prepared-statements\n+[docs-mysql-server]: https://sidorares.github.io/node-mysql2/docs/documentation/mysql-server\n+[docs-promise-wrapper]: https://sidorares.github.io/node-mysql2/docs/documentation/promise-wrapper\n+[docs-authentication-switch]: https://sidorares.github.io/node-mysql2/docs/documentation/authentication-switch\n+[docs-streams]: https://sidorares.github.io/node-mysql2/docs/documentation/extras\n+[docs-typescript-docs]: https://sidorares.github.io/node-mysql2/docs/documentation/typescript-examples\n+[docs-qs-pooling]: https://sidorares.github.io/node-mysql2/docs#using-connection-pools\n+[docs-qs-first-query]: https://sidorares.github.io/node-mysql2/docs#first-query\n+[docs-qs-using-prepared-statements]: https://sidorares.github.io/node-mysql2/docs#using-prepared-statements\n+[docs-examples]: https://sidorares.github.io/node-mysql2/docs/examples\n+[docs-faq]: https://sidorares.github.io/node-mysql2/docs/faq\n+[docs-documentation]: https://sidorares.github.io/node-mysql2/docs/documentation\n+[docs-contributing]: https://sidorares.github.io/node-mysql2/docs/contributing/website\n+[coverage]: https://img.shields.io/codecov/c/github/sidorares/node-mysql2\n+[coverage-url]: https://app.codecov.io/github/sidorares/node-mysql2\n+[ci-url]: https://github.com/sidorares/node-mysql2/actions/workflows/ci-coverage.yml?query=branch%3Amaster\n+[ci-image]: https://img.shields.io/github/actions/workflow/status/sidorares/node-mysql2/ci-coverage.yml?event=push&style=flat&label=CI&branch=master\n \n-Work in progress.\n-Aims to be faster drop-in replacement driver for https://github.com/felixge/node-mysql\n+# MySQL2\n+\n+[![NPM Version][npm-image]][npm-url]\n+[![NPM Downloads][downloads-image]][downloads-url]\n+[![Node.js Version][node-version-image]][node-version-url]\n+[![GitHub Workflow Status (with event)][ci-image]][ci-url]\n+[![Codecov][coverage]][coverage-url]\n+[![License][license-image]][license-url]\n+\n+[English][docs-base] | [简体中文][docs-base-zh-CN] | [Português (BR)][docs-base-pt-BR]\n+\n+> MySQL client for Node.js with focus on performance. Supports prepared statements, non-utf8 encodings, binary log protocol, compression, ssl [much more][docs-documentation].\n+\n+**Table of Contents**\n+\n+- [History and Why MySQL2](#history-and-why-mysql2)\n+- [Installation](#installation)\n+- [Documentation](#documentation)\n+- [Acknowledgements](#acknowledgements)\n+- [Contributing](#contributing)\n+\n+## History and Why MySQL2\n+\n+MySQL2 project is a continuation of [MySQL-Native][mysql-native]. Protocol parser code was rewritten from scratch and api changed to match popular [Node MySQL][node-mysql]. MySQL2 team is working together with [Node MySQL][node-mysql] team to factor out shared code and move it under [mysqljs][mysqljs] organization.\n+\n+MySQL2 is mostly API compatible with [Node MySQL][node-mysql] and supports majority of features. MySQL2 also offers these additional features:\n+\n+- Faster / Better Performance\n+- [Prepared Statements][docs-prepared-statements]\n+- MySQL Binary Log Protocol\n+- [MySQL Server][docs-mysql-server]\n+- Extended support for Encoding and Collation\n+- [Promise Wrapper][docs-promise-wrapper]\n+- Compression\n+- SSL and [Authentication Switch][docs-authentication-switch]\n+- [Custom Streams][docs-streams]\n+- [Pooling][docs-qs-pooling]\n+\n+## Installation\n+\n+MySQL2 is free from native bindings and can be installed on Linux, Mac OS or Windows without any issues.\n+\n+```bash\n+npm install --save mysql2\n+```\n+\n+If you are using TypeScript, you will need to install `@types/node`.\n+\n+```bash\n+npm install --save-dev @types/node\n+```\n+\n+> For TypeScript documentation and examples, see [here][docs-typescript-docs].\n+\n+## Documentation\n+\n",
					"match": false,
					"packageHash": "127894125ac6f8930f3d4b92c72d7f84a5b068de3fc9342309502a15708487f7",
					"size": 391,
					"sourceHash": "735fd19fcc12984b9dcfe440cacb7e762b31bb4eef5d8ffa102261b91bbda846",
					"status": "content"
				},
				"benchmarks/bench-insert-select-parallel.js": {
					"match": false,
					"packageHash": "623ab1e060d8064bd4d24bbad4cc174a2a366144d343bc9751eab665b0233120",
					"size": 2156,
					"status": "missing-in-source"
				},
				"benchmarks/bench-insert-select-prepared.js": {
					"match": false,
					"packageHash": "5238399c40b77aee0a5054ac1f2de961e03f9c8f16fe157b709f4ad7dd6148ef",
					"size": 2298,
					"status": "missing-in-source"
				},
				"benchmarks/bench-insert-select.js": {
					"match": false,
					"packageHash": "9a7dd7f552086d884337d4e4b64b41c5d84ce1b40c1ab1ab5b94d0e789d81eae",
					"size": 2259,
					"status": "missing-in-source"
				},
				"benchmarks/benchmark-query.js": {
					"match": false,
					"packageHash": "3d4668ae6feb708737a3718b1a9ca71dd1317a4096811884b7bcc225d2b70e80",
					"size": 967,
					"status": "missing-in-source"
				},
				"benchmarks/http-select-and-render.js": {
					"match": false,
					"packageHash": "0119093f1f073228056194257b4f95face80381b29c45d4b3c8b0dcb40b94d5e",
					"size": 966,
					"status": "missing-in-source"
				},
				"benchmarks/httperf.sh": {
					"match": false,
					"packageHash": "ee28bf4a9d790cb29f184df0c54e92b8c1bfc3d4c7a0c48754ee5df8c325044a",
					"size": 123,
					"status": "missing-in-source"
				},
				"benchmarks/test-benchmark-select-1.js": {
					"match": false,
					"packageHash": "b7e3004446ec010852154634ad1455e90266ab453e487d282cb801170829851b",
					"size": 976,
					"status": "missing-in-source"
				},
				"examples/execute.js": {
					"match": false,
					"packageHash": "cd3024347859c61e81638cfe3db99d95f32bbb1fccacb10cdf7c536466733888",
					"size": 293,
					"status": "missing-in-source"
				},
				"examples/pool-test.js": {
					"match": false,
					"packageHash": "614e2214f05666f31089b638b64a57c9d48b50b553f421f072f168d94e841d8b",
					"size": 292,
					"status": "missing-in-source"
				},
				"examples/simple-select.js": {
					"match": false,
					"packageHash": "dfaa3867fc2b03a6b8d194e9c50c3ae40d55a5cade491fdd1d69e4e814120755",
					"size": 301,
					"status": "missing-in-source"
				},
				"examples/ssl/certs/ca-cert.pem": {
					"match": false,
					"packageHash": "ce1cd354c3046f5b24592711fcbd74c6e8811fdf1cda33f5454ced7953ba93fe",
					"size": 1346,
					"status": "missing-in-source"
				},
				"examples/ssl/certs/ca-key.pem": {
					"match": false,
					"packageHash": "9cf123e4d04763874fe632061ed29470e1ea908a3d0ce5ff401a4e25fef0bb37",
					"size": 1679,
					"status": "missing-in-source"
				},
				"examples/ssl/certs/client-cert.pem": {
					"match": false,
					"packageHash": "252430490fc4a8a781b0a1d3bff02b65572db0e7e29d4a2b6689d974e4ef6a07",
					"size": 1099,
					"status": "missing-in-source"
				},
				"examples/ssl/certs/client-key.pem": {
					"match": false,
					"packageHash": "beb4e3124e78cf4c784b0499f1d0587dad0f4f675ceb44105980ece9fc8dd441",
					"size": 1675,
					"status": "missing-in-source"
				},
				"examples/ssl/certs/client-req.pem": {
					"match": false,
					"packageHash": "40896aea669ba4d672d4a489c3769ecb64fb04beede6f51a1df1d7c6c5dac42e",
					"size": 956,
					"status": "missing-in-source"
				},
				"examples/ssl/certs/mkcerts.sh": {
					"match": false,
					"packageHash": "e8f11af59c69bca52bd72c965035f0fb5e213809613f120062918aa796d91474",
					"size": 508,
					"status": "missing-in-source"
				},
				"examples/ssl/certs/server-cert.pem": {
					"match": false,
					"packageHash": "68528bfcb6f3212994418bdf15b3bda22abe8b561071a31260d3a8777d04870f",
					"size": 1099,
					"status": "missing-in-source"
				},
				"examples/ssl/certs/server-key.pem": {
					"match": false,
					"packageHash": "2653f5dc8ec2626ea9adcf4777fecbce55c5733d912384d6cc8b66ea5f31061d",
					"size": 1679,
					"status": "missing-in-source"
				},
				"examples/ssl/certs/server-req.pem": {
					"match": false,
					"packageHash": "ddd2e237eddc76ffc1f0eed5be2e4d2c489dbc3de94e873f2864239e655c52f9",
					"size": 956,
					"status": "missing-in-source"
				},
				"examples/ssl/client-flags.sh": {
					"match": false,
					"packageHash": "cb371238d6d93aac409e6c928b40f3669335173365c563627220dca0e1219b89",
					"size": 91,
					"status": "missing-in-source"
				},
				"examples/ssl/select-over-ssl.js": {
					"match": false,
					"packageHash": "28eea5170f1d08aca81d0910b18e5839a99ccb498b5985c3879cfe492d37c200",
					"size": 495,
					"status": "missing-in-source"
				},
				"index.js": {
					"diff": "--- published/index.js\n+++ rebuilt/index.js\n@@ -1,16 +1,77 @@\n-var Connection = require('./lib/connection');\n-var ConnectionConfig = require('./lib/connection_config');\n-module.exports.createConnection = function(opts) {\n-  return new Connection({config: new ConnectionConfig(opts)});\n-  //return new Connection(opts);\n+'use strict';\n+\n+const SqlString = require('sqlstring');\n+\n+const ConnectionConfig = require('./lib/connection_config.js');\n+const parserCache = require('./lib/parsers/parser_cache.js');\n+\n+const Connection = require('./lib/connection.js');\n+\n+exports.createConnection = require('./lib/create_connection.js');\n+exports.connect = exports.createConnection;\n+exports.Connection = Connection;\n+exports.ConnectionConfig = ConnectionConfig;\n+\n+const Pool = require('./lib/pool.js');\n+const PoolCluster = require('./lib/pool_cluster.js');\n+const createPool = require('./lib/create_pool.js');\n+const createPoolCluster = require('./lib/create_pool_cluster.js');\n+\n+exports.createPool = createPool;\n+\n+exports.createPoolCluster = createPoolCluster;\n+\n+exports.createQuery = Connection.createQuery;\n+\n+exports.Pool = Pool;\n+\n+exports.PoolCluster = PoolCluster;\n+\n+exports.createServer = function (handler) {\n+  const Server = require('./lib/server.js');\n+  const s = new Server();\n+  if (handler) {\n+    s.on('connection', handler);\n+  }\n+  return s;\n };\n \n-module.exports.Connection = Connection;\n-module.exports.Types      = require('./lib/constants/types');\n+exports.PoolConnection = require('./lib/pool_connection.js');\n+exports.authPlugins = require('./lib/auth_plugins');\n+exports.escape = SqlString.escape;\n+exports.escapeId = SqlString.escapeId;\n+exports.format = SqlString.format;\n+exports.raw = SqlString.raw;\n+\n+exports.__defineGetter__(\n+  'createConnectionPromise',\n+  () => require('./promise.js').createConnection\n+);\n+\n+exports.__defineGetter__(\n+  'createPoolPromise',\n+  () => require('./promise.js').createPool\n+);\n+\n+exports.__defineGetter__(\n+  'createPoolClusterPromise',\n+  () => require('./promise.js').createPoolCluster\n+);\n \n+exports.__defineGetter__('Types', () => require('./lib/constants/types.js'));\n+\n+exports.__defineGetter__('Charsets', () =>\n+  require('./lib/constants/charsets.js')\n+);\n+\n+exports.__defineGetter__('CharsetToEncoding', () =>\n+  require('./lib/constants/charset_encodings.js')\n+);\n+\n+exports.setMaxParserCache = function (max) {\n+  parserCache.setMaxCache(max);\n+};\n \n-var PoolConfig = require('./lib/pool_config');\n-var Pool = require('./lib/pool');\n-module.exports.createPool = function(config) {\n-    return new Pool({config: new PoolConfig(config)});\n+exports.clearParserCache = function () {\n+  parserCache.clearCache();\n };\n",
					"match": false,
					"packageHash": "abdbc637288f8df42373d73df38081dae000ec0fe469867a659a4aa264c2f242",
					"size": 546,
					"sourceHash": "1947f86b2e1ec51dbbd53cfadb034e776c27d282459d6229866033f9df8a1d88",
					"status": "content"
				},
				"lib/commands/command.js": {
					"diff": "--- published/lib/commands/command.js\n+++ rebuilt/lib/commands/command.js\n@@ -1,33 +1,54 @@\n-var EventEmitter = require('events').EventEmitter;\n-var util = require('util');\n+'use strict';\n \n-function Command() {\n-  EventEmitter.call(this);\n-  this.next = null;\n-}\n-util.inherits(Command, EventEmitter);\n+const EventEmitter = require('events').EventEmitter;\n+const Timers = require('timers');\n \n-Command.prototype.execute = function(packet, connection) {\n-  // TODO: hack\n-  if (!this.next) {\n-    this.next = this.start;\n+class Command extends EventEmitter {\n+  constructor() {\n+    super();\n+    this.next = null;\n   }\n \n-  if (packet && packet.isError()) {\n-    var err = packet.asError();\n-    this.emit('error', err);\n-    return true;\n+  // slow. debug only\n+  stateName() {\n+    const state = this.next;\n+    for (const i in this) {\n+      if (this[i] === state && i !== 'next') {\n+        return i;\n+      }\n+    }\n+    return 'unknown name';\n   }\n \n-  // TODO: don't return anything from execute, it's ugly and error-prone. Listen for 'end' event in connection\n-  this.next = this.next(packet, connection);\n-  if (this.next) {\n-    return false;\n-  } else {\n-    //console.log('done command!');\n+  execute(packet, connection) {\n+    if (!this.next) {\n+      this.next = this.start;\n+      connection._resetSequenceId();\n+    }\n+    if (packet && packet.isError()) {\n+      const err = packet.asError(connection.clientEncoding);\n+      err.sql = this.sql || this.query;\n+      if (this.queryTimeout) {\n+        Timers.clearTimeout(this.queryTimeout);\n+        this.queryTimeout = null;\n+      }\n+      if (this.onResult) {\n+        this.onResult(err);\n+        this.emit('end');\n+      } else {\n+        this.emit('error', err);\n+        this.emit('end');\n+      }\n+      return true;\n+    }\n+    // TODO: don't return anything from execute, it's ugly and error-prone. Listen for 'end' event in connection\n+    this.next = this.next(packet, connection);\n+    if (this.next) {\n+      return false;\n+    }\n     this.emit('end');\n     return true;\n   }\n-};\n+}\n \n module.exports = Command;\n",
					"match": false,
					"packageHash": "715934678b6a87faa4a095bd1a15d3d53849241297309a6926598efed4adda2a",
					"size": 749,
					"sourceHash": "f94521022f77fce0a0af821a063bc6ca5631f975dc167ee6bd9d4994c76be338",
					"status": "content"
				},
				"lib/commands/execute.js": {
					"diff": "--- published/lib/commands/execute.js\n+++ rebuilt/lib/commands/execute.js\n@@ -1,195 +1,112 @@\n-var Command  = require('./command');\n-var Packets  = require('../packets/index.js');\n-var util    = require('util');\n-var compileParser = require('../compile_binary_parser');\n-\n-function Execute(sql, parameters, callback)\n-{\n-  Command.call(this);\n-  this.query = sql;\n-  this.onResult = callback; // TODO check felixge multi-result api\n-  this.fieldCount = 0;\n-  this.parameterCount = 0;\n-  this.fields = [];\n-  this.parameterDefinitions = [];\n-\n-  this.resultFields = [];\n-  this.resultFieldCount = 0;\n-  this.insertId = 0;\n-\n-  this.parameters = parameters;\n-  this.rows   = [];\n-  this.id = 0;\n-  this.rowParser = null;\n-}\n-util.inherits(Execute, Command);\n-\n-Execute.prototype.start = function(packet, connection) {\n-  var id = connection.statements[this.query];\n-  if (!id) { // prepare first\n-    console.log('preparing ' + this.query);\n-    connection.writePacket(new Packets.PrepareStatement(this.query).toPacket(1));\n-  } else {\n-    this.id = id;\n-    //console.log('executing cached! ID=' + this.id);\n-    return this.doExecute(connection);\n-  }\n-  return Execute.prototype.prepareHeader;\n-};\n-\n-Execute.prototype.prepareHeader = function(packet, connection) {\n-  var header = new Packets.PreparedStatementHeader(packet);\n-  this.fieldCount     = header.fieldCount;\n-  this.parameterCount = header.parameterCount;\n-  this.id = header.id;\n-  console.log('saving prepared statement:' + this.id);\n-  connection.statements[this.query] = this.id;\n-  if (this.parameterCount > 0)\n-    return Execute.prototype.readParameter;\n-  else if (this.fieldCount > 0)\n-    return Execute.prototype.readField;\n-  else\n-    return this.doExecute(connection);\n-};\n-\n-Execute.prototype.readParameter = function(packet, connection) {\n-  var def = new Packets.ColumnDefinition(packet);\n-  this.parameterDefinitions.push(def);\n-  if (this.parameterDefinitions.length == this.parameterCount)\n-    return Execute.prototype.parametersEOF;\n-  return this.readParameter;\n-};\n-\n-// TODO: move to connection.js?\n-function getFieldsKey(fields) {\n-  var res = '';\n-  for (var i=0; i < fields.length; ++i)\n-    res += '/' + fields[i].name + ':' + fields[i].columnType + ':' + fields[i].flags;\n-  return res;\n-}\n+'use strict';\n \n-Execute.prototype.readField = function(packet, connection) {\n-  var def = new Packets.ColumnDefinition(packet);\n-  this.fields.push(def);\n-\n-  // TODO: api to allow to flag \"I'm not going to chnge schema for this statement\"\n-  // this way we can ignore column definitions in binary response and use\n-  // definition from prepare phase. Note that it's what happens currently\n-  // e.i if you do execute(\"select * from foo\") and later add/remove/rename rows to foo\n-  // (without reconnecting) you are in trouble\n-\n-  if (this.fields.length == this.fieldCount) {\n-    // compile row parser\n-    var parserKey = getFieldsKey(this.fields);\n-    // try cached first\n-    this.rowParser = connection.textProtocolParsers[parserKey];\n-    if (!this.rowParser) {\n-      this.rowParser = compileParser(this.fields);\n-      console.log(this.rowParser.toString());\n-      connection.textProtocolParsers[parserKey] = this.rowParser;\n+const Command = require('./command.js');\n+const Query = require('./query.js');\n+const Packets = require('../packets/index.js');\n+\n+const getBinaryParser = require('../parsers/binary_parser.js');\n+const getStaticBinaryParser = require('../parsers/static_binary_parser.js');\n+\n",
					"match": false,
					"packageHash": "5c73bd214fe8f77737604ac840b77423b7168f5bacf46233baf8277a4a52f53f",
					"size": 5806,
					"sourceHash": "172f8b5e32ab499f98160aa279935c42b5c4d8093361a00f87bf3874c4ec85f1",
					"status": "content"
				},
				"lib/commands/handshake.js": {
					"match": false,
					"packageHash": "320acd110a9da80796927e56967d4a152ba829d79e79f324b61b9b68b37caa41",
					"size": 2855,
					"status": "missing-in-source"
				},
				"lib/commands/index.js": {
					"diff": "--- published/lib/commands/index.js\n+++ rebuilt/lib/commands/index.js\n@@ -1,4 +1,27 @@\n-\"handshake query execute\".split(' ').forEach(function(name) {\n-  var ctor = require('./' + name);\n-  module.exports[ctor.name] = ctor;\n-});\n+'use strict';\n+\n+const ClientHandshake = require('./client_handshake.js');\n+const ServerHandshake = require('./server_handshake.js');\n+const Query = require('./query.js');\n+const Prepare = require('./prepare.js');\n+const CloseStatement = require('./close_statement.js');\n+const Execute = require('./execute.js');\n+const Ping = require('./ping.js');\n+const RegisterSlave = require('./register_slave.js');\n+const BinlogDump = require('./binlog_dump.js');\n+const ChangeUser = require('./change_user.js');\n+const Quit = require('./quit.js');\n+\n+module.exports = {\n+  ClientHandshake,\n+  ServerHandshake,\n+  Query,\n+  Prepare,\n+  CloseStatement,\n+  Execute,\n+  Ping,\n+  RegisterSlave,\n+  BinlogDump,\n+  ChangeUser,\n+  Quit,\n+};\n",
					"match": false,
					"packageHash": "f90669395830655dda1bf2944bdd8ae220c441869bf88680f90dd20e7a998e8e",
					"size": 137,
					"sourceHash": "63e2165286ffc366ebda65d30787d799988d981d9179ae1a04252374e99debf2",
					"status": "content"
				},
				"lib/commands/query.js": {
					"diff": "--- published/lib/commands/query.js\n+++ rebuilt/lib/commands/query.js\n@@ -1,124 +1,366 @@\n-var Command  = require('./command');\n-var Packets  = require('../packets/index.js');\n-var util    = require('util');\n-var compileParser = require('../compile_text_parser');\n-\n-function Query(sql, callback)\n-{\n-  Command.call(this);\n-  this.query = sql;\n-  this.onResult = callback; // TODO check felixge multi-result api\n-  this.fieldCount = 0;\n-  this.insertId   = 0;\n-  this.fields     = [];\n-  this.rows       = [];\n-  this.rowParser  = null;\n-  this.on('error', function(err) {\n-    if (this.callback) {\n-      this.callback(err);\n-    }\n-  });\n-}\n-util.inherits(Query, Command);\n+'use strict';\n \n-Query.prototype.start = function(packet, connection) {\n+const process = require('process');\n+const Timers = require('timers');\n \n-  if (this.callback)\n-    this.on('error', callback);\n-  else\n-    this.on('error', function(err) {\n-      connection.emit('error', err);\n-    });\n+const Readable = require('stream').Readable;\n \n-  var cmdPacket = new Packets.Query(this.query);\n-  connection.writePacket(cmdPacket.toPacket(1));\n-  return Query.prototype.resultsetHeader;\n-};\n-\n-Query.prototype.resultsetHeader = function(packet) {\n-  var rs = new Packets.ResultSetHeader(packet);\n-  this.fieldCount = rs.fieldCount;\n-  this.insertId = rs.insertId;\n-  if (this.fieldCount === 0) {\n-    if (this.onResult)\n-      this.onResult(null, [], []);\n-    return null;\n+const Command = require('./command.js');\n+const Packets = require('../packets/index.js');\n+const getTextParser = require('../parsers/text_parser.js');\n+const staticParser = require('../parsers/static_text_parser.js');\n+const ServerStatus = require('../constants/server_status.js');\n+\n+const EmptyPacket = new Packets.Packet(0, Buffer.allocUnsafe(4), 0, 4);\n+\n+// http://dev.mysql.com/doc/internals/en/com-query.html\n+class Query extends Command {\n+  constructor(options, callback) {\n+    super();\n+    this.sql = options.sql;\n+    this.values = options.values;\n+    this._queryOptions = options;\n+    this.namedPlaceholders = options.namedPlaceholders || false;\n+    this.onResult = callback;\n+    this.timeout = options.timeout;\n+    this.queryTimeout = null;\n+    this._fieldCount = 0;\n+    this._rowParser = null;\n+    this._fields = [];\n+    this._rows = [];\n+    this._receivedFieldsCount = 0;\n+    this._resultIndex = 0;\n+    this._localStream = null;\n+    this._unpipeStream = function () {};\n+    this._streamFactory = options.infileStreamFactory;\n+    this._connection = null;\n   }\n-  return Query.prototype.readField;\n-};\n \n-// TODO: move to connection.js ?\n-function getFieldsKey(fields) {\n-  var res = '';\n-  for (var i=0; i < fields.length; ++i)\n-    res += '/' + fields[i].name + ':' + fields[i].columnType + ':' + fields[i].flags;\n-  return res;\n-}\n+  then() {\n+    const err =\n+      \"You have tried to call .then(), .catch(), or invoked await on the result of query that is not a promise, which is a programming error. Try calling con.promise().query(), or require('mysql2/promise') instead of 'mysql2' for a promise-compatible version of the query interface. To learn how to use async/await or Promises check out documentation at https://sidorares.github.io/node-mysql2/docs#using-promise-wrapper, or the mysql2 documentation at https://sidorares.github.io/node-mysql2/docs/documentation/promise-wrapper\";\n+    // eslint-disable-next-line\n+    console.log(err);\n+    throw new Error(err);\n+  }\n+\n",
					"match": false,
					"packageHash": "dc467eb6738ac18cf334120e561c99b46297a39163f983a346efb15ea6dad0a1",
					"size": 3295,
					"sourceHash": "0e0cac86bcffd0b533061d28587ea0a2f9a669f82199c82cf107f94d6b756887",
					"status": "content"
				},
				"lib/compile_binary_parser.js": {
					"match": false,
					"packageHash": "15baffbdc2597f5ae06a23996340b5323f889728146727540c8d4a19c96c036d",
					"size": 2385,
					"status": "missing-in-source"
				},
				"lib/compile_text_parser.js": {
					"match": false,
					"packageHash": "a08ea70cf8a24ddb63495fdca7ed8e317eb28c49da63b45c7a82d6a0509c4d62",
					"size": 833,
					"status": "missing-in-source"
				},
				"lib/connection.js": {
					"diff": "--- published/lib/connection.js\n+++ rebuilt/lib/connection.js\n@@ -1,352 +1,12 @@\n-var _            = require('underscore');\n-var net          = require('net');\n-var util         = require('util');\n-var EventEmitter = require('events').EventEmitter;\n-var Queue        = require('fastqueue');\n+'use strict';\n \n-var PacketParser = require('./packet_parser');\n-var Packet       = require('./packets/packet');\n-var Commands     = require('./commands/index.js');\n-var SqlString    = require('./sql_string');\n+const BaseConnection = require('./base/connection.js');\n \n-function Connection(opts)\n-{\n-  EventEmitter.call(this);\n-  // params are encoded as url string\n-  /*\n-  if (typeof opts == 'string')\n-  {\n-    var url = opts;\n-    opts = {};\n-    var params = require('url').parse(url, true);\n-    opts.host = params.host;\n-    opts.database = params.pathname.substring(1);\n-    var userPass = params.auth.split(':');\n-    opts.user = userPass[0];\n-    opts.password = userPass[1];\n-    if (params.query.flags)\n-      opts.flags = params.query.flags.split(',');\n-    _.extend(opts, _.pick(params.query, 'socketPath', 'charset', 'timezone', 'insecureAuth', 'typeCast', 'supportBigNumbers', 'debug'));\n+class Connection extends BaseConnection {\n+  promise(promiseImpl) {\n+    const PromiseConnection = require('./promise/connection.js');\n+    return new PromiseConnection(this, promiseImpl);\n   }\n-  */\n-\n-  //this.config = return new Connection({config: new ConnectionConfig(config)});\n-  this.config = opts.config;\n-\n-  // TODO: fill defaults\n-  // if no params, connect to /var/lib/mysql/mysql.sock ( /tmp/mysql.sock on OSX )\n-  // if host is given, connect to host:3306\n-\n-  // TODO: use `/usr/local/mysql/bin/mysql_config --socket` output? as default socketPath\n-  // if there is no host/port and no socketPath parameters?\n-\n-  if (!opts.config.stream) {\n-    if (opts.socketPath)\n-      this.stream = net.connect(opts.config.socketPath);\n-    else\n-      this.stream = net.connect(opts.config.port, opts.config.host);\n-  } else {\n-    this.stream = stream;\n-  }\n-\n-  this._commands = new Queue();\n-  this._command = null;\n-\n-  this.statements = {};\n-\n-  // TODO: make it lru cache\n-  // https://github.com/mercadolibre/node-simple-lru-cache\n-  // or https://github.com/rsms/js-lru\n-  // or https://github.com/monsur/jscache\n-  // or https://github.com/isaacs/node-lru-cache\n-  //\n-  // key is field.name + ':' + field.columnType + ':' field.flags + '/'\n-  this.textProtocolParsers = {};\n-\n-  // TODO: not sure if cache should be separate (same key as with textProtocolParsers)\n-  // or part of prepared statements cache (key is sql query)\n-  this.binaryProtocolParsers = {};\n-\n-  this.serverCapabilityFlags = 0;\n-  this.authorized = false;\n-\n-  var connection = this;\n-\n-  // big TODO: benchmark if it all worth using 'ondata' and onPacket callbacks directly\n-  // compositing streams would be much more easier.\n-  // also, look for existing length-prefixed streams to reuse instead of packet_parser\n-  //  https://github.com/squaremo/node-spb - currently only fixed 4 byte prefix\n-  //  ...?\n-\n-\n-  // TODO: check if bind can be a performance problem\n-  // see https://gist.github.com/khoomeister/4985691#use-that-instead-of-bind\n-  this.packetParser = new PacketParser(this.handlePacket.bind(this));\n-\n-  if (this.stream instanceof net.Stream) {\n-    this.stream.ondata = function(data, start, end) {\n-      connection.packetParser.execute(data, start, end);\n-    };\n-  } else {\n-    this.stream.on('data', function(data) {\n",
					"match": false,
					"packageHash": "f87ac2af51e1888bc573573480931b6bdaa420e81d46712e581f38b6f4a98d7b",
					"size": 11585,
					"sourceHash": "3282d2cb7af3032699ff7690c2451cd92d34871421bb8f53af17f553056b9b6a",
					"status": "content"
				},
				"lib/connection_config.js": {
					"diff": "--- published/lib/connection_config.js\n+++ rebuilt/lib/connection_config.js\n@@ -1,106 +1,284 @@\n-var urlParse        = require('url').parse;\n-var ClientConstants = require('./constants/client');\n-var Charsets        = require('./constants/charsets');\n-\n-module.exports = ConnectionConfig;\n-function ConnectionConfig(options) {\n-  if (typeof options === 'string') {\n-    options = ConnectionConfig.parseUrl(options);\n-  }\n-\n-  this.host               = options.host || 'localhost';\n-  this.port               = options.port || 3306;\n-  this.socketPath         = options.socketPath;\n-  this.user               = options.user || undefined;\n-  this.password           = options.password || undefined;\n-  this.database           = options.database;\n-  this.insecureAuth       = options.insecureAuth || false;\n-  this.supportBigNumbers  = options.supportBigNumbers || false;\n-  this.bigNumberStrings   = options.bigNumberStrings || false;\n-  this.debug              = options.debug;\n-  this.timezone           = options.timezone || 'local';\n-  this.flags              = options.flags || '';\n-  this.queryFormat        = options.queryFormat;\n-  this.pool               = options.pool || undefined;\n-  this.multipleStatements = options.multipleStatements || false;\n-  this.typeCast           = (options.typeCast === undefined) ? true : options.typeCast;\n-  this.ssl                = options.ssl;\n-  this.cmpress            = options.compress;\n-\n-  if (this.timezone[0] == \" \") {\n-    // \"+\" is a url encoded char for space so it\n-    // gets translated to space when giving a\n-    // connection string..\n-    this.timezone = \"+\" + this.timezone.substr(1);\n-  }\n-\n-  this.maxPacketSize = 0;\n-  this.charsetNumber = (options.charset)\n-    ? ConnectionConfig.getCharsetNumber(options.charset)\n-    : options.charsetNumber||Charsets.UTF8_GENERAL_CI;\n-\n-  this.clientFlags = ConnectionConfig.mergeFlags(ConnectionConfig.getDefaultFlags(options),\n-                                                 options.flags || '');\n-}\n-\n-ConnectionConfig.mergeFlags = function(default_flags, user_flags) {\n-  var flags = 0x0, i;\n-\n-  user_flags = (user_flags || '').toUpperCase().split(/\\s*,+\\s*/);\n-\n-  // add default flags unless \"blacklisted\"\n-  for (i in default_flags) {\n-    if (user_flags.indexOf(\"-\" + default_flags[i]) >= 0) continue;\n+// This file was modified by Oracle on September 21, 2021.\n+// New connection options for additional authentication factors were\n+// introduced.\n+// Multi-factor authentication capability is now enabled if one of these\n+// options is used.\n+// Modifications copyright (c) 2021, Oracle and/or its affiliates.\n+\n+'use strict';\n+\n+const { URL } = require('url');\n+const ClientConstants = require('./constants/client');\n+const Charsets = require('./constants/charsets');\n+const { version } = require('../package.json');\n+let SSLProfiles = null;\n+\n+const validOptions = {\n+  authPlugins: 1,\n+  authSwitchHandler: 1,\n+  bigNumberStrings: 1,\n+  charset: 1,\n+  charsetNumber: 1,\n+  compress: 1,\n+  connectAttributes: 1,\n+  connectTimeout: 1,\n+  database: 1,\n+  dateStrings: 1,\n+  debug: 1,\n+  decimalNumbers: 1,\n+  enableKeepAlive: 1,\n+  flags: 1,\n+  host: 1,\n+  insecureAuth: 1,\n+  infileStreamFactory: 1,\n+  isServer: 1,\n+  keepAliveInitialDelay: 1,\n+  localAddress: 1,\n+  maxPreparedStatements: 1,\n+  multipleStatements: 1,\n+  namedPlaceholders: 1,\n+  nestTables: 1,\n+  password: 1,\n+  // with multi-factor authentication, the main password (used for the first\n+  // authentication factor) can be provided via password1\n+  password1: 1,\n",
					"match": false,
					"packageHash": "9d36f62b8bc6105b17d743fbecca03a26308267e593c9aa9c68dafffe3848a53",
					"size": 3748,
					"sourceHash": "a6aaa7b9fd346c1679bd855f23c8ab5c8f8d4bd80c8af80db570635d565b507b",
					"status": "content"
				},
				"lib/connection_fq.js": {
					"match": false,
					"packageHash": "df6d992334c623eb0acaed8c190707ab5ac4a9ec9b0e1e460a8cc6237cd5b4e1",
					"size": 10057,
					"status": "missing-in-source"
				},
				"lib/constants/charsets.js": {
					"diff": "--- published/lib/constants/charsets.js\n+++ rebuilt/lib/constants/charsets.js\n@@ -1,195 +1,317 @@\n-exports.BIG5_CHINESE_CI        = 1;\n-exports.LATIN2_CZECH_CS        = 2;\n-exports.DEC8_SWEDISH_CI        = 3;\n-exports.CP850_GENERAL_CI       = 4;\n-exports.LATIN1_GERMAN1_CI      = 5;\n-exports.HP8_ENGLISH_CI         = 6;\n-exports.KOI8R_GENERAL_CI       = 7;\n-exports.LATIN1_SWEDISH_CI      = 8;\n-exports.LATIN2_GENERAL_CI      = 9;\n-exports.SWE7_SWEDISH_CI        = 10;\n-exports.ASCII_GENERAL_CI       = 11;\n-exports.UJIS_JAPANESE_CI       = 12;\n-exports.SJIS_JAPANESE_CI       = 13;\n-exports.CP1251_BULGARIAN_CI    = 14;\n-exports.LATIN1_DANISH_CI       = 15;\n-exports.HEBREW_GENERAL_CI      = 16;\n-exports.TIS620_THAI_CI         = 18;\n-exports.EUCKR_KOREAN_CI        = 19;\n-exports.LATIN7_ESTONIAN_CS     = 20;\n-exports.LATIN2_HUNGARIAN_CI    = 21;\n-exports.KOI8U_GENERAL_CI       = 22;\n-exports.CP1251_UKRAINIAN_CI    = 23;\n-exports.GB2312_CHINESE_CI      = 24;\n-exports.GREEK_GENERAL_CI       = 25;\n-exports.CP1250_GENERAL_CI      = 26;\n-exports.LATIN2_CROATIAN_CI     = 27;\n-exports.GBK_CHINESE_CI         = 28;\n-exports.CP1257_LITHUANIAN_CI   = 29;\n-exports.LATIN5_TURKISH_CI      = 30;\n-exports.LATIN1_GERMAN2_CI      = 31;\n-exports.ARMSCII8_GENERAL_CI    = 32;\n-exports.UTF8_GENERAL_CI        = 33;\n-exports.CP1250_CZECH_CS        = 34;\n-exports.UCS2_GENERAL_CI        = 35;\n-exports.CP866_GENERAL_CI       = 36;\n-exports.KEYBCS2_GENERAL_CI     = 37;\n-exports.MACCE_GENERAL_CI       = 38;\n-exports.MACROMAN_GENERAL_CI    = 39;\n-exports.CP852_GENERAL_CI       = 40;\n-exports.LATIN7_GENERAL_CI      = 41;\n-exports.LATIN7_GENERAL_CS      = 42;\n-exports.MACCE_BIN              = 43;\n-exports.CP1250_CROATIAN_CI     = 44;\n-exports.UTF8MB4_GENERAL_CI     = 45;\n-exports.UTF8MB4_BIN            = 46;\n-exports.LATIN1_BIN             = 47;\n-exports.LATIN1_GENERAL_CI      = 48;\n-exports.LATIN1_GENERAL_CS      = 49;\n-exports.CP1251_BIN             = 50;\n-exports.CP1251_GENERAL_CI      = 51;\n-exports.CP1251_GENERAL_CS      = 52;\n-exports.MACROMAN_BIN           = 53;\n-exports.UTF16_GENERAL_CI       = 54;\n-exports.UTF16_BIN              = 55;\n-exports.CP1256_GENERAL_CI      = 57;\n-exports.CP1257_BIN             = 58;\n-exports.CP1257_GENERAL_CI      = 59;\n-exports.UTF32_GENERAL_CI       = 60;\n-exports.UTF32_BIN              = 61;\n-exports.BINARY                 = 63;\n-exports.ARMSCII8_BIN           = 64;\n-exports.ASCII_BIN              = 65;\n-exports.CP1250_BIN             = 66;\n-exports.CP1256_BIN             = 67;\n-exports.CP866_BIN              = 68;\n-exports.DEC8_BIN               = 69;\n-exports.GREEK_BIN              = 70;\n-exports.HEBREW_BIN             = 71;\n-exports.HP8_BIN                = 72;\n-exports.KEYBCS2_BIN            = 73;\n-exports.KOI8R_BIN              = 74;\n-exports.KOI8U_BIN              = 75;\n-exports.LATIN2_BIN             = 77;\n-exports.LATIN5_BIN             = 78;\n-exports.LATIN7_BIN             = 79;\n-exports.CP850_BIN              = 80;\n-exports.CP852_BIN              = 81;\n-exports.SWE7_BIN               = 82;\n-exports.UTF8_BIN               = 83;\n-exports.BIG5_BIN               = 84;\n-exports.EUCKR_BIN              = 85;\n-exports.GB2312_BIN             = 86;\n-exports.GBK_BIN                = 87;\n-exports.SJIS_BIN               = 88;\n-exports.TIS620_BIN             = 89;\n-exports.UCS2_BIN               = 90;\n-exports.UJIS_BIN               = 91;\n-exports.GEOSTD8_GENERAL_CI     = 92;\n-exports.GEOSTD8_BIN            = 93;\n-exports.LATIN1_SPANISH_CI      = 94;\n-exports.CP932_JAPANESE_CI      = 95;\n-exports.CP932_BIN              = 96;\n-exports.EUCJPMS_JAPANESE_CI    = 97;\n-exports.EUCJPMS_BIN            = 98;\n-exports.CP1250_POLISH_CI       = 99;\n-exports.UTF16_UNICODE_CI       = 101;\n-exports.UTF16_ICELANDIC_CI     = 102;\n",
					"match": false,
					"packageHash": "a3b3b0e22c0b27eaf471fbb56df3b01c8bd31dff6c2142cfa6cd9786b6a5adf9",
					"size": 7305,
					"sourceHash": "752a71ac24bee3651dfad46cae49b6b6fba697f0cb2f212d6def312093a5fa0c",
					"status": "content"
				},
				"lib/constants/client.js": {
					"diff": "--- published/lib/constants/client.js\n+++ rebuilt/lib/constants/client.js\n@@ -1,26 +1,39 @@\n-// Manually extracted from mysql-5.5.23/include/mysql_com.h\n-exports.LONG_PASSWORD     = 1; /* new more secure passwords */\n-exports.FOUND_ROWS        = 2; /* Found instead of affected rows */\n-exports.LONG_FLAG         = 4; /* Get all column flags */\n-exports.CONNECT_WITH_DB   = 8; /* One can specify db on connect */\n-exports.NO_SCHEMA         = 16; /* Don't allow database.table.column */\n-exports.COMPRESS          = 32; /* Can use compression protocol */\n-exports.ODBC              = 64; /* Odbc client */\n-exports.LOCAL_FILES       = 128; /* Can use LOAD DATA LOCAL */\n-exports.IGNORE_SPACE      = 256; /* Ignore spaces before '(' */\n-exports.PROTOCOL_41       = 512; /* New 4.1 protocol */\n-exports.INTERACTIVE       = 1024; /* This is an interactive client */\n-exports.SSL               = 2048; /* Switch to SSL after handshake */\n-exports.IGNORE_SIGPIPE    = 4096;    /* IGNORE sigpipes */\n-exports.TRANSACTIONS      = 8192; /* Client knows about transactions */\n-exports.RESERVED          = 16384;   /* Old flag for 4.1 protocol  */\n-exports.SECURE_CONNECTION = 32768;  /* New 4.1 authentication */\n+// This file was modified by Oracle on September 21, 2021.\n+// New capability for multi-factor authentication based on mandatory session\n+// trackers, that are signaled with an extra single-byte prefix on new\n+// versions of the MySQL server.\n+// Modifications copyright (c) 2021, Oracle and/or its affiliates.\n+\n+'use strict';\n \n-exports.MULTI_STATEMENTS = 65536; /* Enable/disable multi-stmt support */\n-exports.MULTI_RESULTS    = 131072; /* Enable/disable multi-results */\n-exports.PS_MULTI_RESULTS = 262144; /* Multi-results in PS-protocol */\n+// Manually extracted from mysql-5.5.23/include/mysql_com.h\n+exports.LONG_PASSWORD = 0x00000001; /* new more secure passwords */\n+exports.FOUND_ROWS = 0x00000002; /* found instead of affected rows */\n+exports.LONG_FLAG = 0x00000004; /* get all column flags */\n+exports.CONNECT_WITH_DB = 0x00000008; /* one can specify db on connect */\n+exports.NO_SCHEMA = 0x00000010; /* don't allow database.table.column */\n+exports.COMPRESS = 0x00000020; /* can use compression protocol */\n+exports.ODBC = 0x00000040; /* odbc client */\n+exports.LOCAL_FILES = 0x00000080; /* can use LOAD DATA LOCAL */\n+exports.IGNORE_SPACE = 0x00000100; /* ignore spaces before '' */\n+exports.PROTOCOL_41 = 0x00000200; /* new 4.1 protocol */\n+exports.INTERACTIVE = 0x00000400; /* this is an interactive client */\n+exports.SSL = 0x00000800; /* switch to ssl after handshake */\n+exports.IGNORE_SIGPIPE = 0x00001000; /* IGNORE sigpipes */\n+exports.TRANSACTIONS = 0x00002000; /* client knows about transactions */\n+exports.RESERVED = 0x00004000; /* old flag for 4.1 protocol  */\n+exports.SECURE_CONNECTION = 0x00008000; /* new 4.1 authentication */\n+exports.MULTI_STATEMENTS = 0x00010000; /* enable/disable multi-stmt support */\n+exports.MULTI_RESULTS = 0x00020000; /* enable/disable multi-results */\n+exports.PS_MULTI_RESULTS = 0x00040000; /* multi-results in ps-protocol */\n+exports.PLUGIN_AUTH = 0x00080000; /* client supports plugin authentication */\n+exports.CONNECT_ATTRS = 0x00100000; /* permits connection attributes */\n+exports.PLUGIN_AUTH_LENENC_CLIENT_DATA = 0x00200000; /* Understands length-encoded integer for auth response data in Protocol::HandshakeResponse41. */\n+exports.CAN_HANDLE_EXPIRED_PASSWORDS = 0x00400000; /* Announces support for expired password extension. */\n+exports.SESSION_TRACK = 0x00800000; /* Can set SERVER_SESSION_STATE_CHANGED in the Status Flags and send session-state change data after a OK packet. */\n+exports.DEPRECATE_EOF = 0x01000000; /* Can send OK after a Text Resultset. */\n \n-exports.PLUGIN_AUTH = 524288; /* Client supports plugin authentication */\n+exports.SSL_VERIFY_SERVER_CERT = 0x40000000;\n+exports.REMEMBER_OPTIONS = 0x80000000;\n \n-exports.SSL_VERIFY_SERVER_CERT = 1073741824;\n-exports.REMEMBER_OPTIONS       = 2147483648;\n+exports.MULTI_FACTOR_AUTHENTICATION = 0x10000000; /* multi-factor authentication */\n",
					"match": false,
					"packageHash": "aa1d1346eeb89273da43d7ee02054dc85c19ea9b528e4781d76025f18c4ced9e",
					"size": 1475,
					"sourceHash": "4d5594c15d28aa4f8f10d5ac8cb0522237325120933a76e2a57a4520661e892e",
					"status": "content"
				},
				"lib/constants/commands.js": {
					"diff": "--- published/lib/constants/commands.js\n+++ rebuilt/lib/constants/commands.js\n@@ -1,5 +1,36 @@\n+'use strict';\n+\n module.exports = {\n+  SLEEP: 0x00, // deprecated\n+  QUIT: 0x01,\n+  INIT_DB: 0x02,\n   QUERY: 0x03,\n-  PREPARE: 0x16,\n-  EXECUTE: 0x17\n+  FIELD_LIST: 0x04,\n+  CREATE_DB: 0x05,\n+  DROP_DB: 0x06,\n+  REFRESH: 0x07,\n+  SHUTDOWN: 0x08,\n+  STATISTICS: 0x09,\n+  PROCESS_INFO: 0x0a, // deprecated\n+  CONNECT: 0x0b, // deprecated\n+  PROCESS_KILL: 0x0c,\n+  DEBUG: 0x0d,\n+  PING: 0x0e,\n+  TIME: 0x0f, // deprecated\n+  DELAYED_INSERT: 0x10, // deprecated\n+  CHANGE_USER: 0x11,\n+  BINLOG_DUMP: 0x12,\n+  TABLE_DUMP: 0x13,\n+  CONNECT_OUT: 0x14,\n+  REGISTER_SLAVE: 0x15,\n+  STMT_PREPARE: 0x16,\n+  STMT_EXECUTE: 0x17,\n+  STMT_SEND_LONG_DATA: 0x18,\n+  STMT_CLOSE: 0x19,\n+  STMT_RESET: 0x1a,\n+  SET_OPTION: 0x1b,\n+  STMT_FETCH: 0x1c,\n+  DAEMON: 0x1d, // deprecated\n+  BINLOG_DUMP_GTID: 0x1e,\n+  UNKNOWN: 0xff, // bad!\n };\n",
					"match": false,
					"packageHash": "a79ac69309d8bd1e7bd368b8ccd7e6ab8dcbec091d2be84ee433ab32a9644322",
					"size": 70,
					"sourceHash": "fc5f6ba56dc5e847d43fe3ed62f51a49e5c1f7ed8c411bb2e46f1b1998768fa2",
					"status": "content"
				},
				"lib/constants/cursor.js": {
					"diff": "--- published/lib/constants/cursor.js\n+++ rebuilt/lib/constants/cursor.js\n@@ -1,6 +1,8 @@\n+'use strict';\n+\n module.exports = {\n   NO_CURSOR: 0,\n   READ_ONLY: 1,\n   FOR_UPDATE: 2,\n-  SCROLLABLE: 3\n+  SCROLLABLE: 3,\n };\n",
					"match": false,
					"packageHash": "16d660ddfe5ee147e4e89bb1896bb948b1cc17e53ce6a7ed3b3736fcdeeb6055",
					"size": 87,
					"sourceHash": "f565588e6be5663bad08e755aa86040630aec8419bece24cd9356dd2ded3009a",
					"status": "content"
				},
				"lib/constants/errors.js": {
					"diff": "--- published/lib/constants/errors.js\n+++ rebuilt/lib/constants/errors.js\n@@ -1,726 +1,3973 @@\n-// Generated by generate-error-constants.js, do not modify by hand\n-module.exports.codeToName  = [];\n-module.exports.codeToName[1000] = 'ER_HASHCHK';\n-module.exports.codeToName[1001] = 'ER_NISAMCHK';\n-module.exports.codeToName[1002] = 'ER_NO';\n-module.exports.codeToName[1003] = 'ER_YES';\n-module.exports.codeToName[1004] = 'ER_CANT_CREATE_FILE';\n-module.exports.codeToName[1005] = 'ER_CANT_CREATE_TABLE';\n-module.exports.codeToName[1006] = 'ER_CANT_CREATE_DB';\n-module.exports.codeToName[1007] = 'ER_DB_CREATE_EXISTS';\n-module.exports.codeToName[1008] = 'ER_DB_DROP_EXISTS';\n-module.exports.codeToName[1009] = 'ER_DB_DROP_DELETE';\n-module.exports.codeToName[1010] = 'ER_DB_DROP_RMDIR';\n-module.exports.codeToName[1011] = 'ER_CANT_DELETE_FILE';\n-module.exports.codeToName[1012] = 'ER_CANT_FIND_SYSTEM_REC';\n-module.exports.codeToName[1013] = 'ER_CANT_GET_STAT';\n-module.exports.codeToName[1014] = 'ER_CANT_GET_WD';\n-module.exports.codeToName[1015] = 'ER_CANT_LOCK';\n-module.exports.codeToName[1016] = 'ER_CANT_OPEN_FILE';\n-module.exports.codeToName[1017] = 'ER_FILE_NOT_FOUND';\n-module.exports.codeToName[1018] = 'ER_CANT_READ_DIR';\n-module.exports.codeToName[1019] = 'ER_CANT_SET_WD';\n-module.exports.codeToName[1020] = 'ER_CHECKREAD';\n-module.exports.codeToName[1021] = 'ER_DISK_FULL';\n-module.exports.codeToName[1022] = 'ER_DUP_KEY';\n-module.exports.codeToName[1023] = 'ER_ERROR_ON_CLOSE';\n-module.exports.codeToName[1024] = 'ER_ERROR_ON_READ';\n-module.exports.codeToName[1025] = 'ER_ERROR_ON_RENAME';\n-module.exports.codeToName[1026] = 'ER_ERROR_ON_WRITE';\n-module.exports.codeToName[1027] = 'ER_FILE_USED';\n-module.exports.codeToName[1028] = 'ER_FILSORT_ABORT';\n-module.exports.codeToName[1029] = 'ER_FORM_NOT_FOUND';\n-module.exports.codeToName[1030] = 'ER_GET_ERRNO';\n-module.exports.codeToName[1031] = 'ER_ILLEGAL_HA';\n-module.exports.codeToName[1032] = 'ER_KEY_NOT_FOUND';\n-module.exports.codeToName[1033] = 'ER_NOT_FORM_FILE';\n-module.exports.codeToName[1034] = 'ER_NOT_KEYFILE';\n-module.exports.codeToName[1035] = 'ER_OLD_KEYFILE';\n-module.exports.codeToName[1036] = 'ER_OPEN_AS_READONLY';\n-module.exports.codeToName[1037] = 'ER_OUTOFMEMORY';\n-module.exports.codeToName[1038] = 'ER_OUT_OF_SORTMEMORY';\n-module.exports.codeToName[1039] = 'ER_UNEXPECTED_EOF';\n-module.exports.codeToName[1040] = 'ER_CON_COUNT_ERROR';\n-module.exports.codeToName[1041] = 'ER_OUT_OF_RESOURCES';\n-module.exports.codeToName[1042] = 'ER_BAD_HOST_ERROR';\n-module.exports.codeToName[1043] = 'ER_HANDSHAKE_ERROR';\n-module.exports.codeToName[1044] = 'ER_DBACCESS_DENIED_ERROR';\n-module.exports.codeToName[1045] = 'ER_ACCESS_DENIED_ERROR';\n-module.exports.codeToName[1046] = 'ER_NO_DB_ERROR';\n-module.exports.codeToName[1047] = 'ER_UNKNOWN_COM_ERROR';\n-module.exports.codeToName[1048] = 'ER_BAD_NULL_ERROR';\n-module.exports.codeToName[1049] = 'ER_BAD_DB_ERROR';\n-module.exports.codeToName[1050] = 'ER_TABLE_EXISTS_ERROR';\n-module.exports.codeToName[1051] = 'ER_BAD_TABLE_ERROR';\n-module.exports.codeToName[1052] = 'ER_NON_UNIQ_ERROR';\n-module.exports.codeToName[1053] = 'ER_SERVER_SHUTDOWN';\n-module.exports.codeToName[1054] = 'ER_BAD_FIELD_ERROR';\n-module.exports.codeToName[1055] = 'ER_WRONG_FIELD_WITH_GROUP';\n-module.exports.codeToName[1056] = 'ER_WRONG_GROUP_FIELD';\n-module.exports.codeToName[1057] = 'ER_WRONG_SUM_SELECT';\n-module.exports.codeToName[1058] = 'ER_WRONG_VALUE_COUNT';\n-module.exports.codeToName[1059] = 'ER_TOO_LONG_IDENT';\n-module.exports.codeToName[1060] = 'ER_DUP_FIELDNAME';\n-module.exports.codeToName[1061] = 'ER_DUP_KEYNAME';\n-module.exports.codeToName[1062] = 'ER_DUP_ENTRY';\n-module.exports.codeToName[1063] = 'ER_WRONG_FIELD_SPEC';\n-module.exports.codeToName[1064] = 'ER_PARSE_ERROR';\n-module.exports.codeToName[1065] = 'ER_EMPTY_QUERY';\n-module.exports.codeToName[1066] = 'ER_NONUNIQ_TABLE';\n-module.exports.codeToName[1067] = 'ER_INVALID_DEFAULT';\n-module.exports.codeToName[1068] = 'ER_MULTIPLE_PRI_KEY';\n-module.exports.codeToName[1069] = 'ER_TOO_MANY_KEYS';\n-module.exports.codeToName[1070] = 'ER_TOO_MANY_KEY_PARTS';\n-module.exports.codeToName[1071] = 'ER_TOO_LONG_KEY';\n-module.exports.codeToName[1072] = 'ER_KEY_COLUMN_DOES_NOT_EXITS';\n-module.exports.codeToName[1073] = 'ER_BLOB_USED_AS_KEY';\n-module.exports.codeToName[1074] = 'ER_TOO_BIG_FIELDLENGTH';\n-module.exports.codeToName[1075] = 'ER_WRONG_AUTO_KEY';\n-module.exports.codeToName[1076] = 'ER_READY';\n-module.exports.codeToName[1077] = 'ER_NORMAL_SHUTDOWN';\n-module.exports.codeToName[1078] = 'ER_GOT_SIGNAL';\n-module.exports.codeToName[1079] = 'ER_SHUTDOWN_COMPLETE';\n-module.exports.codeToName[1080] = 'ER_FORCING_CLOSE';\n-module.exports.codeToName[1081] = 'ER_IPSOCK_ERROR';\n-module.exports.codeToName[1082] = 'ER_NO_SUCH_INDEX';\n-module.exports.codeToName[1083] = 'ER_WRONG_FIELD_TERMINATORS';\n-module.exports.codeToName[1084] = 'ER_BLOBS_AND_NO_TERMINATED';\n-module.exports.codeToName[1085] = 'ER_TEXTFILE_NOT_READABLE';\n-module.exports.codeToName[1086] = 'ER_FILE_EXISTS_ERROR';\n-module.exports.codeToName[1087] = 'ER_LOAD_INFO';\n-module.exports.codeToName[1088] = 'ER_ALTER_INFO';\n-module.exports.codeToName[1089] = 'ER_WRONG_SUB_KEY';\n-module.exports.codeToName[1090] = 'ER_CANT_REMOVE_ALL_FIELDS';\n-module.exports.codeToName[1091] = 'ER_CANT_DROP_FIELD_OR_KEY';\n-module.exports.codeToName[1092] = 'ER_INSERT_INFO';\n-module.exports.codeToName[1093] = 'ER_UPDATE_TABLE_USED';\n-module.exports.codeToName[1094] = 'ER_NO_SUCH_THREAD';\n",
					"match": false,
					"packageHash": "18373b61fe4c6acad6534b56a6fcb4071bd21ed094fe889545f26046c1e44bf5",
					"size": 44480,
					"sourceHash": "4778749caf383bcdef6e45750fcc1fbe99d530806367a74c485409ce79156164",
					"status": "content"
				},
				"lib/constants/field_flags.js": {
					"diff": "--- published/lib/constants/field_flags.js\n+++ rebuilt/lib/constants/field_flags.js\n@@ -1,18 +1,20 @@\n+'use strict';\n+\n // Manually extracted from mysql-5.5.23/include/mysql_com.h\n-exports.NOT_NULL     = 1; /* Field can't be NULL */\n-exports.PRI_KEY      = 2; /* Field is part of a primary key */\n-exports.UNIQUE_KEY   = 4; /* Field is part of a unique key */\n+exports.NOT_NULL = 1; /* Field can't be NULL */\n+exports.PRI_KEY = 2; /* Field is part of a primary key */\n+exports.UNIQUE_KEY = 4; /* Field is part of a unique key */\n exports.MULTIPLE_KEY = 8; /* Field is part of a key */\n-exports.BLOB         = 16; /* Field is a blob */\n-exports.UNSIGNED     = 32; /* Field is unsigned */\n-exports.ZEROFILL     = 64; /* Field is zerofill */\n-exports.BINARY       = 128; /* Field is binary   */\n+exports.BLOB = 16; /* Field is a blob */\n+exports.UNSIGNED = 32; /* Field is unsigned */\n+exports.ZEROFILL = 64; /* Field is zerofill */\n+exports.BINARY = 128; /* Field is binary   */\n \n /* The following are only sent to new clients */\n-exports.ENUM             = 256; /* field is an enum */\n-exports.AUTO_INCREMENT   = 512; /* field is a autoincrement field */\n-exports.TIMESTAMP        = 1024; /* Field is a timestamp */\n-exports.SET              = 2048; /* field is a set */\n+exports.ENUM = 256; /* field is an enum */\n+exports.AUTO_INCREMENT = 512; /* field is a autoincrement field */\n+exports.TIMESTAMP = 1024; /* Field is a timestamp */\n+exports.SET = 2048; /* field is a set */\n exports.NO_DEFAULT_VALUE = 4096; /* Field doesn't have default value */\n-exports.ON_UPDATE_NOW    = 8192; /* Field is set to NOW on UPDATE */\n-exports.NUM              = 32768; /* Field is num (for clients) */\n+exports.ON_UPDATE_NOW = 8192; /* Field is set to NOW on UPDATE */\n+exports.NUM = 32768; /* Field is num (for clients) */\n",
					"match": false,
					"packageHash": "d56198da1baa668d1d2c5fbda30ba23d9f46af16790be88b394d43a82fc018ef",
					"size": 991,
					"sourceHash": "6e10d228a15efa9c2393ee5551ef9639cb31ad211035424c0f5a5e7631419c2e",
					"status": "content"
				},
				"lib/constants/server_status.js": {
					"diff": "--- published/lib/constants/server_status.js\n+++ rebuilt/lib/constants/server_status.js\n@@ -1,3 +1,5 @@\n+'use strict';\n+\n // Manually extracted from mysql-5.5.23/include/mysql_com.h\n \n /**\n@@ -7,11 +9,11 @@\n   implicitly, by the first transactional\n   statement, when autocommit=off.\n */\n-exports.SERVER_STATUS_IN_TRANS          = 1;\n-exports.SERVER_STATUS_AUTOCOMMIT        = 2;  /* Server in auto_commit mode */\n-exports.SERVER_MORE_RESULTS_EXISTS      = 8;    /* Multi query - next query exists */\n+exports.SERVER_STATUS_IN_TRANS = 1;\n+exports.SERVER_STATUS_AUTOCOMMIT = 2; /* Server in auto_commit mode */\n+exports.SERVER_MORE_RESULTS_EXISTS = 8; /* Multi query - next query exists */\n exports.SERVER_QUERY_NO_GOOD_INDEX_USED = 16;\n-exports.SERVER_QUERY_NO_INDEX_USED      = 32;\n+exports.SERVER_QUERY_NO_INDEX_USED = 32;\n /**\n   The server was able to fulfill the clients request and opened a\n   read-only non-scrollable cursor for a query. This flag comes\n@@ -22,18 +24,21 @@\n   This flag is sent when a read-only cursor is exhausted, in reply to\n   COM_STMT_FETCH command.\n */\n-exports.SERVER_STATUS_LAST_ROW_SENT        = 128;\n-exports.SERVER_STATUS_DB_DROPPED           = 256; /* A database was dropped */\n+exports.SERVER_STATUS_LAST_ROW_SENT = 128;\n+exports.SERVER_STATUS_DB_DROPPED = 256; /* A database was dropped */\n exports.SERVER_STATUS_NO_BACKSLASH_ESCAPES = 512;\n /**\n   Sent to the client if after a prepared statement reprepare\n-  we discovered that the new statement returns a different \n+  we discovered that the new statement returns a different\n   number of result set columns.\n */\n exports.SERVER_STATUS_METADATA_CHANGED = 1024;\n-exports.SERVER_QUERY_WAS_SLOW          = 2048;\n+exports.SERVER_QUERY_WAS_SLOW = 2048;\n \n /**\n   To mark ResultSet containing output parameter values.\n */\n exports.SERVER_PS_OUT_PARAMS = 4096;\n+\n+exports.SERVER_STATUS_IN_TRANS_READONLY = 0x2000; // in a read-only transaction\n+exports.SERVER_SESSION_STATE_CHANGED = 0x4000;\n",
					"match": false,
					"packageHash": "bccc66d429a9919f964f94390d252018340edeb18a3bedcdb396ebc0477e594a",
					"size": 1450,
					"sourceHash": "85dfcaeb3c8c0a4e9188fd1f04671da9d15dbe2e0ff785ff31cb2950709f6928",
					"status": "content"
				},
				"lib/constants/types.js": {
					"diff": "--- published/lib/constants/types.js\n+++ rebuilt/lib/constants/types.js\n@@ -1,29 +1,64 @@\n+'use strict';\n+\n+module.exports = {\n+  0x00: 'DECIMAL', // aka DECIMAL\n+  0x01: 'TINY', // aka TINYINT, 1 byte\n+  0x02: 'SHORT', // aka SMALLINT, 2 bytes\n+  0x03: 'LONG', // aka INT, 4 bytes\n+  0x04: 'FLOAT', // aka FLOAT, 4-8 bytes\n+  0x05: 'DOUBLE', // aka DOUBLE, 8 bytes\n+  0x06: 'NULL', // NULL (used for prepared statements, I think)\n+  0x07: 'TIMESTAMP', // aka TIMESTAMP\n+  0x08: 'LONGLONG', // aka BIGINT, 8 bytes\n+  0x09: 'INT24', // aka MEDIUMINT, 3 bytes\n+  0x0a: 'DATE', // aka DATE\n+  0x0b: 'TIME', // aka TIME\n+  0x0c: 'DATETIME', // aka DATETIME\n+  0x0d: 'YEAR', // aka YEAR, 1 byte (don't ask)\n+  0x0e: 'NEWDATE', // aka ?\n+  0x0f: 'VARCHAR', // aka VARCHAR (?)\n+  0x10: 'BIT', // aka BIT, 1-8 byte\n+  0xf5: 'JSON',\n+  0xf6: 'NEWDECIMAL', // aka DECIMAL\n+  0xf7: 'ENUM', // aka ENUM\n+  0xf8: 'SET', // aka SET\n+  0xf9: 'TINY_BLOB', // aka TINYBLOB, TINYTEXT\n+  0xfa: 'MEDIUM_BLOB', // aka MEDIUMBLOB, MEDIUMTEXT\n+  0xfb: 'LONG_BLOB', // aka LONGBLOG, LONGTEXT\n+  0xfc: 'BLOB', // aka BLOB, TEXT\n+  0xfd: 'VAR_STRING', // aka VARCHAR, VARBINARY\n+  0xfe: 'STRING', // aka CHAR, BINARY\n+  0xff: 'GEOMETRY', // aka GEOMETRY\n+};\n+\n // Manually extracted from mysql-5.5.23/include/mysql_com.h\n // some more info here: http://dev.mysql.com/doc/refman/5.5/en/c-api-prepared-statement-type-codes.html\n-exports.DECIMAL     = 0x00; // aka DECIMAL (http://dev.mysql.com/doc/refman/5.0/en/precision-math-decimal-changes.html)\n-exports.TINY        = 0x01; // aka TINYINT, 1 byte\n-exports.SHORT       = 0x02; // aka SMALLINT, 2 bytes\n-exports.LONG        = 0x03; // aka INT, 4 bytes\n-exports.FLOAT       = 0x04; // aka FLOAT, 4-8 bytes\n-exports.DOUBLE      = 0x05; // aka DOUBLE, 8 bytes\n-exports.NULL        = 0x06; // NULL (used for prepared statements, I think)\n-exports.TIMESTAMP   = 0x07; // aka TIMESTAMP\n-exports.LONGLONG    = 0x08; // aka BIGINT, 8 bytes\n-exports.INT24       = 0x09; // aka MEDIUMINT, 3 bytes\n-exports.DATE        = 0x0a; // aka DATE\n-exports.TIME        = 0x0b; // aka TIME\n-exports.DATETIME    = 0x0c; // aka DATETIME\n-exports.YEAR        = 0x0d; // aka YEAR, 1 byte (don't ask)\n-exports.NEWDATE     = 0x0e; // aka ?\n-exports.VARCHAR     = 0x0f; // aka VARCHAR (?)\n-exports.BIT         = 0x10; // aka BIT, 1-8 byte\n-exports.NEWDECIMAL  = 0xf6; // aka DECIMAL\n-exports.ENUM        = 0xf7; // aka ENUM\n-exports.SET         = 0xf8; // aka SET\n-exports.TINY_BLOB   = 0xf9; // aka TINYBLOB, TINYTEXT\n-exports.MEDIUM_BLOB = 0xfa; // aka MEDIUMBLOB, MEDIUMTEXT\n-exports.LONG_BLOB   = 0xfb; // aka LONGBLOG, LONGTEXT\n-exports.BLOB        = 0xfc; // aka BLOB, TEXT\n-exports.VAR_STRING  = 0xfd; // aka VARCHAR, VARBINARY\n-exports.STRING      = 0xfe; // aka CHAR, BINARY\n-exports.GEOMETRY    = 0xff; // aka GEOMETRY\n+module.exports.DECIMAL = 0x00; // aka DECIMAL (http://dev.mysql.com/doc/refman/5.0/en/precision-math-decimal-changes.html)\n+module.exports.TINY = 0x01; // aka TINYINT, 1 byte\n+module.exports.SHORT = 0x02; // aka SMALLINT, 2 bytes\n+module.exports.LONG = 0x03; // aka INT, 4 bytes\n+module.exports.FLOAT = 0x04; // aka FLOAT, 4-8 bytes\n+module.exports.DOUBLE = 0x05; // aka DOUBLE, 8 bytes\n+module.exports.NULL = 0x06; // NULL (used for prepared statements, I think)\n+module.exports.TIMESTAMP = 0x07; // aka TIMESTAMP\n+module.exports.LONGLONG = 0x08; // aka BIGINT, 8 bytes\n+module.exports.INT24 = 0x09; // aka MEDIUMINT, 3 bytes\n+module.exports.DATE = 0x0a; // aka DATE\n+module.exports.TIME = 0x0b; // aka TIME\n+module.exports.DATETIME = 0x0c; // aka DATETIME\n+module.exports.YEAR = 0x0d; // aka YEAR, 1 byte (don't ask)\n+module.exports.NEWDATE = 0x0e; // aka ?\n+module.exports.VARCHAR = 0x0f; // aka VARCHAR (?)\n+module.exports.BIT = 0x10; // aka BIT, 1-8 byte\n+module.exports.VECTOR = 0xf2;\n+module.exports.JSON = 0xf5;\n+module.exports.NEWDECIMAL = 0xf6; // aka DECIMAL\n+module.exports.ENUM = 0xf7; // aka ENUM\n+module.exports.SET = 0xf8; // aka SET\n+module.exports.TINY_BLOB = 0xf9; // aka TINYBLOB, TINYTEXT\n+module.exports.MEDIUM_BLOB = 0xfa; // aka MEDIUMBLOB, MEDIUMTEXT\n+module.exports.LONG_BLOB = 0xfb; // aka LONGBLOG, LONGTEXT\n+module.exports.BLOB = 0xfc; // aka BLOB, TEXT\n+module.exports.VAR_STRING = 0xfd; // aka VARCHAR, VARBINARY\n+module.exports.STRING = 0xfe; // aka CHAR, BINARY\n+module.exports.GEOMETRY = 0xff; // aka GEOMETRY\n",
					"match": false,
					"packageHash": "fcd25e828fd0680cb9076403f056a57e27a266e8894bbed7b8f53011e9922098",
					"size": 1562,
					"sourceHash": "7a0ca576c46ab457e9ccc5734c64088dbb93dfb66c3b926246150e8897866ef1",
					"status": "content"
				},
				"lib/packet_parser.js": {
					"diff": "--- published/lib/packet_parser.js\n+++ rebuilt/lib/packet_parser.js\n@@ -1,82 +1,195 @@\n-var Packet   = require('./packets/packet');\n+'use strict';\n \n-// as this is very low level parser, EventEmitter is not used\n-// onPayload(sequenceId, payload) is called for each mysql packet\n-function PacketParser(onPacket)\n-{\n-  // array of last payload chunks\n-  // only used when corrent payload is not complete\n-  this.buffer = [];\n-  // total length of chunks on buffer\n-  this.bufferLength = 0;\n-  this.headerLen = 0;\n-  this.headerBuff = Buffer(4);\n-\n-  this.state = 'head0';\n-\n-  // expected payload length\n-  this.length = 0;\n-  this.sequenceId = 0;\n-  this.onPacket = onPacket;\n+const Packet = require('./packets/packet.js');\n+\n+const MAX_PACKET_LENGTH = 16777215;\n+\n+function readPacketLength(b, off) {\n+  const b0 = b[off];\n+  const b1 = b[off + 1];\n+  const b2 = b[off + 2];\n+  if (b1 + b2 === 0) {\n+    return b0;\n+  }\n+  return b0 + (b1 << 8) + (b2 << 16);\n }\n \n-PacketParser.prototype.execute = function(chunk, start, end) {\n-  //var length = end - start;\n-  //if (length == 0)\n-  //  return;\n-  while (start < chunk.length) {\n-    if (this.state == 'head0' && (end - start) > 3) {\n-      this.length = chunk[start] + (chunk[start+1] << 8) + (chunk[start+2] << 16);\n-      this.sequenceId = chunk[start+3];\n-      var packetLength = this.length + 4;\n-      if (end - start > packetLength) { // more than one packet in chunk\n-        this.onPacket(new Packet(this.sequenceId, chunk, start + 4, start + packetLength));\n-        start += packetLength;\n-      } else if (end - start == packetLength) {\n-        return this.onPacket(new Packet(this.sequenceId, chunk, start + 4, start + packetLength));\n-      } else { // payload is incomplete\n-        this.buffer = [chunk.slice(start + 4, end)];\n-        this.bufferLength = end - start - 4;\n-        this.state = 'payload';\n-        return;\n-      }\n-    } else if (this.state == 'payload') {\n-      var remainingPayload = this.length - this.bufferLength;\n-      if (end - start >= remainingPayload) { // last chunk for payload\n-        var payload = new Buffer(this.length);\n-        var offset = 0;\n-        for (var i=0; i < this.buffer.length; ++i) {\n-          this.buffer[i].copy(payload, offset);\n-          offset += this.buffer[i].length;\n+class PacketParser {\n+  constructor(onPacket, packetHeaderLength) {\n+    // 4 for normal packets, 7 for comprssed protocol packets\n+    if (typeof packetHeaderLength === 'undefined') {\n+      packetHeaderLength = 4;\n+    }\n+    // array of last payload chunks\n+    // only used when current payload is not complete\n+    this.buffer = [];\n+    // total length of chunks on buffer\n+    this.bufferLength = 0;\n+    this.packetHeaderLength = packetHeaderLength;\n+    // incomplete header state: number of header bytes received\n+    this.headerLen = 0;\n+    // expected payload length\n+    this.length = 0;\n+    this.largePacketParts = [];\n+    this.firstPacketSequenceId = 0;\n+    this.onPacket = onPacket;\n+    this.execute = PacketParser.prototype.executeStart;\n+    this._flushLargePacket =\n+      packetHeaderLength === 7\n+        ? this._flushLargePacket7\n+        : this._flushLargePacket4;\n+  }\n+\n+  _flushLargePacket4() {\n+    const numPackets = this.largePacketParts.length;\n+    this.largePacketParts.unshift(Buffer.from([0, 0, 0, 0])); // insert header\n+    const body = Buffer.concat(this.largePacketParts);\n+    const packet = new Packet(this.firstPacketSequenceId, body, 0, body.length);\n+    this.largePacketParts.length = 0;\n+    packet.numPackets = numPackets;\n+    this.onPacket(packet);\n",
					"match": false,
					"packageHash": "39023c41478d67af5ecc65653102c7e8edbcdf9c42649e3b5b02de3fd15e5b86",
					"size": 2900,
					"sourceHash": "ceb1db3229dc07eefee45cb57761d5995fc91c7face59da3240c1ecd6f95527f",
					"status": "content"
				},
				"lib/packets/binary_row.js": {
					"diff": "--- published/lib/packets/binary_row.js\n+++ rebuilt/lib/packets/binary_row.js\n@@ -1,44 +1,95 @@\n-var Types = require('../constants/types');\n-var Packet = require('../packets/packet');\n+'use strict';\n \n-function BinaryRow(columns)\n-{\n-  this.columns = columns || [];\n-}\n+const Types = require('../constants/types');\n+const Packet = require('../packets/packet');\n+\n+const binaryReader = new Array(256);\n \n-  var binaryReader = new Array(256);\n+class BinaryRow {\n+  constructor(columns) {\n+    this.columns = columns || [];\n+  }\n+\n+  static toPacket(columns, encoding) {\n+    // throw new Error('Not implemented');\n+    const sequenceId = 0; // TODO remove, this is calculated now in connecton\n+    let length = 0;\n+    columns.forEach((val) => {\n+      if (val === null || typeof val === 'undefined') {\n+        ++length;\n+        return;\n+      }\n+      length += Packet.lengthCodedStringLength(val.toString(10), encoding);\n+    });\n+\n+    length = length + 2;\n+\n+    const buffer = Buffer.allocUnsafe(length + 4);\n+    const packet = new Packet(sequenceId, buffer, 0, length + 4);\n+    packet.offset = 4;\n+\n+    packet.writeInt8(0);\n+\n+    let bitmap = 0;\n+    let bitValue = 1;\n+    columns.forEach((parameter) => {\n+      if (parameter.type === Types.NULL) {\n+        bitmap += bitValue;\n+      }\n+      bitValue *= 2;\n+      if (bitValue === 256) {\n+        packet.writeInt8(bitmap);\n+        bitmap = 0;\n+        bitValue = 1;\n+      }\n+    });\n+    if (bitValue !== 1) {\n+      packet.writeInt8(bitmap);\n+    }\n+\n+    columns.forEach((val) => {\n+      if (val === null) {\n+        packet.writeNull();\n+        return;\n+      }\n+      if (typeof val === 'undefined') {\n+        packet.writeInt8(0);\n+        return;\n+      }\n+      packet.writeLengthCodedString(val.toString(10), encoding);\n+    });\n+    return packet;\n+  }\n \n-  // TODO: replace with constants.MYSQL_TYPE_*\n-  binaryReader[Types.DECIMAL] = Packet.prototype.readLengthCodedString;\n-  binaryReader[1] = Packet.prototype.readInt8;   // tiny\n-  binaryReader[2] = Packet.prototype.readInt16;  // short\n-  binaryReader[3] = Packet.prototype.readInt32;  // long\n-  binaryReader[4] = Packet.prototype.readFloat;  // float\n-  binaryReader[5] = Packet.prototype.readDouble; // double\n-  binaryReader[6] = Packet.prototype.assertInvalid; // null, should be skipped vie null bitmap\n-  binaryReader[7] = Packet.prototype.readTimestamp; // timestamp, http://dev.mysql.com/doc/internals/en/prepared-statements.html#packet-ProtocolBinary::MYSQL_TYPE_TIMESTAMP\n-  binaryReader[8] = Packet.prototype.readInt64;  // long long\n-  binaryReader[9] = Packet.prototype.readInt32;  // int24\n-  binaryReader[10] = Packet.prototype.readTimestamp; // date\n-  binaryReader[11] = Packet.prototype.readTime;  // time, http://dev.mysql.com/doc/internals/en/prepared-statements.html#packet-ProtocolBinary::MYSQL_TYPE_TIME\n-  binaryReader[12] = Packet.prototype.readDateTime;  // datetime, http://dev.mysql.com/doc/internals/en/prepared-statements.html#packet-ProtocolBinary::MYSQL_TYPE_DATETIME\n-  binaryReader[13] = Packet.prototype.readInt16;  // year\n-  binaryReader[Types.VAR_STRING] = Packet.prototype.readLengthCodedString;  // var string\n   // TODO: complete list of types...\n+  static fromPacket(fields, packet) {\n+    const columns = new Array(fields.length);\n+    packet.readInt8(); // TODO check it's 0\n+    const nullBitmapLength = Math.floor((fields.length + 7 + 2) / 8);\n+    // TODO: read and interpret null bitmap\n+    packet.skip(nullBitmapLength);\n+    for (let i = 0; i < columns.length; ++i) {\n+      columns[i] = binaryReader[fields[i].columnType].apply(packet);\n+    }\n+    return new BinaryRow(columns);\n",
					"match": false,
					"packageHash": "761bf8441756e972bf0811e86c298bd74abdb3e69397c5e4bdf3676308d35144",
					"size": 2110,
					"sourceHash": "611341ab2858680427478d42210aaaa18520f13843958d86c6e60f6a992ada11",
					"status": "content"
				},
				"lib/packets/column_definition.js": {
					"diff": "--- published/lib/packets/column_definition.js\n+++ rebuilt/lib/packets/column_definition.js\n@@ -1,21 +1,291 @@\n-var Packet = require('../packets/packet');\n+'use strict';\n \n-function ColumnDefinition(packet)\n-{\n-  this.catalog  = packet.readLengthCodedString();\n-  this.schema   = packet.readLengthCodedString();\n-  this.table    = packet.readLengthCodedString();\n-  this.orgTable = packet.readLengthCodedString();\n-  this.name     = packet.readLengthCodedString();\n-  this.orgName  = packet.readLengthCodedString();\n-  packet.skip(1); //  length of the following fields (always 0x0c)\n-  this.characterSet = packet.readInt16();\n-  this.columnLength = packet.readInt32();\n-  this.columnType   = packet.readInt8();\n-  this.flags        = packet.readInt16();\n-  this.decimals     = packet.readInt8();\n+const Packet = require('../packets/packet');\n+const StringParser = require('../parsers/string');\n+const CharsetToEncoding = require('../constants/charset_encodings.js');\n+\n+const fields = ['catalog', 'schema', 'table', 'orgTable', 'name', 'orgName'];\n+\n+// creating JS string is relatively expensive (compared to\n+// reading few bytes from buffer) because all string properties\n+// except for name are unlikely to be used we postpone\n+// string conversion until property access\n+//\n+// TODO: watch for integration benchmarks (one with real network buffer)\n+// there could be bad side effect as keeping reference to a buffer makes it\n+// sit in the memory longer (usually until final .query() callback)\n+// Latest v8 perform much better in regard to bufferer -> string conversion,\n+// at some point of time this optimisation might become unnecessary\n+// see https://github.com/sidorares/node-mysql2/pull/137\n+//\n+class ColumnDefinition {\n+  constructor(packet, clientEncoding) {\n+    this._buf = packet.buffer;\n+    this._clientEncoding = clientEncoding;\n+    this._catalogLength = packet.readLengthCodedNumber();\n+    this._catalogStart = packet.offset;\n+    packet.offset += this._catalogLength;\n+    this._schemaLength = packet.readLengthCodedNumber();\n+    this._schemaStart = packet.offset;\n+    packet.offset += this._schemaLength;\n+    this._tableLength = packet.readLengthCodedNumber();\n+    this._tableStart = packet.offset;\n+    packet.offset += this._tableLength;\n+    this._orgTableLength = packet.readLengthCodedNumber();\n+    this._orgTableStart = packet.offset;\n+    packet.offset += this._orgTableLength;\n+    // name is always used, don't make it lazy\n+    const _nameLength = packet.readLengthCodedNumber();\n+    const _nameStart = packet.offset;\n+    packet.offset += _nameLength;\n+    this._orgNameLength = packet.readLengthCodedNumber();\n+    this._orgNameStart = packet.offset;\n+    packet.offset += this._orgNameLength;\n+    packet.skip(1); //  length of the following fields (always 0x0c)\n+    this.characterSet = packet.readInt16();\n+    this.encoding = CharsetToEncoding[this.characterSet];\n+    this.name = StringParser.decode(\n+      this._buf,\n+      this.encoding === 'binary' ? this._clientEncoding : this.encoding,\n+      _nameStart,\n+      _nameStart + _nameLength\n+    );\n+    this.columnLength = packet.readInt32();\n+    this.columnType = packet.readInt8();\n+    this.type = this.columnType;\n+    this.flags = packet.readInt16();\n+    this.decimals = packet.readInt8();\n+  }\n+\n+  inspect() {\n+    return {\n+      catalog: this.catalog,\n+      schema: this.schema,\n+      name: this.name,\n+      orgName: this.orgName,\n+      table: this.table,\n+      orgTable: this.orgTable,\n+      characterSet: this.characterSet,\n+      encoding: this.encoding,\n+      columnLength: this.columnLength,\n+      type: this.columnType,\n+      flags: this.flags,\n+      decimals: this.decimals,\n+    };\n+  }\n+\n+  [Symbol.for('nodejs.util.inspect.custom')](depth, inspectOptions, inspect) {\n+    const Types = require('../constants/types.js');\n+    const typeNames = [];\n+    for (const t in Types) {\n+      typeNames[Types[t]] = t;\n+    }\n",
					"match": false,
					"packageHash": "6265bdd30cc7b01674fbe349d8f60fc6e5e1cae0399994fd54936acb540d7d20",
					"size": 712,
					"sourceHash": "d491dfa7fad8f7a9e7874c8a983dccb867fa8b2bbf01e18cf84a081528c329d8",
					"status": "content"
				},
				"lib/packets/execute.js": {
					"diff": "--- published/lib/packets/execute.js\n+++ rebuilt/lib/packets/execute.js\n@@ -1,89 +1,214 @@\n-var CursorType   = require('../constants/cursor');\n-var CommandCodes = require('../constants/commands');\n-var Types        = require('../constants/types');\n-var Packet       = require('../packets/packet');\n-\n-function Execute(id, parameters)\n-{\n-  this.id = id;\n-  this.parameters = parameters;\n+'use strict';\n+\n+const CursorType = require('../constants/cursor');\n+const CommandCodes = require('../constants/commands');\n+const Types = require('../constants/types');\n+const Packet = require('../packets/packet');\n+const CharsetToEncoding = require('../constants/charset_encodings.js');\n+\n+function isJSON(value) {\n+  return (\n+    Array.isArray(value) ||\n+    value.constructor === Object ||\n+    (typeof value.toJSON === 'function' && !Buffer.isBuffer(value))\n+  );\n }\n \n-Execute.prototype.toPacket = function()\n-{\n+/**\n+ * Converts a value to an object describing type, String/Buffer representation and length\n+ * @param {*} value\n+ */\n+function toParameter(value, encoding, timezone) {\n+  let type = Types.VAR_STRING;\n+  let length;\n+  let writer = function (value) {\n+    // eslint-disable-next-line no-invalid-this\n+    return Packet.prototype.writeLengthCodedString.call(this, value, encoding);\n+  };\n+  if (value !== null) {\n+    switch (typeof value) {\n+      case 'undefined':\n+        throw new TypeError('Bind parameters must not contain undefined');\n+\n+      case 'number':\n+        type = Types.DOUBLE;\n+        length = 8;\n+        writer = Packet.prototype.writeDouble;\n+        break;\n+\n+      case 'boolean':\n+        value = value | 0;\n+        type = Types.TINY;\n+        length = 1;\n+        writer = Packet.prototype.writeInt8;\n+        break;\n+\n+      case 'object':\n+        if (Object.prototype.toString.call(value) === '[object Date]') {\n+          type = Types.DATETIME;\n+          length = 12;\n+          writer = function (value) {\n+            // eslint-disable-next-line no-invalid-this\n+            return Packet.prototype.writeDate.call(this, value, timezone);\n+          };\n+        } else if (isJSON(value)) {\n+          value = JSON.stringify(value);\n+          type = Types.JSON;\n+        } else if (Buffer.isBuffer(value)) {\n+          length = Packet.lengthCodedNumberLength(value.length) + value.length;\n+          writer = Packet.prototype.writeLengthCodedBuffer;\n+        }\n+        break;\n \n-  // TODO: don't try to calculate packet length in advance, allocate some big buffer in advance (header + 256 bytes?)\n-  // and copy + reallocate if not enough\n+      default:\n+        value = value.toString();\n+    }\n+  } else {\n+    value = '';\n+    type = Types.NULL;\n+  }\n+  if (!length) {\n+    length = Packet.lengthCodedStringLength(value, encoding);\n+  }\n+  return { value, type, length, writer };\n+}\n \n-  var i;\n-  // 0 + 4 - length, seqId\n-  // 4 + 1 - COM_EXECUTE\n-  // 5 + 4 - stmtId\n-  // 9 + 1 - flags\n-  // 10 + 4 - iteration-count (always 1)\n-  var length = 14;\n-  if (this.parameters && this.parameters.length > 0)\n-  {\n",
					"match": false,
					"packageHash": "6b0444daf82ca611db1adf091a66987a9c60dafcde898adc98a31a5edb5e4acb",
					"size": 2684,
					"sourceHash": "c0b74c8ca35ea416d1638e7292b3437c41d12fc1c7f1fa647f5c099e68494649",
					"status": "content"
				},
				"lib/packets/handshake.js": {
					"diff": "--- published/lib/packets/handshake.js\n+++ rebuilt/lib/packets/handshake.js\n@@ -1,21 +1,112 @@\n-function Handshake(packet)\n-{\n-  this.version         = packet.readInt8();\n-  this.serverVersion   = packet.readNullTerminatedString();\n-  this.connectionId    = packet.readInt32();\n-  this.authPluginData1 = packet.readBuffer(8);\n-  packet.skip(1);\n-  this.capabilityFlags = packet.readInt16();\n-  if (packet.haveMoreData()) {\n-    this.characterSet = packet.readInt8();\n-    this.statusFlags  = packet.readInt16();\n-    // upper 2 bytes\n-    this.capabilityFlags += packet.readInt16() << 16;\n-    this.authPluginDataLength = packet.readInt8();\n+'use strict';\n+\n+const Packet = require('../packets/packet');\n+const ClientConstants = require('../constants/client.js');\n+\n+// https://dev.mysql.com/doc/internals/en/connection-phase-packets.html#packet-Protocol::Handshake\n+\n+class Handshake {\n+  constructor(args) {\n+    this.protocolVersion = args.protocolVersion;\n+    this.serverVersion = args.serverVersion;\n+    this.capabilityFlags = args.capabilityFlags;\n+    this.connectionId = args.connectionId;\n+    this.authPluginData1 = args.authPluginData1;\n+    this.authPluginData2 = args.authPluginData2;\n+    this.characterSet = args.characterSet;\n+    this.statusFlags = args.statusFlags;\n+    this.authPluginName = args.authPluginName;\n+  }\n+\n+  setScrambleData(cb) {\n+    require('crypto').randomBytes(20, (err, data) => {\n+      if (err) {\n+        cb(err);\n+        return;\n+      }\n+      this.authPluginData1 = data.slice(0, 8);\n+      this.authPluginData2 = data.slice(8, 20);\n+      cb();\n+    });\n+  }\n+\n+  toPacket(sequenceId) {\n+    const length = 68 + Buffer.byteLength(this.serverVersion, 'utf8');\n+    const buffer = Buffer.alloc(length + 4, 0); // zero fill, 10 bytes filler later needs to contain zeros\n+    const packet = new Packet(sequenceId, buffer, 0, length + 4);\n+    packet.offset = 4;\n+    packet.writeInt8(this.protocolVersion);\n+    packet.writeString(this.serverVersion, 'cesu8');\n+    packet.writeInt8(0);\n+    packet.writeInt32(this.connectionId);\n+    packet.writeBuffer(this.authPluginData1);\n+    packet.writeInt8(0);\n+    const capabilityFlagsBuffer = Buffer.allocUnsafe(4);\n+    capabilityFlagsBuffer.writeUInt32LE(this.capabilityFlags, 0);\n+    packet.writeBuffer(capabilityFlagsBuffer.slice(0, 2));\n+    packet.writeInt8(this.characterSet);\n+    packet.writeInt16(this.statusFlags);\n+    packet.writeBuffer(capabilityFlagsBuffer.slice(2, 4));\n+    packet.writeInt8(21); // authPluginDataLength\n     packet.skip(10);\n+    packet.writeBuffer(this.authPluginData2);\n+    packet.writeInt8(0);\n+    packet.writeString('mysql_native_password', 'latin1');\n+    packet.writeInt8(0);\n+    return packet;\n+  }\n+\n+  static fromPacket(packet) {\n+    const args = {};\n+    args.protocolVersion = packet.readInt8();\n+    args.serverVersion = packet.readNullTerminatedString('cesu8');\n+    args.connectionId = packet.readInt32();\n+    args.authPluginData1 = packet.readBuffer(8);\n+    packet.skip(1);\n+    const capabilityFlagsBuffer = Buffer.allocUnsafe(4);\n+    capabilityFlagsBuffer[0] = packet.readInt8();\n+    capabilityFlagsBuffer[1] = packet.readInt8();\n+    if (packet.haveMoreData()) {\n+      args.characterSet = packet.readInt8();\n+      args.statusFlags = packet.readInt16();\n+      // upper 2 bytes\n+      capabilityFlagsBuffer[2] = packet.readInt8();\n+      capabilityFlagsBuffer[3] = packet.readInt8();\n+      args.capabilityFlags = capabilityFlagsBuffer.readUInt32LE(0);\n+      if (args.capabilityFlags & ClientConstants.PLUGIN_AUTH) {\n+        args.authPluginDataLength = packet.readInt8();\n+      } else {\n+        args.authPluginDataLength = 0;\n+        packet.skip(1);\n+      }\n+      packet.skip(10);\n+    } else {\n",
					"match": false,
					"packageHash": "cda904fad64cdce7dea98377c11f1596f2af2f2d3e9aedfaa63381ee499d9e84",
					"size": 695,
					"sourceHash": "3fefa7e904cfe55977f14e1283af62a013eca95cf6e4160d55dbddb1bbb0c55f",
					"status": "content"
				},
				"lib/packets/handshake_response.js": {
					"diff": "--- published/lib/packets/handshake_response.js\n+++ rebuilt/lib/packets/handshake_response.js\n@@ -1,95 +1,144 @@\n-//var _ = require('underscore');\n-var ClientConstants = require('../constants/client');\n-var Charsets = require('../constants/charsets');\n-var crypto = require('crypto');\n-var Packet = require('../packets/packet');\n-\n-function sha1(msg, msg1, msg2) {\n-  var hash = crypto.createHash('sha1');\n-  hash.update(msg);\n-  if (msg1)\n-    hash.update(msg1);\n-  if (msg2)\n-    hash.update(msg2);\n-  return hash.digest('binary');\n-}\n+'use strict';\n \n-function xor(a, b) {\n-  if (!Buffer.isBuffer(a))\n-    a = new Buffer(a, 'binary');\n-  if (!Buffer.isBuffer(b))\n-    b = new Buffer(b, 'binary');\n-  var result = new Buffer(a.length);\n-  for (var i = 0; i < a.length; i++) {\n-    result[i] = (a[i] ^ b[i]);\n+const ClientConstants = require('../constants/client.js');\n+const CharsetToEncoding = require('../constants/charset_encodings.js');\n+const Packet = require('../packets/packet.js');\n+\n+const auth41 = require('../auth_41.js');\n+\n+class HandshakeResponse {\n+  constructor(handshake) {\n+    this.user = handshake.user || '';\n+    this.database = handshake.database || '';\n+    this.password = handshake.password || '';\n+    this.passwordSha1 = handshake.passwordSha1;\n+    this.authPluginData1 = handshake.authPluginData1;\n+    this.authPluginData2 = handshake.authPluginData2;\n+    this.compress = handshake.compress;\n+    this.clientFlags = handshake.flags;\n+    // TODO: pre-4.1 auth support\n+    let authToken;\n+    if (this.passwordSha1) {\n+      authToken = auth41.calculateTokenFromPasswordSha(\n+        this.passwordSha1,\n+        this.authPluginData1,\n+        this.authPluginData2\n+      );\n+    } else {\n+      authToken = auth41.calculateToken(\n+        this.password,\n+        this.authPluginData1,\n+        this.authPluginData2\n+      );\n+    }\n+    this.authToken = authToken;\n+    this.charsetNumber = handshake.charsetNumber;\n+    this.encoding = CharsetToEncoding[handshake.charsetNumber];\n+    this.connectAttributes = handshake.connectAttributes;\n   }\n-  return result;\n-}\n \n-function token(password, scramble1, scramble2) {\n-  var scramble = Buffer(scramble1.toString('binary') + scramble2.toString('binary'));\n-  if (!password) {\n-    return new Buffer(0);\n+  serializeResponse(buffer) {\n+    const isSet = (flag) => this.clientFlags & ClientConstants[flag];\n+    const packet = new Packet(0, buffer, 0, buffer.length);\n+    packet.offset = 4;\n+    packet.writeInt32(this.clientFlags);\n+    packet.writeInt32(0); // max packet size. todo: move to config\n+    packet.writeInt8(this.charsetNumber);\n+    packet.skip(23);\n+    const encoding = this.encoding;\n+    packet.writeNullTerminatedString(this.user, encoding);\n+    let k;\n+    if (isSet('PLUGIN_AUTH_LENENC_CLIENT_DATA')) {\n+      packet.writeLengthCodedNumber(this.authToken.length);\n+      packet.writeBuffer(this.authToken);\n+    } else if (isSet('SECURE_CONNECTION')) {\n+      packet.writeInt8(this.authToken.length);\n+      packet.writeBuffer(this.authToken);\n+    } else {\n+      packet.writeBuffer(this.authToken);\n+      packet.writeInt8(0);\n+    }\n+    if (isSet('CONNECT_WITH_DB')) {\n+      packet.writeNullTerminatedString(this.database, encoding);\n+    }\n+    if (isSet('PLUGIN_AUTH')) {\n+      // TODO: pass from config\n+      packet.writeNullTerminatedString('mysql_native_password', 'latin1');\n+    }\n+    if (isSet('CONNECT_ATTRS')) {\n",
					"match": false,
					"packageHash": "b0066b4f7c761da00df03eb01da168610e554b42a241ce9ef988f759b575e0df",
					"size": 3033,
					"sourceHash": "7b6d4ab7ec0edb08ae3ab8fd299b50f77057bce4828014ea53a5c32dede68f53",
					"status": "content"
				},
				"lib/packets/index.js": {
					"diff": "--- published/lib/packets/index.js\n+++ rebuilt/lib/packets/index.js\n@@ -1,4 +1,152 @@\n-\"handshake handshake_response query resultset_header column_definition text_row binary_row prepare_statement prepared_statement_header execute\".split(' ').forEach(function(name) {\n-  var ctor = require('./' + name);\n-  module.exports[ctor.name] = ctor;\n+// This file was modified by Oracle on June 1, 2021.\n+// A utility method was introduced to generate an Error instance from a\n+// binary server packet.\n+// Modifications copyright (c) 2021, Oracle and/or its affiliates.\n+\n+// This file was modified by Oracle on September 21, 2021.\n+// The new AuthNextFactor packet is now available.\n+// Modifications copyright (c) 2021, Oracle and/or its affiliates.\n+\n+'use strict';\n+\n+const process = require('process');\n+\n+const AuthNextFactor = require('./auth_next_factor');\n+const AuthSwitchRequest = require('./auth_switch_request');\n+const AuthSwitchRequestMoreData = require('./auth_switch_request_more_data');\n+const AuthSwitchResponse = require('./auth_switch_response');\n+const BinaryRow = require('./binary_row');\n+const BinlogDump = require('./binlog_dump');\n+const ChangeUser = require('./change_user');\n+const CloseStatement = require('./close_statement');\n+const ColumnDefinition = require('./column_definition');\n+const Execute = require('./execute');\n+const Handshake = require('./handshake');\n+const HandshakeResponse = require('./handshake_response');\n+const PrepareStatement = require('./prepare_statement');\n+const PreparedStatementHeader = require('./prepared_statement_header');\n+const Query = require('./query');\n+const RegisterSlave = require('./register_slave');\n+const ResultSetHeader = require('./resultset_header');\n+const SSLRequest = require('./ssl_request');\n+const TextRow = require('./text_row');\n+\n+const ctorMap = {\n+  AuthNextFactor,\n+  AuthSwitchRequest,\n+  AuthSwitchRequestMoreData,\n+  AuthSwitchResponse,\n+  BinaryRow,\n+  BinlogDump,\n+  ChangeUser,\n+  CloseStatement,\n+  ColumnDefinition,\n+  Execute,\n+  Handshake,\n+  HandshakeResponse,\n+  PrepareStatement,\n+  PreparedStatementHeader,\n+  Query,\n+  RegisterSlave,\n+  ResultSetHeader,\n+  SSLRequest,\n+  TextRow,\n+};\n+Object.entries(ctorMap).forEach(([name, ctor]) => {\n+  module.exports[name] = ctor;\n+  // monkey-patch it to include name if debug is on\n+  if (process.env.NODE_DEBUG) {\n+    if (ctor.prototype.toPacket) {\n+      const old = ctor.prototype.toPacket;\n+      ctor.prototype.toPacket = function () {\n+        const p = old.call(this);\n+        p._name = name;\n+        return p;\n+      };\n+    }\n+  }\n });\n+\n+// simple packets:\n+const Packet = require('./packet');\n+exports.Packet = Packet;\n+\n+class OK {\n+  static toPacket(args, encoding) {\n+    args = args || {};\n+    const affectedRows = args.affectedRows || 0;\n+    const insertId = args.insertId || 0;\n+    const serverStatus = args.serverStatus || 0;\n+    const warningCount = args.warningCount || 0;\n+    const message = args.message || '';\n+\n+    let length = 9 + Packet.lengthCodedNumberLength(affectedRows);\n+    length += Packet.lengthCodedNumberLength(insertId);\n+\n+    const buffer = Buffer.allocUnsafe(length);\n+    const packet = new Packet(0, buffer, 0, length);\n+    packet.offset = 4;\n+    packet.writeInt8(0);\n+    packet.writeLengthCodedNumber(affectedRows);\n+    packet.writeLengthCodedNumber(insertId);\n+    packet.writeInt16(serverStatus);\n+    packet.writeInt16(warningCount);\n+    packet.writeString(message, encoding);\n",
					"match": false,
					"packageHash": "51b2dc056847e419d0471e9e1907fe1afe02d2a83edbc3e6079a9a3e54ccf8a1",
					"size": 255,
					"sourceHash": "c5ef7d814e06572bb4135e40282829a6da2d4dce38a413ef059a27dd2fbfbdba",
					"status": "content"
				},
				"lib/packets/packet.js": {
					"diff": "--- published/lib/packets/packet.js\n+++ rebuilt/lib/packets/packet.js\n@@ -1,348 +1,931 @@\n-//var BigNumber = require(\"bignumber.js\");\n-var ErrorCodeToName = require('../constants/errors').codeToName;\n-\n-function Packet(id, buffer, start, end)\n-{\n-  this.sequenceId = id;\n-  this.buffer = buffer;\n-  this.offset = start || 0;\n-  this.start = start || 0;\n-  this.end = end || this.buffer.length;\n+// This file was modified by Oracle on June 1, 2021.\n+// A comment describing some changes in the strict default SQL mode regarding\n+// non-standard dates was introduced.\n+// Modifications copyright (c) 2021, Oracle and/or its affiliates.\n+\n+'use strict';\n+\n+const ErrorCodeToName = require('../constants/errors.js');\n+const NativeBuffer = require('buffer').Buffer;\n+const Long = require('long');\n+const StringParser = require('../parsers/string.js');\n+const Types = require('../constants/types.js');\n+const INVALID_DATE = new Date(NaN);\n+\n+// this is nearly duplicate of previous function so generated code is not slower\n+// due to \"if (dateStrings)\" branching\n+const pad = '000000000000';\n+function leftPad(num, value) {\n+  const s = value.toString();\n+  // if we don't need to pad\n+  if (s.length >= num) {\n+    return s;\n+  }\n+  return (pad + s).slice(-num);\n }\n \n-// ==============================\n-// readers\n-// ==============================\n-\n-Packet.prototype.reset = function() {\n-  this.offset = this.start;\n-};\n-\n-Packet.prototype.length = function() {\n-  return this.end - this.start;\n-};\n-\n-Packet.prototype.slice = function() {\n-  return this.buffer.slice(this.start, this.end);\n-};\n-\n-Packet.prototype.dump = function() {\n-  console.log([this.buffer.asciiSlice(this.start, this.end)], this.buffer.slice(this.start, this.end), this.length(), this.sequenceId);\n-};\n-\n-Packet.prototype.haveMoreData = function() {\n-  return this.end > this.offset;\n-};\n-\n-Packet.prototype.skip = function(num) {\n-   if (!num)\n-     throw \"Bad param in skip!\"; // for some reason I keep doing skip(0) to indicate \"skip one byte which should be 0\"\n-   this.offset += num;\n-};\n-\n-Packet.prototype.readInt8 = function()\n-{\n-  return this.buffer[this.offset++];\n-};\n-\n-Packet.prototype.readInt16 = function()\n-{\n-  this.offset += 2;\n-  return this.buffer.readUInt16LE(this.offset - 2);\n-};\n+// The whole reason parse* function below exist\n+// is because String creation is relatively expensive (at least with V8), and if we have\n+// a buffer with \"12345\" content ideally we would like to bypass intermediate\n+// \"12345\" string creation and directly build 12345 number out of\n+// <Buffer 31 32 33 34 35> data.\n+// In my benchmarks the difference is ~25M 8-digit numbers per second vs\n+// 4.5 M using Number(packet.readLengthCodedString())\n+// not used when size is close to max precision as series of *10 accumulate error\n+// and approximate result mihgt be diffreent from (approximate as well) Number(bigNumStringValue))\n+// In the futire node version if speed difference is smaller parse* functions might be removed\n+// don't consider them as Packet public API\n \n-Packet.prototype.readInt24 = function() {\n-  return this.readInt16() + (this.readInt8() << 16);\n-}\n+const minus = '-'.charCodeAt(0);\n+const plus = '+'.charCodeAt(0);\n \n-Packet.prototype.readInt32 = function()\n-{\n-  this.offset += 4;\n",
					"match": false,
					"packageHash": "f92187efd9645f78046536f6344fbaa629d063467772755fc86313581c9fe86b",
					"size": 8255,
					"sourceHash": "2e0440d54bcdaa988dab6515845f9f7153af5d1c77cf13df688a7957828dcfbc",
					"status": "content"
				},
				"lib/packets/prepare_statement.js": {
					"diff": "--- published/lib/packets/prepare_statement.js\n+++ rebuilt/lib/packets/prepare_statement.js\n@@ -1,20 +1,27 @@\n-var Packet = require('../packets/packet');\n-var CommandCodes = require('../constants/commands');\n+'use strict';\n \n-function PrepareStatement(sql)\n-{\n-  this.query = sql;\n-}\n+const Packet = require('../packets/packet');\n+const CommandCodes = require('../constants/commands');\n+const StringParser = require('../parsers/string.js');\n+const CharsetToEncoding = require('../constants/charset_encodings.js');\n+\n+class PrepareStatement {\n+  constructor(sql, charsetNumber) {\n+    this.query = sql;\n+    this.charsetNumber = charsetNumber;\n+    this.encoding = CharsetToEncoding[charsetNumber];\n+  }\n \n-PrepareStatement.prototype.toPacket = function()\n-{\n-  var length = 5 + Buffer.byteLength(this.query, 'utf8');\n-  var buffer = new Buffer(length);\n-  var packet = new Packet(0, buffer);\n-  packet.offset = 4;\n-  packet.writeInt8(CommandCodes.PREPARE);\n-  packet.writeString(this.query);\n-  return packet;\n-};\n+  toPacket() {\n+    const buf = StringParser.encode(this.query, this.encoding);\n+    const length = 5 + buf.length;\n+    const buffer = Buffer.allocUnsafe(length);\n+    const packet = new Packet(0, buffer, 0, length);\n+    packet.offset = 4;\n+    packet.writeInt8(CommandCodes.STMT_PREPARE);\n+    packet.writeBuffer(buf);\n+    return packet;\n+  }\n+}\n \n module.exports = PrepareStatement;\n",
					"match": false,
					"packageHash": "64d0ad2bb42f0e45af14eafdac353ad11dac6941f4ae34f6882394b1e226d822",
					"size": 488,
					"sourceHash": "228bace8626d8180a755f5cf9864f9180de27760608b10518883b1ddd523dce3",
					"status": "content"
				},
				"lib/packets/prepared_statement_header.js": {
					"diff": "--- published/lib/packets/prepared_statement_header.js\n+++ rebuilt/lib/packets/prepared_statement_header.js\n@@ -1,13 +1,14 @@\n-var Packet = require('../packets/packet');\n+'use strict';\n \n-function PreparedStatementHeader(packet)\n-{\n-  packet.skip(1);     // should be 0\n-  this.id = packet.readInt32();\n-  this.fieldCount      = packet.readInt16();\n-  this.parameterCount  = packet.readInt16();\n-  packet.skip(1);     // should be 0\n-  this.warningCount = packet.readInt16();\n+class PreparedStatementHeader {\n+  constructor(packet) {\n+    packet.skip(1); // should be 0\n+    this.id = packet.readInt32();\n+    this.fieldCount = packet.readInt16();\n+    this.parameterCount = packet.readInt16();\n+    packet.skip(1); // should be 0\n+    this.warningCount = packet.readInt16();\n+  }\n }\n \n // TODO: toPacket\n",
					"match": false,
					"packageHash": "521774ffae3d5afecd569e7669bf5aa0c329e2971cd6ef21a2ca67ec288b2570",
					"size": 389,
					"sourceHash": "871f2b27e7bc56bbf887640b08398fd3b1efb8f9f8b18f39b059affb7ea33a36",
					"status": "content"
				},
				"lib/packets/query.js": {
					"diff": "--- published/lib/packets/query.js\n+++ rebuilt/lib/packets/query.js\n@@ -1,20 +1,27 @@\n-var Packet = require('../packets/packet');\n-var CommandCode = require('../constants/commands');\n+'use strict';\n \n-function Query(sql)\n-{\n-  this.query = sql;\n-}\n+const Packet = require('../packets/packet.js');\n+const CommandCode = require('../constants/commands.js');\n+const StringParser = require('../parsers/string.js');\n+const CharsetToEncoding = require('../constants/charset_encodings.js');\n+\n+class Query {\n+  constructor(sql, charsetNumber) {\n+    this.query = sql;\n+    this.charsetNumber = charsetNumber;\n+    this.encoding = CharsetToEncoding[charsetNumber];\n+  }\n \n-Query.prototype.toPacket = function()\n-{\n-  var length = 5 + Buffer.byteLength(this.query, 'utf8');\n-  var buffer = new Buffer(length);\n-  var packet = new Packet(0, buffer);\n-  packet.offset = 4;\n-  packet.writeInt8(CommandCode.QUERY);\n-  packet.writeString(this.query);\n-  return packet;\n-};\n+  toPacket() {\n+    const buf = StringParser.encode(this.query, this.encoding);\n+    const length = 5 + buf.length;\n+    const buffer = Buffer.allocUnsafe(length);\n+    const packet = new Packet(0, buffer, 0, length);\n+    packet.offset = 4;\n+    packet.writeInt8(CommandCode.QUERY);\n+    packet.writeBuffer(buf);\n+    return packet;\n+  }\n+}\n \n module.exports = Query;\n",
					"match": false,
					"packageHash": "ee945f2f477aa8a4a2fbbd983e0c063f7fc98e947bf1cdb9fe12050f5bddd8e0",
					"size": 451,
					"sourceHash": "afb37f33fd344b631b4ddd54a59ec9e9635d5ab5dd8b8b3ef008f2672c410c19",
					"status": "content"
				},
				"lib/packets/resultset_header.js": {
					"diff": "--- published/lib/packets/resultset_header.js\n+++ rebuilt/lib/packets/resultset_header.js\n@@ -1,21 +1,124 @@\n-var Packet = require('../packets/packet');\n+'use strict';\n \n-function ResultSetHeader(packet)\n-{\n-  this.fieldCount = packet.readLengthCodedNumber();\n-  // is this correct?\n-  if (packet.haveMoreData())\n-    this.insertId   = packet.readLengthCodedNumber();\n-\n-  // snippet from mysql-native:\n-  // res.affected_rows = this.lcnum();\n-  // res.insert_id = this.lcnum();\n-  // res.server_status = this.num(2);\n-  // res.warning_count = this.num(2);\n+// TODO: rename to OK packet\n+// https://dev.mysql.com/doc/internals/en/packet-OK_Packet.html\n \n-  // TODO: extra\n-}\n+const Packet = require('./packet.js');\n+const ClientConstants = require('../constants/client.js');\n+const ServerSatusFlags = require('../constants/server_status.js');\n+\n+const EncodingToCharset = require('../constants/encoding_charset.js');\n+const sessionInfoTypes = require('../constants/session_track.js');\n+\n+class ResultSetHeader {\n+  constructor(packet, connection) {\n+    const bigNumberStrings = connection.config.bigNumberStrings;\n+    const encoding = connection.serverEncoding;\n+    const flags = connection._handshakePacket.capabilityFlags;\n+    const isSet = function (flag) {\n+      return flags & ClientConstants[flag];\n+    };\n+    if (packet.buffer[packet.offset] !== 0) {\n+      this.fieldCount = packet.readLengthCodedNumber();\n+      if (this.fieldCount === null) {\n+        this.infileName = packet.readString(undefined, encoding);\n+      }\n+      return;\n+    }\n+    this.fieldCount = packet.readInt8(); // skip OK byte\n+    this.affectedRows = packet.readLengthCodedNumber(bigNumberStrings);\n+    this.insertId = packet.readLengthCodedNumberSigned(bigNumberStrings);\n+    this.info = '';\n+    if (isSet('PROTOCOL_41')) {\n+      this.serverStatus = packet.readInt16();\n+      this.warningStatus = packet.readInt16();\n+    } else if (isSet('TRANSACTIONS')) {\n+      this.serverStatus = packet.readInt16();\n+    }\n+    let stateChanges = null;\n+    if (isSet('SESSION_TRACK') && packet.offset < packet.end) {\n+      this.info = packet.readLengthCodedString(encoding);\n \n-// TODO: toPacket\n+      if (this.serverStatus && ServerSatusFlags.SERVER_SESSION_STATE_CHANGED) {\n+        // session change info record - see\n+        // https://dev.mysql.com/doc/internals/en/packet-OK_Packet.html#cs-sect-packet-ok-sessioninfo\n+        let len =\n+          packet.offset < packet.end ? packet.readLengthCodedNumber() : 0;\n+        const end = packet.offset + len;\n+        let type, key, stateEnd;\n+        if (len > 0) {\n+          stateChanges = {\n+            systemVariables: {},\n+            schema: null,\n+            gtids: [],\n+            trackStateChange: null,\n+          };\n+        }\n+        while (packet.offset < end) {\n+          type = packet.readInt8();\n+          len = packet.readLengthCodedNumber();\n+          stateEnd = packet.offset + len;\n+          if (type === sessionInfoTypes.SYSTEM_VARIABLES) {\n+            key = packet.readLengthCodedString(encoding);\n+            const val = packet.readLengthCodedString(encoding);\n+            stateChanges.systemVariables[key] = val;\n+            if (key === 'character_set_client') {\n+              const charsetNumber = EncodingToCharset[val];\n+              // TODO - better api for driver users to handle unknown encodings?\n+              // maybe custom coverter in the config?\n+              // For now just ignore character_set_client command if there is\n+              // no known mapping from reported encoding to a charset code\n+              if (typeof charsetNumber !== 'undefined') {\n+                connection.config.charsetNumber = charsetNumber;\n+              }\n+            }\n+          } else if (type === sessionInfoTypes.SCHEMA) {\n+            key = packet.readLengthCodedString(encoding);\n+            stateChanges.schema = key;\n+          } else if (type === sessionInfoTypes.STATE_CHANGE) {\n+            stateChanges.trackStateChange =\n+              packet.readLengthCodedString(encoding);\n+          } else if (type === sessionInfoTypes.STATE_GTIDS) {\n",
					"match": false,
					"packageHash": "37b7051f31873bf8815152afc39329e3106d994dde9ec34eaada958adde757b7",
					"size": 493,
					"sourceHash": "6ff296d6e0e00fe4fe3b2e26a249cd6801ff4d80f197e1c5cf864b23bd15956d",
					"status": "content"
				},
				"lib/packets/text_row.js": {
					"diff": "--- published/lib/packets/text_row.js\n+++ rebuilt/lib/packets/text_row.js\n@@ -1,34 +1,47 @@\n-var Packet = require('../packets/packet');\n+'use strict';\n \n-function TextRow(columns)\n-{\n-  this.columns = columns || [];\n-}\n+const Packet = require('../packets/packet');\n \n-TextRow.fromPacket = function(packet) {\n-  //packet.reset(); // set offset to starting point?\n-  var columns = [];\n-  while(packet.haveMoreData()) {\n-    columns.push(packet.readLengthCodedString());\n+class TextRow {\n+  constructor(columns) {\n+    this.columns = columns || [];\n   }\n-  return new TextRow(columns);\n-};\n \n-TextRow.prototype.toPacket = function(sequenceId) {\n-  var buffer, i, packet, column;\n-  var length = 0;\n-  for(i=0; i < this.columns.length; ++i) {\n-    column = this.columns[i];\n-    length += Packet.lengthCodedNumberLength(column);\n-    length += column.length;\n+  static fromPacket(packet) {\n+    // packet.reset(); // set offset to starting point?\n+    const columns = [];\n+    while (packet.haveMoreData()) {\n+      columns.push(packet.readLengthCodedString());\n+    }\n+    return new TextRow(columns);\n   }\n-  buffer = new Buffer(length+4);\n-  packet = new Packet(sequenceId, buffer);\n-  packet.offset = 4;\n-  for(i=0; i < this.columns.length; ++i) {\n-    packet.writeLengthCodedString(this.columns[i]);\n+\n+  static toPacket(columns, encoding) {\n+    const sequenceId = 0; // TODO remove, this is calculated now in connecton\n+    let length = 0;\n+    columns.forEach((val) => {\n+      if (val === null || typeof val === 'undefined') {\n+        ++length;\n+        return;\n+      }\n+      length += Packet.lengthCodedStringLength(val.toString(10), encoding);\n+    });\n+    const buffer = Buffer.allocUnsafe(length + 4);\n+    const packet = new Packet(sequenceId, buffer, 0, length + 4);\n+    packet.offset = 4;\n+    columns.forEach((val) => {\n+      if (val === null) {\n+        packet.writeNull();\n+        return;\n+      }\n+      if (typeof val === 'undefined') {\n+        packet.writeInt8(0);\n+        return;\n+      }\n+      packet.writeLengthCodedString(val.toString(10), encoding);\n+    });\n+    return packet;\n   }\n-  return packet;\n-};\n+}\n \n module.exports = TextRow;\n",
					"match": false,
					"packageHash": "dbc81bff6986f0630a09220c2285a38490dbc9fb971c8347a39f24f851e113e2",
					"size": 848,
					"sourceHash": "b7f7047e08dcedd8247c806b444f214c42806b8f4e7b9f12f1514d5b8a1ba08f",
					"status": "content"
				},
				"lib/pool.js": {
					"diff": "--- published/lib/pool.js\n+++ rebuilt/lib/pool.js\n@@ -1,157 +1,12 @@\n+'use strict';\n \n-var mysql        = require('../index.js');\n-var Connection   = mysql.Connection;\n+const BasePool = require('./base/pool.js');\n \n-module.exports = Pool;\n-function Pool(options) {\n-  this.config = options.config;\n-  this.config.connectionConfig.pool = this;\n-\n-  this._allConnections   = [];\n-  this._freeConnections  = [];\n-  this._connectionQueue  = [];\n-  this._closed           = false;\n-}\n-\n-Pool.prototype.getConnection = function(cb) {\n-  var connection;\n-  if (this._closed) {\n-    cb(new Error('Pool is closed.'));\n-    return;\n-  }\n-\n-  if (this._freeConnections.length > 0) {\n-    connection = this._freeConnections[0];\n-    this._freeConnections.shift();\n-    cb(null, connection);\n-  } else if (this.config.connectionLimit === 0 || this._allConnections.length < this.config.connectionLimit) {\n-    var self       = this;\n-    connection = this._createConnection();\n-    this._allConnections.push(connection);\n-    connection.connect(function(err) {\n-      if (self._closed) {\n-        cb(new Error('Pool is closed.'));\n-      }\n-      else if (err) {\n-        cb(err);\n-      } else {\n-        cb(null, connection);\n-      }\n-    });\n-  } else if (this.config.waitForConnections) {\n-    this._connectionQueue.push(cb);\n-  } else {\n-    cb(new Error('No connections available.'));\n-  }\n-};\n-\n-Pool.prototype.releaseConnection = function(connection) {\n-  var cb;\n-  if (connection._poolRemoved) {\n-    // The connection has been removed from the pool and is no longer good.\n-    if (this._connectionQueue.length) {\n-      cb = this._connectionQueue[0];\n-      this._connectionQueue.shift();\n-      process.nextTick(this.getConnection.bind(this, cb));\n-    }\n-  } else if (this._connectionQueue.length) {\n-    cb = this._connectionQueue[0];\n-    this._connectionQueue.shift();\n-    process.nextTick(cb.bind(null, null, connection));\n-  } else {\n-    this._freeConnections.push(connection);\n-  }\n-};\n-\n-Pool.prototype.end = function(cb) {\n-  this._closed = true;\n-  cb = cb || function(err) { if( err ) throw err; };\n-  var self              = this;\n-  var closedConnections = 0;\n-  var calledBack        = false;\n-  var endCB = function(err) {\n-    if (calledBack) {\n-      return;\n-    } else if (err) {\n-      calledBack = true;\n-      cb(err);\n-    } else if (++closedConnections >= self._allConnections.length) {\n-      calledBack = true;\n-      cb();\n-    }\n-  };\n-\n-  if (this._allConnections.length === 0) {\n-    endCB();\n-    return;\n-  }\n-\n-  for (var i = 0; i < this._allConnections.length; ++i) {\n-    var connection = this._allConnections[i];\n-    connection.destroy = connection._realDestroy;\n-    connection.end     = connection._realEnd;\n-    connection.end(endCB);\n-  }\n-};\n",
					"match": false,
					"packageHash": "b291f03b7ad6e96e2ab7e60e6c373ef611cbff4074ff692fcabfbfc759b384dc",
					"size": 4405,
					"sourceHash": "38e5b2eb0dbbe491c5f5b8fc90e7db14bbc4eb13d5b1d725ba0da1efe6f8ef17",
					"status": "content"
				},
				"lib/pool_config.js": {
					"diff": "--- published/lib/pool_config.js\n+++ rebuilt/lib/pool_config.js\n@@ -1,9 +1,30 @@\n-var ConnectionConfig = require('./connection_config');\n+'use strict';\n \n-module.exports = PoolConfig;\n-function PoolConfig(options) {\n-  this.connectionConfig   = new ConnectionConfig(options);\n-  this.createConnection   = options.createConnection || undefined;\n-  this.waitForConnections = (options.waitForConnections === undefined) ? true : Boolean(options.waitForConnections);\n-  this.connectionLimit    = (options.connectionLimit === undefined) ? 10 : Number(options.connectionLimit);\n+const ConnectionConfig = require('./connection_config.js');\n+\n+class PoolConfig {\n+  constructor(options) {\n+    if (typeof options === 'string') {\n+      options = ConnectionConfig.parseUrl(options);\n+    }\n+    this.connectionConfig = new ConnectionConfig(options);\n+    this.waitForConnections =\n+      options.waitForConnections === undefined\n+        ? true\n+        : Boolean(options.waitForConnections);\n+    this.connectionLimit = isNaN(options.connectionLimit)\n+      ? 10\n+      : Number(options.connectionLimit);\n+    this.maxIdle = isNaN(options.maxIdle)\n+      ? this.connectionLimit\n+      : Number(options.maxIdle);\n+    this.idleTimeout = isNaN(options.idleTimeout)\n+      ? 60000\n+      : Number(options.idleTimeout);\n+    this.queueLimit = isNaN(options.queueLimit)\n+      ? 0\n+      : Number(options.queueLimit);\n+  }\n }\n+\n+module.exports = PoolConfig;\n",
					"match": false,
					"packageHash": "e98a20e10c6fc2834c4588e191336ca56877421ddfd0e8cac19c1d07a3bb2f41",
					"size": 469,
					"sourceHash": "efb921efefa6ad78b99de76dfb295e5e3223b0012975c8f29e327a2f996664df",
					"status": "content"
				},
				"lib/results_stream.js": {
					"diff": "--- published/lib/results_stream.js\n+++ rebuilt/lib/results_stream.js\n@@ -1,34 +1,36 @@\n-var Readable  = require('stream').Readable;\n+'use strict';\n \n-// copy-paste from https://github.com/felixge/node-mysql/blob/master/lib/protocol/sequences/Query.js\n+const Readable = require('stream').Readable;\n+\n+// copy-paste from https://github.com/mysqljs/mysql/blob/master/lib/protocol/sequences/Query.js\n module.exports = function (command, connectionStream) {\n-  command.stream = function(options) {\n-    var self = this,\n-        stream;\n+  command.stream = function (options) {\n+    let stream;\n \n     options = options || {};\n     options.objectMode = true;\n-    stream = new Readable(options),\n-\n-    stream._read = function() {\n-      connectionStream.resume();\n-    };\n-\n-    this.on(\"result\",function(row,i) {\n-      if (!stream.push(row)) connectionStream.pause();\n-      stream.emit(\"result\",row,i);  // replicate old emitter\n+    (stream = new Readable(options)),\n+      (stream._read = function () {\n+        connectionStream.resume();\n+      });\n+\n+    this.on('result', (row, i) => {\n+      if (!stream.push(row)) {\n+        connectionStream.pause();\n+      }\n+      stream.emit('result', row, i); // replicate old emitter\n     });\n \n-    this.on(\"error\",function(err) {\n-      stream.emit('error',err);  // Pass on any errors\n+    this.on('error', (err) => {\n+      stream.emit('error', err); // Pass on any errors\n     });\n \n-    this.on(\"end\", function() {\n-      stream.push(null);  // pushing null, indicating EOF\n+    this.on('end', () => {\n+      stream.push(null); // pushing null, indicating EOF\n     });\n \n-    this.on(\"fields\",function(fields,i) {\n-      stream.emit('fields\",fields',i);  // replicate old emitter\n+    this.on('fields', (fields, i) => {\n+      stream.emit('fields', fields, i); // replicate old emitter\n     });\n \n     return stream;\n",
					"match": false,
					"packageHash": "749c71f520f962fe98679389f7e87a95ce9203e9d99183822bf975e545849edd",
					"size": 955,
					"sourceHash": "fbe5b4e0653c16f286ec2c76906b1b2bb165ffa7f8863c9968231fbef7067a1d",
					"status": "content"
				},
				"lib/sql_string.js": {
					"match": false,
					"packageHash": "8f8ddbca44ef45c7db68731c172a02fb9a9aa3701bd7c01d1fbd55345a91027d",
					"size": 3399,
					"status": "missing-in-source"
				},
				"package.json": {
					"diff": "--- published/package.json\n+++ rebuilt/package.json\n@@ -1,28 +1,80 @@\n {\n   \"name\": \"mysql2\",\n-  \"version\": \"0.7.0\",\n+  \"version\": \"3.16.0\",\n   \"description\": \"fast mysql driver. Implements core protocol, prepared statements, ssl and compression in native JS\",\n   \"main\": \"index.js\",\n-  \"directories\": {\n-    \"example\": \"examples\"\n-  },\n+  \"typings\": \"typings/mysql/index\",\n+  \"type\": \"commonjs\",\n   \"scripts\": {\n-    \"test\": \"./test/run.js\"\n+    \"lint\": \"eslint . && prettier --check .\",\n+    \"lint:fix\": \"eslint . --fix && prettier --write .\",\n+    \"test\": \"poku -d -r=verbose --sequential test/esm test/unit test/integration\",\n+    \"test:bun\": \"bun poku -d --sequential test/esm test/unit test/integration\",\n+    \"test:deno\": \"deno run --allow-read --allow-env --allow-run npm:poku -d --sequential --denoAllow=\\\"read,env,net,sys\\\" test/esm test/unit test/integration\",\n+    \"test:tsc-build\": \"cd \\\"test/tsc-build\\\" && npx tsc -p \\\"tsconfig.json\\\"\",\n+    \"coverage-test\": \"c8 npm run test\",\n+    \"benchmark\": \"node ./benchmarks/benchmark.js\",\n+    \"wait-port\": \"wait-on\"\n   },\n   \"repository\": {\n     \"type\": \"git\",\n-    \"url\": \"https://github.com/sidorares/node-mysql2\"\n+    \"url\": \"git+https://github.com/sidorares/node-mysql2.git\"\n   },\n+  \"homepage\": \"https://sidorares.github.io/node-mysql2/docs\",\n   \"keywords\": [\n-    \"mysql\"\n+    \"mysql\",\n+    \"client\",\n+    \"server\"\n+  ],\n+  \"files\": [\n+    \"lib\",\n+    \"typings/mysql\",\n+    \"index.js\",\n+    \"index.d.ts\",\n+    \"promise.js\",\n+    \"promise.d.ts\"\n   ],\n-  \"author\": \"Andrey Sidorov <sidorares@yandex.ru>\",\n+  \"exports\": {\n+    \".\": \"./index.js\",\n+    \"./package.json\": \"./package.json\",\n+    \"./promise\": \"./promise.js\",\n+    \"./promise.js\": \"./promise.js\"\n+  },\n+  \"engines\": {\n+    \"node\": \">= 8.0\"\n+  },\n+  \"author\": \"Andrey Sidorov <andrey.sidorov@gmail.com>\",\n   \"license\": \"MIT\",\n   \"dependencies\": {\n-    \"underscore\": \"~1.4.4\",\n-    \"fastqueue\": \"~0.1.0\"\n+    \"aws-ssl-profiles\": \"^1.1.1\",\n+    \"denque\": \"^2.1.0\",\n+    \"generate-function\": \"^2.3.1\",\n+    \"iconv-lite\": \"^0.7.0\",\n+    \"long\": \"^5.2.1\",\n+    \"lru.min\": \"^1.0.0\",\n+    \"named-placeholders\": \"^1.1.3\",\n+    \"seq-queue\": \"^0.0.5\",\n+    \"sqlstring\": \"^2.3.2\"\n   },\n   \"devDependencies\": {\n-    \"urun\": \"0.0.6\"\n+    \"@eslint/eslintrc\": \"^3.3.0\",\n+    \"@eslint/js\": \"^9.21.0\",\n+    \"@eslint/markdown\": \"^7.0.0\",\n+    \"@types/node\": \"^25.0.2\",\n+    \"@typescript-eslint/eslint-plugin\": \"^8.26.0\",\n+    \"@typescript-eslint/parser\": \"^8.26.0\",\n+    \"assert-diff\": \"^3.0.2\",\n+    \"benchmark\": \"^2.1.4\",\n+    \"c8\": \"^10.1.1\",\n+    \"error-stack-parser\": \"^2.0.3\",\n+    \"eslint-config-prettier\": \"^10.0.2\",\n+    \"eslint-plugin-async-await\": \"^0.0.0\",\n+    \"eslint-plugin-markdown\": \"^5.1.0\",\n+    \"eslint-plugin-prettier\": \"^5.2.3\",\n+    \"globals\": \"^16.0.0\",\n+    \"poku\": \"^3.0.0\",\n+    \"portfinder\": \"^1.0.28\",\n+    \"prettier\": \"^3.0.0\",\n+    \"typescript\": \"^5.0.2\"\n   }\n }\n",
					"match": false,
					"packageHash": "5bb6026ab6cc5ae00fbdd118353dc60e8feb63e25ba77243260d7cebb14bcc7a",
					"size": 612,
					"sourceHash": "f7d30639374ae65d3987f086d8da07210509d6c419bed3ef8f5a968021757cdd",
					"status": "content"
				},
				"test/common.js": {
					"match": false,
					"packageHash": "16dedd55340b5d050919964bebe163fc6265039cc512a457dc58bea00112daa6",
					"size": 1670,
					"status": "missing-in-source"
				},
				"test/common2.js": {
					"match": false,
					"packageHash": "61eabdbc0cf2cb24aee74dff7526b939f3b637ffef4308a78d96cb258fe04728",
					"size": 2057,
					"status": "missing-in-source"
				},
				"test/create-500k-random-ints-doubles-table.sql": {
					"match": false,
					"packageHash": "58de7240430b2cfef846956579cd658627bfe6396f5b1908b212d263e21dbc18",
					"size": 701,
					"status": "missing-in-source"
				},
				"test/create-500k-random-rows-table.sql": {
					"match": false,
					"packageHash": "c57be4eef0101997065a83c0509064cd5cd8dbb166f7364689140ddebac1714f",
					"size": 641,
					"status": "missing-in-source"
				},
				"test/integration/connection/test-insert-results.js": {
					"match": false,
					"packageHash": "d19cb63a1478102b1fb0e082002ff1082a482153526e824fd5215631d3bdec5f",
					"size": 1075,
					"status": "missing-in-source"
				},
				"test/integration/connection/test-select-1.js": {
					"match": false,
					"packageHash": "69c5510a7241db202bb2a5baffa80af7a3e15c3daa4323d30d83270a96aeb6e8",
					"size": 422,
					"status": "missing-in-source"
				},
				"test/integration/connection/test-select-empty-string.js": {
					"match": false,
					"packageHash": "07154bf82eb5e2342de07ead051e79bb311f4d289665b9336fbd9ec0567d790a",
					"size": 323,
					"status": "missing-in-source"
				},
				"test/integration/connection/test-select-utf8.js": {
					"match": false,
					"packageHash": "617d80091b477e582c54b135370e3f252ad6295cbe90875407ffbb5a89f9161a",
					"size": 517,
					"status": "missing-in-source"
				},
				"test/run.js": {
					"match": false,
					"packageHash": "769ce8a47e11306d6c261348f00f57da5e0981a09c5c56591ea23e102f6de625",
					"size": 172,
					"status": "missing-in-source"
				},
				"test/template.jade": {
					"match": false,
					"packageHash": "4fa1983bbf2536a8d39746aa32b784346220b561fa70b635542ee3e15f110cd5",
					"size": 103,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-bad-credentials.js": {
					"match": false,
					"packageHash": "b9befb8412b3d3bb97bc9e92f19c8b3ac9ab5c72a93d65592857e9ff740ca868",
					"size": 724,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-bulk-insert.js": {
					"match": false,
					"packageHash": "ff144d22831f3fd45bb11fa52c53761a9fbb0b0aba529502e2060dff96926ef2",
					"size": 973,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-callback-errors-are-not-caught.js": {
					"match": false,
					"packageHash": "6043db106b5941ebdef73b3296d5822bc57a7928bca6a8e7b56d593cdef074b5",
					"size": 398,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-change-user-fatal-error.js": {
					"match": false,
					"packageHash": "388bd6a07b590d752662bd6c63d0e4792c6464a4ff12f8c53fa60686bfce4d7a",
					"size": 787,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-change-user.js": {
					"match": false,
					"packageHash": "7dda18e51ce3c3e8c509f50f11ae6e8f4b77be70e5c7859b88563c1a6e784092",
					"size": 938,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-connection-config-flags-affected-rows.js": {
					"match": false,
					"packageHash": "ed1f118217031102c0ada36a22f3bed2f0482598b35b08dd6d4ce4d4ee9b9479",
					"size": 1754,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-connection-config-flags.js": {
					"match": false,
					"packageHash": "e27b1b9162d981d2fbb7a5ef9478589d07fee437d6162e413e3ed03864dd02d2",
					"size": 1962,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-connection-destroy.js": {
					"match": false,
					"packageHash": "05d3e5b31da4e8c6ec6f22d6d26116d96b8a60fa27aa65625e3b8964642bd5b9",
					"size": 209,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-custom-query-format.js": {
					"match": false,
					"packageHash": "683d7d1c3b85451f2a4829beee2fb6ddcc640b1934ef196ca1116bd2dff8672b",
					"size": 650,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-custom-typecast.js": {
					"match": false,
					"packageHash": "4d9a7a7e430d1c474ed83da7735d537babeedeae3915763262ed0cae24dae92f",
					"size": 1074,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-destroy-while-streaming-rows.js": {
					"match": false,
					"packageHash": "e247db5bf5a3e42f5b4ca454be2fd68a58f8f04287863fc576f9bb9b62630f7a",
					"size": 960,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-double-connect.js": {
					"match": false,
					"packageHash": "46961956a66b8c0e0afb60b42ef5a4de6e3ff3d29ce0a6872d5984111711a2c7",
					"size": 515,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-drain-event.js": {
					"match": false,
					"packageHash": "be87895c3b7afbbc1bbfc45ce7400233edde6454f990ce6fb26faafadf06903d",
					"size": 428,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-end-callback.js": {
					"match": false,
					"packageHash": "23db7c2cd9a7c5facb28a72a0749ce8572cb0645388cd310004b5c5a3b82f053",
					"size": 520,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-escape-id.js": {
					"match": false,
					"packageHash": "22af24e55f6f587e39ff8477dbf7178e72ccad405f002d73ce7a27412eaa0586",
					"size": 321,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-fatal-auth-error-going-to-all-callbacks.js": {
					"match": false,
					"packageHash": "201c0383d6141da5027d808b6645adb6afde75dacb885de2ec0dc0acd0a92761",
					"size": 632,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-fatal-auth-error-without-handlers.js": {
					"match": false,
					"packageHash": "5101941213b9ed05e86265df6bf2f3723a1e688c6a2d4b494c7fd2d17dd618c0",
					"size": 520,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-fatal-network-error-going-to-all-callbacks.js": {
					"match": false,
					"packageHash": "314f554bb94391b0417a2d14b2530653933173731bda7135dcb4549ff62db08f",
					"size": 528,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-fatal-network-error-without-handlers.js": {
					"match": false,
					"packageHash": "f762c481f61954ce337965b9e31ae9639c83ec5d5d8494f43c410ad95d43aa81",
					"size": 411,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-fatal-query-error-without-callback.js": {
					"match": false,
					"packageHash": "ed6cca45212eee04c89589f20595c83e5b476f3a378d228826b259ec7f5e3413",
					"size": 437,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-host-denied-error.js": {
					"match": false,
					"packageHash": "e75711203a3bb612b18f19117e52df8e74a4cb4b6fc33d6c247cf7649c93f12a",
					"size": 715,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-implicit-connect.js": {
					"match": false,
					"packageHash": "4a9229467c287aa4307b66089ec1660a18b2a8a5897313cdee8f06ddad41366f",
					"size": 332,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-insert-results.js": {
					"match": false,
					"packageHash": "094458062e1a02f1597c501edf997017de35806bd341ce67749af95666cd3e77",
					"size": 656,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-load-data-infile.js": {
					"match": false,
					"packageHash": "85aace60e6094eb332ba0a6fbae5ba2d56ee9ed8547c906c996af42ae547a2d7",
					"size": 1339,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-long-stack-traces-for-connection-errors.js": {
					"match": false,
					"packageHash": "0040abff4769d078fc68f549aa837f2fb7af4eef12e5de28e6771d0f5f1165d4",
					"size": 295,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-long-stack-traces.js": {
					"match": false,
					"packageHash": "5baca02a68d240e8ec503dd606a9f8929f01c918b4ef7966f03714318edd346f",
					"size": 370,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-multiple-statements-streaming.js": {
					"match": false,
					"packageHash": "02e334ef79fc21346072caaa99cc3a2b95e1eb481532add181663fceddbb24bd",
					"size": 1316,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-multiple-statements-with-error.js": {
					"match": false,
					"packageHash": "32f09e70340b85a41195e0f2c1b27b6195eeb64095184953a9d4abdb5c85c897",
					"size": 872,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-multiple-statements.js": {
					"match": false,
					"packageHash": "b4661ec91c69999ad1f251dd268b74744fe33a0e3b1a1f7c18d4e318a773e771",
					"size": 744,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-nested-tables-query.js": {
					"match": false,
					"packageHash": "06187813d433f04ba3c6f7282ac5cdbe1d5514a9390ce8acf80194d7c521610d",
					"size": 1141,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-normal-error-without-handler.js": {
					"match": false,
					"packageHash": "f91f38e965dcff8370623c320804960c6b74a62fb0ef26b6df21886cffa730c9",
					"size": 421,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-normal-query-error-without-callback.js": {
					"match": false,
					"packageHash": "febaef55c41a084722c1a88b54cfe6f2618fdfaecffb51f504c6464479e787f7",
					"size": 428,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-old-password.js": {
					"match": false,
					"packageHash": "c495509de5583be6b68adba142abbb9fb24a2347a0dd135e9b174ff885cc82d5",
					"size": 789,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-ping.js": {
					"match": false,
					"packageHash": "0c33a0277e228c24910353264ac5192baaa089c8fa81e179f8afb89b7d384564",
					"size": 277,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-procedure-with-multiple-selects.js": {
					"match": false,
					"packageHash": "dd1eb2452426aa9a748665be28ce19eafccd279b2c0bd131d6e2bc0492907b7a",
					"size": 1018,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-procedure-with-single-select.js": {
					"match": false,
					"packageHash": "4b4edc588428b4fa08f01021e36c55418c7f6195aa034556a3a7a1067576ede6",
					"size": 792,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-query-after-destroy.js": {
					"match": false,
					"packageHash": "fd2d5d03029ebc4baef7ade6e3df2434322ee8fa3aec1b77a5b9a506aa3a86c5",
					"size": 394,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-query-after-end-without-callback.js": {
					"match": false,
					"packageHash": "fe8ed71f35449ec17a3cf2d39c19b7b00d0ac3aaa7a5cf0672aca043c77c5834",
					"size": 496,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-query-after-end.js": {
					"match": false,
					"packageHash": "ea13c945bdb22be5748acaa0ebbdda88182bdaf45c6eb1cb13d90d06102a82bb",
					"size": 503,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-query-dates-as-strings.js": {
					"match": false,
					"packageHash": "c6834037bf6ae7d48ac5ebd7e2066eafec0e7e497f949a4cde1d04608d3c9e4e",
					"size": 1220,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-query-escape-id.js": {
					"match": false,
					"packageHash": "d976af386560119d30fe3575da7fb40cf162da235976b464f0f65bb86eb7487a",
					"size": 783,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-query-escaping.js": {
					"match": false,
					"packageHash": "af8609bbb3eb26733708e14fc39e869d84901c0c6090b16762ed63b81a56e8c9",
					"size": 933,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-select-1.js": {
					"match": false,
					"packageHash": "41936cb3c22b236a98dc51ca2795468cbff10084bd25f8d6ee85eebdf697e463",
					"size": 445,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-select-empty-string.js": {
					"match": false,
					"packageHash": "07154bf82eb5e2342de07ead051e79bb311f4d289665b9336fbd9ec0567d790a",
					"size": 323,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-server-timeout-disconnect.js": {
					"match": false,
					"packageHash": "2cabfb645dd9efe10f39be83475681836cd2d2016b0048a64aa3e78a4453b7ba",
					"size": 549,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-server-unexpected-disconnect.js": {
					"match": false,
					"packageHash": "a38446a5ab981d5f1733a371ccc1fe4a1fd9fdb64f8f2f4810923eef90a5e779",
					"size": 816,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-statistics.js": {
					"match": false,
					"packageHash": "65d37748e8c6510d132edf136eb8925820c2edee2f1747bb980d88b3e88355d6",
					"size": 986,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-streaming-rows-quick-pause-resume.js": {
					"match": false,
					"packageHash": "9d817f0609b58fa19e6fd8fca5915f7725f2f4f3cc5ab68b48a02892bb067f16",
					"size": 972,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-streaming-rows.js": {
					"match": false,
					"packageHash": "f824be1e46f6bab84fbf789659bc58ec41a35a813da578b67da291a42c04abee",
					"size": 1381,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-timezones.js": {
					"match": false,
					"packageHash": "3dd589d1a1531a9ee113540c8ed731ae8c6341df99a471231c53f06f664c04d6",
					"size": 1623,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-transaction-commit.js": {
					"match": false,
					"packageHash": "cc0fccadd6bae9618becd0f247746c7ae0b2f27342ece2dff19b8edcf180a1c4",
					"size": 886,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-transaction-rollback.js": {
					"match": false,
					"packageHash": "49bf32ebc70334653aefc99a3c27f85026cbdf7befc4181b8aedf5eafd40cde5",
					"size": 876,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-type-cast-null-fields.js": {
					"match": false,
					"packageHash": "4bd2c6366fec439d39379d7498394c3a2c76f1d9a403fa9fe5fde12bae949cfd",
					"size": 802,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-type-cast-query.js": {
					"match": false,
					"packageHash": "e469a25ae812fb456699a2a08fb3a982d79e6f2159dccefebc168f9184c3d316",
					"size": 1088,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-type-casting.js": {
					"match": false,
					"packageHash": "eb1a03b6af1e366c80f9a08105861e1b9bcf167e262bb855c88dde485d35e160",
					"size": 5087,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-unix-domain-socket.js": {
					"match": false,
					"packageHash": "a29aa3ec06bcbc2850a36411609e814ca0a6bd0d4127ae9f979957da6a1db772",
					"size": 759,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/connection/test-zerofill-results.js": {
					"match": false,
					"packageHash": "5fc9c6cc00e9076a8968993b96f3b1b517022185e08324e3db248f524a3d9eac",
					"size": 1224,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/pool/test-connection-limit.js": {
					"match": false,
					"packageHash": "da2c5a1c062de662a0e7d02c909133eaa8f7aa6446d4ab7c92a12c5d1248fb4c",
					"size": 636,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/pool/test-destroy-connection.js": {
					"match": false,
					"packageHash": "4c73d0ef29bd418bd706f085599f530a12763a0e07aa8e7f5c956e3529c60cbf",
					"size": 568,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/pool/test-end-empty.js": {
					"match": false,
					"packageHash": "514a4b7a93e6572c32726e89f7b31429757af97ac17f402befd0b9cfbaf22887",
					"size": 266,
					"status": "missing-in-source"
				},
				"tests_fail/integration-mysql1/pool/test-get-connection.js": {
					"match": false,
					"packageHash": "a96ddd84903edd889926af15087bf4230ddb0d8de0e2e4fe4344ba5cb9a196b5",
					"size": 258,
					"status": "missing-in-source"
				},
				"tests_fail/test-exception-safety.js": {
					"match": false,
					"packageHash": "7244712f73a7ff56423130a394f2ace7e7e9daa65683eeddc22b58560017b82d",
					"size": 1855,
					"status": "missing-in-source"
				},
				"tests_fail/test-send-and-receive-large-packets.js": {
					"match": false,
					"packageHash": "f164695224bb540f567293dbe1735a89755832f56688d3ec0e00325d454f8e34",
					"size": 2208,
					"status": "missing-in-source"
				},
				"index.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_41.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_plugins/caching_sha2_password.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_plugins/caching_sha2_password.md": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_plugins/index.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_plugins/mysql_clear_password.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_plugins/mysql_native_password.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/auth_plugins/sha256_password.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/base/connection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/base/pool.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/base/pool_connection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/auth_switch.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/binlog_dump.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/change_user.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/client_handshake.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/close_statement.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/ping.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/prepare.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/quit.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/register_slave.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/commands/server_handshake.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/compressed_protocol.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/charset_encodings.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/encoding_charset.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/session_track.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/constants/ssl_profiles.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/create_connection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/create_pool.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/create_pool_cluster.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/helpers.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/auth_next_factor.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/auth_switch_request.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/auth_switch_request_more_data.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/auth_switch_response.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/binlog_dump.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/binlog_query_statusvars.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/change_user.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/close_statement.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/register_slave.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/packets/ssl_request.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/parsers/binary_parser.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/parsers/parser_cache.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/parsers/static_binary_parser.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/parsers/static_text_parser.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/parsers/string.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/parsers/text_parser.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/pool_cluster.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/pool_connection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/connection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/inherit_events.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/make_done_cb.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/pool.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/pool_cluster.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/pool_connection.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/promise/prepared_statement_info.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"lib/server.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"promise.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"promise.js": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/LICENSE.txt": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/index.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/info.txt": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/Auth.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/Connection.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/Pool.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/PoolCluster.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/PoolConnection.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/Server.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/constants/CharsetToEncoding.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/constants/Charsets.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/constants/Types.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/constants/index.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/parsers/ParserCache.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/parsers/index.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/parsers/typeCast.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/Field.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/FieldPacket.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/OkPacket.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/ProcedurePacket.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/ResultSetHeader.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/RowDataPacket.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/index.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/params/ErrorPacketParams.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/packets/params/OkPacketParams.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/ExecutableBase.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/Prepare.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/Query.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/QueryableBase.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/Sequence.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/promise/ExecutableBase.d.ts": {
					"match": false,
					"status": "missing-in-package"
				},
				"typings/mysql/lib/protocol/sequences/promise/QueryableBase.d.ts": {
					"match": false,
					"status": "missing-in-package"
				}
			},
			"summary": {
				"differentFiles": 34,
				"matchingFiles": 0,
				"missingInPackage": 90,
				"missingInSource": 101,
				"score": 0,
				"totalFiles": 225
			}
		}
	}
]
